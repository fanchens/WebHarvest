"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["10377"],{965775:function(e,i,t){t.r(i),t.d(i,{Helmet:function(){return l}});let l=t(429719).Head},103104:function(e,i,t){t.d(i,{z:function(){return u}});var l=t(520739),n=t(563097);t(88648);var o=t(326673),r=t(713097),a=t.n(r);let u=e=>{let{size:i="normal",type:t="primary",children:r,autoFixed:u=!0,className:d,width:s,style:v,theme:c="solid",disabled:_=!1,newStyle:f=!1,onClick:m}=e,p=a()(o.default.button,o.default[i],o.default[t],o.default[c],{[o.default.fixed]:!u,[o.default.newStyle]:f},d);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("button",{type:"button",disabled:_,onClick:m,className:p,style:(0,l._)({width:s&&`${s}px`},v),children:r})})}},819972:function(e,i,t){t.d(i,{k:function(){return d}});var l=t(563097),n=t(88648),o=t(222406),r=t(620923),a=t(519055);let u=function(e,i,t,l){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"component",o=arguments.length>5?arguments[5]:void 0;null==l||l(e,i),"module"===n&&(null==o||o("report",{ev_type:"blank_screen",payload:{timestamp:Date.now(),score:0,error:{type:"js_error",message:e.message}}})),null==o||o("sendEvent",{name:"live_component_error_boundary",categories:{componentName:t,message:e.message,stack:e.stack,componentStack:i,isNewProject:!0},type:"event"})},d=e=>{let{onError:i,beforeCapture:t,fallback:d,children:s,type:v="component",componentName:c,_slardarInstance:_}=e,f=(0,n.useMemo)(()=>{if(!a.s)return _||(0,r.OK)()},[_]),m=n.useCallback((e,t)=>{u(e,t,c,i,v,f)},[v,i,c,f]);return(0,l.jsx)(o.SV,{onError:m,beforeCapture:t,fallback:d,Slardar:f,children:s})}},83188:function(e,i,t){t.d(i,{M2:function(){return r},_q:function(){return u},dE:function(){return a}}),t(250440);var l=t(408487),n=t(926012),o=t(207964);let r=(e,i)=>{if([void 0,null,""].includes(e))return;let t=Number(e);if(i){let e=i.find(e=>t===e.id);if(e)return e.value}switch(t){case l.V_.LINKMICUILAYOUT_VIDEOCHAT_DYNAMICLAYOUT1V6:return n.yP.VIDEO_DYNAMIC_FLOAT;case l.V_.LINKMICUILAYOUT_VIDEOCHAT_ENLARGEGUEST1V6:case l.V_.LINKMICUILAYOUT_VIDEOCHATFLOATWINDOWLAYOUT:return n.yP.VIDEO_1V6;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_3X3:return n.yP.VIDEO_GRID;case l.V_.LINKMICUILAYOUT_VIDEOEQUALDYNAMICLAYOUT:return n.yP.VIDEO_DYNAMIC;case l.V_.LINKMICUILAYOUT_CROSSROOMLINKMIC_6V6:return n.yP.VIDEO_6V6;case l.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8:return n.yP.AUDIO_1V8;case l.V_.LINKMICUILAYOUT_AUDIOCHAT_3X3:return n.yP.AUDIO_GRID;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V3:return n.yP.VIDEO_1_V_3;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V6:return n.yP.VIDEO_1_V_6;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V8:return n.yP.VIDEO_1_V_8;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_TOP1V8:return n.yP.VIDEO_T1_V_B8;case l.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_STAGE:return n.yP.AUDIO_1V8_STAGE;case l.V_.LINKMICUILAYOUT_VIDEOEQUAL_DYNAMICLAYOUT1V8FIX:return n.yP.VIDEO_1V8;case l.V_.LINKMICUILAYOUT_VIDEO_2V4V4:return n.yP.VIDEO_2V4V4;case l.V_.LINKMICUILAYOUT_LIVE_PARTNER_DYNAMIC:return n.yP.MATE_CUSTOM;case l.V_.LINKMICUILAYOUT_AUDIOCHAT_TOP2V4V4:return n.yP.AUDIO_DOUBLE_C;case l.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_ENLARGE_STAGE:if((0,o.getInLiveAudioLayoutOptAB)())return n.yP.AUDIO_1V8_STAGE;return n.yP.AUDIO_1V8;default:return}},a=e=>"new_audience"===e,u=(e,i)=>{if([e,i].some(e=>!e))return{top:0,left:0,right:0,bottom:0};let t=e.getBoundingClientRect(),l=i.getBoundingClientRect(),n=l.top-t.top,o=l.left-t.left,r=o+i.clientWidth,a=n+i.clientHeight;return{top:n,left:o,right:r,bottom:a}}},81947:function(e,i,t){t.d(i,{l:function(){return l}});var l={TRIPLE_SCREEN_PLUGIN:"triple_screen_plugin",ROTATE_PLUGIN:"rotate_plugin",GLOBAL_APP:"global_app",GIFT_BAR:"gift_bar",GIFT_BAR_MINI:"gift_bar_mini",HEADER:"header",NAVIGATION:"navigation",SIDEBAR:"siderbar",CATEGORY_TAB:"category_tab",TAB:"tab",TITLE_PLUGIN:"title_plugin",FOLLOW_PLUGIN:"follow_plugin",COMMENT_PLUGIN:"comment_plugin",GIFT_SWITCH_PLUGIN:"gift_switch_plugin",GIFT_BAR_PLUGIN:"gift_bar_plugin",EFFECT_SWITCH_PLUGIN:"effect_switch_plugin",GIFT_TRAY_PLUGIN:"gift_tray_plugin",GIFT_EFFECT_PLUGIN:"gift_effect_plugin",FANS_CLUB_PLUGIN:"fans_club_plugin",EXHIBITION_VIEW_PLUGIN:"exhibition_view_plugin",VIP_VIEW_PLUGIN:"vip_view_plugin",EFFECT_PLUGIN:"effect_plugin",HOUR_RANK_LIST_VIEW_PLUGIN:"hour_rank_list_view_plugin",TOOL_BAR_PLUGIN:"tool_bar_plugin",QUALITY_SWITCH_PLUGIN:"quality_switch_plugin",DANMAKU_PLUGIN:"danmaku_plugin",AUDIO_ROOM_PLUGIN:"audio_room_plugin",VIDEO_ROOM_PLUGIN:"video_room_plugin",RTC_LAYER_PLUGIN:"rtc_layer_plugin",PK_VIEW_PLUGIN:"pk_view_plugin",PIP_PLUGIN:"pip_plugin",INPICTURE_PLUGIN:"inpicture_plugin",ADMIN_PRIVILEGE_PLUGIN:"admin_privilege_plugin",LIVING_PLAYER:"living_plyaer",IFRAME_PLAYER:"iframe_player",GIFT_ITEM:"gift_item",GIFT_PANEL:"gift_panel",LIVE_CATEGORY:"live_category",LIVE_CARD:"live_card",RANK_LIST:"rank_list",ORDER_SING_LIST:"order_sing_list",ORDER_SING_RULE:"order_sing_rule",PROMOTION_POP:"promotion_pop",PROMOTION_LIST_WRAPPER:"promotion_list_wrapper",FANS_CLUB_POPUP:"fans_club_popup",USER_POPUP:"user_popup",CHAT_ROOM_PANEL:"chat_room_panel",AUDIENCE_PANEL:"audience_panel",FIXED_CHAT:"fixed_chat",LIVE_CAROUSEL:"live_carousel",LIVE_COVER:"live_cover",LIVE_FULLPLAYER_QULIATY:"live_fullplayer_quality",Live_Like:"live_like",Live_Flutter_Like:"live_flutter_like",DANMAKU_SETTINGS:"danmaku_settings",VIP_LIVE_BOUNDARY:"vip_live_boundary",FOLD_CHAT_ROOM_COMMENT_PLUGIN:"fold_chat_room_comment_plugin",LIVING_PIP_WINDOW:"living-pip-window",SHORT_CUT:"short_cut",SERVICE_CENTER_PLUGIN:"service_center_plugin",QUALITY_SWITCH:"quality_switch",LivePreviewEnterRoom:"LivePreviewEnterRoom",LiveUserProfile:"live_user_profile",LOTTERY_COMPONENT:"lottery_componet",LOTTERY_COMPONENT_PLUGIN:"lottery_componet_plugin",LINK_MIC_DYNAMIC_CONFIG:"link_mic_dynamic_config",LIVE_RESERVE_CARD:"live_reserve_card",StreamCompute:"StreamCompute",RoomLogic:"RoomLogic",EnterAndLeave:"EnterAndLeave",ForceLoginRecorder:"ForceLoginRecorder",ChatRoom:"ChatRoom",Tracking:"Tracking",RoomInit:"RoomInit",RoomMessageConsume:"RoomMessageConsume",StatusHandler:"StatusHandler",RoomEvent:"RoomEvent",RightPanelContainer:"RightPanelContainer",RoomInfoBar:"RoomInfoBar",LandPageContainer:"LandPageContainer",LiveShare:"LiveShare",OperatingBar:"OperatingBar",TheaterPlugin:"TheaterPlugin",KeyBindPlugin:"KeyBindPlugin",VolumeMemoryPlugin:"VolumeMemoryPlugin",RefreshPlugin:"RefreshPlugin",HintContainerPlugin:"HintContainerPlugin",CancelMutePlugin:"CancelMutePlugin",GlobalControlPlugin:"GlobalControlPlugin",PlayerLoggerPlugin:"PlayerLoggerPlugin",PlayerTeaLogPlugin:"PlayerTeaLogPlugin",PlayerEndCover:"PlayerEndCover",VolumeWheelPlugin:"VolumeWheelPlugin",AdaptedBySEIPlugin:"AdaptedBySEIPlugin",PKSEIPlugin:"PKSEIPlugin",NewPlayerErrorCover:"NewPlayerErrorCover",PaidLivePlugin:"PaidLivePlugin",LeadingLoginPlugin:"LeadingLoginPlugin",LinkMicLayoutPlugin:"LinkMicLayoutPlugin",LinkMicPlayModeLimitPlugin:"LinkMicPlayModeLimitPlugin",UpdateFunctionTypePlugin:"UpdateFunctionTypePlugin",TopEffectPlugin:"TopEffectPlugin",OrderSingPlugin:"OrderSingPlugin",GroupFightPlugin:"GroupFightPlugin",GuestBattlePlugin:"GuestBattlePlugin",LiveReserveCard:"LiveReserveCard",PlayerControl:"PlayerControl",UgcAvatar:"UgcAvatar",PlayerEventConsume:"PlayerEventConsume",GroupLive:"GroupLive",ChangeDynamicBg:"ChangeDynamicBg",LinkMicApplyPlugin:"LinkMicApplyPlugin",ORDER_SING_SELECT_GUEST:"order_sing_select_guest",PausePop:"PausePop",DetailContextMenuPlugin:"DetailContextMenuPlugin",DoubleScreenPlugin:"DoubleScreenPlugin",ProgrammeWrapper:"ProgrammeWrapper",LiveTDK:"LiveTDK",AutoRunModal:"AutoRunModal",AudioCheatTips:"AudioCheatTips",GetDressList:"GetDressList",GROUP_LIVE_PLUGIN:"group_live_plugin",LiveFromAppTips:"LiveFromAppTips",COMMENT_EDITOR:"comment_editor",WaterMark:"WaterMark",LIVE_CARD_IN_MIX_PLAYER:"live_card_in_mix_player",VrPlugin:"VrPlugin",Gift_MENU_PLUGIN:"GiftMenu",LIVE_CHANNEL_BANNER_ROOMS:"LIVE_CHANNEL_BANNER_ROOMS",LIVE_CHANNEL_BANNER:"LIVE_CHANNEL_BANNER"}},795478:function(e,i,t){t.d(i,{qd:function(){return T},Lj:function(){return E}});var l=t("520739"),n=t("878389"),o=t("64814"),r=t("88648"),a=t("859231");let u=e=>{var i,t;let l=null==e?void 0:e.data[0],n=(null==l?void 0:l.live_room_mode)!==a.ke.MEDIA&&(null==l?void 0:null===(i=l.room_auth)||void 0===i?void 0:i.LandscapeChat)!==a.xW.OFF;return{roomEnterMode:e.enter_mode,roomAuth:null==l?void 0:l.room_auth,anchor:null==e?void 0:e.user,roomId:e.enter_room_id,roomStatus:null==l?void 0:l.status,roomTitle:null==l?void 0:l.title,roomUserCount:null==l?void 0:l.user_count_str,roomCover:null==l?void 0:l.cover,roomAdminUserIds:null==l?void 0:l.admin_user_ids_str,roomLiveRoomMode:null==l?void 0:l.live_room_mode,roomViewStats:null==l?void 0:l.room_view_stats,roomOthers:null==l?void 0:l.others,roomInfo:l,isOpenDanmu:n,isDanmuOn:n,isOpenComment:null==l?void 0:null===(t=l.room_auth)||void 0===t?void 0:t.Chat,roomInit:!0,qrcodeUrl:null==e?void 0:e.qrcode_url}};var d=(e,i,t)=>({roomEnterMode:null,roomAuth:null,anchor:null,webRid:null,roomId:null,roomStatus:null,roomTitle:null,roomUserCount:null,roomCover:null,roomAdminUserIds:[],roomLiveRoomMode:null,roomViewStats:null,roomOthers:null,roomInfo:null,roomStats:null,setAnchor:i=>e(()=>({anchor:i})),setRoomViewStats:i=>e(()=>({roomViewStats:i})),setRoomStatus:i=>e(()=>({roomStatus:Number(i)})),setRoomAuth:i=>e(()=>({roomAuth:i})),setRoomInfo:i=>e(()=>({roomInfo:i})),initRoom:i=>e(()=>u(i)),setWebRid:i=>e(()=>({webRid:i})),roomErrorStatus:a.$V.DEFAULT,setRoomErrorStatus:i=>e(()=>({roomErrorStatus:i})),isOpenDanmu:!0,isDanmuOn:!1,setIsDanmuOn:i=>e(()=>({isDanmuOn:i})),isCleanScreen:!1,setIsCleanScreen:i=>e(()=>({isCleanScreen:i})),isOpenComment:!1,isMedia:!1,roomInit:!0,qrcodeUrl:"",isLiveModal:!1,setIsLiveModal:i=>e(()=>({isLiveModal:i})),isInnerText:"",setInnerText:i=>e(()=>({isInnerText:i}))}),s=t("389128");t("413806"),t("826893");var v=t("566125");let c=e=>{var i,t,l,n,o,r,a,u;let d={data:{}};try{d=JSON.parse(null!==(u=null==e?void 0:null===(a=e.live_core_sdk_data)||void 0===a?void 0:null===(r=a.pull_data)||void 0===r?void 0:r.stream_data)&&void 0!==u?u:"{}")}catch(e){}let s=null==e?void 0:e.hls_pull_url_map,v=null==e?void 0:null===(i=e.default_resolution)||void 0===i?void 0:i.toLocaleUpperCase();return{defaultResolution:v,streamOrientation:null==e?void 0:e.stream_orientation,flvPullUrl:null==e?void 0:e.flv_pull_url,hlsPullUrl:s||{[v]:null==e?void 0:e.hls_pull_url},options:null==e?void 0:null===(l=e.live_core_sdk_data)||void 0===l?void 0:null===(t=l.pull_data)||void 0===t?void 0:t.options,streamData:d,extension:null==e?void 0:null===(o=e.live_core_sdk_data)||void 0===o?void 0:null===(n=o.pull_data)||void 0===n?void 0:n.extension,streamType:null==e?void 0:e.stream_orientation}};var _=t("889503");let f=(e,i)=>{let t=null==e?void 0:e.split("?")[0];return t===(null==i?void 0:i.split("?")[0])};var m=(e,i,t)=>({useOptions:{useH265:!1,useFlv:!0},h264:null,h265:null,currentResolution:null,setH264:i=>e(()=>({h264:i})),setH265:i=>e(()=>({h265:i})),setUseOptions:i=>e(()=>({useOptions:i})),setCurrentResolution:i=>e(()=>({currentResolution:i})),getCurrentStream:()=>{var e;let t=i();return(null==t?void 0:null===(e=t.useOptions)||void 0===e?void 0:e.useH265)?null==t?void 0:t.h265:null==t?void 0:t.h264},getQuliaties:()=>{var e,t,l;let n=null===(e=i())||void 0===e?void 0:e.getCurrentStream();return null!==(l=null==n?void 0:null===(t=n.options)||void 0===t?void 0:t.qualities)&&void 0!==l?l:[]},streamUrl:"",streamInit:!1,sessionId:"",setSessionId:i=>e(()=>({sessionId:i})),initStream:function(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.jx.H264;return e(e=>{var l,n,o,r,a,u;let d=t===v.jx.H265?"h265":"h264";return{sessionId:null!==(u=null===(n=JSON.parse(null!==(a=null==i?void 0:null===(r=i.live_core_sdk_data)||void 0===r?void 0:null===(o=r.pull_data)||void 0===o?void 0:o.stream_data)&&void 0!==a?a:"{}"))||void 0===n?void 0:null===(l=n.common)||void 0===l?void 0:l.session_id)&&void 0!==u?u:"",[d]:c(i),streamInit:!0}})},initUrl:()=>e(e=>{var i,t,l,n,o,r;let a=null==e?void 0:e.getCurrentStream(),u=null!==(n=(null==e?void 0:null===(i=e.useOptions)||void 0===i?void 0:i.useFlv)?null==a?void 0:a.flvPullUrl:null==a?void 0:a.hlsPullUrl)&&void 0!==n?n:{},d=null==a?void 0:a.defaultResolution,s=(0,_.uC)(null!==(o=u[d])&&void 0!==o?o:""),v={currentResolution:null!==(r=null==a?void 0:null===(l=a.options)||void 0===l?void 0:null===(t=l.default_quality)||void 0===t?void 0:t.sdk_key)&&void 0!==r?r:""};return!f(s,e.streamUrl)&&(v.streamUrl=s),v})}),p=t("83188");let g=e=>{var i,t,l;let n=null==e?void 0:e.data[0],o=null!==(l=null==n?void 0:null===(i=n.linker_detail)||void 0===i?void 0:i.linker_play_modes)&&void 0!==l?l:[],r=null==n?void 0:null===(t=n.linker_detail)||void 0===t?void 0:t.linker_ui_layout;return{layout:(0,p.M2)(r),linkerPlayModes:o}};var h=(e,i,t)=>({layout:void 0,setLayout:i=>e(()=>({layout:i})),linkSeats:{},setLinkSeats:i=>e(()=>({linkSeats:i})),linkUsers:{},setLinkUsers:i=>e(()=>({linkUsers:i})),initLinkMick:i=>e(()=>g(i)),linkPositions:{},setLinkPositions:i=>e(()=>({linkPositions:i})),isPlayModeNotSupport:!1,setIsPlayModeNotSupport:i=>e(()=>({isPlayModeNotSupport:i}))}),y=(e,i,t)=>({});let w=e=>{let i=null==e?void 0:e.data[0];return{toolbarData:null==i?void 0:i.toolbar_data,hasInitToolBarData:!0}};var P=(e,i,t)=>({toolbarData:{},hasInitToolBarData:!1,cartVisible:!1,setToolBarData:i=>e(()=>({toolbarData:i})),initEcommerce:i=>e(()=>w(i)),setCartVisible:i=>e(()=>({cartVisible:i}))}),C=(e,i,t)=>({adData:null,setAdData:i=>e(()=>({adData:i}))}),I=(e,i,t)=>({}),S=t("114217");let E=e=>()=>(0,o.ZP)((i,t,o)=>(0,n._)((0,l._)({},d(i,t,o),(0,s.Z)(i,t,o),m(i,t,o),h(i,t,o),h(i,t,o),y(i,t,o),P(i,t,o),C(i,t,o),I(i,t,o)),{destroy:()=>{o.destroy()},initByFeed:e=>{let i=t();null==i||i.initStream(e.stream_url),null==i||i.initUrl()},initByEnter:function(e){let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1],l=t();if((null==e?void 0:e.status_code)===0){let{data:t}=e,n=null==t?void 0:t.data[0];i&&(null==l||l.initStream(t.web_stream_url,v.jx.H265),null==l||l.initStream(null==n?void 0:n.stream_url,v.jx.H264),null==l||l.initUrl()),null==l||l.initRoom(t),null==l||l.initEcommerce(t),null==l||l.initLinkMick(t)}},loading:!0,webRid:e,messageInstance:new S.v0C,setMessageInstance:e=>i(i=>({messageInstance:e})),teaCommonParams:{},setTeaCommonParams:e=>i(i=>({teaCommonParams:e})),isActive:!1,setIsActive:e=>i(i=>({isActive:e}))})),T=(0,r.createContext)({})},389128:function(e,i,t){var l=t(566125),n=t(716551),o=t(738612);i.Z=(e,i,t)=>({position:{x:0,y:0},playerCoverText:n.kx.NONE,setPlayerCoverText:i=>e(()=>({playerCoverText:i})),setPosition:i=>e(()=>({position:i})),pauseReason:l.g.DEFAULT,setPauseReason:i=>e(()=>({pauseReason:i})),isTheaterOn:!1,setIsTheaterOn:i=>e(()=>({isTheaterOn:i})),isEffectSwitch:!0,setIsEffectSwitch:i=>e(()=>({isEffectSwitch:i})),emojiList:[],emojiReflex:{},setEmojiList:i=>e(()=>({emojiList:i})),setEmojiReflex:i=>e(()=>({emojiReflex:i})),marginControls:!0,setMarginControls:i=>e(()=>({marginControls:i})),screenMode:o.wq.NORMAL,setScreenMode:i=>e(()=>({screenMode:i})),playLoggerExt:{},setPlayLoggerExt:i=>e(()=>({playLoggerExt:i})),hasPlay:!1,setHasPlay:i=>e(()=>({hasPlay:i})),videoInit:!1,setVideoInit:i=>e(()=>({videoInit:i})),isEditComment:!1,setIsEditComment:i=>e(()=>({isEditComment:i})),isFullScreen:!1,setIsFullScreen:i=>e({isFullScreen:i}),fullScreenRoot:null,setFullScreenRoot:i=>e({fullScreenRoot:i})})},566125:function(e,i,t){t.d(i,{g:function(){return l},jx:function(){return n}});var l={PLAYER_ERROR:0,0:"PLAYER_ERROR",USER:1,1:"USER",DEFAULT:2,2:"DEFAULT"},n={H264:0,0:"H264",H265:1,1:"H265"}},912835:function(e,i,t){t.d(i,{C:function(){return r},D:function(){return a}}),t(874386),t(675373);var l=t(620923),n=t(56702),o=t(419631);let r=t.n(o)()(async()=>{try{return n.CpO.instance}catch(i){var e;null===(e=(0,l.OK)())||void 0===e||e.sendEvent({name:"import_static_idl_error",categories:{error:i}})}}),a=async function(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];let l=await r();return null==l?void 0:l.decode(...i)}},114217:function(e,i,t){t.d(i,{v0C:function(){return p}});var l=t(134761),n=t(520739),o=t(878389);t(413806),t(826893),t(284961),t(927234),t(874386);var r=t(44905),a=t(519055),u=t(400985),d=t(620923),s=t(661898),v=t(785632),c=t(455239),_=t(119159),f=t(912835),m=t(207964);t(56702);class p extends s.TQ{setImRequestPath(e){this.polling.props.im_path=e}setWebsocketKey(e){this.polling.props.websocket_key=e}setInsertKey(e,i){this.insertData={insert_task_id:e,live_reason:i}}getimReponseHeader(){return this.headers.fetchHeader}getCursor(){var e;return null===this||void 0===this?void 0:null===(e=this.cursor)||void 0===e?void 0:e._first_cursor}getPolling(){return this.polling}getDecoder(){return null===this||void 0===this?void 0:this.decoder}getimPushResponseHeader(){return this.headers.pushHeader}getimHeader(){return this.headers}subscribe(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.C7.ASYNC;if(t===_.C7.ASYNC){let t=e.split(",").map(e=>this.on(e.replace(v.nl,""),i));return()=>{t.forEach(e=>e())}}let l=e=>i([e]);this.cachedHandler.set(i,l);let n=e.split(",").map(e=>this.syncOn(e.replace(v.nl,""),l));return()=>{this.cachedHandler.delete(i),n.forEach(e=>e())}}unsubscribe(e,i){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.C7.ASYNC;if(t===_.C7.ASYNC){e.split(",").forEach(e=>this.off(e.replace(v.nl,""),i));return}let l=this.cachedHandler.get(i);this.cachedHandler.delete(i),e.split(",").forEach(e=>this.syncOff(e.replace(v.nl,""),l))}start(e){var i,t,l,o,r,u,s,c;arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{this.systemEmitter.on("header",(e,i)=>{if("http"===e&&!this.headers.fetchHeader){this.headers.fetchHeader=i;return}if("socket"===e){this.headers.pushHeader=i;return}});let d="15";if(!a.s){let e=(null===(u=window)||void 0===u?void 0:null===(r=u.__STORE__)||void 0===r?void 0:null===(o=r.roomStore)||void 0===o?void 0:null===(l=o.roomInfo)||void 0===l?void 0:null===(t=l.room)||void 0===t?void 0:null===(i=t.room_auth)||void 0===i?void 0:i.FirstFeedHistChat)||0;2===e&&(d="0")}"string"==typeof e?super.start({room_id:e,identity:v.nN.Audience,need_persist_msg_count:d,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason}):super.start((0,n._)({identity:v.nN.Audience,need_persist_msg_count:d,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason},e))}catch(e){try{(0,d.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",categories:{message:null==e?void 0:e.message,stack:null==e?void 0:null===(c=e.stack)||void 0===c?void 0:null===(s=c.toString)||void 0===s?void 0:s.call(c)},level:"warn",type:"log"}})}catch(e){}}}queuePush(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];i.forEach(e=>this.mock(e.method,e))}constructor(){var e;super(f.C,{host:(0,u.iE)().API_DOMAIN,aid:"6383",live_id:1,app_name:"douyin_web",did_rule:3,endpoint:"live_pc",support_wrds:1,user_unique_id:null===(e=(0,r.Es)())||void 0===e?void 0:e.user_unique_id,im_path:"/webcast/im/fetch/",websocket_key:[]},[],{emitter:new c.Q,get backdropWhenHidden(){if("undefined"==typeof window||(0,m.getInLiveMsgFetchOpt)())return[];return["ChatMessage","GiftMessage","LikeMessage"]},wrdsV1:["WebcastPaidLiveTypeModifyMessage"]}),(0,l._)(this,"headers",{}),(0,l._)(this,"insertData",{insert_task_id:"",live_reason:""}),(0,l._)(this,"cachedHandler",new Map);let i=(0,o._)((0,n._)({},this.wrds),{subscribe:(e,i)=>{let t=e.split(",").map(t=>this.wrds.on("RoomDataSyncMessage",e,i,"v1"));return()=>{t.forEach(e=>e())}},unsubscribe:(e,i)=>{e.split(",").forEach(e=>{this.wrds.off("RoomDataSyncMessage",e,i)})}});this.wrds=i,!a.s&&(window.__use_isaac_sdk=!0),this.systemEmitter.on("downgrade",e=>{var i,t,l,n,o,r;this.downgrade(e),(0,d.OK)().report({ev_type:"custom",payload:{name:"im-sdk-downgrade",metrics:{downgrade:1},categories:{type:scope,userId:null===(l=window.INITIAL_STATE)||void 0===l?void 0:null===(t=l.userStore)||void 0===t?void 0:null===(i=t.userInfo)||void 0===i?void 0:i.id_str,roomId:null===(r=window.INITIAL_STATE)||void 0===r?void 0:null===(o=r.roomStore)||void 0===o?void 0:null===(n=o.roomInfo)||void 0===n?void 0:n.roomId},type:"event"}})}),this.systemEmitter.on("error",(e,i)=>{var t,l,n,o,r,a;(0,d.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",metrics:{[e]:1},categories:{type:e,userId:null===(n=window.INITIAL_STATE)||void 0===n?void 0:null===(l=n.userStore)||void 0===l?void 0:null===(t=l.userInfo)||void 0===t?void 0:t.id_str,roomId:null===(a=window.INITIAL_STATE)||void 0===a?void 0:null===(r=a.roomStore)||void 0===r?void 0:null===(o=r.roomInfo)||void 0===o?void 0:o.roomId},content:`${i}`,level:"warn",type:"log"}})})}}},388521:function(e,i,t){t.d(i,{f:function(){return l}}),t(284961),t(826893);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/^http:\/\//i,"https://")}},785594:function(e,i,t){t.d(i,{J:function(){return n},U:function(){return l}});var l={RECOMMEND:253,253:"RECOMMEND",FOLLOW:254,254:"FOLLOW"},n={TEXTANDICON:1,1:"TEXTANDICON",IMG:2,2:"IMG",AVATAR:3,3:"AVATAR"}},700662:function(e,i,t){t.d(i,{$:function(){return s}}),t(874386);var l=t(563097),n=t(88648),o=t(965775),r=t(330746),a=t(746025),u=t(399796),d=t(35730);function s(e){let{children:i,mobileUrl:t,nonce:s,applicableDevice:v="pc,mobile"}=e,[c,_]=n.useState(!1);n.useEffect(()=>{(0,r.GP)()&&_(!0)},[]);let f=n.useMemo(()=>(0,a.Dr)(u.Q.getItem({sKey:d.CookieKeys.Theme})),[]);return(0,l.jsxs)(o.Helmet,{children:[(0,l.jsx)("meta",{charSet:"utf-8"}),i,(0,l.jsx)("meta",{httpEquiv:"Cache-Control",content:"no-transform"}),(0,l.jsx)("meta",{httpEquiv:"Cache-Control",content:"no-siteapp"}),(0,l.jsx)("meta",{httpEquiv:"x-dns-prefetch-control",content:"on"}),(0,l.jsx)("meta",{name:"applicable-device",content:t?"pc":v}),t&&(0,l.jsx)("meta",{name:"mobile-agent",content:`format=[html5]; url=${t}`}),t&&(0,l.jsx)("link",{rel:"alternate",media:"only screen and (max-width: 640px)",href:t}),(0,l.jsx)("meta",{name:"baidu-site-verification",content:"code-2WPwEy0bEv"}),(0,l.jsx)("meta",{name:"google",content:"notranslate"}),(0,l.jsx)("meta",{name:"theme-color",content:`${"light"===f?"#ffffff":"#161823"}`}),(0,l.jsx)("script",{nonce:s,children:`
        (function(win, export_obj) {
          win['TeaAnalyticsObject'] = export_obj;
          if (!win[export_obj]) {
              function _collect() {
                  _collect.q.push(arguments);
              }
              _collect.q = _collect.q || [];
              win[export_obj] = _collect;
          }
          win[export_obj].l = +new Date();
      })(window, 'collectEvent');
      `}),!c&&(0,l.jsx)("link",{rel:"manifest",href:"https://p-pc-weboff.byteimg.com/tos-cn-i-9r5gewecjs/pwa/manifest.json"}),(0,l.jsx)("link",{href:"//fonts.bytedance.com/dfd/api/v1/css?family=DFPKingGothicGB-Medium:500&display=swap",rel:"stylesheet",media:"print",id:"media1"}),(0,l.jsx)("link",{href:"//fonts.bytedance.com/dfd/api/v1/css?family=DFPKingGothicGB-Regular:500&display=swap",rel:"stylesheet",media:"print",id:"media2"}),(0,l.jsx)("script",{nonce:s,children:`
          document.getElementById("media1").addEventListener("load", function () {
            this.media = "all";
            this.onload = null;
          });
          document.getElementById("media2").addEventListener("load", function () {
            this.media = "all";
            this.onload = null;
          });
        `})]})}},758590:function(e,i,t){t.d(i,{g:function(){return g}});var l=t(520739);t(874386),t(250440);var n=t(88648),o=t(746864),r=t(147613),a=t(79307),u=t(782442),d=t(433188),s=t(637005),v=t(367366),c=t(631493),_=t(532765),f=t(903868);let m=[o.e.LiveCard,o.e.WordCupCard,o.e.Article],p=[o.e.LiveCard,o.e.WordCupCard,o.e.Note,o.e.Article],g=e=>{let{swiper:i,setAwemeInfoList:t,awemeInfoList:g,awemeInfo:h,refMixPlayer:y,liveCardDisable:w=!0,scrollRef:P,isInnerFeed:C,enterFrom:I}=e,S=(0,n.useRef)(null),E=(0,_.Z)({refMixPlayer:y,from:"sideList"}),{isWebMiniWin:T,isListenVideoMiniWin:L}=(0,f.Iq)(e=>{let{isWebMiniWin:i,isListenVideoMiniWin:t}=e;return{isWebMiniWin:i,isListenVideoMiniWin:t}}),[N,b]=(0,n.useState)(!1),A=(0,n.useRef)({}),x=(0,n.useRef)([]),D=(0,n.useRef)(0);x.current=g,S.current=null==P?void 0:P.current;let k=(0,n.useMemo)(()=>T||E||L,[T,E,L]);return(0,r.o)(()=>{var e,l;let n=void 0!==C&&C||(null===(e=u.Le.getConfig(u.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal),o=null==y?void 0:null===(l=y.current)||void 0===l?void 0:l.getPlayer();if(!(o&&!o.isUserActive&&I&&["follow","friend"].includes(I)&&(T||L))){if(k&&(!n||!N)&&i&&g){for(let e=0;e<g.length;e++){let i=g[e];T?p.includes(i.awemeType)&&(A.current[e]=i):L&&!(0,d.P)(i)?A.current[e]=i:m.includes(i.awemeType)&&(A.current[e]=i)}let e=0;for(let t=0;t<Object.keys(A.current).length;t++)Number(Object.keys(A.current)[t])<i.activeIndex&&e++,g.splice(Number(Object.keys(A.current)[t])-t,1);return t([...g]),i.slideTo(i.activeIndex-e,0),()=>{var e;let l=0,n=[...x.current];for(let e=0;e<Object.keys(A.current).length;e++)Number(Object.keys(A.current)[e])<=i.activeIndex+l&&l++,n.splice(Number(Object.keys(A.current)[e]),0,A.current[Object.keys(A.current)[e]]);A.current={},t(n),(null===(e=S.current)||void 0===e?void 0:e.setScrollData)&&S.current.setScrollData({dataList:n}),setTimeout(()=>i.slideTo(i.activeIndex+l,0),0)}}}},[k,N,i,C]),(0,r.o)(()=>{let e=s.listen(s.EVENT.exitModalVideo,()=>{var e,i,t,l;if((null===(e=S.current)||void 0===e?void 0:e.setScrollData)&&(null===(t=x.current)||void 0===t?void 0:null===(i=t.filter(e=>"releated"===e.dataType))||void 0===i?void 0:i.length)>0){let e=null===(l=x.current)||void 0===l?void 0:l.filter(e=>"releated"!==e.dataType);S.current.setScrollData({dataList:e})}});return()=>{e()}},[]),(0,r.o)(()=>{let e=s.listen(s.EVENT.changeMinWindows,e=>{var t,l;let{event:n,clickMethod:r,source:d}=e,_=null==y?void 0:null===(t=y.current)||void 0===t?void 0:t.getPlayer(),f=(null==g?void 0:null===(l=g[null==i?void 0:i.activeIndex])||void 0===l?void 0:l.awemeType)===o.e.LiveCard&&w&&"small_window_widget"!==d,m=c.s.getPlayersByScene(a.lT.Modal).length>0&&_&&c.s.getPlayerScene(null==_?void 0:_.playerId)!==a.lT.Modal;if(!f&&!m)"check"===n&&setTimeout(()=>{if(!u.Le.getConfig(u.gI.IsMiniWin))((null==g?void 0:g.length)>0||h)&&((0,v.r)()&&(null==_||_.exitFullscreen()),s.emit(s.EVENT.changeMinWindows,{event:"open",isMiniWin:!0,clickMethod:r,source:d}))},50)});return()=>e()},[g,h,y,i,w]),(0,r.o)(()=>{var e,i;let n=null==y?void 0:null===(e=y.current)||void 0===e?void 0:e.getPlayer();if(n&&!n.isUserActive&&I&&["follow","friend"].includes(I)&&(T||L))return;let o=void 0!==C&&C||(null===(i=u.Le.getConfig(u.gI.IsInLookMiniModal))||void 0===i?void 0:i.isInMiniModal);if(k&&(!o||!N)&&g&&g.length!==D.current){let e=Object.keys(A.current).length,i={};for(let t=0;t<g.length;t++){let l=g[t];T?p.includes(l.awemeType)&&(i[e+t]=l):L&&!(0,d.P)(l)?i[e+t]=l:m.includes(l.awemeType)&&(i[e+t]=l)}for(let t=0;t<Object.keys(i).length;t++)g.splice(Number(Object.keys(i)[t])-t-e,1);A.current=(0,l._)({},A.current,i),t([...g]),D.current=g.length}},[g,k,N,C]),(0,r.o)(()=>{let e=s.listen(s.EVENT.changeVideoSideBar,e=>{let{isShowRelatedCard:i,isAuthorCardShow:t}=e;b(!!(i||t))});return()=>e()},[]),{refLiveStore:A}}},532765:function(e,i,t){t.d(i,{Z:function(){return v}}),t(874386);var l=t(88648),n=t(147613),o=t(79307),r=t(782442),a=t(637005),u=t(616520),d=t(88977),s=t(631493);let v=e=>{let{changeMinWinCb:i,refMixPlayer:t,from:v}=e||{},[c,_]=(0,l.useState)(!1),f=(0,l.useRef)(void 0);return(0,n.o)(()=>{_(r.Le.getConfig(r.gI.IsMiniWin));let e=a.listen(a.EVENT.changeMinWindows,e=>{var l;let{isMiniWin:n,source:r,event:a}=e,u=n,d=null==t?void 0:null===(l=t.current)||void 0===l?void 0:l.getPlayer();s.s.getPlayersByScene(o.lT.Modal).length>0&&d&&s.s.getPlayerScene(null==d?void 0:d.playerId)!==o.lT.Modal&&(u=!1),f.current=r,_(u),null==i||i(u)});return()=>e()},[]),(0,l.useEffect)(()=>{c&&!(0,u.En)()&&"sideList"===v&&d.Z.sendLog("smallWindowShow",{source:f.current})},[c]),c}},5919:function(e,i,t){t.d(i,{N:function(){return P}});var l=t(520739),n=t(878389);t(874386);var o=t(563097),r=t(352982),a=t.n(r),u=t(88648),d=t(713097),s=t.n(d),v=t(948375),c=t(629582),_=t(711725),f=t(844375),m=t(17750),p=t(155067),g=t(969610),h=t(504426),y=t(15334),w=t(851563);let P=(0,u.forwardRef)((e,i)=>{let{className:t,style:r={},children:d,config:P,onPlayerCreated:C,playerDOMRef:I,playerReactClassName:S,isInitPlayer:E,enableProgressPlugin:T=!0}=e,[L,N]=(0,u.useState)(null),b=I||(0,u.useRef)(null),A=(0,v.Z)(e=>{N(e),null==C||C(e),D.current.emit(w.A.PLAYER_CREATE,e)});(0,u.useEffect)(()=>{!E&&N(null)},[E]);let{SLIDES:x}=(0,h.G)(d),D=(0,u.useRef)();return!D.current&&(D.current=new(a())),(0,u.useImperativeHandle)(i,()=>({getPlayer:()=>L,player:L,getPlayerRoot:()=>b.current,root:b.current}),[L]),(0,u.useEffect)(()=>{if(null==L?void 0:L.on){let e=()=>{L.focus({isLock:!1})};return L.on(c.FP.PLAY,e),L.on(c.FP.PAUSE,e),L.on(c.FP.ENDED,e),()=>{L.off(c.FP.PLAY,e),L.off(c.FP.PAUSE,e),L.off(c.FP.ENDED,e)}}},[L]),(0,o.jsx)("div",{ref:b,className:s()(g.default.basePlayer,"basePlayerContainer",t),style:r,children:(0,o.jsxs)(y.E.Provider,{value:{player:L,contextEvent:D.current,isDouyinPlayer:!0},children:[x[h.o.START],!!E&&(0,o.jsxs)(c.v7,(0,n._)((0,l._)({},P),{ref:i,className:S,Logger:_.Z,onPlayerCreated:A,reduceUpdates:!0,children:[(0,o.jsx)(p.Mf,{}),(0,o.jsx)(f.Um,{}),(0,o.jsx)(f.bT,{}),T&&(0,o.jsx)(f.uS,{isDraggingSeek:!0}),(0,o.jsx)(f.yb,{position:c.PZ.CONTROL_RIGHT,index:0,props:{position:"top-right",keyboardCode:m.SHORTCUT_KEY.fullscreen.code}}),(0,o.jsx)(f.dm,{position:c.PZ.CONTROL_RIGHT,index:1,props:{showVolume:!0}}),x[h.o.CHILDREN]]})),x[h.o.END]]})})})},616519:function(e,i,t){t.d(i,{E:function(){return o}});var l=t(352982),n=t.n(l);let o=t(88648).createContext({player:{},contextEvent:new(n())})},921248:function(e,i,t){t.d(i,{O:function(){return o}}),t(874386);var l=t(88648),n=t(171087);function o(e){let{player:i,isActive:t}=e,[o,r]=(0,l.useState)(void 0);return(0,l.useEffect)(()=>{if((null==i?void 0:i.on)&&t&&"function"==typeof i.on){let e=e=>{"boolean"==typeof(null==e?void 0:e.isOn)&&r(e.isOn)};return i.on(n.C.ImmersiveSwitchChange,e),()=>{i.off(n.C.ImmersiveSwitchChange,e)}}!t&&i&&r(!1)},[i,t]),{inImmersive:o}}},675001:function(e,i,t){t.d(i,{l:function(){return o}});var l=t(88648),n=t(616519);let o=()=>{let{contextEvent:e}=(0,l.useContext)(n.E);return e}},729075:function(e,i,t){t.d(i,{G9:function(){return A},kL:function(){return k},l7:function(){return L}});var l=t(134761),n=t(520739),o=t(878389);t(874386);var r=t(563097),a=t(88648),u=t(205457),d=t(713097),s=t.n(d);t(298695);var v=t(629582),c=t(35730),_=t(147613),f=t(555106),m=t(782442),p=t(658065),g=t(54517),h=t(330746),y=t(637005),w=t(860684),P=t(122788),C=t(171087),I=t(969911),S=t(102642),E=t(252376),T=t(17750),L={Shortcut:0,0:"Shortcut"};function N(e){let{isOn:i}=e;return(0,r.jsxs)("div",{className:s()("dyTips"),children:[i&&(0,r.jsx)("span",{children:"关闭自动连播"}),!i&&(0,r.jsx)("span",{children:"自动连播"}),!!T.SHORTCUT_KEY.autoPlay.badgeText&&(0,r.jsx)("span",{className:"shortcutKey",children:T.SHORTCUT_KEY.autoPlay.badgeText})]})}function b(e){let{autoplay:i,onIconClick:t,shortcutDisabled:l}=e,n=(0,E.H)("auto_play");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:n,className:"douyin-player-icon",onClick:t,"data-e2e":"video-player-auto-play","data-e2e-state":i?"video-player-auto-playing":"video-player-no-auto-play",children:(0,r.jsxs)("div",{className:"douyin-player-setting-label",children:[(0,r.jsx)("button",{"aria-checked":"true",className:s()("douyin-player-switch",{"douyin-player-switch-checked":i}),"aria-labelledby":"douyin-player-switch-pip",type:"button",children:(0,r.jsx)("span",{className:"douyin-player-switch-inner"})}),(0,r.jsx)("span",{className:"douyin-player-setting-title",children:"连播"})]})}),!l&&(0,r.jsx)(N,{isOn:i})]})}function A(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=(0,f.$o)(null!=e?e:c.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY);return null!=t?t:i}class x extends v.di{afterPlayerInit(){var e,i;if(!this._config.disable)this.renderRoot(),null===(e=this._player)||void 0===e||e.on(C.C.UpdateIsAutoPlay,this.updateIsAutoPlay),null===(i=this._player)||void 0===i||i.on(C.C.UpdateAutoPlaySwitch,this.switchAutoPlay),this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseleave)}beforeDestroy(){var e,i;this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseleave),null===(e=this._player)||void 0===e||e.off(C.C.UpdateIsAutoPlay,this.updateIsAutoPlay),null===(i=this._player)||void 0===i||i.off(C.C.UpdateAutoPlaySwitch,this.switchAutoPlay),(0,S.v)(this)}renderRoot(){let e=!!this._config.nextAutoPlay,i=this.onClickChange,t=(0,r.jsx)(b,{autoplay:e,onIconClick:i,shortcutDisabled:this._config.shortcutDisabled});(0,S.s)(this,t)}render(){return'<dy-icon class="douyin-player-autoplay-setting automatic-continuous" data-state="normal"></dy-icon>'}constructor(...e){super(...e),(0,l._)(this,"stopFlag",0),(0,l._)(this,"switchAutoPlay",e=>{var i;let t=null!==(i=null==e?void 0:e.isOn)&&void 0!==i?i:!this._config.nextAutoPlay;!!this._config.nextAutoPlay!==t&&this.autoPlayChangeLogic((0,o._)((0,n._)({},e),{isOn:t}))}),(0,l._)(this,"onMouseleave",()=>{this._player.emit(C.C.IconMouseleave,{pluginName:I.p7.AutoPlaySettingPlugin})}),(0,l._)(this,"onMouseenter",()=>{this._player.emit(C.C.IconMouseenter,{pluginName:I.p7.AutoPlaySettingPlugin})}),(0,l._)(this,"updateIsAutoPlay",e=>{this.autoPlayChangeLogic((0,n._)({isOn:!!Number(A(this._config.customLocalStorage,this._config.defaultVal)),logParams:{},isInnerReset:!0,switchBy:void 0},e))}),(0,l._)(this,"autoPlayChangeLogic",e=>{let{isOn:i,logParams:t,isInnerReset:l,switchBy:n,mode:o}=e;if(!this._config.shortcutDisabled||0!==n){if("syncInteraction"!==o&&m.Le.setConfig(m.gI.InnerAutoPlay,null),!!this._config.nextAutoPlay!==i&&this.el){var r,a;this._config.nextAutoPlay=i?1:0,(0,f.qQ)(null!==(a=this._config.customLocalStorage)&&void 0!==a?a:c.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY,i?"1":"0"),this.renderRoot();null===(r=this._player)||void 0===r||r.emit(C.C.AutoPlaySwitchChange,{isOn:!!i,logParams:t,isInnerReset:l}),this.el&&[...this.el.getElementsByTagName("button")].forEach(e=>e.blur()),this.stopFlag=0}}}),(0,l._)(this,"onClickChange",()=>{var e;let{author_id:i,group_id:t,log_pb:l,extraParams:o}=this._config.logInfo;(0,f.qQ)(null!==(e=this._config.customLocalStorage)&&void 0!==e?e:c.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY,this._config.nextAutoPlay?"0":"1"),m.Le.getConfig(m.gI.IsInMixCard)&&m.Le.setConfig(m.gI.AutoPlayChanged,{changed:!0}),this.autoPlayChangeLogic({isOn:!this._config.nextAutoPlay,logParams:(0,n._)({enter_method:"click_bar",urlParamList:["previous_page"],author_id:i,group_id:t,log_pb:l,enter_from:(0,p.yW)(),status:this._config.nextAutoPlay?"off":"on"},o),isInnerReset:!1,switchBy:void 0})})}}(0,l._)(x,"pluginName",I.p7.AutoPlaySettingPlugin);let D=e=>{let{isActive:i,awemeInfo:t,playNextFunc:l,ablePlayNext:o,shortcutDisabled:r,customLocalStorage:u,defaultVal:d}=e,s=(0,w.n)(),c=(0,a.useMemo)(()=>t,[t]),f={position:v.PZ.CONTROL_RIGHT,index:9,className:"douyin-player-autoplay-setting"},p=(0,a.useCallback)(()=>{let e=s.getPlugin(I.p7.AutoPlaySettingPlugin),i=s.config.pluginsConfig[I.p7.AutoPlaySettingPlugin];if(l&&(null==i?void 0:i.nextAutoPlay)&&(null==e?void 0:e.playeNextWeightNum)===0&&(null==e?void 0:e.stopFlag)===0&&o)(0,g.i0)(g.CK.Auto),null==l||l({from:"auto"}),m.Le.setConfig(m.gI.VideoPlayMethod,"auto_play_open");else{let e=()=>{s.replay(),s.replayed=!0,m.Le.setConfig(m.gI.VideoPlayMethod,"auto")};(0,h.G6)()?setTimeout(e,50):e()}},[l,s,o]);return(0,a.useEffect)(()=>{if(s&&c){s.replayed=!1,s.registerPlugin(x,(0,n._)({nextAutoPlay:Number(A(u,d)),logInfo:c,shortcutDisabled:r,customLocalStorage:u,defaultVal:d},f));let e=s.getPlugin(I.p7.AutoPlaySettingPlugin);return!Number.isInteger(e.playeNextWeightNum)&&(e.playeNextWeightNum=0),()=>{if(!s.destroyed)s.getPlugin(I.p7.AutoPlaySettingPlugin)&&s.unRegisterPlugin(I.p7.AutoPlaySettingPlugin)}}},[s,c,d]),(0,a.useEffect)(()=>{if(s&&i){let e,i;if(s.getPlugin(I.p7.AutoPlaySettingPlugin)){let t=s.getPlugin(I.p7.AutoPlaySettingPlugin);!Number.isInteger(t.playeNextWeightNum)&&(t.playeNextWeightNum=0),e=y.listen(y.EVENT.videoStopPlayNext,e=>{if(!1===s.isUserActive)return;let{openSideCard:i}=e||{},t=s.getPlugin(I.p7.AutoPlaySettingPlugin),l=i?"stopFlag":"playeNextWeightNum";t&&t[l]<1&&(t[l]+=1)}),i=y.listen(y.EVENT.videoRemoveStopPlayNext,e=>{if(!1===s.isUserActive)return;let{openSideCard:i}=e||{},t=s.getPlugin(I.p7.AutoPlaySettingPlugin),l=i?"stopFlag":"playeNextWeightNum";t&&(t[l]=Math.max(t[l]-1,0))})}return()=>{null==e||e(),null==i||i()}}},[s,i]),(0,_.o)(()=>{if(s&&i){let e=s.getPlugin(I.p7.AutoPlaySettingPlugin);null==e||e.updateIsAutoPlay();let i=y.listen(y.EVENT.syncInteraction,()=>{s.registerPlugin(x,(0,n._)({nextAutoPlay:Number(A(u,d)),logInfo:c,shortcutDisabled:r,customLocalStorage:u,defaultVal:d},f))});return()=>{i()}}},[s,i,d]),(0,a.useEffect)(()=>{if(s&&i&&p)return s.on(v.FP.ENDED,p),()=>{s.off(v.FP.ENDED,p)}},[s,i,p]),null},k=e=>{let i=(0,P.N)();return(0,r.jsx)(u.k,{componentName:"AutoPlayPlugin",Slardar:i,children:(0,r.jsx)(D,(0,n._)({},e))})}},889934:function(e,i,t){t.d(i,{x:function(){return K}});var l=t("520739");t("874386");var n=t("563097"),o=t("88648"),r=t("629582"),a=t("309931"),u=t("35730"),d=t("60013"),s=t("79307"),v=t("399796"),c=t("555106"),_=t("658065"),f=t("330746"),m=t("782442"),p=t("637005"),g=t("544933"),h=new g.h({voiceBubbleShow:{eventName:"voice_bubble_show",params:{enter_from:"",mute_type:""}},voiceBarShow:{eventName:"voice_bar_show",params:{enter_from:""}},clickVoiceBubble:{eventName:"click_voice_bubble",params:{is_open:1,mute_type:""}}}),y=t("878389"),w={User:"user",Browser:"browser"};let P={isAlwaysPrevent:!1,slideTime:0,isTipShow:!1},C={isAlwaysPrevent:!1,slideTime:5,isTipShow:!0},I=u.LocalStorageKeys.forceMuteInfo,S=m.gI.ForceMuted,E=()=>{let e=(0,c.$o)(I),i=!!((null==e?void 0:e.user)||(null==e?void 0:e.browser));return!i&&(0,c.bv)(I),i?e:null},T=e=>(0,c.qQ)(I,(0,l._)({},(0,c.$o)(I),e)),L=(e,i)=>m.Le.setConfig(S,(0,y._)((0,l._)({},m.Le.getConfig(S)),{[e]:i})),N=e=>{var i;return null===(i=m.Le.getConfig(S))||void 0===i?void 0:i[e]},b=e=>m.Le.setConfig(S,(0,l._)({},P,e)),A=(e,i)=>m.Le.setConfig(S,(0,l._)((0,y._)((0,l._)({},C),{currentMuteType:e,slideTime:5}),i)),x=e=>{let i=E(),{showTime:t,closeTime:l}=(null==i?void 0:i[e])||{},n=null!=l?l:t;return n&&Date.now()-n<=864e5*("user"===e?7:3)},D=e=>e.muted||0===e.volume,k=e=>{let{onFail:i,onSuccess:t,player:l}=e;!D(l)&&(L("isMuted",!0),l.muted=!0),setTimeout(()=>{!D(l)&&(L("isMuted",!0),l.muted=!0),l.paused&&l.play(),setTimeout(()=>{l.paused?(l.muted=!1,null==i||i()):D(l)&&(null==t||t())},500)},100)};var R=t("205457"),M=t("860684"),F=t("122788"),j=t("631493"),O=t("171087"),U=t("969911"),V=t("962820"),H=t("432695");let B=e=>{var i,t;let{isShowGuide:l=!1,isActive:g,awemeInfo:y,abtestData:P,scene:C}=e,{awemeId:I}=y,S=(0,M.n)(),[E,D]=(0,o.useState)(!1),R=(0,o.useRef)(!1),F=N("isTipShow"),[B,K]=(0,o.useState)(null!=F&&F),{attemptOpen:q,executeClose:G}=(0,d.B)({popName:"浏览器限制-声音提醒",onOpen:()=>{K(!0)},onClose:()=>{K(!1)}}),Y=(0,o.useMemo)(()=>(!S||j.s.getPlayerScene(S.playerId)===s.lT.Modal||!(j.s.getPlayersByScene(s.lT.Modal).length>0))&&S&&g&&!l&&!N("isAlwaysPrevent"),[g,l,S]),W=(0,o.useCallback)(e=>{if(Y){if(!N("isTipShow"))k({player:S,onSuccess:()=>{q({afterCallback:()=>{A(e),h.sendLog("voiceBubbleShow",{enter_from:(0,_.yW)(),mute_type:N("currentMuteType")}),T({[e]:{showTime:Date.now()}})}})},onFail:()=>{b({isAlwaysPrevent:!0})}}),L("currentMuteType",e),e===w.Browser&&(0,c.qQ)(u.LocalStorageKeys.browserMute,!0)}},[S,Y]),Q=(0,o.useCallback)(()=>{let e=N("currentMuteType");if(!!e&&!!N("isTipShow"))G(),L("isTipShow",!1),T({[e]:{closeTime:Date.now()}})},[]),z=(0,o.useRef)(!1);(0,o.useEffect)(()=>{if(S&&g){let e=()=>{z.current=!0,S.paused||S.pause(),S.muted=!1,S.play()};return S.on(r.FP.AUTOPLAY_WAS_PREVENTED,e),()=>{S.off(r.FP.AUTOPLAY_WAS_PREVENTED,e)}}},[S,g]),(0,o.useEffect)(()=>{let e=()=>{if(!(!S.paused&&!S.muted&&S.volume>0||(0,f.G6)()||R.current)){if(R.current=!0,x(w.Browser)){k({player:S}),(0,c.qQ)(u.LocalStorageKeys.browserMute,!0);return}W(w.Browser)}};return S&&(z.current||S.inlinePlayerAutoPlayWasPrevented)&&(e(),z.current=!1,S.inlinePlayerAutoPlayWasPrevented=!1),null==S||S.on(r.FP.AUTOPLAY_WAS_PREVENTED,e),()=>null==S?void 0:S.off(r.FP.AUTOPLAY_WAS_PREVENTED,e)},[S,W]),(0,o.useEffect)(()=>{S&&S.muted&&(0,c.$o)(u.LocalStorageKeys.browserMute)&&!x(w.Browser)&&W(w.Browser)},[S,W]),(0,o.useEffect)(()=>{if("user"!==N("currentMuteType"))((v.Q.getItem({sKey:u.CookieKeys.VolumeInfo})||{}).isUserMute||(0,c.$o)(u.LocalStorageKeys.userMute))&&!x(w.User)&&W(w.User)},[W]),(0,o.useEffect)(()=>{var e;let{isInMiniModal:i}=null!==(e=m.Le.getConfig(m.gI.IsInLookMiniModal))&&void 0!==e?e:{};if(i){G();return}let t=N("isTipShow");g&&(t?q({afterCallback:()=>{let e=N("slideTime")-1;L("slideTime",e),e<=0&&Q()}}):G())},[I,g,Q]),(0,o.useEffect)(()=>{if(S){let e=e=>{((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume")&&((0,c.qQ)(u.LocalStorageKeys.browserMute,!1),(B||N("isTipShow"))&&Q(),setTimeout(()=>{!0===S.muted||0===S.volume?((0,c.qQ)(u.LocalStorageKeys.userMute,!0),T({[w.User]:{closeTime:Date.now()}})):(0,c.qQ)(u.LocalStorageKeys.userMute,!1)}))};return S.on(r.FP.USER_ACTION,e),()=>{S.off(r.FP.USER_ACTION,e)}}},[S,B,Q]),(0,o.useEffect)(()=>{if(S){let e=e=>{("volumeDown"===e.action||"volumeUp"===e.action)&&((0,c.qQ)(u.LocalStorageKeys.browserMute,!1),(B||N("isTipShow"))&&Q(),setTimeout(()=>{0===S.volume?((0,c.qQ)(u.LocalStorageKeys.userMute,!0),T({[w.User]:{closeTime:Date.now()}})):(0,c.qQ)(u.LocalStorageKeys.userMute,!1)}))};return S.on(O.C.CustomShortCut,e),()=>{S.off(O.C.CustomShortCut,e)}}},[S,B,Q]);if((0,o.useEffect)(()=>{!g&&E&&D(!1)},[g,E]),(0,o.useEffect)(()=>{if(!!I)p.emit(p.EVENT.silentStatusChange,{awemeId:I,isAuto:!0,status:B&&(null==S?void 0:S.muted)})},[B,I,null==S?void 0:S.muted]),!B||!(null==S?void 0:S.muted))return null;let Z=null==S?void 0:null===(t=S.getPlugin)||void 0===t?void 0:null===(i=t.call(S,U.p7.SoundGuideTooltipPlugin))||void 0===i?void 0:i.el;return(0,n.jsx)(n.Fragment,{children:Z?(0,a.createPortal)((0,n.jsx)(H.V,{onClose:()=>{Q(),(0,c.qQ)(u.LocalStorageKeys.browserMute,!1),(0,c.qQ)(u.LocalStorageKeys.userMute,!0),T({[w.User]:{closeTime:Date.now()}}),h.sendLog("clickVoiceBubble",{is_open:0,mute_type:N("currentMuteType")})},onOpen:()=>{let{volume:e}=(0,V.J)(P);S&&(S.muted?S.muted=!1:S.volume=e),Q(),S.emit(r.FP.VOLUMECHANGE),null==S||S.emit(r.FP.USER_ACTION,{action:"change_muted"}),(0,c.qQ)(u.LocalStorageKeys.browserMute,!1),(0,c.qQ)(u.LocalStorageKeys.userMute,!1),h.sendLog("clickVoiceBubble",{is_open:1,mute_type:N("currentMuteType")})},description:"browser"===N("currentMuteType")?"因浏览器限制，当前为静音":"当前为静音，是否要打开声音？"}),Z):null})},K=e=>{let i=(0,F.N)();return(0,n.jsxs)(R.k,{componentName:"AutoSilentPlugin",Slardar:i,children:[(0,n.jsx)(H.I,(0,l._)({},e)),(0,n.jsx)(B,(0,l._)({},e))]})}},611350:function(e,i,t){t.d(i,{t:function(){return Y}});var l=t("520739"),n=t("563097"),o=t("88648");t("874386"),t("250440");var r=t("629582"),a=t("713097"),u=t.n(a),d=t("747909"),s=t("309931"),v=t("60013"),c=t("35730"),_=t("507217"),f=t("746864"),m=t("702726"),p=t("966410"),g=t("701523"),h=t("820303"),y=t("555106"),w=t("637005"),P=t("32167"),C=t("349998"),I=t("428647"),S=t("291773"),E=t("620976"),T=t("358003"),L=t("304493");t("216555");var N=t("254897"),b=t("516021"),A=t("171087"),x=t("969911");let D=0,k=!1,R=!1,M=e=>{var i,t,a,M,F,j,O;let{userInfo:U,isActive:V,awemeInfo:H,dispatch:B,player:K,isClientMiniWin:q,currentIndex:G,abtestData:Y,isInnerFeed:W}=e,{isLogin:Q}=U||{},[z,Z]=(0,o.useState)(L.QM.Auto),[$,J]=(0,o.useState)(!1),[X,ee]=(0,o.useState)(!1),[ei,et]=(0,o.useState)(!1),el=(0,o.useRef)(null),en=(0,o.useRef)(!1),eo=(0,o.useRef)(null),er=(0,o.useRef)(q),{attemptOpen:ea,executeClose:eu}=(0,v.B)({popName:"清晰度引导登录",onOpen:()=>{J(!0)},onClose:()=>{J(!1)}});(0,o.useEffect)(()=>{el.current=G,(G>0&&V||W)&&(k=!0)},[G,V,W]),(0,o.useEffect)(()=>{V&&(en.current=$)},[V,$]),(0,o.useEffect)(()=>{let e=(0,h.G)(c.SessionStorageKeys.manualSwitch)||{};Z((null==e?void 0:e.gearName)?null==e?void 0:e.gearName:L.QM.Auto)},[V,H]);let ed=(0,o.useCallback)(e=>{L.y8.includes(null==e?void 0:e.pluginName)&&ee(!0)},[Y]),es=(0,o.useCallback)(e=>{L.y8.includes(null==e?void 0:e.pluginName)&&ee(!1)},[Y]);(0,o.useEffect)(()=>{if(K&&V)return K.on(A.C.IconMouseenter,ed),K.on(A.C.IconMouseleave,es),()=>{null==K||K.off(A.C.IconMouseenter,ed),K.on(A.C.IconMouseleave,es)}},[K,H,V]),(0,o.useEffect)(()=>{er.current=q,q&&eu()},[q]),(0,o.useEffect)(()=>{var e,i;if(!V||Q||(null==H?void 0:H.awemeType)===(null==_?void 0:null===(e=f.e)||void 0===e?void 0:e.Note)){eu();return}let t=(0,y.$o)(c.LocalStorageKeys.UnloginClairtyNew),n=Date.now()-(null==t?void 0:t.lstTimestamp);if(n<L.Ts)return;let o=((null==t?void 0:t.totalTimes)||0)+1;if((null==t?void 0:t.totalTimes)>=15){if(!(n>=L.sY))return;o=1}let r=null==w?void 0:w.listen(null==w?void 0:null===(i=w.EVENT)||void 0===i?void 0:i.clarityRel,e=>{e.loginMaskMeeted&&(D=0),e.hoverSelected&&ee(!0),!1===e.hoverSelected&&ee(!1),e.smartAppear&&(en.current&&m.logInstance.sendLog("hdLoginGuideCrash",{enter_from:(0,P.vM)(),guide_type:"bar_guide"}),eu())});return V&&(0===el.current&&!1===k?D=1:D++),(null==H?void 0:H.awemeId)===p.X&&(D=0),3===D&&er.current&&(R=!0),(3===D&&V&&!Q&&!R||D>3&&R&&!er.current)&&(R=!1,ea({afterCallback:()=>{w.emit(w.EVENT.closeOtherTip,"LoginClarityTip"),eo.current=Date.now(),m.logInstance.sendLog("hdLoginGuideShow",(0,l._)({params_for_special:"uc_login",enter_from:(0,P.vM)(),guide_type:"bar_guide"},(0,C.t)())),(0,y.qQ)(c.LocalStorageKeys.UnloginClairtyNew,{totalTimes:o,lstTimestamp:Date.now()})}})),()=>{r()}},[V,null==H?void 0:H.awemeId,Q]);let ev=()=>{eu()};(0,o.useEffect)(()=>{if(K&&V){let e=w.listen("changeNext",ev),i=w.listen("changePrev",ev);return null==K||K.on(A.C.BeforePlaySwitchPrev,ev),null==K||K.on(A.C.BeforePlaySwitchNext,ev),null==K||K.on(r.FP.MINI_STATE_CHANGE,ev),()=>{null==e||e(),null==i||i(),null==K||K.off(A.C.BeforePlaySwitchPrev,ev),null==K||K.off(A.C.BeforePlaySwitchNext,ev),null==K||K.off(r.FP.MINI_STATE_CHANGE,ev)}}},[K,V]);(0,o.useEffect)(()=>{(async()=>{if((0,g.p)(H)&&!W){et(!0);return}et(await (0,E.isHideLoginGuide)(Y))})()},[]),(0,o.useEffect)(()=>{let e=w.listen(w.EVENT.closeOtherTip,e=>{"LoginClarityTip"!==e&&eu()});return()=>e()},[]);let ec=null==K?void 0:null===(t=K.getPlugin(x.p7.PlayClaritySettingPlugin))||void 0===t?void 0:null===(i=t.el)||void 0===i?void 0:i.querySelector(".login-tooltip-slot"),e_=null==K?void 0:null===(O=K.config)||void 0===O?void 0:null===(j=O.shared)||void 0===j?void 0:null===(F=j.clearLists)||void 0===F?void 0:null===(M=F.find)||void 0===M?void 0:null===(a=M.call(F,e=>e))||void 0===a?void 0:a.label;return!1===Q&&V&&$&&!ei&&ec?(0,s.createPortal)((0,n.jsxs)("div",{className:u()("isDark",b.default.loginClarityNewAdjust),onClick:()=>{let e=(0,h.G)(c.SessionStorageKeys.manualSwitch)||{};m.logInstance.sendLog("hdLoginGuideClick",(0,l._)({params_for_special:"uc_login",enter_from:(0,P.vM)(),guide_type:"bar_guide",duration:Date.now()-eo.current,action:"login"},(0,C.t)())),(0,T.default)({clarity:e.gearClarity||"0",headerText:"登录后免费畅享高清画质",enterMethod:"bar_guide",isAuto:e.done?0:1,gearName:e.gearName,success:()=>{var e;eu(),w.emit(null==w?void 0:null===(e=w.EVENT)||void 0===e?void 0:e.clarityRel,{hdLogin:!0}),B({type:"updateUserInfo"})}})},children:[(0,n.jsxs)("div",{className:u()(b.default.textClarityNew,b.default.text),children:["当前观看",(0,n.jsx)("span",{className:b.default.textClarityNewColor,children:z}),"画质，登录即可畅享",(0,n.jsx)("span",{className:b.default.textClarityNewColor,children:null!=e_?e_:"高清"}),"画质"]}),(0,n.jsx)(d.Button,{type:"primary",size:"small",theme:"solid",className:b.default.button,children:"立即登录"}),(0,n.jsx)(N.z,{svg:(0,n.jsx)(I.Z,{}),onClick:e=>{e.cancelBubble=!0,e.stopPropagation(),e.preventDefault(),e.returnValue=!1,eu(),m.logInstance.sendLog("hdLoginGuideClick",(0,l._)({params_for_special:"uc_login",enter_from:(0,P.vM)(),guide_type:"bar_guide",duration:Date.now()-eo.current,action:"close"},(0,C.t)()))},className:b.default.close}),(0,n.jsx)(N.z,{svg:(0,n.jsx)(S.Z,{}),className:b.default.down})]}),ec):null};var F=t("878389"),j=t("147613"),O=t("896737"),U=t("32504");t("490302");let V=e=>{var i,t;let[a,d]=(0,o.useState)(!1),{attemptOpen:m,executeClose:p}=(0,v.B)({popName:"网络差清晰度切换提示",onOpen:()=>{d(!0)},onClose:()=>{d(!1)}}),[g,P]=(0,o.useState)(L.jH.low),[I,E]=(0,o.useState)(L.jH.lowTail),{awemeInfo:T,player:b,userInfo:D,isActive:k}=e,{awemeId:R=""}=T,M=(0,o.useRef)(null),V=(0,o.useCallback)(()=>{var e,i,t,n;!(null==b?void 0:null===(e=b.video)||void 0===e?void 0:e.error)&&(null==b?void 0:null===(n=b.config)||void 0===n?void 0:null===(t=n.shared)||void 0===t?void 0:null===(i=t.definition)||void 0===i?void 0:i.userSelectDefinition)&&m({afterCallback:()=>{var e;w.emit(null==w?void 0:null===(e=w.EVENT)||void 0===e?void 0:e.clarityRel,{smartAppear:!0}),clearTimeout(M.current),M.current=setTimeout(()=>{clearTimeout(M.current),p()},5e3),U.Z.sendLog("clarityNotifyShow",(0,l._)({group_id:R},(0,C.t)()))}})},[b,R]);(0,j.o)(()=>{var e,i,t,n;let o;if((null==T?void 0:T.awemeType)!==(null==_?void 0:null===(e=f.e)||void 0===e?void 0:e.Note))return b&&k&&(null==b?void 0:null===(n=b.config)||void 0===n?void 0:null===(t=n.shared)||void 0===t?void 0:null===(i=t.definition)||void 0===i?void 0:i.userSelectDefinition)&&(o=setInterval(()=>{var e,i;let t=null==b?void 0:null===(e=b.getPlugin)||void 0===e?void 0:e.call(b,x.p7.BitrateSelector),n=null==t?void 0:null===(i=t.curBitRate)||void 0===i?void 0:i.definition,{type:r}=(null==t?void 0:t.needChangeDefinition(n))||{},a=Date.now(),u=(0,y.$o)(c.LocalStorageKeys.SmartClarity)||(0,l._)({},L.g),d=(0,h.G)(c.SessionStorageKeys.manualSwitch)||{};1===r&&a-u.lowTimestamp>L.Ts&&d.gearClarity!==L.hq.Fast?(P(L.jH.low),E(L.jH.lowTail),u.lowTimestamp=a,clearInterval(o),V()):2===r&&a-u.highTimestamp>L.Ts&&u.highTimes<5&&d.gearClarity!==L.hq.Hd&&(P(L.jH.high),E(L.jH.highTail),u.highTimestamp=a,u.highTimes+=1,clearInterval(o),V()),(0,y.qQ)(c.LocalStorageKeys.SmartClarity,u)},1e4)),()=>{clearInterval(o)}},[b,k,D,R]);let H=()=>{p()},B=(0,o.useCallback)(e=>{L.y8.includes(null==e?void 0:e.pluginName)&&p()},[]);(0,o.useEffect)(()=>{if(b&&k){var e;return null==b||null===(e=b.on)||void 0===e||e.call(b,A.C.IconMouseenter,B),()=>{var e;null==b||null===(e=b.off)||void 0===e||e.call(b,A.C.IconMouseenter,B)}}},[b,R,k]);(0,o.useEffect)(()=>{var e;let i=w.listen("changeNext",H),t=w.listen("changePrev",H);null==b||b.on(A.C.BeforePlaySwitchPrev,H),null==b||b.on(A.C.BeforePlaySwitchNext,H),null==b||b.on(r.FP.MINI_STATE_CHANGE,H);let l=w.listen(w.EVENT.feedVideoCardLocateCurrentVideo,H),n=null==w?void 0:w.listen(null==w?void 0:null===(e=w.EVENT)||void 0===e?void 0:e.clarityRel,e=>{e.hoverSelected&&p()});return()=>{null==i||i(),null==t||t(),null==b||b.off(A.C.BeforePlaySwitchPrev,H),null==b||b.off(A.C.BeforePlaySwitchNext,H),null==b||b.off(r.FP.MINI_STATE_CHANGE,H),l(),n()}},[b]);let K=null==b?void 0:null===(t=b.getPlugin(x.p7.PlayClaritySettingPlugin))||void 0===t?void 0:null===(i=t.el)||void 0===i?void 0:i.querySelector(".smart-tooltip-slot");return a&&K?(0,s.createPortal)((0,n.jsxs)("div",{className:u()("isDark",O.default.smartClarityAdjust),onMouseEnter:()=>{clearTimeout(M.current)},onMouseLeave:()=>{M.current=setTimeout(()=>{clearTimeout(M.current),p()},5e3)},onClick:()=>{var e;let i=(0,h.G)(c.SessionStorageKeys.manualSwitch);i.gearClarity=L.hq.Auto,i.qualityType=0,i.gearName="",i.gearType=0,(0,h.t_)(c.SessionStorageKeys.manualSwitch,i);let t=b.config.shared.definition;b.updateConfig({shared:{definition:(0,F._)((0,l._)({},t),{userSelectDefinition:0})}}),p(),U.Z.sendLog("clarityNotifyClick",(0,l._)({group_id:R,action:"auto"},(0,C.t)())),w.emit(null==w?void 0:null===(e=w.EVENT)||void 0===e?void 0:e.clarityRel,{autoSwitch:!0})},children:[(0,n.jsxs)("div",{className:u()(O.default.textClarityNew,O.default.text),children:[g,(0,n.jsx)("div",{className:O.default.textClarityNewColor,children:"切换至智能模式"}),I]}),(0,n.jsx)(N.z,{svg:(0,n.jsx)(S.Z,{}),className:O.default.down})]}),K):null};var H=t("873175"),B=t("205457"),K=t("860684"),q=t("122788");let G=e=>{let{userInfo:i,isActive:t,abtestData:l,awemeInfo:r,dispatch:a,isClientMiniWin:u,currentIndex:d,isInnerFeed:s,isModalVideo:v,modalEnterFrom:c,srSceneType:_}=e,f=(0,K.n)(),m=(0,o.useRef)(r);return(0,o.useEffect)(()=>{m.current=r},[r]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M,{userInfo:i,dispatch:a,awemeInfo:r,isActive:r.awemeId===m.current.awemeId&&t,isClientMiniWin:u,player:f,currentIndex:d,abtestData:l,isInnerFeed:s}),(0,n.jsx)(V,{isActive:t,userInfo:i,dispatch:a,awemeInfo:r,player:f}),(0,n.jsx)(H.ZL,{isActive:t,userInfo:i,dispatch:a,abtestData:l,awemeInfo:r,isInnerFeed:s,isModalVideo:v,modalEnterFrom:c,srSceneType:_})]})},Y=e=>{let i=(0,q.N)();return(0,n.jsx)(B.k,{componentName:"Clarity",Slardar:i,children:(0,n.jsx)(G,(0,l._)({},e))})}},873175:function(e,i,t){t.d(i,{ZL:function(){return ew},Jy:function(){return eg}});var l=t("134761"),n=t("520739"),o=t("878389");t("874386"),t("268917"),t("250440");var r=t("563097"),a=t("88648"),u=t("629582"),d=t("713097"),s=t.n(d),v=t("948375"),c=t("877639"),_=t.n(c),f=t("823685"),m=t("35730"),p=t("147613"),g=t("507217"),h=t("746864"),y=t("375944"),w=t("820303"),P=t("658065"),C=t("32167"),I=t("349998"),S=t("637005");let E=e=>{let{player:i,action:t,awemeInfo:l,isActive:n,abtestData:o}=e;(0,a.useEffect)(()=>{if(n||!(null==o?void 0:o.switchClarityTiming))return()=>{};let e=S.listen(S.EVENT.syncDefination,e=>{let{awemeId:i}=e;if((null==l?void 0:l.awemeId)!==i)t()});return()=>{e()}},[i,t,l,o])};var T=t("304493");let L="douyin-player-playclarity-setting",N="douyin-player-playclarity-setting-v2",b=e=>{let{indexSelected:i,uniqueKey:t}=e,l=(0,a.useCallback)(e=>{if((0,y.fR)())try{var i;let l=e&&e!==T.hq.Auto?0:1,n="douyin-player-playclarity-setting-unique-"+t,o=null===(i=document.getElementsByClassName(n))||void 0===i?void 0:i[0];if(!o)return;let r=o.className.indexOf(N)>-1?0:1;l!==r&&(o.className=l?`${L} ${n}`:`${L} ${n} ${N}`)}catch(e){}},[t]);(0,a.useEffect)(()=>{l(i)},[i])};t("779788");var A=t("734123"),x=t("663153"),D=t("300277"),k=t.n(D),R={Up:1,1:"Up",Down:2,2:"Down",Auto:0,0:"Auto"},M={start:1,1:"start",process:2,2:"process",end:3,3:"end"},F={auto:"auto",mannual:"mannual",abr:"abr"},j={DefinitionChange:"DefinitionChange",DefinitionChangeSuccess:"DefinitionChangeSuccess",DefinitionChangeFail:"DefinitionChangeFail",DefinitionChangeOnlyForSr:"DefinitionChangeOnlyForSr"},O=t("824711"),U=t("653208");let V=e=>{let{player:i,abtestData:t,awemeInfo:l}=e;return(0,U.pK)({abtestData:t,awemeInfo:l,player:i})?2:(0,U.Xo)({abtestData:t,awemeInfo:l,player:i})?1:0};class H{static addAutoSwitchCount(e){e.autoSwitchCount?e.autoSwitchCount++:e.autoSwitchCount=1}static resetAutoSwitchCount(e){e.autoSwitchCount=0}static getAutoSwitchCount(e){return e.autoSwitchCount}static getIsInAutoSwitch(e){return e.autoSwitchCount>0}static subAutoSwitchCount(e){e.autoSwitchCount&&e.autoSwitchCount--}}let B=function(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t]},K=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object.keys(e).length>0){var i,t;return{ufq_src:null==e?void 0:e.src,ufq_enh:null==e?void 0:e.enh,ufq_trans:null==e?void 0:e.trans,ufq_playback_ori:null==e?void 0:null===(i=e.playback)||void 0===i?void 0:i.ori,ufq_playback_srv1:null==e?void 0:null===(t=e.playback)||void 0===t?void 0:t.srv1}}return{}},q={[T.hq.HD4KHDR]:T.rT.HD4KHDR,[T.hq.HD4K]:T.rT.HD4K,[T.hq.HD2K]:T.rT.HD2K,[T.hq.Hd]:T.rT.Hd,[T.hq.Clear]:T.rT.Clear,[T.hq.Smooth]:T.rT.Smooth,[T.hq.Fast]:T.rT.Fast,[T.hq.Auto]:T.rT.Auto},G={[T.hq.HD4KHDR]:T.YB.HD4KHDR,[T.hq.HD4K]:T.YB.HD4K,[T.hq.HD2K]:T.YB.HD2K,[T.hq.Hd]:T.YB.Hd,[T.hq.Clear]:T.YB.Clear,[T.hq.Smooth]:T.YB.Smooth,[T.hq.Auto]:T.YB.Auto};class Y{start(){if(2!==this._status&&0!==this._status)this._initPlayClarity(),this.initSwitchDefinationInfos(),this._status=2}reset(){this._status=1,this._switchDefinationInfos=[],this._count=0,this._startTime=0,this._srStatus=0}isHas2K(){return(0,y.fR)()}IsReady(){return 1===this._status}getClarityTypeByDefination(){let e=(0,w.G)(m.SessionStorageKeys.manualSwitch)||{};return(null==e?void 0:e.gearClarity)||(null===T.hq||void 0===T.hq?void 0:T.hq.Auto)}setClarity(e){this._nowClarity=e}_initPlayClarity(){let e=this._clarityTransform(this.getClarityTypeByDefination());this._initClarity=e,this._nowClarity=e}bindFunc(){(null===this||void 0===this?void 0:this._player)&&(this._player.getSwitchDefinationInfos=this.getSwitchDefinationInfos.bind(this),this._player.getIsInSwitching=this.getIsInSwitching.bind(this),this._player.getClarity=this.getClarity.bind(this))}unbindFunc(){(null===this||void 0===this?void 0:this._player)&&(this._player.getSwitchDefinationInfos=void 0,this._player.getIsInSwitching=void 0,this._player.getClarity=void 0)}init(){this._initPlayClarity(),this._initListener(),this.bindFunc(),this._status=1}getClarity(e){return e?this._initClarity:this._nowClarity}getAdjustPlayDuration(e){return Math.round(e<0?0:e)}getSwitchDefinationInfos(){let{_switchDefinationInfos:e}=this,i=this.findLatestSwitchSuccessItem();if(i){let e=this._calcPlayDuration();i.definationInfo.play_duration=i.definationInfo.play_duration+this.getAdjustPlayDuration(e),i.definationInfo.is_super_resolution=this.getSuperResolution(!0),this._recordStartTime()}let t={start_play_clarity_type:this._initClarity,switch_down_cnt:0,switch_up_cnt:0,abr_down_cnt:0,abr_up_cnt:0,switch_to_auto_cnt:0,switch_from_auto_cnt:0,switch_up_duration:[],switch_down_duration:[],switch_to_auto_duration:[],switch_from_auto_duration:[],switch_info:""},l=[];e.forEach(e=>{let{stage:i,switchEndTime:n,switchStartTime:o,switchFromAuto:r,switchToAuto:a,switchOption:u,definationInfo:d,isABR:s}=e;if(i!==M.start){let e=n-o;u===R.Up&&(s?t.abr_up_cnt++:t.switch_up_cnt++,t.switch_up_duration.push(e)),u===R.Down&&(s?t.abr_down_cnt++:t.switch_down_cnt++,t.switch_down_duration.push(e)),a&&(t.switch_to_auto_cnt++,t.switch_to_auto_duration.push(e)),r&&(t.switch_from_auto_cnt++,t.switch_from_auto_duration.push(e))}d&&(d.play_duration=d.play_duration||0,l.push(d))});try{t.switch_info=JSON.stringify(l||[])}catch(e){t.switch_info=""}return B("getSwitchDefinationInfos",t),t}getIsInSwitching(){let e=this.getLatestSwitchDefinationInfo();return e?(null==e?void 0:e.status)===3?1:0:0}_clarityTransform(e){let i=this.isHas2K()?G:q;return null==i?void 0:i[e]}_getCumulateTime(){var e,i,t;return(null===(t=this._player)||void 0===t?void 0:null===(i=t.plugins)||void 0===i?void 0:null===(e=i.VodLoggerPlugin)||void 0===e?void 0:e.cumulateTime)||0}_calcPlayDuration(){return this._getCumulateTime()?this.getAdjustPlayDuration((this._getCumulateTime()||0)-this._startTime):0}_recordStartTime(){this._startTime=this._getCumulateTime()||0}_getCodec(){return V({awemeInfo:this._awemeInfo,player:this._player,abtestData:this._abtestData})}initSwitchDefinationInfos(){var e;let{_player:i}=this;this._recordStartTime();let{curDefinition:t={}}=i||{},l=(null==t?void 0:t.bitrate)||(null==t?void 0:t.realBitrate)||0,o=(null==t?void 0:null===(e=t.audioDefinition)||void 0===e?void 0:e.bitrate)||0,r=(null==t?void 0:t.realBitrate)||0,a={stage:M.start,status:1,definationInfo:(0,n._)({switch_order:this._count++,clarity_now:this._initClarity,video_quality:null==t?void 0:t.qualityType,is_bytevc1:this._getCodec(),video_bitrate:l,audio_bitrate:o,play_bitrate:r,is_super_resolution:this.getSuperResolution(),play_duration:0,switch_type:F.auto,video_format:(null==t?void 0:t.format)||""},K((null==t?void 0:t.ufq)||{}))};this.addSwitchDefinationInfo(a)}getSuperResolution(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var i,t,l;let e=null===(t=this._player)||void 0===t?void 0:null===(i=t.superResolution)||void 0===i?void 0:i.is_super_resolution;return k()(e)&&(e=null===(l=(0,O.B)({player:this._player}))||void 0===l?void 0:l.is_super_resolution),e||0}let{is_super_resolution:n}=(0,O.B)({player:this._player});return n}onBeforeDefinitionChange(){this._srStatus=this.getSuperResolution()}_calcPlayTimeForPreItem(){let e=this.findLatestSwitchSuccessItem(1);if(e){var i;let t=this._calcPlayDuration();this._recordStartTime(),e.definationInfo=(0,o._)((0,n._)({},e.definationInfo),{is_super_resolution:this._srStatus,play_duration:(null==e?void 0:null===(i=e.definationInfo)||void 0===i?void 0:i.play_duration)+this.getAdjustPlayDuration(t)})}}onABRDefinitionChangeSuccess(e){var i;let{_player:t}=this,{curDefinition:l={}}=t||{};this._calcPlayTimeForPreItem();let{orgDefinition:n,currentDefinition:o}=e,r=(null==l?void 0:l.bitrate)||(null==l?void 0:l.realBitrate)||0,a=(null==l?void 0:null===(i=l.audioDefinition)||void 0===i?void 0:i.bitrate)||0,u=(null==l?void 0:l.realBitrate)||0,d=null==l?void 0:l.qualityType,s=o<n?R.Up:R.Down,v={switch_order:this._count++,clarity_now:this._clarityTransform(T.hq.Auto),video_quality:d,video_bitrate:r,audio_bitrate:a,play_bitrate:u,play_duration:0,is_super_resolution:this.getSuperResolution(),switch_type:F.abr,is_bytevc1:this._getCodec()};this.addSwitchDefinationInfo({switchOption:s,switchFromAuto:!1,switchToAuto:!1,switchStartTime:0,switchEndTime:0,isABR:!0,status:1,definationInfo:v}),this.recordSrStatus()}onDefinitionChangeFail(){}onDefinitionChangeSuccess(e){var i,t;if(H.getIsInAutoSwitch(this._player))return;let{hack:l}=e,r=this.findLatestSwitchSuccessItem(1);if(r){let e=this._calcPlayDuration();this._recordStartTime(),r.definationInfo=(0,o._)((0,n._)({},r.definationInfo),{play_duration:(null==r?void 0:null===(t=r.definationInfo)||void 0===t?void 0:t.play_duration)+e})}let a=this.findLatestSwitchSuccessItem(3);this.setClarity(null==a?void 0:null===(i=a.definationInfo)||void 0===i?void 0:i.clarity_now),a&&(a.switchEndTime=l?null==a?void 0:a.switchStartTime:Date.now(),a.status=1,a.definationInfo=(0,o._)((0,n._)({},a.definationInfo),{is_super_resolution:this._srStatus,play_duration:0})),this.recordSrStatus()}recordSrStatus(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this._srStatus=this.getSuperResolution(),this._timer=null},1e3)}addSwitchDefinationInfo(e){this._switchDefinationInfos.push(e)}removeSwitchDefinationInfo(e){this._switchDefinationInfos.shift()}clearSwitchDefinationInfo(){this._switchDefinationInfos=[]}onDefinitionChange(e){var i,t,l,r;if(H.getIsInAutoSwitch(this._player))return;let{to:a,from:u,hack:d=0}=e||{},{_player:s}=this,{clarityChange:v}=(null==s?void 0:null===(i=s.config)||void 0===i?void 0:i.shared)||{},{from:c,to:_}=v||{};if(c&&_){let e;let{clarity:i}=_,{clarity:u}=c,s=u===T.hq.Auto,v=i===T.hq.Auto;e=s||v?R.Auto:Number(i)>Number(u)?R.Up:R.Down;let f={};if(d){let e=null===this||void 0===this?void 0:null===(t=this._player)||void 0===t?void 0:t.curDefinition,o=(null==e?void 0:e.bitrate)||(null==e?void 0:e.realBitrate)||0,r=(null==e?void 0:null===(l=e.audioDefinition)||void 0===l?void 0:l.bitrate)||0,u=(null==e?void 0:e.realBitrate)||0;f=(0,n._)({switch_order:this._count++,clarity_now:this._clarityTransform(i),video_quality:null==a?void 0:a.qualityType,video_bitrate:o,audio_bitrate:r,play_bitrate:u,play_duration:0,switch_type:F.mannual,is_bytevc1:this._getCodec(),video_format:(null==e?void 0:e.format)||""},K((null==e?void 0:e.ufq)||{}))}else{let e=(null==a?void 0:a.bitrate)||(null==a?void 0:a.realBitrate)||0,t=(null==a?void 0:null===(r=a.audioDefinition)||void 0===r?void 0:r.bitrate)||0,l=(null==a?void 0:a.realBitrate)||0;f=(0,n._)({switch_order:this._count++,clarity_now:this._clarityTransform(i),video_quality:null==a?void 0:a.qualityType,video_bitrate:e,audio_bitrate:t,play_bitrate:l,play_duration:0,switch_type:F.mannual,is_bytevc1:this._getCodec(),video_format:(null==a?void 0:a.format)||""},K((null==a?void 0:a.ufq)||{}))}let m={switchOption:e,switchFromAuto:s,switchToAuto:v,switchStartTime:Date.now(),status:3,definationInfo:f};this.addSwitchDefinationInfo(m);let p=this.findLatestSwitchSuccessItem(1);p&&(p.definationInfo=(0,o._)((0,n._)({},p.definationInfo),{is_super_resolution:this._srStatus}))}}onUserAction(e){}onEnded(){}_initListener(){let{_player:e}=this;null==e||e.on(A.Events.USER_ACTION,this.onUserAction),null==e||e.on(j.BeforeDefinitionChange,this.onBeforeDefinitionChange),null==e||e.on(x._c.ABR_DEFINITION_REAL_CHANGE,this.onABRDefinitionChangeSuccess),null==e||e.on(j.DefinitionChange,this.onDefinitionChange),null==e||e.on(j.DefinitionChangeSuccess,this.onDefinitionChangeSuccess),null==e||e.on(j.DefinitionChangeFail,this.onDefinitionChangeFail),null==e||e.on(A.Events.ENDED,this.onEnded)}_uninitListener(){let{_player:e}=this;null==e||e.off(A.Events.USER_ACTION,this.onUserAction),null==e||e.off(j.BeforeDefinitionChange,this.onBeforeDefinitionChange),null==e||e.off(j.DefinitionChange,this.onDefinitionChange),null==e||e.off(j.DefinitionChangeSuccess,this.onDefinitionChangeSuccess),null==e||e.off(j.DefinitionChangeFail,this.onDefinitionChangeFail),null==e||e.off(A.Events.ENDED,this.onEnded)}destroy(){this._uninitListener(),this.clearSwitchDefinationInfo(),this._initClarity=null,this.unbindFunc(),this._player=null,this._status=null,this._timer&&(clearTimeout(this._timer),this._timer=null)}getLatestSwitchDefinationInfo(){var e,i;return null===(i=this._switchDefinationInfos)||void 0===i?void 0:i[(null===(e=this._switchDefinationInfos)||void 0===e?void 0:e.length)-1]}findLatestSwitchSuccessItem(e){var i;let t;let l=null===(i=this._switchDefinationInfos)||void 0===i?void 0:i.length,n=e||1;for(let e=l-1;e>=0;e--){let i=this._switchDefinationInfos[e];if((null==i?void 0:i.status)===n){t=i;break}}return t}constructor(e){(0,l._)(this,"_switchDefinationInfos",[]),(0,l._)(this,"_player",void 0),(0,l._)(this,"_startTime",void 0),(0,l._)(this,"_initClarity",void 0),(0,l._)(this,"_count",0),(0,l._)(this,"_timer",null),(0,l._)(this,"_status",void 0),(0,l._)(this,"_nowClarity",void 0),(0,l._)(this,"_abtestData",void 0),(0,l._)(this,"_srStatus",void 0),(0,l._)(this,"_awemeInfo",void 0);let{player:i,awemeInfo:t,abtestData:n}=e;this._switchDefinationInfos=[],this._player=i,this._abtestData=n,this._awemeInfo=t,this._status=0,this.onBeforeDefinitionChange=this.onBeforeDefinitionChange.bind(this),this.onDefinitionChangeFail=this.onDefinitionChangeFail.bind(this),this.onDefinitionChangeSuccess=this.onDefinitionChangeSuccess.bind(this),this.onDefinitionChange=this.onDefinitionChange.bind(this),this.onABRDefinitionChangeSuccess=this.onABRDefinitionChangeSuccess.bind(this),this.onUserAction=this.onUserAction.bind(this),this.onEnded=this.onEnded.bind(this)}}let W=e=>{let{player:i,gearList:t,abtestData:l,isActive:n,awemeInfo:o}=e,r=(0,a.useRef)(null);(0,a.useEffect)(()=>{var e,n;return i?(r.current=new Y({player:i,gearList:t,abtestData:l,awemeInfo:o}),null===(e=r.current)||void 0===e||e.init(),null===(n=r.current)||void 0===n||n.start(),()=>{var e;null===(e=r.current)||void 0===e||e.destroy(),r.current=null}):()=>{}},[i,l]),(0,a.useEffect)(()=>{var e,t;if(!!i)n?null===(e=r.current)||void 0===e||e.start():null===(t=r.current)||void 0===t||t.reset()},[n]),(0,a.useEffect)(()=>{var e,t;if(!!i)null===(e=r.current)||void 0===e||e.reset(),null===(t=r.current)||void 0===t||t.start()},[null==o?void 0:o.awemeId])};var Q=t("358003"),z=t("860684"),Z=t("32504"),$=t("102642");t("887817");var J=t("171087"),X=t("969911"),ee=t("252376"),ei=t("827480"),et=t("303587");let el=e=>{let{awemeInfo:i,abtestData:t}=e,{definition:l}=(0,et.d)({awemeInfo:i,abtestData:t,disableBitrateFilter:!0,enableDash:!0});try{return null==l||l.list.forEach(e=>{var i;null==e||null===(i=e.url)||void 0===i||i.forEach(e=>{e.src=(0,ei.preProcessUrl)(e.src).url})}),l}catch(e){return{}}};var en=t("69921"),eo=t("755964"),er=t("555106"),ea=t("782442"),eu=t("782563"),ed=t("156053");let es=e=>!!e&&e>1&&e<10,ev=e=>{var i;let{player:t,abtestData:l,awemeInfo:n,curDefinition:o}=e;if((0,er.$o)(m.LocalStorageKeys.srDegradePermanently)||ea.Le.getConfig(ea.gI.SrDegrade))return!1;if(!es(null==o?void 0:o.definition))return!1;return(null==l?!!void 0:null===(i=l.SR)||void 0===i?!!void 0:!!i.improvePictureQuality)||(null==o?!!void 0:!!o.orgDefinition)||!1},ec=e=>!!(0,eu.DT)()||(0,ed.YO)(e),e_=e=>{var i,t,l,n,o,r,a,u,d,s,v,c,_,f,m,p;let{player:g,abtestData:h,awemeInfo:y,isActive:w,curDefinition:P}=e,{awemeId:C,isAds:I}=y;if((null==P?void 0:P.qualityType)>9&&!I&&((null==h?void 0:null===(t=h.SR)||void 0===t?void 0:t.improvePictureQuality)||(null==h?void 0:null===(n=h.SR)||void 0===n?void 0:null===(l=n.targetDefinition)||void 0===l?void 0:l.includes(null==P?void 0:P.definition))||(null==P?void 0:P.orgDefinition))){let e=null==y?void 0:null===(o=y.video)||void 0===o?void 0:o.duration,i=null==P?void 0:P.isH265;if(!(null==h?void 0:null===(r=h.SR)||void 0===r?void 0:r.filteredFormats)||(null==h?void 0:null===(a=h.SR)||void 0===a?void 0:a.filteredFormats)&&(null==h?void 0:null===(d=h.SR)||void 0===d?void 0:null===(u=d.filteredFormats)||void 0===u?void 0:u.includes(i))){if(null==h||null===(s=h.SR)||void 0===s||!s.videoDuration)return!!window.TTCommon;if(e<(null==h?void 0:null===(v=h.SR)||void 0===v?void 0:v.videoDuration)&&(null==h?void 0:null===(_=h.SR)||void 0===_?void 0:null===(c=_.filteredFormatsLow)||void 0===c?void 0:c.includes(i))||e>=(null==h?void 0:null===(f=h.SR)||void 0===f?void 0:f.videoDuration)&&(null==h?void 0:null===(p=h.SR)||void 0===p?void 0:null===(m=p.filteredFormatsHigh)||void 0===m?void 0:m.includes(i)))return!!window.TTCommon}}if(I&&(null==g?void 0:null===(i=g.curDefinition)||void 0===i?void 0:i.qualityType)>9)return!!window.TTCommon},ef=e=>{var i,t,l,n,o,r,a,u,d,s,v,c,_,f,m,p,g,h,y;let{player:w,abtestData:P,awemeInfo:C,isActive:I,curDefinition:S}=e,{awemeId:E,isAds:T}=C;if((null==w?void 0:null===(i=w.curDefinition)||void 0===i?void 0:i.qualityType)>9&&!T&&((null==P?void 0:null===(t=P.SRMultiScene)||void 0===t?void 0:t.improvePictureQuality)||(null==P?void 0:null===(o=P.SRMultiScene)||void 0===o?void 0:null===(n=o.targetDefinition)||void 0===n?void 0:n.includes(null==w?void 0:null===(l=w.curDefinition)||void 0===l?void 0:l.definition))||(null===(r=w.curDefinition)||void 0===r?void 0:r.orgDefinition))){let e=null==C?void 0:null===(a=C.video)||void 0===a?void 0:a.duration,i=null==w?void 0:null===(u=w.curDefinition)||void 0===u?void 0:u.isH265;if(!(null==P?void 0:null===(d=P.SRMultiScene)||void 0===d?void 0:d.filteredFormats)||(null==P?void 0:null===(s=P.SRMultiScene)||void 0===s?void 0:s.filteredFormats)&&(null==P?void 0:null===(c=P.SRMultiScene)||void 0===c?void 0:null===(v=c.filteredFormats)||void 0===v?void 0:v.includes(i))){if(null==P||null===(_=P.SRMultiScene)||void 0===_||!_.videoDuration)return!!window.TTCommon;if(e<(null==P?void 0:null===(f=P.SRMultiScene)||void 0===f?void 0:f.videoDuration)&&(null==P?void 0:null===(p=P.SRMultiScene)||void 0===p?void 0:null===(m=p.filteredFormatsLow)||void 0===m?void 0:m.includes(i))||e>=(null==P?void 0:null===(g=P.SRMultiScene)||void 0===g?void 0:g.videoDuration)&&(null==P?void 0:null===(y=P.SRMultiScene)||void 0===y?void 0:null===(h=y.filteredFormatsHigh)||void 0===h?void 0:h.includes(i)))return!!window.TTCommon}}return!1},em=e=>(0,eu.DT)()?(null==e?void 0:e.srSceneType)===T.dd.douyinClientMulti?ef(e):e_(e):ev(e),ep=(e,i)=>{let t={key:T.hq.HD4K,label:T.cJ.HD4K,val:(0,r.jsxs)("div",{className:"clarity-wrapper",children:[(0,r.jsx)("span",{children:T.cJ.HD4K}),!1===e?(0,r.jsx)("span",{className:"loginV2",children:"登录即享"}):null]}),stat:T.hq.HD4K,quality:0,defaultQuality:1,gearName:"",gearType:T.EA.HD4K},l={key:T.hq.HD2K,label:T.cJ.HD2K,val:(0,r.jsxs)("div",{className:"clarity-wrapper",children:[(0,r.jsx)("span",{children:T.cJ.HD2K}),!1===e?(0,r.jsx)("span",{className:"loginV2",children:"登录即享"}):null]}),stat:T.hq.HD2K,quality:0,defaultQuality:1,gearName:"",gearType:T.EA.HD2K},n=[{key:T.hq.Hd,label:T.cJ.Hd,val:(0,r.jsxs)("div",{className:"clarity-wrapper",children:[(0,r.jsx)("span",{children:T.cJ.Hd}),!1===e?(0,r.jsx)("span",{className:"loginV2",children:"登录即享"}):null]}),stat:T.hq.Hd,quality:0,defaultQuality:1,gearName:"",gearType:T.EA.Hd},{key:T.hq.Clear,label:T.cJ.Clear,val:T.cJ.Clear,stat:T.hq.Clear,quality:0,defaultQuality:10,gearName:"",gearType:T.EA.Clear},{key:T.hq.Smooth,label:T.cJ.Smooth,val:T.cJ.Smooth,stat:T.hq.Smooth,quality:0,defaultQuality:20,gearName:"",gearType:T.EA.Smooth},{key:T.hq.Auto,label:T.cJ.Auto,val:T.cJ.Auto,stat:T.hq.Auto,quality:0,gearName:"",gearType:T.EA.Auto}],o=[{key:T.hq.Hd,label:T.QM.Hd,val:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:T.QM.Hd}),!1===e?(0,r.jsx)("span",{className:"login",children:"登录即享"}):null]}),stat:T.hq.Hd,quality:0,defaultQuality:1,gearName:"",gearType:T.EA.Hd},{key:T.hq.Clear,label:T.QM.Clear,val:T.QM.Clear,stat:T.hq.Clear,quality:0,defaultQuality:10,gearName:"",gearType:T.EA.Clear},{key:T.hq.Smooth,label:T.QM.Smooth,val:T.QM.Smooth,stat:T.hq.Smooth,quality:0,defaultQuality:20,gearName:"",gearType:T.EA.Smooth},{key:T.hq.Fast,label:T.QM.Fast,val:T.QM.Fast,stat:T.hq.Fast,quality:0,defaultQuality:24,gearName:"",gearType:T.EA.Fast},{key:T.hq.Auto,label:T.QM.Auto,val:T.QM.Auto,stat:T.hq.Auto,quality:0,gearName:"",gearType:T.EA.Auto}];return(0,y.fR)()?[t,l].concat(n):(null==i?void 0:i.exposureDefination)?n:o},eg=e=>{let{awemeInfo:i,userInfo:t={},player:l,isActive:n,currentDefinition:o,userSelectDefinition:r,abtestData:u,isInnerFeed:d,srSceneType:s,isModalVideo:v,modalEnterFrom:c}=e,{isLogin:g}=t,h=(0,a.useMemo)(()=>(0,y.fR)()?T.cJ:T.QM,[u]),[P,C]=(0,a.useState)(""),[I,S]=(0,a.useState)(h.Auto);(0,a.useEffect)(()=>{l&&(l.curClarity=P)},[P]);let L=(0,a.useMemo)(()=>{let e=ep(g,u),t=el({awemeInfo:i,abtestData:u});if((null==u?void 0:u.switchUseSR)&&ec({abtestData:u,awemeInfo:i,isInnerFeed:d,isModalVideo:v,modalEnterFrom:c})&&t.list.forEach(e=>{em({srSceneType:s,player:l,abtestData:u,awemeInfo:i,isActive:n,curDefinition:e})&&(e.enableSr=!0)}),e=ep(g,u).filter(e=>{if(e.gearType===T.EA.Auto)return!0;if(Array.isArray(t.list)&&-1!==t.list.findIndex(i=>i.definition===e.gearType))return!0;{let i=T.i4[e.gearType];if(!i)return!1;let l=t.list.find(e=>e.definition===i&&(null==e?void 0:e.enableSr));return!!l&&(e.isSr=!0,e.srInfo=l,!0)}}),n){var o,r;let t=null!==(r=null==u?void 0:u.clarityMap)&&void 0!==r?r:f.ClarityMap,n=[];((null==i?void 0:null===(o=i.video)||void 0===o?void 0:o.bitRateList)||[]).forEach(i=>{n.push(i.gearName),Object.keys(t).forEach(l=>{let n=e.findIndex(e=>{if(null==e||!e.isSr)return e.key===l;{let i=null===T.vk||void 0===T.vk?void 0:T.vk[e.key];return!!i&&i===l}});n>-1&&t[l].includes(i.gearName)&&(e[n].quality=i.qualityType,e[n].gearName=i.gearName)})});let a=(0,w.G)(m.SessionStorageKeys.manualSwitch)||{};a.clarityReal=n,(0,w.t_)(m.SessionStorageKeys.manualSwitch,a),l&&(l.gearList=e,l.allowList=t)}return e},[g,i,o,n,r,u,d]),N=(0,a.useCallback)(_()(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,w.G)(m.SessionStorageKeys.manualSwitch)||{};if(t.gearClarity&&t.gearClarity!==T.hq.Auto){let n,o=!1,r=null==t?void 0:t.gearClarity;if(u.switchUseSR&&(n=L.find(e=>{let i=(null==e?void 0:e.isSr)?null===T.i4||void 0===T.i4?void 0:T.i4[e.gearType]:e.gearType;return e.key===r&&i===Number(null==l?void 0:l.curDefinition.definition)})),!n&&((0,y.fR)()||(null==u?void 0:u.exposureDefination))){if(!(n=L.find(e=>e.key===r))&&(null==L?void 0:L.length)>1){let e=null==L?void 0:L[0],i=null==L?void 0:L[L.length-2];n=Number(r)>Number(null==e?void 0:e.key)?null==L?void 0:L[0]:Number(r)<Number(null==i?void 0:i.key)?[...L].reverse().find(e=>Number(e.key)>Number(r)):L.find(e=>Number(e.key)<Number(r))}n&&!function(e){var i,t;let{item:l,player:n,onBeforeSwitch:o,awemeInfo:r,abtestData:a}=e,{gearType:u,isSr:d}=l,{curDefinition:s}=n,v=d?null===T.i4||void 0===T.i4?void 0:T.i4[u]:Number(u),c=el({awemeInfo:r,abtestData:a});if(!(null===(i=c.list)||void 0===i?void 0:i.length))return;let _=c.list.find(e=>Number(e.definition)===v);_&&_.definition!==s.definition&&(o(),n.seamlessSwitch({url:void 0,urlList:_.url,mediaInfo:{size:_.size,bitrate:_.bitrate,duration:(null==r?void 0:null===(t=r.video)||void 0===t?void 0:t.duration)/1e3||0,id:null==r?void 0:r.awemeId,file_id:null==_?void 0:_.file_id}}),n.emit(j.DefinitionChange,{to:_,from:{},hack:!1}),n.curDefinition=_)}({onBeforeSwitch:()=>{H.addAutoSwitchCount(l)},abtestData:u,item:n,awemeInfo:i,player:l})}if(n&&(C(n.key),S(n.label),o=!0),!o)for(let i of L)if(e){if(t.gearClarity===i.key){C(i.key),S(i.label),o=!0;break}}else{let e=i.gearType;if(u.switchUseSR&&(e=(null==i?void 0:i.isSr)&&(null===T.i4||void 0===T.i4?void 0:T.i4[i.gearType])||i.gearType),Number(null==l?void 0:l.curDefinition.definition)===e||Number(null==l?void 0:l.curDefinition.definition)===T.EA.Fast&&e===T.EA.Smooth){C(i.key),S(i.label),o=!0;break}}!o&&(S(h.Auto),C(T.hq.Auto))}else S(h.Auto),C(T.hq.Auto)},500),[L,l,u,h]);(0,p.o)(()=>{N()},[N]),E({player:l,action:N,awemeInfo:i,isActive:n,abtestData:u}),(0,a.useEffect)(()=>(null==l||l.on("UpdateSyncText",N),()=>{null==l||l.off("UpdateSyncText",N)}),[N,l]);let[b,A]=(0,a.useState)(en.N.Off);(0,a.useEffect)(()=>{if(l){let e=e=>{l.emit(j.DefinitionChangeSuccess,{defination:e,hack:!1})};return l.on("change_bitrate_success",e),()=>{l.off("change_bitrate_success",e)}}},[l]),(0,a.useEffect)(()=>{if(l){let e;let i=en.N.Off,t=t=>{i=t,A(t),clearTimeout(e),e=setTimeout(()=>{i=en.N.Off,A(en.N.Off)},1e3)},n=()=>{if(!((null==l?void 0:l.curClarity)===T.hq.Auto||H.getIsInAutoSwitch(l)))t(en.N.Switching)},o=()=>{if((null==l?void 0:l.curClarity)!==T.hq.Auto){if(H.getIsInAutoSwitch(l)){H.subAutoSwitchCount(l);return}setTimeout(()=>{t(en.N.SwitchSuccess)},i===en.N.Off?0:500),l.emit(J.C.UpdateDebugInfo)}},r=()=>{if(H.getIsInAutoSwitch(l)){H.subAutoSwitchCount(l);return}setTimeout(()=>{t(en.N.SwitchFail)},i===en.N.Off?0:500),l.emit(J.C.UpdateDebugInfo)};return l.on(j.DefinitionChange,n),l.on(j.DefinitionChangeSuccess,o),l.on(j.DefinitionChangeFail,r),()=>{l.off(j.DefinitionChange,n),l.off(j.DefinitionChangeSuccess,o),l.off(j.DefinitionChangeFail,r),clearTimeout(e)}}},[l]);let x=(0,a.useRef)({indexSelected:P,current:I});return(0,a.useEffect)(()=>{b===en.N.SwitchSuccess&&(x.current={current:I,indexSelected:P})},[b,P,I]),{indexSelectedState:[P,C],currentState:[I,S],lists:L,swichStatus:b,syncSelectText:N}},eh=e=>{let{awemeInfo:i,onMouseLeave:t,dispatch:l,player:d,abtestData:c,timeStamp:_}=e,[f,p]=(0,a.useState)(!1),g=null==i?void 0:i.awemeId,[h,E]=(0,a.useState)(e.userInfo),{isLogin:L}=h,N=(0,ee.H)("clarity"),A=(0,a.useRef)(),{indexSelectedState:[x,D],currentState:[k,R],lists:M,swichStatus:F,syncSelectText:O}=eg((0,o._)((0,n._)({},e),{userInfo:h}));b({indexSelected:x,current:k,uniqueKey:`${null==i?void 0:i.awemeId}-${_}`}),W({player:d,gearList:M,abtestData:c,awemeInfo:i}),(0,a.useEffect)(()=>{if(d){var e;d.videoList=null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.bitRateList}},[i,d]);let U=(0,a.useCallback)((e,i)=>{let t=(0,w.G)(m.SessionStorageKeys.manualSwitch)||{};t.done=1;let l=e||i===T.hq.Auto&&(null==M?void 0:M[(null==M?void 0:M.length)-1]);l&&(t.gearClarity=l.key,t.qualityType=l.quality||(null==e?void 0:e.defaultQuality),t.gearName=l.label,t.gearType=l.gearType),(0,w.t_)(m.SessionStorageKeys.manualSwitch,t)},[M]),V=(0,v.Z)(e=>{U(e),d.curClarity=e.key;let{curDefinition:t}=d;d.updateConfig({shared:{clarityChange:{from:{clarity:x,defination:t.definition},to:{clarity:e.key,defination:e.gearType}}}}),!function(e){var i,t;let{item:l,player:r,indexSelected:a,awemeInfo:u,abtestData:d}=e;if(l.key===T.hq.Auto){r.emit(j.DefinitionChange,{hack:!0}),setTimeout(()=>{r.emit(j.DefinitionChangeSuccess,{hack:!0})},1e3),(null==d?void 0:d.switchUseSR)&&r.emit(j.DefinitionChangeOnlyForSr);return}let{gearType:s,isSr:v}=l,{curDefinition:c}=r,_=v?null===T.i4||void 0===T.i4?void 0:T.i4[s]:Number(s);if(_===Number(c.definition)){a===T.hq.Auto&&(r.emit(j.DefinitionChange,{hack:!0}),setTimeout(()=>{r.emit(j.DefinitionChangeSuccess,{hack:!0})},1e3)),(null==d?void 0:d.switchUseSR)&&r.emit(j.DefinitionChangeOnlyForSr);return}let f=el({awemeInfo:u,abtestData:d});if(!(null===(i=f.list)||void 0===i?void 0:i.length)){r.emit(j.DefinitionChangeFail);return}let m=f.list.find(e=>Number(e.definition)===_);if(m){if(m.definition!==c.definition){let e=r.config.shared.definition;r.updateConfig({shared:{definition:(0,o._)((0,n._)({},e),{list:f.list})}}),H.resetAutoSwitchCount(r),r.seamlessSwitch({url:void 0,urlList:m.url,mediaInfo:{size:m.size,bitrate:m.bitrate,duration:(null==u?void 0:null===(t=u.video)||void 0===t?void 0:t.duration)/1e3||0,id:null==u?void 0:u.awemeId,file_id:null==m?void 0:m.file_id}}),r.emit(j.DefinitionChange,{to:m,from:{},hack:!1}),r.curDefinition=m}}else r.emit(j.DefinitionChangeFail)}({item:e,player:d,indexSelected:x,awemeInfo:i,abtestData:c}),p(!1),D(e.key),R(e.label)}),B=(0,v.Z)(function(e){var r;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null==t||t(),d.emit(u.FP.USER_ACTION,{action:"switch_clarity",pluginName:"clarity"});let s=(0,w.G)(m.SessionStorageKeys.manualSwitch)||{};if(Z.Z.sendLog("clarityCellClick",(0,n._)({group_id:g,action:e.key,item_duration_ms:(null==i?void 0:null===(r=i.video)||void 0===r?void 0:r.duration)||0,enter_from_merge:(0,P.yW)(),enter_from:(0,C.mo)(),enter_method:"clarity_panel",player_display_mode:(0,C.Ok)()},(0,I.t)(),a)),!1===L&&[T.hq.HD4K,T.hq.HD2K,T.hq.Hd].includes(e.key)){(0,Q.default)({headerText:"登录后即可享受高清画质",success:()=>{var i,t,r,a;if(l({type:"updateUserInfo"}),d&&(null==d?void 0:null===(t=d.config)||void 0===t?void 0:null===(i=t.shared)||void 0===i?void 0:i.definition)){let e=d.config.shared.definition;d.updateConfig({shared:{definition:(0,o._)((0,n._)({},e),{userSelectDefinition:1})}})}E(e=>(0,o._)((0,n._)({},e),{isLogin:!0})),null==d||null===(a=d.getPlugin)||void 0===a||null===(r=a.call(d,X.p7.PlayClaritySettingPlugin))||void 0===r||r.renderRoot(),V(e)},enterMethod:"clarity_panel",clarity:s.gearClarity,isAuto:s.done?0:1,gearName:s.gearName});return}V(e)}),[,K]=(0,a.useState)({});(0,a.useEffect)(()=>{var e;let i=null==S?void 0:S.listen(null==S?void 0:null===(e=S.EVENT)||void 0===e?void 0:e.clarityRel,e=>{if(e.hdLogin){var i;(null==d?void 0:null===(i=d.config)||void 0===i?void 0:i.shared)&&(d.config.shared.userSelectUpdate=Date.now());let e=M.find(e=>[T.hq.HD4K,T.hq.HD2K,T.hq.Hd].includes(e.key));e&&V(e),E(e=>(0,o._)((0,n._)({},e),{isLogin:!0}))}if(e.autoSwitch){let e=M.find(e=>e.key===T.hq.Auto);e&&V(e),d.config.shared.userSelectUpdate=Date.now(),K({})}e.exitInner&&(d.config.shared.userSelectUpdate=Date.now(),O(!0),K({}))});return()=>{i()}},[d,c]),(0,a.useEffect)(()=>{let e=e=>{let{item:i,logParams:t}=e;B(i,t)};if(d)return null==d||d.on(J.C.UpdateClarity,e),()=>{null==d||d.off(J.C.UpdateClarity,e)}},[d]),(0,a.useEffect)(()=>{d&&M&&d.updateConfig({shared:{clearLists:M}})},[d,M]);let q=!!M.find(e=>[T.hq.HD4K,T.hq.HD2K,T.hq.Hd].includes(e.key));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:s()("gear",{hover:f,isClarityLogin:!((0,y.fR)()||(null==c?void 0:c.exposureDefination))&&(L||!q),isSmoothSwitchClarity:((0,y.fR)()||(null==c?void 0:c.exposureDefination))&&!L,isSmoothSwitchClarityLogin:!(((0,y.fR)()||(null==c?void 0:c.exposureDefination))&&!L)}),ref:N,onMouseOver:e=>{if(!e.target.closest(".semi-portal"))clearTimeout(A.current),p(!0),!f&&Z.Z.sendLog("clarityCellShow",(0,n._)({group_id:null==i?void 0:i.awemeId},(0,I.t)()))},onMouseOut:()=>{p(!1)},children:[(0,r.jsx)("div",{className:"virtual",children:null==M?void 0:M.map(e=>(0,r.jsx)("div",{className:s()("item",{selected:e.key===x}),onClick:()=>B(e),children:e.val},e.key))}),(0,r.jsx)(eo.A,{visible:F!==en.N.Off,getPopupContainer:()=>N.current,swichStatus:F,current:k,children:(0,r.jsx)("div",{className:s()("btn",{btnV2:((0,y.fR)()||(null==c?void 0:c.exposureDefination))&&x&&x!==T.hq.Auto}),children:k})})]}),(0,r.jsx)("div",{className:"login-tooltip-slot"}),(0,r.jsx)("div",{className:"smart-tooltip-slot"})]})};class ey extends u.di{afterPlayerInit(){this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseleave),this.renderRoot()}beforeDestroy(){this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseleave),this.el.removeEventListener("blur",this.onMouseleave),(0,$.v)(this)}renderRoot(){var e,i,t,l,a,u,d,s,v,c,_,f,m,p;if((null===(i=this._config)||void 0===i?void 0:null===(e=i.awemeInfo)||void 0===e?void 0:e.awemeType)===(null==g?void 0:null===(t=h.e)||void 0===t?void 0:t.Note))return;let y=(0,r.jsx)(eh,(0,o._)((0,n._)({onMouseEnter:this.onMouseenter,onMouseLeave:this.onMouseleave},this._config),{player:this._player,currentDefinition:null===(d=this._player)||void 0===d?void 0:null===(u=d.getPlugin)||void 0===u?void 0:null===(a=u.call(d,X.p7.BitrateSelector))||void 0===a?void 0:null===(l=a.curBitRate)||void 0===l?void 0:l.definition,userSelectDefinition:null===(_=this._player)||void 0===_?void 0:null===(c=_.config)||void 0===c?void 0:null===(v=c.shared)||void 0===v?void 0:null===(s=v.definition)||void 0===s?void 0:s.userSelectDefinition,userSelectUpdate:null===(p=this._player)||void 0===p?void 0:null===(m=p.config)||void 0===m?void 0:null===(f=m.shared)||void 0===f?void 0:f.userSelectUpdate}));(0,$.s)(this,y)}render(){var e,i,t;return`<dy-icon class="douyin-player-playclarity-setting douyin-player-playclarity-setting-unique-${null===(i=this._config)||void 0===i?void 0:null===(e=i.awemeInfo)||void 0===e?void 0:e.awemeId}-${null===(t=this._config)||void 0===t?void 0:t.timeStamp}" data-state="normal"></dy-icon>`}constructor(...e){super(...e),(0,l._)(this,"onMouseleave",()=>{this._player.emit(J.C.IconMouseleave,{pluginName:X.p7.PlayClaritySettingPlugin})}),(0,l._)(this,"onMouseenter",()=>{this._player.emit(J.C.IconMouseenter,{pluginName:X.p7.PlayClaritySettingPlugin})})}}(0,l._)(ey,"pluginName",X.p7.PlayClaritySettingPlugin);let ew=e=>{let{userInfo:{isLogin:i},awemeInfo:t,isActive:l}=e,r=(0,z.n)();return(0,p.o)(()=>{if(r&&(null==t?void 0:t.awemeType)!==h.e.Note)return r.registerPlugin(ey,(0,o._)((0,n._)({},e),{player:r,timeStamp:Date.now(),position:u.PZ.CONTROL_RIGHT,index:7,className:"douyin-player-playclarity-setting"})),()=>{if(!r.destroyed)r.getPlugin(X.p7.PlayClaritySettingPlugin)&&r.unRegisterPlugin(X.p7.PlayClaritySettingPlugin)}},[r,i,t]),(0,a.useEffect)(()=>{r&&l&&r.emit("UpdateSyncText")},[l,r]),null}},755964:function(e,i,t){t.d(i,{A:function(){return a}});var l=t(563097),n=t(88648),o=t(747909),r=t(69921);let a=e=>{let{current:i,swichStatus:t,children:a,getPopupContainer:u,visible:d}=e,s=(0,n.useRef)("");return t===r.N.SwitchFail?s.current="清晰度切换失败，请稍后再试":t===r.N.Switching?s.current=`正在切换到 ${i} ...`:t===r.N.SwitchSuccess&&(s.current=`清晰度已经切换至 ${i}`),(0,l.jsx)(o.Tooltip,{position:"top",visible:d,getPopupContainer:u,trigger:"custom",rePosKey:String(d),zIndex:10,content:(0,l.jsx)("div",{children:s.current}),children:a})}},304493:function(e,i,t){t.d(i,{EA:function(){return u},QM:function(){return s},Ts:function(){return _},YB:function(){return o},cJ:function(){return v},dd:function(){return g},g:function(){return m},hq:function(){return r},i4:function(){return d},jH:function(){return c},rT:function(){return n},sY:function(){return f},vk:function(){return a},y8:function(){return p}});var l=t(969911),n={HD4K:7,7:"HD4K",HD2K:6,6:"HD2K",Hd:5,5:"Hd",Clear:4,4:"Clear",Smooth:3,3:"Smooth",Fast:2,2:"Fast",Auto:1,1:"Auto"},o={HD4K:6,6:"HD4K",HD2K:5,5:"HD2K",Hd:4,4:"Hd",Clear:3,3:"Clear",Smooth:2,2:"Smooth",Auto:1,1:"Auto"},r={HD4K:"20",HD2K:"10",Hd:"5",Clear:"4",Smooth:"3",Fast:"2",Auto:"0"};let a={5:"4",4:"3",3:"2"};var u={HD4K:-2,"-2":"HD4K",HD2K:-1,"-1":"HD2K",Hd:1,1:"Hd",Clear:2,2:"Clear",Smooth:3,3:"Smooth",Fast:4,4:"Fast",Auto:0,0:"Auto"};let d={1:2,2:3,3:4};var s={Hd:"高清",Clear:"清晰",Smooth:"流畅",Fast:"极速",Auto:"智能"},v={HD4K:"超清 4K",HD2K:"超清 2K",Hd:"高清 1080P",Clear:"高清 720P",Smooth:"标清 540P",Fast:"极速",Auto:"智能"},c={low:"当前网络较差，",high:"当前网络良好，",lowTail:"更流畅",highTail:"更清晰"};let _=864e5,f=158112e5,m={highTimestamp:0,highTimes:0,lowTimestamp:0},p=["volume","fullscreen","playbacksettingplugin","autoplaysettingplugin","innerautoplayplugin","immersiveswitchsettingplugin","playclaritysettingplugin","pagefullscreenplugin",l.p7.PlayBackSettingPlugin,l.p7.AutoPlaySettingPlugin,l.p7.ImmersiveSwitchSettingPlugin,l.p7.PlayClaritySettingPlugin,l.p7.PageFullScreenPlugin,l.p7.InnerAutoPlayPlugin];var g={douyinWeb:0,0:"douyinWeb",douyinClient:1,1:"douyinClient",douyinClientMulti:2,2:"douyinClientMulti"}},69921:function(e,i,t){t.d(i,{N:function(){return l}});var l={Off:0,0:"Off",Switching:1,1:"Switching",SwitchSuccess:2,2:"SwitchSuccess",SwitchFail:3,3:"SwitchFail"}},32504:function(e,i,t){var l=t(544933);i.Z=new l.h({clarityNotifyShow:{eventName:"clarity_notify_show",params:{group_id:"",clarity:"",is_auto:1,gear_name:""}},clarityNotifyClick:{eventName:"clarity_notify_click",params:{group_id:"",action:"",clarity:"",is_auto:1,gear_name:""}},clarityCellShow:{eventName:"clarity_cell_show",params:{group_id:"",clarity:"",is_auto:1,gear_name:""}},clarityCellClick:{eventName:"clarity_cell_click",params:{group_id:"",action:"",clarity:"",is_auto:1,gear_name:"",enter_from_merge:"",enter_from:"",item_duration_ms:0,player_display_mode:""}},clarityBubbleShow:{eventName:"clarity_bubble_show",params:{group_id:"",clarity:"",is_auto:1,method:"",gear_name:""}}})},201099:function(e,i,t){t.d(i,{E:function(){return ec}});var l=t("88648"),n=t("629582"),o=t("782442");let r=e=>{let{player:i,isActive:t}=e;(0,l.useEffect)(()=>{if(i&&t){let e=()=>{o.Le.setConfig(o.gI.VideoHasPrevent,!0)};return i.on(n.FP.AUTOPLAY_WAS_PREVENTED,e),()=>{i.off(n.FP.AUTOPLAY_WAS_PREVENTED,e)}}},[i,t])};var a=t("520739"),u=t("878389");t("250440"),t("209955");var d=t("948375"),s=t("497730"),v=t("35730"),c=t("391779"),_=t("972438"),f=t("399796"),m=t("137425"),p=t("702726"),g={Loading:"douyin-player-isloading"},h=t("303587"),y=t("516599"),w=t("378844");let P=e=>{let{player:i,isActive:t,awemeInfo:l,abtestData:n,startTime:o}=e;i.isPlaying=!1;let r=(0,h.d)({awemeInfo:l,abtestData:n,enableDash:!0}).url.find(e=>!!e.src);return!!r&&(i.updateConfig({baseConfig:{autoplay:t}}),t?(i.updateConfig({baseConfig:{startTime:o}}),i.play()):(i.src=r.src,i.video.autoplay=!1),!0)},C=()=>{p.logInstance.sendLog("videoRetryError",{type:"retry_success"})},I=()=>{p.logInstance.sendLog("videoRetryError",{type:"retry_error"})},S=e=>{e.off(n.FP.ERROR,I),e.off(n.FP.LOADEDDATA,C)},E=e=>{S(e),e.once(n.FP.ERROR,I),e.once(n.FP.LOADEDDATA,C)},T=e=>{let{player:i,isActive:t,awemeInfo:n,deleteCurrentSwiper:r,abtestData:h}=e,C=(0,l.useRef)(t);C.current=t;let I=(0,l.useRef)(null==n?void 0:n.awemeId);I.current=null==n?void 0:n.awemeId;let T=(0,l.useRef)(!1),L=(0,l.useRef)(!1),N=(0,l.useRef)(!1),b=(0,l.useRef)(0),A=(0,d.Z)(async(e,t,l)=>{var n,a,u,d,v,_,f,w,S,A,x,D,k;if((t||Date.now()-b.current>6e4)&&(L.current=!1,N.current=!1),L.current&&N.current)return p.logInstance.sendLog("videoRetryError",{type:"real_blank_screen",aweme_id:e}),!1;if(b.current=Date.now(),null===(a=i.plugins)||void 0===a||null===(n=a.error)||void 0===n||n.setError(null),i.addClass(g.Loading),E(i),L.current||6===l)L.current=!0;else{L.current=!0;let t=i.src&&1===(0,c.q)(i.src),l=i.currentTime,n=(null==i?void 0:null===(d=i.config)||void 0===d?void 0:null===(u=d.baseConfig)||void 0===u?void 0:u.urlList)instanceof Array?null==i?void 0:null===(f=i.config)||void 0===f?void 0:null===(_=f.baseConfig)||void 0===_?void 0:null===(v=_.urlList)||void 0===v?void 0:v.find(e=>{var i;return null==e?void 0:null===(i=e.src)||void 0===i?void 0:i.includes("www.douyin.com")}):null;return!n&&p.logInstance.sendLog("videoRetryError",{type:"retry_base_url_miss",aweme_id:e}),t&&n?(i.src=n.src,i.currentTime=l):i.retry(),!0}p.logInstance.sendLog("videoRetryError",{type:"retry_native",aweme_id:e});try{N.current=!0;let t=i.currentTime,l=await (0,m.m_)({awemeId:e,originType:s.F.PlayerRetry});if(!T.current&&I.current===e){let n=null;if(0===l.statusCode&&l.detail){if(n=l.detail,!P({player:i,awemeInfo:l.detail,isActive:C.current,abtestData:h,startTime:t}))return null===(S=i.plugins)||void 0===S||null===(w=S.error)||void 0===w||w.setError(Error()),i.removeClass(g.Loading),!1;p.logInstance.sendLog("videoRetryError",{type:"retry_api_aweme_ok",aweme_id:e})}else{if(!l.isUnknownAweme)return null===(x=i.plugins)||void 0===x||null===(A=x.error)||void 0===A||A.setError(Error()),i.removeClass(g.Loading),p.logInstance.sendLog("videoRetryError",{type:"retry_api_statuscode_error",aweme_id:e}),!1;null==r||r(),C.current&&y.F.info("该视频已被删除"),p.logInstance.sendLog("videoRetryError",{type:"retry_api_aweme_404",aweme_id:e})}o.Le.setConfig(o.gI.RefetchAwemeInfo,{[e]:n})}}catch(t){return null===(k=i.plugins)||void 0===k||null===(D=k.error)||void 0===D||D.setError(Error()),i.removeClass(g.Loading),p.logInstance.sendLog("videoRetryError",{type:"retry_api_catch",aweme_id:e}),!1}return!0});(0,l.useEffect)(()=>(T.current=!1,()=>{T.current=!0}),[]);let x=e=>{var t,l,o,r,d,s,m;let g=null==i?void 0:null===(t=i.curDefinition)||void 0===t?void 0:t.isH265,h=(0,u._)((0,a._)({urlParamList:["previous_page","tab_name"]},(0,w.Z)(i)),{group_id:n.groupId,aweme_type:n.awemeType,player_type:"xgplayer",player_version:i.version,errorCode:(null==e?void 0:null===(l=e.mediaError)||void 0===l?void 0:l.code)||(null==e?void 0:e.errorCode)||"",errorDesc:(null==e?void 0:null===(o=e.mediaError)||void 0===o?void 0:o.message)||(null==e?void 0:e.errorMessage)||"",is_cdn_expired:1===(0,c.q)(i.src)?1:0,vduration:null==n?void 0:null===(r=n.video)||void 0===r?void 0:r.duration,is_video_support:Number((0,_.k)().isSupport),is_bytevc1:g,log_pb:null==n?void 0:n.logPb,video_play_mode:(null===(d=f.Q.getItem({sKey:v.CookieKeys.VideoFilterMemoSelect,refresh:!1}))||void 0===d?void 0:d.type)===1?"landscape":"all",is_landscape:(null==n?void 0:null===(s=n.video)||void 0===s?void 0:s.width)>(null==n?void 0:null===(m=n.video)||void 0===m?void 0:m.height)?1:0});p.logInstance.sendLog("videoPlayError",h)};(0,l.useEffect)(()=>{var e;i&&(null==n?void 0:null===(e=n.video)||void 0===e?void 0:e.playApi)&&i.plugins.error.updateConfig({beforeRetry:e=>(A(n.awemeId,!1,null==e?void 0:e.errorCode).then(i=>{!i&&x(e)}),!1)})},[i,n]),(0,l.useEffect)(()=>{t&&i&&i.error&&n&&A(n.awemeId,!0)},[h,t,i,n,A]),(0,l.useEffect)(()=>()=>i&&i.off&&S(i),[i])};t("179133"),t("826893");var L=t("567754"),N=t("598467"),b=t("79307"),A=t("35385"),x=t("637005"),D=t("850063"),k=t("744121"),R=t("631493"),M=t("901414"),F=t("820303"),j=t("969911"),O=t("58764");let U=e=>{let{player:i,state:t}=e;i&&(i.preloadActive=t,i.video&&(i.video.autoplay=t),i.autoplay=t,i.updateConfig({baseConfig:{autoplay:t}}),(0,k.wS)(i.playerId,t))},V=e=>{var i,t;let{player:l,gearType:n,config:o,awemeInfo:r}=e;l.updateConfig({shared:{definition:(0,u._)((0,a._)({},null==o?void 0:o.definition),{userSelectDefinition:n})}}),null===(t=l.getPlugin)||void 0===t||null===(i=t.call(l,j.p7.PlayClaritySettingPlugin))||void 0===i||i.updateConfig({awemeInfo:r})},H=e=>{let{player:i}=e;U({player:i,state:!1}),i.pause()},B=e=>{var i,t,l,n,r,a,u,d,s,c,_,f,m,p,g,h,y,w,P,C,I,S;let{player:E,config:T,awemeInfo:N}=e;U({player:E,state:!0});let A=null===(i=(0,F.G)(v.SessionStorageKeys.manualSwitch))||void 0===i?void 0:i.gearType;10===A&&!(null===(a=E.config)||void 0===a?void 0:null===(r=a.shared)||void 0===r?void 0:null===(n=r.definition)||void 0===n?void 0:null===(l=n.list)||void 0===l?void 0:null===(t=l.find)||void 0===t?void 0:t.call(l,e=>10===e.definition))&&(A=1),20===A&&!(null===(_=E.config)||void 0===_?void 0:null===(c=_.shared)||void 0===c?void 0:null===(s=c.definition)||void 0===s?void 0:null===(d=s.list)||void 0===d?void 0:null===(u=d.find)||void 0===u?void 0:u.call(d,e=>20===e.definition))&&(A=(null===(h=E.config)||void 0===h?void 0:null===(g=h.shared)||void 0===g?void 0:null===(p=g.definition)||void 0===p?void 0:null===(m=p.list)||void 0===m?void 0:null===(f=m.find)||void 0===f?void 0:f.call(m,e=>10===e.definition))?10:1);let x=()=>{var e,i,t;let l=R.s.getPlayerScene(E.playerId)===b.lT.Modal||(null==E?void 0:null===(e=E.config)||void 0===e?void 0:e.isModal),n=R.s.getPlayersByScene(b.lT.Modal).length>0,r=!!(null===(i=(0,L.parse)(location.search))||void 0===i?void 0:i.webRid);if((!!l||!n)&&!r)o.Le.setConfig(o.gI.StartPlayTime,Date.now()),0===(0,O.v)(N.awemeId)&&E.currentTime>0&&E.seek(0),null==E||null===(t=E.play)||void 0===t||t.call(E)};E.isPlaying||E.currentTime>0?((null==E?void 0:null===(P=E.config)||void 0===P?void 0:null===(w=P.shared)||void 0===w?void 0:null===(y=w.definition)||void 0===y?void 0:y.userSelectDefinition)!==A&&V({player:E,gearType:A,config:T,awemeInfo:N}),E.isPlaying=!1,x("start")):(null==E?void 0:null===(S=E.config)||void 0===S?void 0:null===(I=S.shared)||void 0===I?void 0:null===(C=I.definition)||void 0===C?void 0:C.userSelectDefinition)!==A?(V({player:E,gearType:A,config:T,awemeInfo:N}),E.isPlaying=!1,x("start")):(x("play"),E.emit("immediatePlay"))},K=e=>{let{player:i,isActive:t,awemeInfo:r,config:a,abtestData:u,currentIndex:d}=e,s=(0,l.useRef)(!1),v=()=>{i.pause()};(0,l.useEffect)(()=>{let e=x.listen(x.EVENT.changeMinWindows,e=>{let{isMiniWin:i}=e;s.current=!0}),i=x.listen(x.EVENT.changeMinWinWeb,e=>{let{isMiniWinWeb:i}=e;s.current=!0});return()=>{e(),i()}},[]),(0,l.useEffect)(()=>{let e=o.Le.getConfig(o.gI.GlobalSwiper);if(e&&d&&i){let t=e=>{let{index:t}=e,l=M.e.activeScene===N.d.WebVideo,u=M.e.activeScene===N.d.ListenVideo;if(!o.Le.getConfig(o.gI.IsMiniWin)&&!s.current&&!l&&!u)d===t?(i.off(n.FP.TIMEUPDATE,v),B({player:i,config:a,awemeInfo:r}),i.preplay=1,x.emit(x.EVENT.livePause)):H({player:i})};return e.on("activeIndexChange",t),()=>{e.off("activeIndexChange",t)}}},[r,i,d]),(0,l.useEffect)(()=>{if(i){if(!(t&&(i.config.notUseRefreshVid||(0,D.B)())||t&&(0,D.r)())){if(i.__isInlinePlayer&&t&&!i.isBlockedInlinePlayerRestart&&(i.isPlaying=!1),!t)return H({player:i}),i.on(n.FP.TIMEUPDATE,v),()=>{i.off(n.FP.TIMEUPDATE,v)};i.preplay?(i.preplay=0,i.play()):B({player:i,config:a,awemeInfo:r})}}},[i,t]),(0,l.useEffect)(()=>{i&&t&&window.dispatchEvent(new Event("playNext",{bubbles:!0}))},[i,t]),(0,l.useEffect)(()=>{let e=null;if(i&&t){var l;e=window.player,window.player=i;let t=R.s.getPlayersByScene(b.lT.Modal).length>0&&R.s.getPlayerScene(i.playerId)!==b.lT.Modal;(null===(l=(0,L.parse)(location.search))||void 0===l?void 0:l.webRid)&&(i.pause(),i.updateConfig({baseConfig:{autoplay:!1}})),!t&&(k.wS,(0,k.wS)(null==i?void 0:i.playerId,!0));let n=x.listen(x.EVENT.videoPause,()=>{i.pause(),i.updateConfig({baseConfig:{autoplay:!1}})});return()=>{e&&(window.player=e),n()}}},[i,t]),(0,l.useEffect)(()=>{let e=()=>{i&&t&&R.s.getPlayersByScene(b.lT.Modal).length>0&&R.s.getPlayerScene(i.playerId)!==b.lT.Modal&&(i.pause(),i.updateConfig({baseConfig:{autoplay:!1}}),i.video.autoplay=!1)};if(i&&t)return i.once(n.FP.CANPLAY,e),i.once(n.FP.TIMEUPDATE,e),()=>{i.off(n.FP.CANPLAY,e),i.off(n.FP.TIMEUPDATE,e)}},[i,t]),(0,A.w)(()=>{if(i&&t){i.pause();let e=()=>{i.pause()};return i.on(n.FP.PLAY,e),i.on(n.FP.TIMEUPDATE,e),()=>{i.off(n.FP.PLAY,e),i.off(n.FP.TIMEUPDATE,e)}}},[t,i])};var q=t("734123");let G=e=>{let{player:i,isActive:t}=e;(0,l.useEffect)(()=>{var e,l,n;if(i&&(null===(n=i.root)||void 0===n?void 0:null===(l=n.getElementsByClassName)||void 0===l?void 0:null===(e=l.call(n,"douyin-player-start"))||void 0===e?void 0:e[0])&&(i.root.getElementsByClassName("douyin-player-start")[0].classList.add("douyinHide"),t)){let e=setTimeout(()=>{var e,t;(null===(t=i.root)||void 0===t?void 0:null===(e=t.getElementsByClassName)||void 0===e?void 0:e.call(t,"douyin-player-start")[0])&&i.root.getElementsByClassName("douyin-player-start")[0].classList.remove("douyinHide")},1e3),t=()=>{var t,l;clearTimeout(e),(null===(l=i.root)||void 0===l?void 0:null===(t=l.getElementsByClassName)||void 0===t?void 0:t.call(l,"douyin-player-start")[0])&&i.root.getElementsByClassName("douyin-player-start")[0].classList.remove("douyinHide")};return i.once(q.Events.AUTOPLAY_STARTED,t),()=>{if(!i.destroyed)i.off(q.Events.AUTOPLAY_STARTED,t),i.root.getElementsByClassName("douyin-player-start")[0]&&i.root.getElementsByClassName("douyin-player-start")[0].classList.add("douyinHide")}}},[i,t])};var Y=t("613063"),W=t.n(Y),Q=t("138871"),z=t.n(Q),Z=t("899731"),$=t.n(Z),J=t("746864"),X=t("871212"),ee=t("864630"),ei=t("441398"),et=t("44905"),el=t("186554");let en=(e,i)=>{let t=[J.e.Normal,J.e.XgVideo].includes(null==e?void 0:e.awemeType),l=i.currentTime>=3&&i.duration-i.currentTime>=30;return t&&l},eo=e=>{var i,t;let{player:r,isActive:a,awemeInfo:u,scene:d,userInfo:s}=e,v=(0,el.U7)(),c=(0,el.dY)("multi_device_resume",null==s?void 0:s.isLogin),_=v&&(null==c?void 0:c.enable)===1&&(null==c?void 0:c.pc_auto_record)===1;(0,l.useEffect)(()=>{var e,i;if(r&&(null==s?void 0:null===(e=s.info)||void 0===e?void 0:e.uid)&&(null==u?void 0:null===(i=u.continationInfo)||void 0===i?void 0:i.continationVideoAlreadyConsume)===!1){let{fwsExample:e}=o.Le.getConfig(o.gI.fwsExample)||{},i=e=>{var i,t,l,n,o;let r={app_id:X.APP_ID,message_type:new($())(ee.Cs.ReplyConsume||"0"),user_id:new($())(s.info.uid||"0"),device_id:new($())((null===(i=(0,et.Es)())||void 0===i?void 0:i.user_unique_id)||"0"),to_device_type:new($())(ee.Yi.Phone||"0"),to_device_id:new($())((null==u?void 0:null===(t=u.continationInfo)||void 0===t?void 0:t.fromDeviceId)||"0"),continuation_info:{ItemId:new($())(null==u?void 0:u.awemeId),RecordType:new($())(null==u?void 0:null===(l=u.continationInfo)||void 0===l?void 0:l.recordType),EpisodeId:new($())((null==u?void 0:null===(o=u.lvideoBrief)||void 0===o?void 0:null===(n=o.episodeInfo)||void 0===n?void 0:n.episodeId)||"0")}},a=z().stringify(r);e.send(a,{service:ee.oU.Multicast,method:10}),W()(u,"continationInfo.continationVideoAlreadyConsume",!0)};if(e){let t=()=>{i(e)};if(r.paused)return r.once(n.FP.CANPLAY,t),()=>{r.off(n.FP.CANPLAY,t)};t()}else{let e=null,t=x.listen(x.EVENT.fwsExampleInit,t=>{r.paused?(e=()=>{i(t)},r.once(n.FP.CANPLAY,e)):i(t)});return()=>{t(),r.off(n.FP.CANPLAY,e)}}}},[r,u]),(0,l.useEffect)(()=>{var e;if(r&&a&&(null==s?void 0:null===(e=s.info)||void 0===e?void 0:e.uid))return x.listen(x.EVENT.sendPullMessage,e=>{if(r.isUserActive&&en(u,r)){var i,t,l,n,a,d,v;let{toDeviceId:c,toDeviceType:_}=e||{},{fwsExample:f}=o.Le.getConfig(o.gI.fwsExample)||{},m={app_id:new($())("6383"),message_type:2,user_id:new($())((null==s?void 0:null===(i=s.info)||void 0===i?void 0:i.uid)||"0"),device_id:new($())((null===(t=(0,et.Es)())||void 0===t?void 0:t.user_unique_id)||"0"),to_device_type:new($())(_),to_device_id:new($())(c),continuation_info:{UserId:new($())((null==s?void 0:null===(l=s.info)||void 0===l?void 0:l.uid)||"0"),ItemId:new($())((null==u?void 0:u.awemeId)||"0"),ItemType:new($())((null==u?void 0:u.awemeType)||"0"),PlayTime:Math.floor(r.currentTime),Cover:(null==u?void 0:null===(n=u.video)||void 0===n?void 0:n.cover)||"",FromDeviceId:new($())((null===(a=(0,et.Es)())||void 0===a?void 0:a.user_unique_id)||"0"),FromDeviceType:Number(ee.Yi.PC),RecordType:Number(ee.ns.auto),EpisodeId:new($())((null==u?void 0:null===(v=u.lvideoBrief)||void 0===v?void 0:null===(d=v.episodeInfo)||void 0===d?void 0:d.episodeId)||"0")}},p=z().stringify(m);f.send(p,{service:ee.oU.Multicast,method:10})}})},[r,a,null==s?void 0:null===(i=s.info)||void 0===i?void 0:i.uid]),(0,l.useEffect)(()=>{var e;if(r&&a&&[ee.b.Default,ee.b.Open].includes(null==s?void 0:null===(e=s.info)||void 0===e?void 0:e.continuationState)&&_){let e=()=>{"hidden"===document.visibilityState&&r.isUserActive&&en(u,r)&&(0,ei.wU)({item_id:null==u?void 0:u.awemeId,item_type:null==u?void 0:u.awemeType,play_progress:Math.floor(r.currentTime),to_client:Number(ee.Yi.Phone),record_type:Number(ee.ns.auto)})},i=()=>{r.isUserActive&&en(u,r)&&(0,ei.wU)({item_id:null==u?void 0:u.awemeId,item_type:null==u?void 0:u.awemeType,play_progress:Math.floor(r.currentTime),to_client:Number(ee.Yi.Phone),record_type:Number(ee.ns.auto)})};return window.addEventListener("beforeunload",i),document.addEventListener("visibilitychange",e),()=>{window.removeEventListener("beforeunload",i),document.removeEventListener("visibilitychange",e)}}},[r,a,null==s?void 0:null===(t=s.info)||void 0===t?void 0:t.uid,_])};var er=t("482869");let ea=e=>{let{player:i,isNext:t,awemeInfo:n,abtestData:o}=e,r=(0,er.Y)({awemeInfo:n,abtestData:o});(0,l.useEffect)(()=>{i&&t&&!i.destroyed&&((0,k.tw)(null==i?void 0:i.playerId,!0),window.nextPlayer=i,i.isMultiple=1,r())},[i,t])};var eu=t("675001"),ed=t("171087");let es=e=>{let{player:i,awemeInfo:t,abtestData:n}=e,o=(0,eu.l)();(0,l.useEffect)(()=>{var e;let i=()=>{let e=null==t?void 0:t.isAds;if(window.TTCommon){var i,l;null===(i=(l=window.TTCommon).execute)||void 0===i||i.call(l,"applyConfig",e?'{"gpu_use_single_video_decoder_texture":1}':'{"gpu_use_single_video_decoder_texture":0}')}};return null==o||null===(e=o.on)||void 0===e||e.call(o,ed.V.PlayerBeforeCreate,i),()=>{var e;null==o||null===(e=o.off)||void 0===e||e.call(o,ed.V.PlayerBeforeCreate,i)}},[t,n])};var ev=t("860684");t("537958");let ec=e=>{let i=(0,ev.n)(),{isActive:t,awemeInfo:l,deleteCurrentSwiper:n,config:o,abtestData:a,scene:u,userInfo:d,isNext:s,currentIndex:v}=e;return r({player:i,isActive:t,awemeInfo:l}),T({player:i,isActive:t,awemeInfo:l,deleteCurrentSwiper:n,abtestData:a}),K({player:i,isActive:t,awemeInfo:l,config:o,abtestData:a,currentIndex:v}),G({player:i,isActive:t}),eo({player:i,isActive:t,awemeInfo:l,scene:u,userInfo:d}),ea({player:i,isNext:s,awemeInfo:l,abtestData:a}),es({player:i,awemeInfo:l,abtestData:a}),null}},784918:function(e,i,t){t.d(i,{h:function(){return D}});var l=t("520739");t("874386"),t("250440");var n=t("563097"),o=t("88648"),r=t("629582"),a=t("877639"),u=t.n(a),d=t("256277"),s=t("702726"),v=t("234048"),c=t("782442"),_=t("637005"),f=t("32167"),m=t("658065"),p=t("843054"),g=t("506467");t("897860");var h=t("1936"),y=t("713097"),w=t.n(y);function P(e){let{x:i=50,y:t=50}=e,l=(0,o.useRef)(parseInt(String(1e4*Math.random()%61-30))),r={left:i-35,top:t-34,transform:`rotate(${l.current}deg)`};return(0,n.jsx)("div",{style:r,className:h.default.containerBox,children:(0,n.jsx)("img",{src:"//p-pc-weboff.byteimg.com/tos-cn-i-9r5gewecjs/feed_money_like_icon.svg",className:w()(h.default.container,h.default.heartBeat)})})}let C=e=>{var i;return(null==e?void 0:null===(i=e.delegateTarget)||void 0===i?void 0:i.tagName)==="douyin-player-volume-slider"};var I=e=>{let{onClick:i,onLongPress:t,onDoubleClick:l,onCancelLongPress:n,longPressDelay:r=300,doubleTapDelay:a=300}=e,u=(0,o.useRef)(null),d=(0,o.useRef)(null),s=(0,o.useRef)(!1),v=(0,o.useRef)(!1),c=(0,o.useRef)(!1);return(0,o.useEffect)(()=>()=>{u.current&&(clearTimeout(u.current),u.current=null),d.current&&(clearTimeout(d.current),d.current=null)},[]),{onMouseDown:e=>{if(!(0!==e.button||C(e)))u.current&&(s.current=!0,clearTimeout(u.current),u.current=null),s.current&&l(e),v.current=!0,u.current=setTimeout(()=>{!s.current&&!v.current&&i(e),s.current=!1,clearTimeout(u.current),u.current=null},a),d.current=setTimeout(()=>{c.current=!0,t(e),clearTimeout(d.current),d.current=null},r)},onMouseUp:e=>{if(!(0!==e.button||C(e)))clearTimeout(d.current),d.current=null,v.current=!1,c.current&&(c.current=!1,n(e))},onMouseLeave:e=>{clearTimeout(u.current),clearTimeout(d.current),u.current=null,d.current=null,c.current&&n(e),v.current=!1,c.current=!1,s.current=!1}}},S=t("860684"),E=t("122788"),T=t("288386"),L=t("205457"),N=t("171087"),b=t("969911");let A=e=>{var i;let t=null===(i=e.root)||void 0===i?void 0:i.closest(".basePlayerContainer");return(null==t?void 0:t.querySelector(".focusPanel"))||null},x=e=>{let{isActive:i,awemeInfo:t,disableShortCut:a,abtestData:h}=e||{},y=(0,S.n)(),w=(0,o.useRef)(0),C=(0,o.useRef)(0),[E,L]=(0,o.useState)([]),{onMouseDown:x,onMouseLeave:D,onMouseUp:k}=I({onClick:e=>{var i,t;let l=A(y);if(e.target===(null==y?void 0:y.root)||e.target===(null==y?void 0:y.video)||e.target===(null==y?void 0:y.innerContainer)||e.target===(null==y?void 0:null===(i=y.video)||void 0===i?void 0:i.__canvas)||l){if(null==y?void 0:null===(t=y.openGeneralSearchModalSlide)||void 0===t?void 0:t.call(y,{from:"pause"})){y.emit(r.FP.USER_ACTION,{action:"click_video_area"});return}(null==y?void 0:y.paused)?(y.play(),y.emitUserAction(r.FP.USER_ACTION,"switch_play_pause",{action:"switch_play_pause",paused:!0,pluginName:"click"})):(y.pause(),y.emitUserAction(r.FP.USER_ACTION,"switch_play_pause",{action:"switch_play_pause",paused:!1,pluginName:"click"}))}},onLongPress:e=>{var i;let l=A(y);if(e.target===(null==y?void 0:y.root)||e.target===(null==y?void 0:y.video)||e.target===(null==y?void 0:y.innerContainer)||e.target===(null==y?void 0:null===(i=y.video)||void 0===i?void 0:i.__canvas)||l){if(c.Le.getConfig(c.gI.disableSpeed)&&!c.Le.getConfig(c.gI.IsMiniWin)){_.emit(_.EVENT.loginBlockKeyBoard,{speed:!0});return}!(0,d.Jt)(t)&&(c.Le.setConfig(c.gI.PlayRatioBeforeLongPress,y.playbackRate),y.emit(N.C.ChangePlayRate,{rate:2,notStorage:!0}),s.logInstance.sendLog("holdVideoSpeed",{group_id:null==t?void 0:t.awemeId,enter_from:(0,f.vM)(),enter_from_merge:(0,m.yW)()}))}},onCancelLongPress:()=>{if(!(0,d.Jt)(t)){let e=c.Le.getConfig(c.gI.PlayRatioBeforeLongPress);y.emit(N.C.ChangePlayRate,{rate:e||1}),c.Le.setConfig(c.gI.PlayRatioBeforeLongPress,0)}},onDoubleClick:e=>{var i;let t=A(y);(e.target===(null==y?void 0:y.root)||e.target===(null==y?void 0:y.video)||e.target===(null==y?void 0:y.innerContainer)||e.target===(null==y?void 0:null===(i=y.video)||void 0===i?void 0:i.__canvas)||t)&&y.emit(N.C.OnStar,{event:e,clickMethod:"mouse"})}});return(0,o.useEffect)(()=>{if(y&&i){var e,n;let i=A(y),o=u()(e=>{let i=0,t=0;if(e&&"keydown"===e.type){var l,n;i=(null==y?void 0:null===(l=y.root)||void 0===l?void 0:l.clientWidth)/2,t=(null==y?void 0:null===(n=y.root)||void 0===n?void 0:n.clientHeight)/2}else i=null==e?void 0:e.offsetX,t=null==e?void 0:e.offsetY;let o=Date.now();L(e=>(w.current++,[...e,{x:i,y:t,index:w.current,timeFlag:o}])),setTimeout(()=>{L(e=>e.filter(e=>e.timeFlag!==o))},1e3)},300),d=(0,p.e)((e,i)=>{var t;if("mouse"===i&&(null==y?void 0:null===(t=y.openGeneralSearchModalSlide)||void 0===t?void 0:t.call(y,{from:"pause"}))){y.emit(r.FP.USER_ACTION,{action:"click_video_area"});return}(null==y?void 0:y.paused)?(y.play(),y.emitUserAction(r.FP.USER_ACTION,"switch_play_pause",{action:"switch_play_pause",paused:!0,pluginName:"click"})):(y.pause(),y.emitUserAction(r.FP.USER_ACTION,"switch_play_pause",{action:"switch_play_pause",paused:!1,pluginName:"click"}))},(e,i)=>{y.emit(N.C.OnStar,{event:e,clickMethod:i})},300),s=e=>{(e.target===y.root||e.target===y.video||e.target===y.innerContainer||e.target===y.video.__canvas||i)&&d(e,"mouse")},_={[g.bf.Space.key]:{key:g.bf.Space.key,action:e=>{d(e,"space")},disable:a,noBodyTarget:!1}},f=e=>{var i,l;if(null==h?void 0:null===(i=h.changeCandle)||void 0===i?void 0:i.includes(null==t?void 0:t.awemeId))return;let{event:n,isKeyWorkCancalLike:r,clickMethod:a}=e,u=null===(l=c.Le.getConfig(c.gI.DiggStatusCache))||void 0===l?void 0:l[null==t?void 0:t.awemeId];if(!(Date.now()-((null==u?void 0:u.lastDiggTime)||0)>1e3&&(null==u?void 0:u.diggStatus)===v.gZ.Digged&&"hot_key"===a&&r&&Date.now()-C.current>500))C.current=Date.now(),o(n)};y.config.closeVideoClick=!0,i?i.addEventListener("click",s,!1):y.root.addEventListener("click",s,!1);let m={[g.bf.Space.key]:null==y?void 0:null===(n=y.plugins)||void 0===n?void 0:null===(e=n.keyboard)||void 0===e?void 0:e.keyCodeMap[g.bf.Space.key]},P=y.plugins.keyboard.keyCodeMap;return y.updatePluginConfig(b.p7.Keyboard,{keyCodeMap:(0,l._)({},P||{},_)}),y.on(N.C.OnStar,f),()=>{if(!y.destroyed){if(y.config.closeVideoClick=!1,i?i.removeEventListener("click",s,!1):y.root.removeEventListener("click",s,!1),y.plugins.keyboard){(0,T.v)({currentCodeMap:y.plugins.keyboard.keyCodeMap,additionalCodeMap:_});let e=y.plugins.keyboard.keyCodeMap;y.updatePluginConfig(b.p7.Keyboard,{keyCodeMap:(0,l._)({},e||{},m)})}y.off(N.C.OnStar,f)}}}},[y,i,t,null==h?void 0:h.changeCandle,!1]),(0,o.useEffect)(()=>{if(y)return y.config.closeVideoClick=!0,()=>{y.config.closeVideoClick=!1}},[y]),(0,n.jsx)(n.Fragment,{children:E.map(e=>(0,n.jsx)(P,{x:e.x,y:e.y},e.index))})},D=e=>{let i=(0,E.N)();return(0,n.jsx)(L.k,{componentName:"DoubleDiggPlugin",Slardar:i,children:(0,n.jsx)(x,(0,l._)({},e))})}},261985:function(e,i,t){t.d(i,{Z:function(){return e1}});var l=t("88648"),n=t("520739"),o=t("878389");t("250440");var r=t("35730"),a=t("782442"),u=t("637005"),d=t("399796"),s=t("555106"),v=t("921248");let c=e=>{var i,t,l,n,o,r,a,u,d,s,v,c,_,f,m,p,g,h,y,w,P,C,I,S,E,T;return{author_id:null==e?void 0:null===(i=e.authorInfo)||void 0===i?void 0:i.uid,group_id:null==e?void 0:e.awemeId,log_pb:null==e?void 0:e.logPb,compilation_id:null==e?void 0:null===(t=e.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==e?void 0:null===(l=e.seriesInfo)||void 0===l?void 0:l.seriesId,impressionData:null==e?void 0:e.impressionData,awemeId:null==e?void 0:e.awemeId,vduration:null==e?void 0:null===(n=e.video)||void 0===n?void 0:n.duration,qualityType:(null==e?void 0:null===(a=e.video)||void 0===a?void 0:null===(r=a.bitRateList)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.qualityType)||(null==e?void 0:null===(u=e.video)||void 0===u?void 0:u.qualityType),bitRate:(null==e?void 0:null===(v=e.video)||void 0===v?void 0:null===(s=v.bitRateList)||void 0===s?void 0:null===(d=s[0])||void 0===d?void 0:d.bitRate)||(null==e?void 0:null===(c=e.video)||void 0===c?void 0:c.bitRate),gearName:(null==e?void 0:null===(m=e.video)||void 0===m?void 0:null===(f=m.bitRateList)||void 0===f?void 0:null===(_=f[0])||void 0===_?void 0:_.gearName)||"",bitrate_set:null==e?void 0:null===(g=e.video)||void 0===g?void 0:null===(p=g.bitRateList)||void 0===p?void 0:p.map(e=>null==e?void 0:e.gearName),quality_bitrate:null==e?void 0:null===(y=e.video)||void 0===y?void 0:null===(h=y.bitRateList)||void 0===h?void 0:h.map(e=>`${null==e?void 0:e.qualityType}:${null==e?void 0:e.bitRate}`),aweme_type:null==e?void 0:e.awemeType,pic_cnt:null!==(T=null==e?void 0:null===(w=e.images)||void 0===w?void 0:w.length)&&void 0!==T?T:0,trending_topic:null==e?void 0:null===(P=e.hotList)||void 0===P?void 0:P.header,first_tag_name:null==e?void 0:null===(C=e.hotList)||void 0===C?void 0:C.sentence,top:null==e?void 0:null===(I=e.hotList)||void 0===I?void 0:I.rank,awemeRequestTime:null==e?void 0:e.requestTime,is_landscape:(null==e?void 0:null===(S=e.video)||void 0===S?void 0:S.width)>(null==e?void 0:null===(E=e.video)||void 0===E?void 0:E.height)?1:0}},_={videoPlay:["is_click_cover"],playTime:["is_click_cover"],videoPlayFinish:["is_click_cover"]};var f=t("79307"),m=t("746864"),p=t("885314"),g=t("913807");let h=e=>{u.emit(u.EVENT.syncInteractionStatus,{action:"lookVideo",awemeId:e.awemeId,fromUserId:e.authorInfo.secUid,extraAwemeInfo:{isFromSort:e.isFromSort}})},y=e=>{var i;let{awemeInfo:t}=e,l=a.Le.getConfig(a.gI.UnLookVideos);if(!!l)(null===(i=l[null==t?void 0:t.awemeId])||void 0===i?void 0:i.status)===f.Pl.UnLook&&(l[null==t?void 0:t.awemeId].status=f.Pl.Looked,h(t))};var w=t("629582"),P=t("32167"),C=t("150566"),I=t("734017"),S=t("544933");let E={byteBenchTask:{eventName:"bytebench_task",params:{task_group_id:0,sdk_version:0,result:"",extra_info:{}}},videoPlayQuality:{eventName:"video_play_quality",params:{group_id:"",previous_page:"",tab_name:"",bitrate_set:"",enter_from:"",codec_format:"",duration:0,cache_size:0,video_quality:"",video_format:"",video_bitrate:"",vduration:"",internet_speed:0,player_type:"xgplayer",player_version:"",internet_speed_dl:0,preload_time:0,preload_size:0,preload_type:1,cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",player_first_frame:0,current_low_decode_count:0,decoder_mode:0,h265_failure_rate:-1,play_order:0,general_search_duration:0}},prfVolumeChange:{eventName:"prf_volume_change",params:{down:0,enter_from:"",search_params:void 0,click_method:"click",is_mute:"0"}},videoBlock:{eventName:"video_block",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",codec_format:"",duration:0,cache_size:0,video_quality:"",video_format:"",video_bitrate:"",vduration:"",block_type:"",internet_speed_dl:0,internet_speed:0,player_type:"xgplayer",player_version:"",cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",play_order:0}},videoBlockCount:{eventName:"video_block_count",params:{enter_from:"",UA_info:"",block_count:0,differ_count:0}},videoPlayEnd:{eventName:"video_play_end",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",codec_format:"",duration:0,is_success:0,vduration:"",internet_speed:0,player_type:"xgplayer",player_version:"",video_quality:"",video_format:"",video_bitrate:"",internet_speed_dl:0,preload_time:0,preload_size:0,preload_type:1,cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",current_low_decode_count:0,decoder_mode:0,is_bytevc1:0,play_order:0,decode_fps:0,cdn_size_video:0,pcdn_size_video:0,play_size:0,loop_cnt:0,seek_cnt:0,seek_time:0,play_leave_position:0,play_duration_clean:0,fid:"",trace_id:"",uri:"",cache_duration:0,cache_size:0,data_player_type:2,is_cache_video:0}},videoPlayFailed:{eventName:"video_play_failed",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",cache_size:0,errorCode:0,errorDesc:"",is_cdn_expired:0,vduration:"",internet_speed:"",player_type:"xgplayer",player_version:"",internet_speed_dl:0,is_video_support:0,cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",h265_failure_rate:-1,play_order:0}},videoDegrade:{eventName:"video_degrade",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",cache_size:0,errorCode:0,errorDesc:"",is_cdn_expired:0,vduration:"",internet_speed:"",player_type:"xgplayer",player_version:"",internet_speed_dl:0,is_video_support:0,cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",h265_failure_rate:-1,play_order:0}},videoInit:{eventName:"video_init",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",video_quality:"",video_format:"",internet_speed:0,is_csr:1,compilation_id:"",cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",play_order:0,is_have_pcdn:0}},videoRequest:{eventName:"video_request",params:{group_id:"",previous_page:"",tab_name:"",enter_from:"",video_quality:"",video_format:"",internet_speed:0,is_csr:1,compilation_id:"",cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",play_order:0,is_have_pcdn:0}},videoRequestResponse:{eventName:"video_request_response",params:{group_id:"",enter_from:"",previous_page:"",tab_name:"",video_quality:"",video_format:"",vduration:"",duration:"",is_success:0,internet_speed:0,is_csr:1,compilation_id:"",internet_speed_dl:0,cpu_core:0,memory_size:0,UA_info:"",host:"",vtype:"",play_order:0}},videoPlay:{eventName:"video_play",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",enter_from_merge:"",previous_page:"",is_visible:"1",compilation_id:"",playlet_id:"",is_auto_play:"0",impression_data:"",video_detail_enter_from:"web_link",tab_name:"",speed:"1",auto_cnt:1,sidebar_status:"open",is_full_screen:"0",trending_topic:"",enter_method:"",from_follow_list:"0",is_mute:"0",mute_type:"",from_academy:0,is_small_window:"0",clarity:"",first_tag_name:"",top:0,video_time:0,from_push:0,is_from_ad:0,url_source:"",latest_group_id:"",expand_video_card_type:"",if_continued_play:"",rate:"",if_first_big_card:0,open_from_page:"",multi_window_order:"",if_new_open_dup:0}},videoPlayFinish:{eventName:"video_play_finish",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",enter_from_merge:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",mute_type:"",trending_topic:"",is_small_window:"0",first_tag_name:"",top:0,video_time:0,from_push:0,is_from_ad:0,url_source:"",if_first_big_card:0,open_from_page:"",multi_window_order:""}},playTime:{eventName:"play_time",params:{play_start_time:0,play_end_time:0,author_id:"",group_id:"",log_pb:"",enter_from:"",enter_from_merge:"",compilation_id:"",playlet_id:"",previous_page:"",is_auto_play:"0",is_visible:"1",duration:0,from_percent:0,to_percent:0,video_detail_enter_from:"web_link",tab_name:"",speed:"",sidebar_status:"open",is_full_screen:"0",trending_topic:"",enter_method:"",from_follow_list:"0",is_mute:"0",mute_type:"",is_small_window:"0",clarity:"",first_tag_name:"",top:0,video_time:0,from_push:0,is_insert_wallpaper:0,is_from_ad:0,latest_group_id:"",url_source:"",if_continued_play:"",rate:"",if_first_big_card:0}},videoPlayCheckPoint:{eventName:"video_play_check_point",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",enter_from_merge:"",previous_page:"",compilation_id:"",order:0,tab_name:"",trending_topic:"",first_tag_name:"",top:0}},clickPreviousVideo:{eventName:"click_previous_video",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",tab_name:"",click_from:"",is_small_window:"0",trending_topic:"",first_tag_name:"",top:0}},clickNextVideo:{eventName:"click_next_video",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",click_from:"",tab_name:"",is_small_window:"0",trending_topic:"",first_tag_name:"",top:0}},clickAutoPlay:{eventName:"click_auto_play",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",status:""}},clickVideoSpeed:{eventName:"click_video_speed",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",speed:"",item_duration_ms:0,is_small_window:"",player_display_mode:""}},enterFullScreen:{eventName:"enter_full_screen",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",is_small_window:"",click_from:"",item_duration_ms:0,player_display_mode:""}},exitFullScreen:{eventName:"exit_full_screen",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",is_small_window:"",click_from:"",player_display_mode:""}},clickScreenMode:{eventName:"click_screen_mode",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",status:""}},clickVolume:{eventName:"click_volume",params:{enter_from:"",mute_remind:"none",status:"0",player_display_mode:"",group_id:""}},pauseVideo:{eventName:"pause_video",params:{enter_from:"",mute_remind:"none",click_method:"click",is_small_window:"0",player_display_mode:"",group_id:""}},startVideo:{eventName:"start_video",params:{enter_from:"",mute_remind:"none",click_method:"click",player_display_mode:"",group_id:""}},openPureMode:{eventName:"open_pure_mode",params:{enter_from:"",enter_method:"",enter_from_merge:"",group_id:"",is_full_screen:"0",is_full_webscreen:"0",item_duration_ms:0,player_display_mode:""}},closePureMode:{eventName:"close_pure_mode",params:{enter_from:"",enter_method:"",group_id:"",player_display_mode:""}},progressClick:{eventName:"progress_click",params:{position:0,enter_from:"",enter_from_merge:"",tab_name:"",group_id:"",play_current_time:0,click_method:"hot_key",rate:-1,action:"",is_small_window:"0",chapter_index:0,is_chapter_bar:0,before_rate:0,if_continued_play:"",player_display_mode:""}},prfFirstFeedShow:{eventName:"prf_first_feed_show",params:{feed_total_duration:0,menu_total_duration:0,landing_page:"",is_landscape:0,group_id:"",vduration:0,if_invisible:"0",is_small_window:"0",small_window_scene:"",real_index:0,is_cache_video:0,aweme_type:m.e.Normal,is_quick_player:0}},pcColdStartPrfRecord:{eventName:"pc_cold_start_prf_record",params:{feed_total_duration:0,menu_total_duration:0,landing_page:"",is_landscape:0,group_id:"",vduration:0,if_invisible:"0",is_small_window:"0",real_index:0,is_cache_video:0,aweme_type:m.e.Normal}},prfFirstFeedFirstFrameShow:{eventName:"prf_first_feed_first_frame_show",params:{feed_total_duration:0,landing_page:"",is_landscape:0,group_id:"",real_index:0,is_cache_video:0,aweme_type:m.e.Normal,is_quick_player:0}},prfFirstFeedCoverShow:{eventName:"prf_first_feed_cover_show",params:{landing_page:"",duration:0,duration_from_rs:0,duration_from_re:0,duration_from_hs:0,duration_from_bs:0,duration_from_ae:0,duration_from_ar:0,duration_from_ps:0}},videoTransform:{eventName:"video_transform",params:{x:0,y:0,width:0,height:0,top:0,left:0,right:0,bottom:0}},prfTaskDataSize:{eventName:"prf_task_data_size",params:{user_unique_id:"",group_id:"",task_type:1,cdn_size:0,pcdn_size:0,cdn_speed:0,pcdn_speed:0,load_dur:0,buffer_dur:0,force_set_min:0,trace_id:"",vduration:0,enter_from:""}},linkPlayFailed:{eventName:"link_play_failed",params:{user_unique_id:"",group_id:"",is_pcdn:0,host:"",aweme_type:0,enter_from:""}},prfLastPreloadDataSize:{eventName:"prf_last_preload_data_size",params:{enter_from:"",group_id:"",preload_size:0,preload_size_cdn:0,preload_size_pcdn:0,preload_time:0,video_bitrate:0,video_quality:"",data_player_type:0,type:0,duration:0,vtype:""}},fpsStuck:{eventName:"fps_stuck",params:{enter_from:"",group_id:""}},srDegrade:{eventName:"sr_degrade",params:{code:"",enter_from:"",group_id:"",vtype:"",quality_type:"",gear_name:"",definition:"",is_bytevc1:0,current_time:""}},videoEditListOffsetTime:{eventName:"video_edit_list_offset_time",params:{duration:0,fix_edit_list_offset:0}},videoPreloadInfo:{eventName:"video_preload_info",params:{buffer:"",currentTime:0,minBufferLength:0,pid:"",startPreloadControl:!1,startPreloadMinBuffer:0,startPreloadMinPosTime:0,vid:""}},videoPreloadCancelInfo:{eventName:"video_preload_cancel_info",params:{buffer:"",currentTime:0,minBufferLength:0,pid:"",startPreloadControl:!1,startPreloadMinBuffer:0,startPreloadMinPosTime:0,vid:""}},hover_speed_cell:{eventName:"hover_speed_cell",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_enter_full_webscreen:{eventName:"hover_enter_full_webscreen",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_exit_full_screen:{eventName:"hover_exit_full_screen",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_pure_mode:{eventName:"hover_pure_mode",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_volume:{eventName:"hover_volume",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_clarity_cell:{eventName:"hover_clarity_cell",params:{enter_from:"",group_id:"",player_display_mode:""}},hover_auto_play_mode:{eventName:"hover_auto_play_mode",params:{enter_from:""}},hover_progress:{eventName:"hover_progress",params:{enter_from:"",player_display_mode:"",group_id:""}},hover_watch_later_add:{eventName:"hover_watch_later_add",params:{enter_from:""}}};var T=new S.h(E),L=t("256277"),N=t("367366"),b=t("726406"),A=t("362501"),x=t("301699"),D=t("276152");let k=e=>{var i,t;let{player:l,qualityType:n}=e;return null!==(t=null==l?void 0:null===(i=l.curDefinition)||void 0===i?void 0:i.qualityType)&&void 0!==t?t:n};var R=t("378844"),M=t("804487"),F=()=>{var e,i,t;return{gpu_vendor:null===(e=(0,M.$)())||void 0===e?void 0:e.vendor,gpu_score:null===(i=(0,M.$)())||void 0===i?void 0:i.score,gpu_info:null===(t=(0,M.$)())||void 0===t?void 0:t.info}},j=t("383212"),O=t("226355"),U=t("616519"),V=t("851563"),H=t("140230"),B=t("631493");let K=e=>{let{getLogInfo:i,clickFrom:t}=e,{author_id:l,group_id:r,log_pb:a,extraParams:u,trending_topic:d,first_tag_name:s,top:v}=i();return(0,o._)((0,n._)({urlParamList:["previous_page"],author_id:l,group_id:r,log_pb:a,enter_from:(0,P.mo)(),click_from:t,tab_name:(0,I.zD)()||(0,C.Rs)("tab_name")||"",trending_topic:d,first_tag_name:s,top:v},u),{is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:""})};var q=t("658065"),G=t("171087");let Y=e=>{let{getLogInfo:i,isAutoPlay:t,customParams:l}=e,{author_id:r,group_id:a,log_pb:u,extraParams:d}=i();return(0,o._)((0,n._)({urlParamList:["previous_page"],author_id:r,group_id:a,log_pb:u,enter_from:(0,q.yW)(),status:t?"on":"off"},d,l),{is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",player_display_mode:(0,P.Ok)()})};t("209955");var W=t("325982"),Q=t("945977");let z={click:"click_button",dblclick:"double_click"},Z=e=>{let{getLogInfo:i,clickFrom:t}=e,{author_id:l,group_id:o,log_pb:r,extraParams:a}=i();return(0,n._)({urlParamList:["previous_page"],author_id:l,group_id:o,log_pb:r,enter_from:(0,q.yW)(),click_from:t,is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",player_display_mode:(0,P.Ok)()},a)};t("777180");var $=t("144565"),J=t("914815");t("338172");var X=t("850063"),ee=t("782563"),ei=t("172660"),et=t("44905"),el=t("969911");let en={playbacksettingplugin:"hover_speed_cell",[el.p7.PlayBackSettingPlugin]:"hover_speed_cell",immersiveswitchsettingplugin:"hover_pure_mode",[el.p7.ImmersiveSwitchSettingPlugin]:"hover_pure_mode",[el.p7.Volume]:"hover_volume",playclaritysettingplugin:"hover_clarity_cell",[el.p7.PlayClaritySettingPlugin]:"hover_clarity_cell",innerautoplayplugin:"hover_auto_play_mode",[el.p7.InnerAutoPlayPlugin]:"hover_auto_play_mode",watchlaterplugin:"hover_watch_later_add",[el.p7.WatchLaterPlugin]:"hover_watch_later_add"};var eo=t("352165");let er=(e,i)=>!e||1===i&&e.currentTime>=e.duration?0:i,ea=e=>{if(!e)return 0;try{var i,t,l;let n=((null==e?void 0:null===(t=e.plugins)||void 0===t?void 0:null===(i=t.VodLoggerPlugin)||void 0===i?void 0:i.cumulateTime)||0)/1e3,o=(null==e?void 0:null===(l=e.curDefinition)||void 0===l?void 0:l.realBitrate)||0;return(0,eo.e)(n*o)}catch(e){return 0}},eu=(e,i)=>{var t,l,n,o;let r=(null==e?void 0:null===(t=e.buffered)||void 0===t?void 0:t.length)||0,a=null!==(l=e.removedBuffer)&&void 0!==l?l:0;if(!e||!e.buffered||r<=0)return Math.min(a,i);try{let t=0,{buffered:l}=e||{};for(let e=0;e<(null==l?void 0:l.length);e++)t+=(null==l?void 0:null===(n=l.end)||void 0===n?void 0:n.call(l,e))-(null==l?void 0:null===(o=l.start)||void 0===o?void 0:o.call(l,e));return Math.min(t+a,i)}catch(e){return Math.min(a,i)}},ed=e=>{let i=null==e?void 0:e.getBufferedRange();return i&&i[1]?Math.round((i[1]-e.currentTime)*1e3):0},es=e=>{var i,t;let l;switch((null==e?void 0:null===(t=e.config)||void 0===t?void 0:null===(i=t.shared)||void 0===i?void 0:i.vtype)||""){case"MP4":l=1;break;case"MP4_0":case"MP4_1":l=3;break;default:l=0}return l},ev=e=>{let i={preloadTime:0,preloadSize:0,startBuffer:0,audioDuration:0,minDuration:0};if(!e)return i;try{var t;let{duration:l,byteLength:n,audioDuration:o=0}=null!==(t=null==e?void 0:e.preloadData)&&void 0!==t?t:{};return i.preloadSize=n,i.preloadTime=l,i.audioDuration=1e3*o,i.minDuration=Math.min(l,1e3*o)||0,i}catch(e){return{preloadSize:0,preloadTime:0,startBuffer:0,audioDuration:0,minDuration:0}}},ec=e=>{let i={};if("string"==typeof e)try{i=JSON.parse(e)}catch(e){i={}}return i},e_=e=>{let i={};try{var t,l,n,o,r;if(!(0,ee.DT)()||!(null==e?void 0:e.video)||(null==e?void 0:null===(t=e.video)||void 0===t?void 0:t.nodeType)!==1)return{};let a=null==e?void 0:null===(n=e.video)||void 0===n?void 0:null===(l=n.querySelectorAll)||void 0===l?void 0:l.call(n,"source");for(let e=0;e<(null==a?void 0:a.length);e++){let t=a[e];if(null==t?void 0:null===(o=t.execute)||void 0===o?void 0:o.call(t,"isActive","")){let e=null==t?void 0:null===(r=t.execute)||void 0===r?void 0:r.call(t,"getMediaInfo","");i=ec(e);break}}}catch(e){i={}}return i},ef=e=>{var i;let t=null===(i=e_(e))||void 0===i?void 0:i.video_platform_decoder;return void 0===t?-1:t};t("268917");let em=r.LocalStorageKeys.FrameInfoList,ep=e=>{var i,t,l,n,o,r,a,u,d,v;let c=null!==(v=(0,s.$o)(em))&&void 0!==v?v:[],_=c.filter(e=>0===e.isH265),f=c.filter(e=>1===e.isH265);if(_.length>=5&&(null==e?void 0:null===(i=e.curDefinition)||void 0===i?void 0:i.isH265)===0||f.length>=5&&(null==e?void 0:null===(t=e.curDefinition)||void 0===t?void 0:t.isH265)===1)return;let m={isH265:null==e?void 0:null===(l=e.curDefinition)||void 0===l?void 0:l.isH265,total:null==e?void 0:null===(r=e.plugins)||void 0===r?void 0:null===(o=r.VodLoggerPlugin)||void 0===o?void 0:null===(n=o.videoFrameInfo)||void 0===n?void 0:n.total,rate:null==e?void 0:null===(d=e.plugins)||void 0===d?void 0:null===(u=d.VodLoggerPlugin)||void 0===u?void 0:null===(a=u.videoFrameInfo)||void 0===a?void 0:a.droppedRate};c.push(m),(0,s.qQ)(em,c)},eg=e=>{var i,t,l,n,o,r;let{player:a,awemeInfo:u}=e,d=null!==(n=null==a?void 0:null===(l=a.config)||void 0===l?void 0:null===(t=l.baseConfig)||void 0===t?void 0:null===(i=t.mediaInfo)||void 0===i?void 0:i.volumebalance)&&void 0!==n?n:{},s={};try{s=JSON.parse((null==u?void 0:null===(r=u.video)||void 0===r?void 0:null===(o=r.meta)||void 0===o?void 0:o.volume_info)||"{}")}catch(e){}return{loudness_range_end:null==s?void 0:s.LoudnessRangeEnd,loudness_range_start:null==s?void 0:s.LoudnessRangeStart,loudness_range:null==s?void 0:s.LoudnessRange,maximum_momentary_loudness:null==s?void 0:s.MaximumMomentaryLoudness,maximum_short_term_loudness:null==s?void 0:s.MaximumShortTermLoudness,peak:null==s?void 0:s.Peak,source_lufs:null==d?void 0:d.source_lufs,target_lufs:null==d?void 0:d.target_lufs}};var eh=t("653208");let ey=e=>{var i,t;return(null==e?void 0:null===(i=e.video)||void 0===i?void 0:i.seeking)?"seeking":(null==e?void 0:null===(t=e.video)||void 0===t?void 0:t.ended)?"end":"playing"},ew=(e,i)=>{var t,l,o,r,a;let{group_id:u,vduration:d,bitRate:s,qualityType:v,extraParams:c,bitrate_set:_,quality_bitrate:f,action_type:m,aweme_type:p,video_play_mode:g,is_landscape:h,bitrate_set_client:y}=i,{bitrate:w}=(null==e?void 0:e.curDefinition)||{},P=(null==e?void 0:null===(t=e._core)||void 0===t?void 0:t.startTimelines)||{};return(0,n._)({group_id:u,vduration:d,bitrate_set:_,quality_bitrate:f,video_play_mode:g,is_landscape:h,aweme_type:p,action_type:"click"===m?"click":"up"===m?"down":"up",video_quality:k({player:e,qualityType:v}),video_bitrate:w||s,audio_bitrate:(null===(o=e.curDefinition)||void 0===o?void 0:null===(l=o.audioDefinition)||void 0===l?void 0:l.bitrate)||0,real_bitrate:(null===(r=e.curDefinition)||void 0===r?void 0:r.realBitrate)||0,feature_id:null===(a=e.curDefinition)||void 0===a?void 0:a.featureId,bitrate_set_client:y},c,P)},eP=e=>{let i=a.Le.getConfig(a.gI.PagingType),t=a.Le.getConfig(a.gI.FastSlowSlide);return{paging_type:e?null==i?void 0:i.current:null==i?void 0:i.pre,slide_speed:t}},eC=(e,i)=>{var t,l,n,o,r,u,d,s,v,c,_,f,m,p,g,h,y,w;let{currentLowDecodeCount:P=0,decoderMode:C=0,lowdecodeVV:I=0,vv:S=0,fps:E=0,currentState:T=0}=(null===(l=e.video)||void 0===l?void 0:null===(t=l.getStats)||void 0===t?void 0:t.call(l))||{},b=null==e?void 0:null===(o=e.plugins)||void 0===o?void 0:null===(n=o.VodLoggerPlugin)||void 0===n?void 0:n.videoFrameInfo,A=null==b?void 0:b.dropped,x=null==b?void 0:b.droppedRate;try{if(null==e?void 0:null===(p=e.plugins)||void 0===p?void 0:null===(m=p.srplugin)||void 0===m?void 0:null===(f=m.getStat())||void 0===f?void 0:f.usingSR){let{totalFrames:i,droppedRate:t}=(null==e?void 0:null===(h=e.plugins)||void 0===h?void 0:null===(g=h.srplugin)||void 0===g?void 0:g.getStat())||{};x=t,A=Math.floor(i*t)}}catch(e){}return{duration:null!==(y=null==e?void 0:null===(u=e.plugins)||void 0===u?void 0:null===(r=u.VodLoggerPlugin)||void 0===r?void 0:r.cumulateTime)&&void 0!==y?y:0,player_version:e.version,video_fps:null==e?void 0:null===(d=e.curDefinition)||void 0===d?void 0:d.fps,drop_frame:null==b?void 0:b.dropped,drop_frame_sr:A,total_play_frame:null==b?void 0:b.total,drop_frame_rate_sr:x,drop_frame_rate:null==b?void 0:b.droppedRate,drop_frame_duration:null==b?void 0:b.droppedDuration,end_status:ey(e),is_bytevc1:null==e?void 0:null===(s=e.curDefinition)||void 0===s?void 0:s.isH265,is_player_v2:1,video_core:null==e?void 0:null===(v=e.baseConfig)||void 0===v?void 0:v.coreType,current_low_decode_count:P,decoder_mode:C,h265_failure_rate:10===S?I/S:-1,decode_fps:null!==(w=null===(c=e.video)||void 0===c?void 0:c.decodeFps)&&void 0!==w?w:0,is_265_degrade_client:(0,eh.ad)({player:e}),is_265_degrade_web:(0,eh.OS)({player:e}),frame_rate:E,current_state:T,is_ad:(0,L.Jt)(i)?1:0,is_compilation:(null==i?void 0:null===(_=i.mixInfo)||void 0===_?void 0:_.mixId)?1:0,is_full_screen:(0,N.r)(),is_show_comment:a.Le.getConfig(a.gI.IsCommetTab)?1:0,is_visible:"visible"===document.visibilityState?1:0}};var eI=t("820303"),eS=t("122391"),eE=t("349998"),eT=t("488656"),eL=t("816299");t("179133"),t("826893");var eN=t("128231"),eb=t.n(eN),eA=t("567754"),ex=t("870105"),eD=t("136808"),ek=t("891655"),eR=t("79982"),eM=t("330746"),eF=t("272978"),ej=t("353994"),eO=t("30321"),eU=t("363706"),eV=t("831202"),eH=t("474160");let eB=(e,i,t)=>{try{var l,n,o,r;if(!t||!e)return;let{list:d="",store:s}=null!==(n=a.Le.getConfig(a.gI.WatchLater))&&void 0!==n?n:{};if(!(t.watchLaterInfo||d.includes(t.awemeId)))return;let v=Math.floor((null!==(o=null==e?void 0:e.currentTime)&&void 0!==o?o:0)*1e3),c=null!==(r=null==t?void 0:null===(l=t.playProgress)||void 0===l?void 0:l.watch_times)&&void 0!==r?r:0,_=i||(null==e?void 0:e.ended),f=c||_?Math.max(c,1):0;if((0,eH.ih)({actionType:2,itemToPlayinfo:{[t.awemeId]:{play_duration:Math.floor((null==e?void 0:e.currentTime)*1e3),loop_status:f}}}),!s||"object"!=typeof s)return;s[t.awemeId]={progress:v,loop:f},u.emit(u.EVENT.WatchLaterProgressChange)}catch(e){eV.oe.event.info({name:eV.Mo.PlayTimeBack,report:{code:null==e?void 0:e.code,message:null==e?void 0:e.message}})}};var eK=t("972438"),eq=t("391779"),eG=t("157526"),eY=t("55426");t("981168");let eW={1:{width:1920,height:1080},2:{width:1280,height:720},3:{width:1024,height:576},4:{width:1024,height:576}},eQ=e=>{var i,t,l,n,o,r,u;if(null===(i=a.Le.getConfig(a.gI.AbtestData))||void 0===i?void 0:i.longtask)return -1;let d={definition:0},s=null==e?void 0:e.video,v=null==s?void 0:s.getBoundingClientRect();a.Le.setConfig(a.gI.videoRect,v);let c=(null==s?void 0:s.videoWidth)/(null==s?void 0:s.videoHeight),_=null==e?void 0:null===(n=e.config)||void 0===n?void 0:null===(l=n.definition)||void 0===l?void 0:null===(t=l.list)||void 0===t?void 0:t.sort((e,i)=>(null==i?void 0:i.definition)-(null==e?void 0:e.definition));if(_&&c>1)for(let e=0;e<_.length;e++){let i=null!==(r=_[e].definition)&&void 0!==r?r:1,t=eW[i];if(!((null==v?void 0:v.width)>(null==t?void 0:t.width))||!((null==v?void 0:v.height)>(null==t?void 0:t.height))){d.definition=i;break}}if(_&&c<1)for(let e=0;e<_.length;e++){let i=null!==(u=_[e].definition)&&void 0!==u?u:1,t=eW[i];if(!((null==v?void 0:v.width)>(null==t?void 0:t.height))||!((null==v?void 0:v.height)>(null==t?void 0:t.width))){d.definition=i;break}}return(null==e?void 0:null===(o=e.curDefinition)||void 0===o?void 0:o.definition)<d.definition?1:0},ez=()=>{let e=a.Le.getConfig(a.gI.ModalStartOpenTime);return e?(a.Le.setConfig(a.gI.ModalStartOpenTime,0),Date.now()-e):-1};var eZ=t("137425"),e$=t("392323"),eJ=t("271994"),eX=t("824711"),e0=t("860684");let e1=e=>{let{awemeInfo:i,isActive:t,isNext:S,isPrev:E,logParams:M,userInfo:ec,isFirst:e_,index:em}=e||{},ey=(0,e0.n)(),{getActionType:eN,getIsChangingVideoSrc:eH}=function(e){let{awemeInfo:i}=e,{isNext:t,isPrev:n,isActive:o}=e,r=(0,l.useRef)(null),a=(0,l.useRef)("click"),u=(0,l.useRef)(!1),d=(0,l.useRef)();t?a.current="down":n&&(a.current="up"),r.current&&(null==i?void 0:i.awemeId)&&(null==i?void 0:i.awemeId)!==r.current&&(o&&d.current?(u.current=!0,a.current="click"):u.current=!1),d.current=o,r.current=null==i?void 0:i.awemeId;let s=(0,l.useCallback)(()=>a.current,[]);return{getActionType:s,getIsChangingVideoSrc:(0,l.useCallback)(()=>u.current,[])}}({awemeInfo:i,isNext:S,isPrev:E,isActive:t}),{getLogInfo:eW}=function(e){let{awemeInfo:i,player:t,isActive:_}=e,{isFirst:f,specialParams:m,logParams:p}=e,{getActionType:g}=e,{inImmersive:h}=(0,v.O)({player:t,isActive:_});(0,l.useEffect)(()=>{if(!t||!_)return;let e=e=>{let i=(null==e?void 0:e.from)||(null==e?void 0:e.clickFrom),t="auto";["click_button","scroll"].includes(i)?t="manual":"auto"===i&&(t="auto_play_open"),a.Le.setConfig(a.gI.VideoPlayMethod,t)},i=u.listen(u.EVENT.reportPlayNext,e),l=u.listen(u.EVENT.reportPlayPrev,e);return()=>{l(),i()}},[t,i,_]);let y=(0,l.useRef)(null);return y.current=(0,l.useMemo)(()=>{var e,l,u,v,_,y,w,P,C,I;let S=(0,o._)((0,n._)({item_duration_ms:(null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)||0},p),{log_pb:null==i?void 0:i.logPb});Object.keys(m).forEach(e=>{m[e].forEach(e=>{delete S[e]})});let E={is_click_cover:f?1:0,action_type:g(),is_pure:h?"1":"0",extraParams:S,video_play_mode:(null===(l=d.Q.getItem({sKey:r.CookieKeys.VideoFilterMemoSelect,refresh:!1}))||void 0===l?void 0:l.type)===1?"landscape":"all",is_insert_wallpaper:(null===(u=a.Le.getConfig(a.gI.WallPaperIds))||void 0===u?void 0:u.includes(null==i?void 0:i.awemeId))?1:0,latest_group_id:null===(v=a.Le.getConfig(a.gI.FeedLatestViewedAweme))||void 0===v?void 0:v.awemeId,if_first_big_card:(null==p?void 0:p.if_first_big_card)||0},T=(0,s.$o)(r.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY),L=(0,s.$o)(r.LocalStorageKeys.SearchHorizontalAutoPlay);return(0,o._)((0,n._)({},c(i),E),{isFromNextAutoPlay:(null===(y=location)||void 0===y?void 0:null===(_=y.href)||void 0===_?void 0:_.includes("search"))?L:T,bitrate_set_client:null==t?void 0:null===(I=t.config)||void 0===I?void 0:null===(C=I.shared)||void 0===C?void 0:null===(P=C.definition)||void 0===P?void 0:null===(w=P.list)||void 0===w?void 0:w.map(e=>null==e?void 0:e.gearName)})},[i,p,f,h,t,g]),{getLogInfo:(0,l.useCallback)(()=>y.current,[])}}({awemeInfo:i,player:ey,specialParams:_,logParams:M,isFirst:e_,isActive:t,getActionType:eN}),{getSpecialParams:e1}=function(e){let{getLogInfo:i}=e,t=i(),n=(0,l.useRef)(null);return n.current=(0,l.useMemo)(()=>{let e={};return Object.keys(_).forEach(i=>{let l={};_[i].forEach(e=>{l[e]=t[e]}),e[i]=l}),e},[t]),{getSpecialParams:(0,l.useCallback)(()=>n.current,[])}}({getLogInfo:eW});return!function(e){let{player:i}=e;(0,l.useEffect)(()=>{if(!i)return;let e=()=>{i.emit("focus")};return!i.paused&&e(),i.on("autoplay_started",e),()=>{i.off("autoplay_started",e)}},[i]),(0,l.useEffect)(()=>{if(!i)return;let e=()=>{u.emit(u.EVENT.videoPlay)},t=()=>{u.emit(u.EVENT.videoPlayPrevent)};return!i.paused&&(e(),t()),i.on("autoplay_was_prevented",t),i.on("autoplay_started",e),()=>{i.off("autoplay_was_prevented",t),i.off("autoplay_started",e)}},[i])}({player:ey}),!function(e){let{player:i,awemeInfo:t,userInfo:n,isActive:o}=e,r=(0,l.useRef)(!1),u=(0,l.useRef)({});(0,l.useEffect)(()=>{if(t&&o)return()=>{let{awemeId:e,progress:i}=u.current;a.Le.setConfig(a.gI.PreAwemeSeenStatus,{id:e,seen:i>=95?1:0})}},[o,t]),(0,l.useEffect)(()=>{r.current=!1},[t.awemeId]),(0,l.useEffect)(()=>{if(i){let e=()=>{i.isCanplay=!0};return i.on(w.FP.CANPLAY,e),()=>{i.off(w.FP.CANPLAY,e)}}},[t.awemeId,i]),(0,l.useEffect)(()=>{if(!i||!t)return;let e=()=>{var e,i,l;if(!r.current){if(r.current=!0,(null==n?void 0:n.isLogin)&&(null==t?void 0:t.awemeId)){let{id:e,seen:i}=a.Le.getConfig(a.gI.PreAwemeSeenStatus)||{};(0,p.w6)({awemeId:null==t?void 0:t.awemeId,authorId:null==t?void 0:null===(l=t.authorInfo)||void 0===l?void 0:l.uid,preItemId:e,preItemSeen:i})}h(t),(null===(i=a.Le.getConfig(a.gI.UnLookVideos))||void 0===i?void 0:null===(e=i[null==t?void 0:t.awemeId])||void 0===e?void 0:e.status)===f.Pl.UnLook&&((0,g.fetchHomeImpression)({awemeIds:t.awemeId}),y({awemeInfo:t}))}},l=e=>{let i=0;(null==t?void 0:t.awemeType)===m.e.Note||(i=(null==e?void 0:e.currentTime)/(null==e?void 0:e.duration)*100);let l=null==t?void 0:t.awemeId,{awemeId:n,progress:o}=u.current;if(l!==n||!(i<o))u.current={awemeId:l,progress:i}};return i.on("timeupdate",l),i.once("timeupdate",e),()=>{i.off("timeupdate",l),i.off("timeupdate",e)}},[i,t,n,o])}({player:ey,awemeInfo:i,userInfo:ec,isActive:t}),!function(e){let{awemeInfo:i,player:t,isActive:v,isNext:c,index:_}=e,{getIsChangingVideoSrc:m,getLogInfo:p,getSpecialParams:h}=e;!function(e){let{player:i,awemeInfo:t}=e,{getLogInfo:o}=e;(0,l.useEffect)(()=>{if(!i)return;let e=!1,t=()=>{e=!0},l=()=>{e=!1},r=1,a=setInterval(()=>{if(!e)return;let{author_id:i,group_id:t,log_pb:l,compilation_id:a,extraParams:u,trending_topic:d,first_tag_name:s,top:v}=o();T.sendLog("videoPlayCheckPoint",(0,n._)({urlParamList:["previous_page"],author_id:i,group_id:t,log_pb:l,enter_from:(0,P.mo)(),compilation_id:a,order:r++,tab_name:(0,I.zD)()||(0,C.Rs)("tab_name")||"",trending_topic:d,first_tag_name:s,top:v},u))},6e4);return!i.paused&&t(),i.on(w.FP.AUTOPLAY_STARTED,t),i.on(w.FP.PLAY,t),i.on(w.FP.PAUSE,l),()=>{a&&clearInterval(a),i.off(w.FP.AUTOPLAY_STARTED,t),i.off(w.FP.PLAY,t),i.off(w.FP.PAUSE,l)}},[i,t,o])}({awemeInfo:i,player:t,getLogInfo:p}),!function(e){let{awemeInfo:i,player:t,isActive:r}=e,{getLogInfo:u}=e,d=(0,l.useRef)(null),s=(0,l.useRef)(null),{contextEvent:v}=(0,l.useContext)(U.E);(0,l.useEffect)(()=>{var e,l;let c;(d.current&&(null===(e=d.current)||void 0===e?void 0:e.awemeId)!==(null==i?void 0:i.awemeId)||!r||!i)&&(d.current=null,s.current=null);let _=t,f=()=>{d.current&&!d.current.isReport&&(d.current.isReport=!0,!function(e){var i,t,l,r,u,d,s,v,c,_,f,m,p;let{group_id:g,compilation_id:h="",is_csr:y=1,extraParams:w={},host:P,vtype:C,player:I,awemeInfo:S,logInfo:E,fetchExpired:M}=e,{aweme_type:U,video_play_mode:V,is_landscape:H,action_type:B}=E,K=(null==S?void 0:null===(l=S.video)||void 0===l?void 0:null===(t=l.bitRateList)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.qualityType)||(null==S?void 0:null===(r=S.video)||void 0===r?void 0:r.qualityType);(0,j.v)();let q=(0,j.G)(),G=(0,o._)((0,n._)({urlParamList:["previous_page","tab_name"],group_id:g,compilation_id:h,is_csr:y,host:P,vtype:C,aweme_type:U,action_type:B,is_ad:(0,L.Jt)(S)?1:0,is_compilation:(null==S?void 0:null===(u=S.mixInfo)||void 0===u?void 0:u.mixId)?1:0,is_full_screen:(0,N.r)(),is_show_comment:a.Le.getConfig(a.gI.IsCommetTab)?1:0,video_format:null==I?void 0:I.playerType,video_play_mode:V,is_landscape:H,is_player_v2:1,is_bytevc1:null==I?void 0:null===(d=I.curDefinition)||void 0===d?void 0:d.isH265,play_order:q,v_like_cnt:null==S?void 0:null===(s=S.stats)||void 0===s?void 0:s.diggCount,v_share_cnt:null==S?void 0:null===(v=S.stats)||void 0===v?void 0:v.shareCount,v_comment_cnt:null==S?void 0:null===(c=S.stats)||void 0===c?void 0:c.commentCount,v_download_cnt:null==S?void 0:null===(_=S.stats)||void 0===_?void 0:_.downloadCount,v_forward_cnt:null==S?void 0:null===(f=S.stats)||void 0===f?void 0:f.forwardCount,vduration:null==S?void 0:null===(m=S.video)||void 0===m?void 0:m.duration,is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,player_version:null==I?void 0:I.version,feature_id:null==I?void 0:null===(p=I.curDefinition)||void 0===p?void 0:p.featureId,video_quality:k({player:I,qualityType:K}),if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:""},(0,R.Z)(I),F(),w),{fetch_expired:M});(0,x.Vw)(D.H.video_request,(0,o._)((0,n._)({},G),{aweme_info:S})),T.sendLog("videoRequest",G)}(d.current.data))},m=()=>{_&&(_.loadstart=1),r&&f()},p=()=>{if(s.current&&!s.current.isReport){var e,i;!function(e){var i,t,l;let{group_id:o,compilation_id:r="",vduration:a,duration:u,is_csr:d=1,is_success:s,videoQuality:v="",extraParams:c={},host:_,vtype:f,player:m,awemeInfo:p,logInfo:g}=e,{aweme_type:h,video_play_mode:y,is_landscape:w,action_type:P}=g,C=(0,j.G)();T.sendLog("videoRequestResponse",(0,n._)({urlParamList:["previous_page","tab_name"],group_id:o,compilation_id:r,vduration:a,video_quality:v,video_format:null==m?void 0:m.playerType,is_success:s,duration:u,is_csr:d,host:_,vtype:f,action_type:P,is_ad:(0,L.Jt)(p)?1:0,is_compilation:(null==p?void 0:null===(i=p.mixInfo)||void 0===i?void 0:i.mixId)?1:0,aweme_type:h,video_play_mode:y,is_landscape:w,is_bytevc1:null==m?void 0:null===(t=m.curDefinition)||void 0===t?void 0:t.isH265,is_player_v2:1,play_order:C,is_hw:(null==m?void 0:null===(l=m.config)||void 0===l?void 0:l.mediaType)==="video"?1:0,is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,player_version:null==m?void 0:m.version},(0,R.Z)(m),F(),c))}(s.current.data),(null===(i=s.current)||void 0===i?void 0:null===(e=i.data)||void 0===e?void 0:e.is_success)&&(s.current.isReport=!0)}},g=()=>{_&&(_.loadeddata=1),r&&p()},h=e=>{var t,l,n,o;let r=u(),{awemeId:a,vduration:s,compilation_id:v,qualityType:c,extraParams:f}=r,m=(null===(t=d.current)||void 0===t?void 0:t.duration)?new Date().getTime()-d.current.duration:0;return{awemeId:i.awemeId,isReport:!1,data:{group_id:a,extraParams:f,duration:m,vduration:s,compilation_id:v,videoQuality:(null==_?void 0:null===(l=_.curDefinition)||void 0===l?void 0:l.qualityType)||c,is_success:e,logInfo:r,player:_,awemeInfo:i,vtype:null==_?void 0:null===(o=_.config)||void 0===o?void 0:null===(n=o.shared)||void 0===n?void 0:n.vtype}}},y=e=>{var t,l;let n=u(),{awemeId:o,extraParams:r}=n;return{awemeId:i.awemeId,duration:new Date().getTime(),data:{group_id:o,extraParams:r,logInfo:n,player:_,awemeInfo:i,host:null==e?void 0:e.host,fetchExpired:null==i?void 0:i.fetchExpired,vtype:null==_?void 0:null===(l=_.config)||void 0===l?void 0:null===(t=l.shared)||void 0===t?void 0:t.vtype},isReport:!1}},P=e=>{var i,t;if("loadstart"===e.eventType||(null==e?void 0:e.eventName)===w.FP.PLAY){let t=a.Le.getConfig(a.gI.SearchVideoPlayMethod);t&&a.Le.setConfig(a.gI.VideoPlayMethod,t),d.current?!(null===(i=s.current)||void 0===i?void 0:i.isReport)&&(s.current=h(0),d.current.duration=new Date().getTime(),g()):(d.current=y(e),m())}else("loadeddata"===e.eventType||(null==e?void 0:e.eventName)===w.FP.PLAY_FULFILLED)&&(!(null===(t=s.current)||void 0===t?void 0:t.isReport)&&(s.current=h(1)),g())};i&&(m(),g(),_&&(_.on("vodlog",P),_.on(w.FP.PLAY_FULFILLED,P),_.on(w.FP.PLAY,P)));let C=e=>{i&&((_=e).on("vodlog",P),_.on(w.FP.PLAY_FULFILLED,P),_.on(w.FP.PLAY,P),c=()=>{_.off("vodlog",P),_.off(w.FP.PLAY_FULFILLED,P),_.off(w.FP.PLAY,P)})};return null==v||null===(l=v.on)||void 0===l||l.call(v,V.A.PLAYER_CREATE,C),()=>{var e;null==c||c(),null==_||_.off("vodlog",P),null==_||_.off(w.FP.PLAY_FULFILLED,P),null==_||_.off(w.FP.PLAY,P),null==v||null===(e=v.off)||void 0===e||e.call(v,V.A.PLAYER_CREATE,C)}},[t,i,r])}({awemeInfo:i,player:t,isActive:v,getLogInfo:p}),!function(e){let{player:i,getLogInfo:t}=e;(0,l.useRef)(-1),(0,l.useEffect)(()=>{if(!i)return;let e=null,l=i=>{"change_volume"===i.action&&(e&&clearTimeout(e),e=setTimeout(()=>{var e,l;let r=null==i?void 0:null===(l=i.props)||void 0===l?void 0:null===(e=l.find)||void 0===e?void 0:e.call(l,e=>"volume"===e.prop);if(!r)return;let{from:a,to:u}=r,d=a>u,{extraParams:s}=t();T.sendLog("prfVolumeChange",(0,o._)((0,n._)({down:d?1:0,enter_from:(0,P.vM)(),group_id:null==s?void 0:s.from_group_id},s,null==i?void 0:i.logData),{is_mute:0===u?"1":"0",pre_player_volume:a,cur_player_volume:u,play_order:(0,j.G)(),is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",listen_device:(0,P.nj)()}))},500))};return i.on(w.FP.USER_ACTION,l),()=>{i.off(w.FP.USER_ACTION,l)}},[i])}({player:t,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:r,getLogInfo:u}=e,d=(0,l.useRef)(0);(0,l.useEffect)(()=>{var e;if(!i||!r)return;let l=!1,s="",v="",c=-1,_=0,f=(null===(e=a.Le.getConfig(a.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)||!1,m=e=>{s=null==e?void 0:e.host,v=null==e?void 0:e.vtype},p=()=>{_=1},g=()=>{c=Date.now()},h=()=>{d.current++},y=()=>{var e,r,a,m,p,g,h,y,w,C,I,S,E,L,N;if(l)return;l=!0;let x=(null==t?void 0:null===(a=t.video)||void 0===a?void 0:null===(r=a.playApi)||void 0===r?void 0:null===(e=r.startsWith)||void 0===e?void 0:e.call(r,"blob"))?1:0,{preloadTime:D,preloadSize:k,startBuffer:M,audioDuration:U,minDuration:V}=ev(i),H=(0,o._)((0,n._)({preload_time:(0,eo.N)(D),preload_time_audio:U,preload_time_min:V,preload_size:k||0,preload_type:(null==i?void 0:i.preloadData)?2:1,is_mute:(null==i?void 0:i.muted)?"1":"0",player_volume:null==i?void 0:i.volume,video_mute:(null==i?void 0:null===(m=i.video)||void 0===m?void 0:m.muted)?"1":"0",video_volume:null==i?void 0:null===(p=i.video)||void 0===p?void 0:p.volume,is_in_modal:f},(()=>{try{var e,l,n,o;let{cdn:r,pcdn:a}=(null==i?void 0:i.bandwidth)||{},{size:u}=r||{},{size:s,trace_id:v,uri:c,fid:_}=a||{},f=er(i,d.current),m=(null==i?void 0:null===(e=i.curDefinition)||void 0===e?void 0:e.realBitrate)||(null==i?void 0:null===(l=i.curDefinition)||void 0===l?void 0:l.bitrate)||0,p=eu(i,null==t?void 0:null===(n=t.video)||void 0===n?void 0:n.duration),g=(0,eo.e)(p*m),h=es(i);if(x){let e=i.duration?(f>0?i.duration:i.currentTime)/i.duration:0;g*=e}let{pcdn_tracker_request_cnt:y,pcdn_tracker_failed_cnt:w,pcdn_download_request_cnt:P,pcdn_download_failed_cnt:C}=(null==i?void 0:i.pcdnReq)||(null==i?void 0:null===(o=i.config)||void 0===o?void 0:o.pcdnReq)||{};return{fid:_,trace_id:v,uri:c,pcdn_size_video:s,cdn_size_video:u,play_size:ea(i),play_leave_position:(0,eo.N)(i.currentTime),play_duration_clean:(0,eo.N)(f>0?i.duration:i.currentTime),cache_size:Math.max(g,ea(i)),cache_duration:(0,eo.N)(p),data_player_type:h,pcdn_tracker_request_cnt:y,pcdn_tracker_failed_cnt:w,pcdn_download_request_cnt:P,pcdn_download_failed_cnt:C}}catch(e){return{}}})()),{urlParamList:["previous_page","tab_name"],is_success:_||(null==i?void 0:null===(g=i.video)||void 0===g?void 0:g.readyState)>=2?1:0,host:s,vtype:v,play_order:(0,j.G)(),from_start_duration:-1===c?-1:Date.now()-c,is_hw:(null==i?void 0:null===(h=i.config)||void 0===h?void 0:h.mediaType)==="video"?1:0,is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,is_hw_client:ef(i),is_gear_down:null!==(N=null==i?void 0:null===(y=i.curDefinition)||void 0===y?void 0:y.orgDefinition)&&void 0!==N?N:0,definition:null==i?void 0:null===(w=i.curDefinition)||void 0===w?void 0:w.definition,start_buffer:M,if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",buffer:(null==i?void 0:null===(C=i.bufferedPoint)||void 0===C?void 0:C.end)-(null==i?void 0:null===(I=i.bufferedPoint)||void 0===I?void 0:I.start)||0});ep(i);let B=(null==i?void 0:null===(S=i.getSwitchDefinationInfos)||void 0===S?void 0:S.call(i))||{};T.sendLog("videoPlayEnd",(0,n._)((0,o._)((0,n._)({},eg(i),eP(!1),H,(0,R.Z)(i),F(),eC(i,t),ew(i,u()),(null==i?void 0:i.pcdnVVStat)||{},(null==i?void 0:null===(L=i.getPlugin)||void 0===L?void 0:null===(E=L.call(i,"vodLogger"))||void 0===E?void 0:E.novv)||{}),{is_cache_video:x,listen_device:(0,P.nj)()}),B),!1),i.preplayStat=0,i.prepauseStat=0,i.superResolution={},i.firstframe=0,i.loadstart=0,i.loadeddata=0,i.danmakuGetBoundingCounts=0,i.danmuElCreateCounts=0};return i.on(w.FP.FIRST_FRAME,g),i.on(w.FP.PLAY,m),i.once(w.FP.LOADEDDATA,p),i.on(w.FP.ENDED,h),window.addEventListener("beforeunload",y),i.once("destroy",y),()=>{y(),i.off(w.FP.FIRST_FRAME,g),i.off(w.FP.PLAY,m),i.off(w.FP.LOADEDDATA,p),i.off(w.FP.ENDED,h),window.removeEventListener("beforeunload",y),i.off("destroy",y)}},[i,t,r]),(0,l.useEffect)(()=>{if(i){let e=()=>{var e;(null==i?void 0:null===(e=i._core)||void 0===e?void 0:e.moveAway)&&i._core.moveAway()};return i.once(w.FP.DESTROY,e),()=>{i.off(w.FP.DESTROY,e)}}},[t,i]),(0,l.useEffect)(()=>{d.current=0},[t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:u,index:s}=e,{getLogInfo:v,getSpecialParams:c}=e;(0,l.useEffect)(()=>{if(!i||!u||(null==t?void 0:t.awemeType)===68)return;let e=c(),l=()=>{var l,u,c,_,f,m,p,g,h,y,w,S;let{author_id:E,group_id:x,log_pb:D,compilation_id:k,playlet_id:R,extraParams:M,aweme_type:F,trending_topic:j,first_tag_name:U,top:V,is_click_cover:H,is_pure:K,is_insert_wallpaper:q,if_first_big_card:G}=v(),Y=!1,W=(0,eI.G)(r.SessionStorageKeys.CacheRecommendActiveAwemeID);W&&W===x&&(Y=!0),T.sendLog("videoPlayFinish",(0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)({is_click_cover:H,urlParamList:["trending_topic","previous_page"],enter_from:(0,P.mo)(),enter_from_merge:(0,eS.z)(""),enter_method:(0,C.Rs)("enter_method")||"",author_id:E,group_id:x,log_pb:D,compilation_id:k,playlet_id:R,is_insert_wallpaper:q,tab_name:(0,I.zD)()||(0,C.Rs)("tab_name")||"",is_full_screen:(0,N.r)()?"1":"0",is_full_webscreen:B.s.getIsPageFullscreen()?"1":"0",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(l=a.Le.getConfig(a.gI.IsCollapseAuthorCard))||void 0===l?void 0:l.isCollapseAuthorCard)?0:1,from_follow_list:(null===(u=a.Le.getConfig(a.gI.FromFollowList))||void 0===u?void 0:u.tag)?"1":"0",is_mute:(null==i?void 0:i.muted)?"1":"0"},(0,eE.t)()),{mute_type:null===(c=a.Le.getConfig(a.gI.ForceMuted))||void 0===c?void 0:c.currentMuteType,is_force:(null===(_=a.Le.getConfig(a.gI.ForceMuted))||void 0===_?void 0:_.currentMuteType)==="browser"?"1":"0",aweme_type:F,trending_topic:j,first_tag_name:U,top:V,is_pure:K,from_push:d.Q.getItem({sKey:r.CookieKeys.FromClientPush})?1:0}),M,e.videoPlayFinish||{}),{is_bytevc1:null==i?void 0:null===(f=i.curDefinition)||void 0===f?void 0:f.isH265,is_player_v2:1,video_time:(0,eT.n)(null==t?void 0:null===(m=t.video)||void 0===m?void 0:m.duration),is_from_ad:(0,L.Jt)(t)?1:0,auto_play_mode:null===(p=a.Le.getConfig(a.gI.InnerAutoPlay))||void 0===p?void 0:p.mode,is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,video_play_method:null!==(y=a.Le.getConfig(a.gI.VideoPlayMethod))&&void 0!==y?y:"auto",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",is_hw_client:ef(i),from_click_group_id:null!==(w=null==t?void 0:t.insertId)&&void 0!==w?w:"",url_source:null!==(S=null==t?void 0:null===(g=t.continationInfo)||void 0===g?void 0:g.urlSource)&&void 0!==S?S:["recommend","personal_homepage"].includes((0,P.vM)())?d.Q.getItem({sKey:r.CookieKeys.UrlSourceForBrowserPlugin}):"",is_cache_video:Y,is_first_video:!s,column_type:(null==M?void 0:M.column_type)||(null==M?void 0:null===(h=M.search_params)||void 0===h?void 0:h.column_type),if_first_big_card:G}),(0,eL.Wc)()),{is_selected_label:(null==t?void 0:t.weeklyRecommend)?1:0}));let Q=a.Le.getConfig(a.gI.SearchVideoPlayMethod);Q&&a.Le.setConfig(a.gI.VideoPlayMethod,Q)};return i.once(w.FP.ENDED,l),()=>{i.off(w.FP.ENDED,l)}},[i,t,u])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p,getSpecialParams:h,index:_}),!function(e){let{player:i,awemeInfo:t,isActive:n}=e,{getLogInfo:o}=e;(0,l.useEffect)(()=>{if(!i||!n)return;let e=e=>{T.sendLog("clickPreviousVideo",K({getLogInfo:o,clickFrom:e})),"click_button"===e&&(0,H.V)()},t=e=>{T.sendLog("clickNextVideo",K({getLogInfo:o,clickFrom:e})),"click_button"===e&&(0,H.V)()},l=()=>{var e;if(!n)return!1;let t=B.s.getPlayerScene(i.playerId),l=B.s.getPlayersByScene(f.lT.Modal)||[],o=null===(e=a.Le.getConfig(a.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal,r=B.s.lastRegisterPlayerId;return(t===f.lT.Modal||!(l.length>0))&&(!o||i.playerId===r)&&!0},r=u.listen(u.EVENT.reportPlayNext,e=>{let{clickFrom:i}=e;if(!!l())t(i)}),d=u.listen(u.EVENT.reportPlayPrev,i=>{let{clickFrom:t}=i;if(!!l())e(t)});return()=>{r(),d()}},[i,t,n])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:n}=e,{getLogInfo:o}=e;(0,l.useEffect)(()=>{if(!i||!n)return;let e=e=>{if((null==e?void 0:e.isInnerReset)===!0)return;let i=null==e?void 0:e.isOn;T.sendLog("clickAutoPlay",Y({getLogInfo:o,isAutoPlay:i,customParams:"object"==typeof(null==e?void 0:e.logParams)?null==e?void 0:e.logParams:{}}))};return i.on(G.C.AutoPlaySwitchChange,e),()=>{i.off(G.C.AutoPlaySwitchChange,e)}},[i,t,n])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e,{getLogInfo:a}=e;(0,l.useEffect)(()=>{if(!i||!r)return;let e=e=>{if((0,L.Jt)(t)){let i=(0,L.Rx)(t);(0,W.E)("full_screen",{tag:(0,Q.f)(),value:i.creative_id,log_extra:i.log_extra,player_form:e})}},l=i=>{T.sendLog("enterFullScreen",Z({getLogInfo:a,clickFrom:i})),e("browser_full")},u=i=>{T.sendLog("exitFullScreen",(0,o._)((0,n._)({},Z({getLogInfo:a,clickFrom:i})),{stack_trace:"click_button"!==i?Error().stack:""})),e("normal")},d=(e,i)=>{e?u(i):l(i)},s=e=>{if("switch_fullscreen"===e.action){var i,t;z[e.eventType],null===(t=e.props)||void 0===t||null===(i=t.find)||void 0===i||i.call(t,e=>"fullscreen"===e.props)}},v=e=>{d(!e.fullscreen,"hot_key")};return i.on(w.FP.USER_ACTION,s),i.on(G.C.SwitchFullScreen,v),()=>{i.off(w.FP.USER_ACTION,s),i.off(G.C.SwitchFullScreen,v)}},[i,t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:u}=e,{getLogInfo:s,getSpecialParams:v}=e,c=(0,l.useRef)(!0);c.current=(0,ex.U)(),(0,l.useEffect)(()=>{if(i&&u){var e,l,_,m,p,g,h;let u=0,y=0,S=i.paused?0:Date.now(),E=0,b=0,x=0,D=!1,k=!1,R=null==i?void 0:null===(l=i.config)||void 0===l?void 0:null===(e=l.shared)||void 0===e?void 0:e.vtype,M="init",U="init",V=(null===(_=a.Le.getConfig(a.gI.IsInLookMiniModal))||void 0===_?void 0:_.isInMiniModal)||B.s.getPlayerScene(null==i?void 0:i.playerId)===f.lT.Modal,H=null!==(h=null===(m=window)||void 0===m?void 0:m.ROUTE_PARAMS)&&void 0!==h?h:(0,eA.parse)(null===(g=window)||void 0===g?void 0:null===(p=g.location)||void 0===p?void 0:p.search),K=(0,I.zD)()||(null==H?void 0:H.tab_name)||(0,C.Rs)("tab_name")||"",q={startTime:0,acc:0},G=e=>{var t,l;if(S=Date.now(),D=!1,V&&(null==i||i.paused),!!(null==i?void 0:i.video))y=i.currentTime,R=null==i?void 0:null===(l=i.config)||void 0===l?void 0:null===(t=l.shared)||void 0===t?void 0:t.vtype,M="string"==typeof e?e:"play"},Y=()=>{b=1},W=(e,l)=>{var c,_,f,m,p,g,h,w,I,D,k,V,H,G,Y,W,Q,z,Z,$,J,X,ee,ei;let{author_id:et,group_id:el,playlet_id:en,log_pb:er,isFromNextAutoPlay:ea,vduration:eu,extraParams:ed,pic_cnt:es,aweme_type:ev,trending_topic:ec,first_tag_name:e_,top:ef,is_click_cover:em,is_pure:ep,is_insert_wallpaper:eg,is_landscape:eh,bitRate:ey,latest_group_id:ew,if_first_big_card:eP}=s(),eC=v(),eI=Date.now()-S,eN=(null==i?void 0:null===(_=i.plugins)||void 0===_?void 0:null===(c=_.VodLoggerPlugin)||void 0===c?void 0:c.cumulateTime)-E;if(a.Le.getConfig(a.gI.IsSearchOuterAsync)){a.Le.setConfig(a.gI.IsSearchOuterAsync,!1);return}if(!S||!i||!el||Date.now()-x<100||eI<100)return;let eb=0;((0,C.Rs)("modeFrom")===eD.MODE_FROM||(0,C.Rs)("modeFrom")===eD.MODE_FROM_SEARCH)&&(eb=1);let eA=(0,C.Rs)("if_from_widget"),ex=u>0?S-u:0;u=0;let eO=(null==i?void 0:null===(f=i.curDefinition)||void 0===f?void 0:f.bitrate)||ey||0,eU=(null===(m=i.curDefinition)||void 0===m?void 0:m.realBitrate)||0,eV=(0,eo.e)(eI/1e3*eU),{memory:eH={},battery:eK}=(0,eR.J)()||{};q.startTime&&(q.acc+=Date.now()-q.startTime,q.startTime=0),T.sendLog("playTime",(0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)({is_player_v2:1,is_click_cover:em,is_insert_wallpaper:eg,is_visible:String(e?1:0),duration:eI,duration_moving:eN,duration_waiting:q.acc,report_reason:l,duration_error:ex,play_time:S,from_percent:1e3*y/eu,to_percent:(null==i?void 0:i.currentTime)*1e3/eu,percentage:(null==i?void 0:i.currentTime)*1e3/eu,play_start_time:Math.floor(y||0),play_end_time:Math.floor((null==i?void 0:i.currentTime)||0),urlParamList:["trending_topic","previous_page"],enter_method:(0,C.Rs)("enter_method")||"",tab_name:K,author_id:et,enter_from:(0,P.mo)(),enter_from_merge:(0,eS.z)(""),group_id:el,playlet_id:en,log_pb:er,video_detail_enter_from:(0,eS.z)("web_link"),speed:String(null==i?void 0:i.playbackRate),is_loop:String(b),is_full_screen:(0,N.r)()?"1":"0",is_full_webscreen:B.s.getIsPageFullscreen()?"1":"0",is_author_card_expand:(null===(p=a.Le.getConfig(a.gI.IsCollapseAuthorCard))||void 0===p?void 0:p.isCollapseAuthorCard)?0:1,from_follow_list:(null===(g=a.Le.getConfig(a.gI.FromFollowList))||void 0===g?void 0:g.tag)?"1":"0",from_push:d.Q.getItem({sKey:r.CookieKeys.FromClientPush})?1:0,is_mute:(null==i?void 0:i.muted)?"1":"0"},(0,eE.t)()),{mute_type:null===(h=a.Le.getConfig(a.gI.ForceMuted))||void 0===h?void 0:h.currentMuteType,from_academy:eb,pic_cnt:es,aweme_type:ev,trending_topic:ec,first_tag_name:e_,top:ef,is_pure:ep,is_from_ad:(0,L.Jt)(t)?1:0,is_bytevc1:null==i?void 0:null===(w=i.curDefinition)||void 0===w?void 0:w.isH265,browser_height:(0,eM.P6)(),browser_width:(0,eM.wi)(),browser_ratio:(0,eM.P6)()/(0,eM.wi)(),is_landscape:eh,stage:`${M}-${U}`}),F(),ed,eC.playTime||{}),{is_force:(null===(I=a.Le.getConfig(a.gI.ForceMuted))||void 0===I?void 0:I.currentMuteType)==="browser"?"1":"0",video_time:(0,eT.n)(null==t?void 0:null===(D=t.video)||void 0===D?void 0:D.duration),auto_play_mode:null===(k=a.Le.getConfig(a.gI.InnerAutoPlay))||void 0===k?void 0:k.mode,seo_vids:eF.t("seo_vids")||"",video_play_method:null!==(X=a.Le.getConfig(a.gI.VideoPlayMethod))&&void 0!==X?X:"auto",if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",is_top:(0,A.k)()?"1":"0",url_source:null!==(ee=null==t?void 0:null===(V=t.continationInfo)||void 0===V?void 0:V.urlSource)&&void 0!==ee?ee:["recommend","personal_homepage"].includes((0,P.vM)())?d.Q.getItem({sKey:r.CookieKeys.UrlSourceForBrowserPlugin}):"",play_order:(0,j.G)(),play_size:eV,video_bitrate:eO,audio_bitrate:(null===(G=i.curDefinition)||void 0===G?void 0:null===(H=G.audioDefinition)||void 0===H?void 0:H.bitrate)||0,real_bitrate:eU,latest_group_id:ew,vduration:eu,vtype:R,video_quality:null==i?void 0:null===(Y=i.curDefinition)||void 0===Y?void 0:Y.qualityType,gear_name:null==i?void 0:null===(W=i.curDefinition)||void 0===W?void 0:W.gearName,rate:a.Le.getConfig(a.gI.PlayRecord)?(null==i?void 0:i.currentTime)/(null==i?void 0:i.duration):""}),(0,ek.K)(t)),{if_from_widget:eA?1:0,from_click_group_id:null!==(ei=null==t?void 0:t.insertId)&&void 0!==ei?ei:"",column_type:(null==ed?void 0:ed.column_type)||(null==ed?void 0:null===(Q=ed.search_params)||void 0===Q?void 0:Q.column_type),memory_js_heap_size_limit:eH.jsHeapSizeLimit,memory_used_js_heap_size:eH.usedJSHeapSize,memory_total_js_heap_size:eH.totalJSHeapSize,memory_free_js_heap_size:eH.freeJSHeapSize,memory_free_level:eH.freeLevel,memory_use_level:eH.usedLevel,battery_charging:null==eK?void 0:eK.charging,battery_level:null==eK?void 0:eK.level,if_first_big_card:eP,sidebar_status:(0,ej.GE)()}),(0,eL.Wc)()),{is_selected_label:(null==t?void 0:t.weeklyRecommend)?1:0}),!1),S=Date.now(),x=Date.now(),E=null==i?void 0:null===(Z=i.plugins)||void 0===Z?void 0:null===(z=Z.VodLoggerPlugin)||void 0===z?void 0:z.cumulateTime,R=null==i?void 0:null===(J=i.config)||void 0===J?void 0:null===($=J.shared)||void 0===$?void 0:$.vtype,M="reported",eB(i,b,t),q.acc=0},Q=eb()(()=>{if(!k&&(null==i?!void 0:!i.paused))U="seeking",W("visible"===document.visibilityState,"seeking")},500,{leading:!0,trailing:!1}),z=eb()(()=>{G("seeked"),k=!1},500,{leading:!1,trailing:!0}),Z=e=>{U=e,W("visible"===document.visibilityState,e),G(e)},$=()=>{if(!!c.current||!!(0,eO.Nr)(location.pathname))Z("pause"),D=!0},J=()=>{!D&&Z("destroy")},X=e=>{i.video&&!(null==i?void 0:i.paused)&&(U="changetab",W(e,"page_visibility_change"),G("changetab"))},ee=()=>{if(!D&&!i.seeking)Z("degrade")},ei=()=>{if(!i.paused)Z("changeurl"),k=!0},et=()=>{u=Date.now()},el=()=>{if(!i.seeking&&!i.paused)q.startTime=Date.now()},en=()=>{q.startTime&&(q.acc+=Date.now()-q.startTime,q.startTime=0)};return i.on(w.FP.ERROR,et),i.on(w.FP.SEEKED,z),i.on(w.FP.PLAY,G),i.on("replay",Y),i.on(w.FP.SEEKING,Q),i.on(w.FP.PAUSE,$),i.on("degrade",ee),i.on("urlchange",ei),(0,eU.vP)(X),i.once(w.FP.DESTROY,J),i.on(w.FP.WAITING,el),i.on(w.FP.PLAYING,en),i.on(w.FP.TIMEUPDATE,en),()=>{i.off(w.FP.ERROR,et),i.off(w.FP.SEEKED,z),i.off(w.FP.SEEKING,Q),i.off(w.FP.PLAY,G),i.off("replay",Y),i.off(w.FP.PAUSE,$),i.off(w.FP.DESTROY,J),i.off("degrade",ee),i.off("urlchange",ei),i.off(w.FP.WAITING,el),i.off(w.FP.PLAYING,en),i.off(w.FP.TIMEUPDATE,en),!D&&Z("unmount"),(0,eU.xC)(X)}}},[t,i,u])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p,getSpecialParams:h}),!function(e){let{player:i,awemeInfo:t,isActive:o}=e,{getLogInfo:r}=e;(0,l.useEffect)(()=>{if(!i||!o)return;let e=e=>{let{author_id:i,group_id:t,log_pb:l,extraParams:o}=r();T.sendLog("clickVideoSpeed",(0,n._)({urlParamList:["previous_page"],author_id:i,group_id:t,log_pb:l,enter_from:(0,q.yW)(),speed:Number(e).toFixed(2),is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",player_display_mode:(0,P.Ok)()},o))};return i.on(G.C.PlayRatioChange,e),()=>{i.off(G.C.PlayRatioChange,e)}},[i,t,o])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e,{getLogInfo:a}=e;(0,l.useEffect)(()=>{if(!i||!r)return;let e=e=>{if((null==e?void 0:e.action)==="switch_play_pause"){let l="pauseVideo";l=i.paused?"startVideo":"pauseVideo";let r=(0,$.m)(e),{extraParams:u}=a();T.sendLog(l,(0,o._)((0,n._)({enter_from:(0,q.yW)(),click_method:r},u),{is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",player_display_mode:(0,P.Ok)(),group_id:t.awemeId||""}))}};return i.on(w.FP.USER_ACTION,e),()=>{i.off(w.FP.USER_ACTION,e)}},[i,t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:o}=e,{getLogInfo:r}=e;(0,l.useEffect)(()=>{if(!i||!o)return;let e=e=>{if((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume"){let l=!1,{extraParams:o}=r();(null==e?void 0:e.action)==="change_muted"?(T.sendLog("clickVolume",(0,n._)({enter_from:(0,q.yW)(),status:e.muted?"1":"0",group_id:null==t?void 0:t.awemeId,player_display_mode:(0,P.Ok)()},o)),(null==e?void 0:e.muted)&&(l=!0)):e.volume>0&&(l=!0),l&&(null==i||i.emit(G.C.OpenVolume))}};return i.on(w.FP.USER_ACTION,e),()=>{i.off(w.FP.USER_ACTION,e)}},[i,t,o])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e;(0,l.useEffect)(()=>{var e,l;if(!i||!r)return;let a=e=>{var l,n,o;return{position:(null==i?void 0:i.currentTime)||0,enter_from:(0,P.mo)(),enter_from_merge:(0,P.vM)(),tab_name:(0,I.zD)()||(0,C.Rs)("tab_name")||"",rate:e.percent,action:e.currentTime>e.prePlayTime?"forward":"rewind",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",is_chapter_bar:(null==t?void 0:null===(l=t.chapterInfo)||void 0===l?void 0:l.status)?1:0,chapter_index:(0,J.P)({awemeInfo:t,currentTime:e.currentTime}),group_id:null==t?void 0:t.awemeId,vduration:null==t?void 0:null===(n=t.video)||void 0===n?void 0:n.duration,before_rate:1e3*e.prePlayTime/(null==t?void 0:null===(o=t.video)||void 0===o?void 0:o.duration),before_position:e.prePlayTime,player_display_mode:(0,P.Ok)()}},u=e=>{(null==e?void 0:e.action)==="click"&&T.sendLog("progressClick",(0,o._)((0,n._)({play_current_time:Math.floor((null==i?void 0:i.currentTime)||0)},a(e)),{click_method:"click"}))};i.on(w.FP.USER_ACTION,u);let d=null===(e=i.plugins)||void 0===e?void 0:e.progress,s=e=>{T.sendLog("progressClick",(0,o._)((0,n._)({play_current_time:Math.floor((null==i?void 0:i.currentTime)||0)},a(e)),{click_method:"drag"}))};return null==d||null===(l=d.addCallBack)||void 0===l||l.call(d,"dragend",s),()=>{var e;i.off(w.FP.USER_ACTION,u),null==d||null===(e=d.removeCallBack)||void 0===e||e.call(d,"dragend",s)}},[i,t,r])}({player:t,awemeInfo:i,isActive:v}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e,{getLogInfo:a}=e;(0,l.useEffect)(()=>{if(!i||!r)return;let e=e=>{let{getEnterFromDynamic:i,extraParams:l}=a();if(e.isInnerReset)return;let r=(null==i?void 0:i())||(0,P.mo)(),u=(0,o._)((0,n._)({enter_from:r},l,e.logParams||{}),{group_id:null==t?void 0:t.awemeId,is_full_screen:(0,N.r)()?"1":"0",is_full_webscreen:B.s.getIsPageFullscreen()?"1":"0",player_display_mode:(0,P.Ok)()});e.isOn&&T.sendLog("openPureMode",u),e.isOn||T.sendLog("closePureMode",u)};return i.on(G.C.ImmersiveSwitchChange,e),()=>{i.off(G.C.ImmersiveSwitchChange,e)}},[i,t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:u}=e,{getLogInfo:d}=e,s=(0,l.useRef)([]),v=(0,l.useRef)(0),c=(0,l.useRef)(""),_=(0,l.useRef)([]),{contextEvent:f}=(0,l.useContext)(U.E);(0,l.useEffect)(()=>{var e;let l;(c.current!==(null==t?void 0:t.awemeId)||!u||!t)&&(c.current=null==t?void 0:t.awemeId,s.current=[],v.current=0);let m=i,p=()=>{s.current.forEach(e=>{T.sendLog("videoPlayFailed",e),eV.oe.event.info({name:eV.Mo.VideoPlayFailed,report:e})}),s.current=[],_.current.forEach(e=>{T.sendLog("linkPlayFailed",e)}),_.current=[]},g=()=>{u&&p()},h=e=>{var i,l,c,_,f,p,h,y,w,P,C,I;let{group_id:S,vduration:E,extraParams:b,action_type:x,aweme_type:D,qualityType:M,log_pb:U,bitrate_set_client:V}=d(),H=(0,n._)((0,o._)((0,n._)({urlParamList:["previous_page","tab_name"]},(0,R.Z)(m),F()),{is_player_v2:1,group_id:S,errorCode:(null==e?void 0:e.code)||"",errorDesc:(null==e?void 0:e.message)||"",vduration:E,video_quality:k({player:m,qualityType:M}),player_version:m.version,current_position:1e3*m.currentTime,is_video_support:Number((0,eK.k)().isSupport),host:null==e?void 0:e.host,vtype:(null==e?void 0:e.vtype)||(null==m?void 0:null===(l=m.config)||void 0===l?void 0:null===(i=l.shared)||void 0===i?void 0:i.vtype),action_type:x,bitrate_set_client:V,is_ad:(0,L.Jt)(t)?1:0,is_compilation:(null==t?void 0:null===(c=t.mixInfo)||void 0===c?void 0:c.mixId)?1:0,is_full_screen:(0,N.r)(),is_show_comment:a.Le.getConfig(a.gI.IsCommetTab)?1:0,is_active:1,is_cdn_expired:1===(0,eq.q)(m.src)?1:0,is_bytevc1:null==m?void 0:null===(_=m.curDefinition)||void 0===_?void 0:_.isH265,aweme_type:D,log_pb:U,play_order:(0,j.G)(),has_report:v.current++,is_265_degrade_client:(0,eh.ad)({player:m}),is_hw:(null==m?void 0:null===(f=m.config)||void 0===f?void 0:f.mediaType)==="video"?1:0,if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",feature_id:null==m?void 0:null===(p=m.curDefinition)||void 0===p?void 0:p.featureId,clarity_now:null==m?void 0:null===(h=m.getClarity)||void 0===h?void 0:h.call(m,!1)}),b);if((null==e?void 0:null===(y=e.mediaError)||void 0===y?void 0:y.code)===6&&(H.aweme_info=null==m?void 0:null===(C=m.config)||void 0===C?void 0:C.url),u?(T.sendLog("videoPlayFailed",H),eV.oe.event.info({name:eV.Mo.VideoPlayFailed,report:H})):(s.current.push(H),g()),(0,eM.G6)()&&(null==e?void 0:null===(w=e.mediaError)||void 0===w?void 0:w.code)===3&&(null==m?void 0:null===(P=m.curDefinition)||void 0===P?void 0:P.isH265)===1){let e=null!==(I=(0,eI.G)(r.SessionStorageKeys.DecodeError))&&void 0!==I?I:0;(0,eI.t_)(r.SessionStorageKeys.DecodeError,e+1)}};t&&(g(),m&&m.on(w.FP.ERROR,h));let y=e=>{(m=e).on(w.FP.ERROR,h),l=()=>{m.on(w.FP.ERROR,h)}};return null==f||null===(e=f.on)||void 0===e||e.call(f,V.A.PLAYER_CREATE,y),()=>{var e;null==l||l(),null==m||m.off(w.FP.ERROR,h),null==f||null===(e=f.off)||void 0===e||e.call(f,V.A.PLAYER_CREATE,y)}},[t,u])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e,{getLogInfo:u,getIsChangingVideoSrc:d}=e;(0,l.useEffect)(()=>{var e;if(!i||!t||!r)return;let l=0,d=!0,s=(null===(e=a.Le.getConfig(a.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)||!1,v=e=>{var r,v,c,_,f,m,p,g,h,y,w,P,C,I,S,E;let{group_id:x,vduration:D,bitRate:M,qualityType:U,extraParams:V,action_type:H,aweme_type:B,video_play_mode:K,is_landscape:q,bitrate_set_client:G}=u(),{bitrate:Y}=(null==i?void 0:i.curDefinition)||{},W=null==i?void 0:null===(v=i.plugins)||void 0===v?void 0:null===(r=v.VodLoggerPlugin)||void 0===r?void 0:r.videoFrameInfo,Q=(0,o._)((0,n._)((0,o._)((0,n._)({urlParamList:["previous_page","tab_name"],group_id:x,duration:e.costTime,duration_origin:e.fixedCostTime,interval:e.interval,diff_start:e.diffStart,diff_end:e.diffEnd,vduration:D,player_version:i.version,video_quality:k({player:i,qualityType:U}),video_fps:null==i?void 0:null===(c=i.curDefinition)||void 0===c?void 0:c.fps,video_bitrate:Y||M,audio_bitrate:(null===(f=i.curDefinition)||void 0===f?void 0:null===(_=f.audioDefinition)||void 0===_?void 0:_.bitrate)||0,real_bitrate:(null===(m=i.curDefinition)||void 0===m?void 0:m.realBitrate)||0,feature_id:null===(p=i.curDefinition)||void 0===p?void 0:p.featureId,current_position:1e3*i.currentTime,percentage_position:1e3*i.currentTime/D*100,video_play_speed:i.playbackRate,is_ad:(0,L.Jt)(t)?1:0,is_compilation:(null==t?void 0:null===(g=t.mixInfo)||void 0===g?void 0:g.mixId)?1:0,is_full_screen:(0,N.r)(),is_show_comment:a.Le.getConfig(a.gI.IsCommetTab)?1:0,buffer_time:ed(i),bitrate_set_client:G,is_visible:Number(!document.hidden),is_visible_when_block_start:Number(d),block_type:null==e?void 0:e.type,end_type:null==e?void 0:e.endType,host:null==e?void 0:e.host,vtype:(null==e?void 0:e.vtype)||(null==i?void 0:null===(y=i.config)||void 0===y?void 0:null===(h=y.shared)||void 0===h?void 0:h.vtype),action_type:H,aweme_type:B,drop_frame:null==W?void 0:W.dropped,total_play_frame:null==W?void 0:W.total,drop_frame_rate:null==W?void 0:W.droppedRate,drop_frame_duration:null==W?void 0:W.droppedDuration,is_bytevc1:null==i?void 0:null===(w=i.curDefinition)||void 0===w?void 0:w.isH265,is_player_v2:1,video_play_mode:K,is_landscape:q,play_order:(0,j.G)(),is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,is_hw_client:ef(i),if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:""},(0,R.Z)(i),F(),V),{preload_type:(null==i?void 0:i.preloadData)?2:1}),(null==i?void 0:null===(P=i.getPlugin("vodLogger"))||void 0===P?void 0:P.novv)||{}),{is_in_modal:s,clarity_now:null==i?void 0:null===(C=i.getClarity)||void 0===C?void 0:C.call(i,!1),is_switch:null==i?void 0:null===(I=i.getIsInSwitching)||void 0===I?void 0:I.call(i)});if("waitingEnd"===e.eventType&&1===e.type){let i=null!==(S=null==e?void 0:e.costTime)&&void 0!==S?S:0,t=null!==(E=null==e?void 0:e.fixedCostTime)&&void 0!==E?E:0;Q.duration=i,Q.duration_origin=t,T.sendLog("videoBlock",Q)}if("waitingStart"===e.eventType&&(l=Date.now(),d="visible"===document.visibilityState),"waitingEnd"===e.eventType){if(0===l||(null==e?void 0:e.type)===1)return;T.sendLog("videoBlock",Q),l=0}};return i.on("vodlog",v),()=>{i.off("vodlog",v)}},[i,t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p,getIsChangingVideoSrc:m}),!function(e){let{player:i,awemeInfo:t,isActive:d}=e,{getLogInfo:v,getIsChangingVideoSrc:c}=e,{contextEvent:_}=(0,l.useContext)(U.E),f=(0,l.useRef)(!1);(0,l.useEffect)(()=>{!d&&(f.current=!1)},[d]);let m=e=>{if("firstFrame"===e.eventType||e.eventName===w.FP.PLAY_FULFILLED){if(!f.current){var l,d,_,m,p,g,h,y,C,I,S,E,x,D,M,U,V,H,B,K,G,Y,W,Q,z,Z,$,J,X;f.current=!0;let{group_id:w,vduration:ee,bitRate:ei,qualityType:et,extraParams:el,bitrate_set:en,bitrate_set_client:er,quality_bitrate:ea,action_type:eu,aweme_type:ed,video_play_mode:es,is_landscape:ec}=v(),{preloadTime:e_,preloadSize:em,startBuffer:ep,audioDuration:ey,minDuration:ew}=ev(i),{bitrate:eC}=(null==i?void 0:i.curDefinition)||{},{slideStartTime:eI}=a.Le.getConfig(a.gI.SlideStartTime)||{},eS=c(),eE=Date.now(),eT=eS||!eI?null==e?void 0:e.fvt:eE-eI,eL=a.Le.getConfig(a.gI.StartPlayTime),eN=null==i?void 0:i.video,eb=0,eA=a.Le.getConfig(a.gI.GeneralSearchVideoSlideIntoVisionTime);"general_search"===(0,q.yW)()&&0!==eA&&(eb=Date.now()-eA);let ex=a.Le.getConfig(a.gI.MenuClick)||0,eD=0;ex&&(a.Le.setConfig(a.gI.MenuClick,0),eD=eE-ex);try{let t=(null==e?void 0:e.vtype)||(null==i?void 0:null===($=i.config)||void 0===$?void 0:null===(Z=$.shared)||void 0===Z?void 0:Z.vtype),l=a.Le.getConfig(a.gI.recentVtypes)||[];l.push(t),a.Le.setConfig(a.gI.recentVtypes,l.slice(0,5))}catch(e){}let ek=(0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)({},eg(i),eP(!0)),{urlParamList:["previous_page","tab_name"]}),(0,R.Z)(i),F()),{group_id:w,bitrate_set:en,bitrate_set_client:er,menu_total_duration:eD,player_first_frame:null==e?void 0:e.fvt,buffer:null==e?void 0:e.buffer,duration:eT,vduration:ee,video_width:null==eN?void 0:eN.videoWidth,video_height:null==eN?void 0:eN.videoHeight,video_ratio:(null==eN?void 0:eN.videoWidth)/(null==eN?void 0:eN.videoHeight),is_over_gear:eQ(i),is_over_rect:(null==i?void 0:null===(l=i.config)||void 0===l?void 0:l.isOverRect)?1:0,device_ratio:null!==(J=window.devicePixelRatio)&&void 0!==J?J:-1,audio_channels:null==i?void 0:null===(d=i.curDefinition)||void 0===d?void 0:d.audioChannels,audio_sample_rate:null==i?void 0:null===(_=i.curDefinition)||void 0===_?void 0:_.audioSampleRate,feature_id:null==i?void 0:null===(m=i.curDefinition)||void 0===m?void 0:m.featureId,player_version:i.version,video_quality:k({player:i,qualityType:et}),video_size:null==i?void 0:null===(p=i.curDefinition)||void 0===p?void 0:p.size,video_fps:null==i?void 0:null===(g=i.curDefinition)||void 0===g?void 0:g.fps,definition:null===(h=i.curDefinition)||void 0===h?void 0:h.definition,video_format:null==i?void 0:i.playerType,video_bitrate:eC||ei,audio_bitrate:(null===(C=i.curDefinition)||void 0===C?void 0:null===(y=C.audioDefinition)||void 0===y?void 0:y.bitrate)||0,real_bitrate:(null===(I=i.curDefinition)||void 0===I?void 0:I.realBitrate)||0,if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",preload_time:(0,eo.N)(e_),preload_time_audio:ey,preload_time_min:ew,preload_size:em||0,preload_type:(null==i?void 0:i.preloadData)?2:1,start_buffer:ep,is_mute:(null==i?void 0:i.muted)?"1":"0",player_volume:null==i?void 0:i.volume,video_mute:(null==i?void 0:null===(S=i.video)||void 0===S?void 0:S.muted)?"1":"0",video_volume:null==i?void 0:null===(E=i.video)||void 0===E?void 0:E.volume,local_mute:(0,s.$o)(r.LocalStorageKeys.PLAYER_IS_MUTE),local_volume:(0,s.$o)(r.LocalStorageKeys.PLAYER_VOLUME),is_in_modal:(null===(x=a.Le.getConfig(a.gI.IsInModalVideo))||void 0===x?void 0:x.isInModal)||!1,host:null==e?void 0:e.host,vtype:(null==e?void 0:e.vtype)||(null==i?void 0:null===(M=i.config)||void 0===M?void 0:null===(D=M.shared)||void 0===D?void 0:D.vtype),is_video_support:Number((0,eK.k)().isSupport),quality_bitrate:ea,action_type:eu,is_ad:(0,L.Jt)(t)?1:0,is_compilation:(null==t?void 0:null===(U=t.mixInfo)||void 0===U?void 0:U.mixId)?1:0,web_rid:null==t?void 0:null===(B=t.authorInfo)||void 0===B?void 0:null===(H=B.roomData)||void 0===H?void 0:null===(V=H.owner)||void 0===V?void 0:V.web_rid,enable_danmaku:(null==t?void 0:null===(K=t.danmakuControl)||void 0===K?void 0:K.enableDanmaku)?1:0,is_full_screen:(0,N.r)(),is_show_comment:a.Le.getConfig(a.gI.IsCommetTab)?1:0,aweme_type:ed,is_bytevc1:null==i?void 0:null===(G=i.curDefinition)||void 0===G?void 0:G.isH265,is_player_v2:1,is_hevc_error_down:null!==(X=null==i?void 0:i.isHevcErrorDown)&&void 0!==X?X:0,video_play_mode:es,is_landscape:ec,play_order:(0,j.G)(),first_video_after_cold_start:(0,eG.R)(0)&&1===(0,j.G)(),is_265_degrade_client:(0,eh.ad)({player:i}),is_265_degrade_web:(0,eh.OS)({player:i}),is_hw:(null==i?void 0:null===(Y=i.config)||void 0===Y?void 0:Y.mediaType)==="video"?1:0,is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,is_hw_client:ef(i),slide_start_to_play:!eS&&eI&&eL?eL-eI:-1,play_to_first_frame:eL?eE-eL:-1,click_to_modal_first_frame:ez(),gear_name:null==i?void 0:null===(W=i.curDefinition)||void 0===W?void 0:W.gearName,media_type:null==i?void 0:null===(Q=i.config)||void 0===Q?void 0:Q.mediaType}),el),{general_search_duration:eb,preplay_stat:(null==i?void 0:i.preplayStat)?1:0,prepause_stat:(null==i?void 0:i.prepauseStat)?1:0,end_type:null==e?void 0:e.endType});i.firstframe=(0,eY.dg)(),T.sendLog("videoPlayQuality",(0,o._)((0,n._)({},ek),{listen_device:(0,P.nj)(),start_play_clarity_type:null==i?void 0:null===(z=i.getClarity)||void 0===z?void 0:z.call(i,!0)})),u.emit(u.EVENT.firstFrame)}}};(0,l.useEffect)(()=>{if(null==t?void 0:t.awemeId){let e;let i=i=>{i.on("vodlog",m),i.on("destroy",e),i.on(w.FP.PLAY_FULFILLED,m),e=()=>{i.off("vodlog",m),i.on("destroy",e),i.off(w.FP.PLAY_FULFILLED,m)}};return _.on(V.A.PLAYER_CREATE,i),()=>{null==e||e(),_.off(V.A.PLAYER_CREATE,i)}}},[null==t?void 0:t.awemeId]),(0,l.useEffect)(()=>{if(i)return i.on("vodlog",m),i.on(w.FP.PLAY_FULFILLED,m),()=>{i.off("vodlog",m),i.off(w.FP.PLAY_FULFILLED,m)}},[i,null==t?void 0:t.awemeId])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p,getIsChangingVideoSrc:m}),!function(e){let{player:i,awemeInfo:t,isActive:n,index:o}=e,r=(0,l.useRef)(!1);(0,l.useEffect)(()=>{var e,l;let d;if(!i||!t||!n)return;let s=()=>{u.emit(u.EVENT.pageFirstFrameLoadStart)},v=()=>{if(a.Le.setConfig(a.gI.isVideoPlayed,!0),u.emit(u.EVENT.pageFirstFrameLoaded),r.current=!0,(0,X.B)())return;let e=d||Date.now();try{if(a.Le.getConfig(a.gI.MarkFirstEnter)){var i,l,n,s,v,c,_,f,m,p,g,h,y,w,P,C,I,S,E,L;a.Le.setConfig(a.gI.MarkFirstEnter,null);let r=(null==t?void 0:null===(n=t.video)||void 0===n?void 0:null===(l=n.playApi)||void 0===l?void 0:null===(i=l.startsWith)||void 0===i?void 0:i.call(l,"blob"))?1:0;(0,ee.DT)()?(0,ei.sE)(t,o):(null===(v=performance)||void 0===v?void 0:null===(s=v.timing)||void 0===s?void 0:s.fetchStart)&&T.sendLog("prfFirstFeedShow",{feed_total_duration:e-(null===(_=performance)||void 0===_?void 0:null===(c=_.timing)||void 0===c?void 0:c.fetchStart),is_landscape:(null==t?void 0:null===(f=t.video)||void 0===f?void 0:f.width)>(null==t?void 0:null===(m=t.video)||void 0===m?void 0:m.height)?1:0,group_id:null==t?void 0:t.awemeId,landing_page:(0,q.yW)(),vduration:null==t?void 0:null===(p=t.video)||void 0===p?void 0:p.duration,if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",real_index:o,is_cache_video:r,aweme_type:null==t?void 0:t.awemeType,is_quick_player:(null===(h=window)||void 0===h?void 0:null===(g=h.__QUICK_PLAYER)||void 0===g?void 0:g.firstLoadDataTimeStamp)?1:0});try{T.sendLog("prfFirstFeedFirstFrameShow",{feed_total_duration:e-(null===(w=performance)||void 0===w?void 0:null===(y=w.timing)||void 0===y?void 0:y.fetchStart),is_landscape:(null==t?void 0:null===(P=t.video)||void 0===P?void 0:P.width)>(null==t?void 0:null===(C=t.video)||void 0===C?void 0:C.height)?1:0,group_id:null==t?void 0:t.awemeId,landing_page:(0,q.yW)(),real_index:o,is_cache_video:r,aweme_type:null==t?void 0:t.awemeType,is_quick_player:(null===(S=window)||void 0===S?void 0:null===(I=S.__QUICK_PLAYER)||void 0===I?void 0:I.firstLoadDataTimeStamp)?1:0}),((null===(E=a.Le.getConfig(a.gI.AbtestData))||void 0===E?void 0:E.prefetchFirst)||(null===(L=a.Le.getConfig(a.gI.AbtestData))||void 0===L?void 0:L.prefetchFirstServer))&&u.emit(u.EVENT.firstLoadMore)}catch(e){}}"recommend"===(0,q.yW)()&&a.Le.getConfig(a.gI.FirstEnterRecommend)&&(a.Le.setConfig(a.gI.FirstEnterRecommend,!1),u.emit(u.EVENT.firstEnterVideoPlay))}catch(e){}},c=()=>{if(a.Le.setConfig(a.gI.isVideoPlayed,!0),!(0,X.B)()&&!!r.current)v()},_=null===(l=window)||void 0===l?void 0:null===(e=l.__QUICK_PLAYER)||void 0===e?void 0:e.firstLoadDataTimeStamp;return _&&(d=_,v()),i.on(w.FP.PLAY,c),i.on(w.FP.LOADEDDATA,v),i.on(w.FP.LOADSTART,s),()=>{i.off(w.FP.PLAY,c),i.off(w.FP.LOADEDDATA,v),i.off(w.FP.LOADSTART,s)}},[i,t,n,o])}({player:t,awemeInfo:i,isActive:v,index:_}),!function(e){let{player:i,awemeInfo:t,isActive:u,index:s}=e,{getLogInfo:v,getSpecialParams:c}=e,{contextEvent:_}=(0,l.useContext)(U.E),f=(0,l.useRef)(""),m=(0,l.useRef)(null),p=(0,l.useRef)(!1);(0,l.useEffect)(()=>{!u&&(f.current="")},[u]),(0,l.useEffect)(()=>{t.awemeId!==f.current&&(f.current="");let e=i,l=()=>{var i,l,u,_,h,y,w,S,E,x,D,k,R,M,j,U,V,H,K,q,G,Y,W,Q,z,Z;if(f.current)return;f.current=t.awemeId;let{author_id:$,group_id:J,log_pb:X,compilation_id:ee,playlet_id:ei,impressionData:et,extraParams:en,aweme_type:eo,pic_cnt:er,trending_topic:ea,first_tag_name:eu,top:ed,is_pure:es,is_click_cover:ev,is_insert_wallpaper:ec,latest_group_id:e_,if_first_big_card:ef}=v(),em=a.Le.getConfig(a.gI.VideoFeedList),ep=(null==em?void 0:em.autoPlayCount)||1,eg=(0,C.Rs)("if_from_widget"),eh=0;((0,C.Rs)("modeFrom")===eD.MODE_FROM||(0,C.Rs)("modeFrom")===eD.MODE_FROM_SEARCH)&&(eh=1);let ey=!1,ew=(0,eI.G)(r.SessionStorageKeys.CacheRecommendActiveAwemeID);ew&&ew===J&&(ey=!0);let eP="";try{eP=(null==t?void 0:null===(Y=t.logPb)||void 0===Y?void 0:Y.includes("impr_id"))?JSON.parse(null==t?void 0:t.logPb).impr_id:null==t?void 0:t.logPb}catch(e){}(0,eJ.K)(),T.sendLog("videoPlay",(0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)((0,o._)((0,n._)({is_click_cover:ev,is_insert_wallpaper:ec,urlParamList:["trending_topic","previous_page","keywords_index","keywords_content"],enter_method:(0,C.Rs)("enter_method")||"",author_id:$,enter_from:(0,P.mo)(),enter_from_merge:(0,eS.z)(""),group_id:J,log_pb:X,compilation_id:ee,playlet_id:ei,is_auto_play:(null==e?void 0:null===(l=e.getPlugin(el.p7.AutoPlaySettingPlugin))||void 0===l?void 0:null===(i=l._config)||void 0===i?void 0:i.nextAutoPlay)||(null==e?void 0:null===(_=e.getPlugin(el.p7.SearchAutoPlaySettingPlugin))||void 0===_?void 0:null===(u=_._config)||void 0===u?void 0:u.nextAutoPlay),is_visible:String("visible"===document.visibilityState?1:0),enable_danmaku:(null==t?void 0:null===(h=t.danmakuControl)||void 0===h?void 0:h.enableDanmaku)?1:0,impression_data:et,speed:`${null==e?void 0:e.playbackRate}`,auto_cnt:ep,video_detail_enter_from:(0,eS.z)("web_link"),is_full_screen:(0,N.r)()?"1":"0",is_full_webscreen:B.s.getIsPageFullscreen()?"1":"0",tab_name:(0,I.zD)()||(0,C.Rs)("tab_name")||"",from_follow_list:(null===(y=a.Le.getConfig(a.gI.FromFollowList))||void 0===y?void 0:y.tag)?"1":"0",is_mute:(null==e?void 0:e.muted)?"1":"0",mute_type:null===(w=a.Le.getConfig(a.gI.ForceMuted))||void 0===w?void 0:w.currentMuteType,is_pure:es},(0,eE.t)()),{from_academy:eh,aweme_type:(null==t?void 0:t.isSlides)?151:eo,pic_cnt:er,trending_topic:ea,first_tag_name:eu,top:ed,impr_id:eP,browser_height:(0,eM.P6)(),browser_width:(0,eM.wi)(),browser_ratio:(0,eM.P6)()/(0,eM.wi)(),is_from_ad:(0,L.Jt)(t)?1:0,is_ad:(0,L.Jt)(t)?1:0,is_compilation:(null==t?void 0:null===(S=t.mixInfo)||void 0===S?void 0:S.mixId)?1:0,is_bytevc1:null==e?void 0:null===(E=e.curDefinition)||void 0===E?void 0:E.isH265,is_player_v2:1,video_time:(0,eT.n)(null==t?void 0:null===(x=t.video)||void 0===x?void 0:x.duration),is_force:(null===(D=a.Le.getConfig(a.gI.ForceMuted))||void 0===D?void 0:D.currentMuteType)==="browser"?"1":"0",from_push:d.Q.getItem({sKey:r.CookieKeys.FromClientPush})?1:0,auto_play_mode:null===(k=a.Le.getConfig(a.gI.InnerAutoPlay))||void 0===k?void 0:k.mode,seo_vids:eF.t("seo_vids")||"",webdriver:navigator&&navigator.webdriver?1:0,vtype:null==e?void 0:null===(M=e.config)||void 0===M?void 0:null===(R=M.shared)||void 0===R?void 0:R.vtype,is_long_not_use_refresh_vid:!!(null==e?void 0:null===(j=e.config)||void 0===j?void 0:j.notUseRefreshVid),is_supported_hevc1_hw:(0,b._u)()?1:0,is_supported_264_hw:(0,b.b4)()?1:0,is_hevc_error_down:null!==(W=null==e?void 0:e.isHevcErrorDown)&&void 0!==W?W:0}),F(),en,(null===(U=c())||void 0===U?void 0:U.videoPlay)||{}),{video_play_method:null!==(Q=a.Le.getConfig(a.gI.VideoPlayMethod))&&void 0!==Q?Q:"auto",if_invisible:(0,A.Vr)()?"1":"0",is_small_window:(0,A.QD)()?"1":"0",small_window_scene:(0,A.QD)()?O.h.getState().smallWindowScene:"",is_top:(0,A.k)()?"1":"0"}),ec&&a.Le.getConfig(a.gI.WallPaperPosition)>0?{vv_sync:1}:{}),{url_source:null!==(z=null==t?void 0:null===(V=t.continationInfo)||void 0===V?void 0:V.urlSource)&&void 0!==z?z:["recommend","personal_homepage"].includes((0,P.vM)())?d.Q.getItem({sKey:r.CookieKeys.UrlSourceForBrowserPlugin}):"",latest_group_id:e_,expand_video_card_type:(null===(H=a.Le.getConfig(a.gI.PlayerCardInfo))||void 0===H?void 0:H.isActive)?null===(K=a.Le.getConfig(a.gI.PlayerCardInfo))||void 0===K?void 0:K.expandCardType:"",rate:a.Le.getConfig(a.gI.PlayRecord)?(null==e?void 0:e.currentTime)/(null==e?void 0:e.duration):""}),(0,ek.K)(t)),{if_from_widget:eg?1:0,from_click_group_id:null!==(Z=null==t?void 0:t.insertId)&&void 0!==Z?Z:"",column_type:(null==en?void 0:en.column_type)||(null==en?void 0:null===(q=en.search_params)||void 0===q?void 0:q.column_type),is_cache_video:ey,is_first_video:!s,if_first_big_card:ef,player_start_time:(null==e?void 0:null===(G=e.config)||void 0===G?void 0:G.startTime)||0,sidebar_status:(0,ej.GE)()}),(0,eL.Wc)(eL.rh.PLAY_START)),{is_selected_label:(null==t?void 0:t.weeklyRecommend)?1:0}));try{!p.current&&(0,e$.yr)()}catch(e){}m.current={aweme_type:eo,item_id:J,source:0,play_delta:1,operation_info:null==t?void 0:t.webOperationInfo},a.Le.getConfig(a.gI.TeaBlocked)&&(0,g.fetchHomeImpression)({awemeIds:t.awemeId,pointBlock:1})},u=()=>{f.current="",l()},h=e=>{f.current=e};if(!e){let i;let n=n=>{t&&((e=n).on("enter_inner_feed",u),e.on("exit_inner_feed",h),e.on(w.FP.AUTOPLAY_STARTED,l),e.on(w.FP.PLAY_FULFILLED,l),i=()=>{e.off("enter_inner_feed",u),e.off("exit_inner_feed",h),e.off(w.FP.AUTOPLAY_STARTED,l),e.off(w.FP.PLAY_FULFILLED,l)})};return _.on(V.A.PLAYER_CREATE,n),()=>{_.off(V.A.PLAYER_CREATE,n),null==i||i()}}return e.on("enter_inner_feed",u),e.on("exit_inner_feed",h),e.on(w.FP.AUTOPLAY_STARTED,l),e.on(w.FP.PLAY_FULFILLED,l),()=>{e.off("enter_inner_feed",u),e.off("exit_inner_feed",h),e.off(w.FP.AUTOPLAY_STARTED,l),e.off(w.FP.PLAY_FULFILLED,l)}},[t.awemeId,i]),(0,l.useEffect)(()=>{let e=()=>{(0,eZ.x0)(m.current)};return u&&i?(i.once(w.FP.TIMEUPDATE,e),()=>{i.off(w.FP.TIMEUPDATE,e)}):()=>null},[u,i])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p,getSpecialParams:h,index:_}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e;(0,l.useEffect)(()=>{if(i){let e=e=>{var i,l;let{vid:r,force_set_min:a}=e||{};T.sendLog("prfTaskDataSize",(0,o._)((0,n._)({},e||{}),{user_unique_id:null===(i=(0,et.Es)())||void 0===i?void 0:i.user_unique_id,group_id:r,force_set_min:a?1:0,vduration:null==t?void 0:null===(l=t.video)||void 0===l?void 0:l.duration,enter_from:(0,q.yW)()}))};return i.on("prf_data_size",e),()=>{i.off("prf_data_size",e)}}},[i,t])}({player:t,awemeInfo:i,isActive:v}),!function(e){let{player:i,awemeInfo:t,isActive:r}=e,{getLogInfo:a}=e,u=(0,l.useRef)([]),d=(0,l.useRef)(0),s=(0,l.useRef)(""),{contextEvent:v}=(0,l.useContext)(U.E);(0,l.useEffect)(()=>{let e;(s.current!==(null==t?void 0:t.awemeId)||!r||!t)&&(s.current=null==t?void 0:t.awemeId,u.current=[],d.current=0);let l=i,c=()=>{r&&(u.current.forEach(e=>{T.sendLog("videoDegrade",e)}),u.current=[])},_=e=>{var i,r,s,v,_;let{group_id:f,vduration:m,extraParams:p,action_type:g,aweme_type:h,awemeRequestTime:y,qualityType:w,log_pb:P,bitrate_set_client:C}=a(),I=(0,n._)((0,o._)((0,n._)({urlParamList:["previous_page","tab_name"]},(0,R.Z)(l),F()),{is_player_v2:1,group_id:f,errorCode:null==e?void 0:e.errc,errorDesc:null==e?void 0:e.err_msg,vduration:m,video_quality:k({player:l,qualityType:w}),player_version:l.version,current_position:1e3*l.currentTime,is_video_support:Number((0,eK.k)().isSupport),host:null==e?void 0:e.host,vtype:(null==e?void 0:e.vtype)||(null==l?void 0:null===(r=l.config)||void 0===r?void 0:null===(i=r.shared)||void 0===i?void 0:i.vtype),action_type:g,bitrate_set_client:C,is_ad:(0,L.Jt)(t)?1:0,is_compilation:(null==t?void 0:null===(s=t.mixInfo)||void 0===s?void 0:s.mixId)?1:0,is_active:1,is_cdn_expired:1===(0,eq.q)(l.src)?1:0,is_bytevc1:null==l?void 0:null===(v=l.curDefinition)||void 0===v?void 0:v.isH265,aweme_type:h,log_pb:P,play_order:(0,j.G)(),has_report:d.current++,is_265_degrade_client:(0,eh.ad)({player:l}),is_hw:(null==l?void 0:null===(_=l.config)||void 0===_?void 0:_.mediaType)==="video"?1:0}),(0,eX.m)({player:l}),(0,eX.B)({player:l}),p);u.current.push(I),c()};t&&(c(),l&&l.on("degrade",_));let f=i=>{(l=i).on("degrade",_),e=()=>{l.on("degrade",_)}};if(!l){var m;null==v||null===(m=v.on)||void 0===m||m.call(v,V.A.PLAYER_CREATE,f)}return()=>{var i;null==e||e(),null==l||l.off("degrade",_),null==v||null===(i=v.off)||void 0===i||i.call(v,V.A.PLAYER_CREATE,f)}},[t,r])}({player:t,awemeInfo:i,isActive:v,getLogInfo:p}),!function(e){let{player:i,getLogInfo:t}=e;(0,l.useEffect)(()=>{var e,l;if(!i)return()=>{};let n=e=>{let i=en[null==e?void 0:e.pluginName];if((null==e?void 0:e.pluginName)===el.p7.Fullscreen&&(i=(0,N.r)()?"hover_exit_full_screen":"hover_enter_full_webscreen"),!i)return;let l=null==t?void 0:t();T.sendLog(i,{enter_from:(0,P.mo)(),player_display_mode:(0,P.Ok)(),group_id:(null==l?void 0:l.group_id)||""})};i.on(G.C.IconMouseleave,n);let o=null==i?void 0:null===(e=i.plugins)||void 0===e?void 0:e.progress,r=()=>{let e=null==t?void 0:t();T.sendLog("hover_progress",{enter_from:(0,P.mo)(),player_display_mode:(0,P.Ok)(),group_id:(null==e?void 0:e.group_id)||""})};return null==o||null===(l=o.addCallBack)||void 0===l||l.call(o,"mouseleave",r),()=>{var e;i.off(G.C.IconMouseleave,n),null==o||null===(e=o.removeCallBack)||void 0===e||e.call(o,"mouseleave",r)}},[i])}({player:t,getLogInfo:p})}({player:ey,isActive:t,awemeInfo:i,getIsChangingVideoSrc:eH,getLogInfo:eW,getSpecialParams:e1,isNext:S,index:em}),null}},378844:function(e,i,t){var l=t(520739),n=t(555106),o=t(32167),r=t(782563),a=t(35730);i.Z=e=>{try{var i,t,u,d,s,v,c,_,f,m,p,g,h;let y=(0,n.$o)(a.LocalStorageKeys.IsSupportHevc);return(0,l._)({enter_from:(0,o.mo)(),internet_speed_dl:null===(t=navigator)||void 0===t?void 0:null===(i=t.connection)||void 0===i?void 0:i.downlink,cpu_core:null===(u=navigator)||void 0===u?void 0:u.hardwareConcurrency,memory_size:(0,r.Bl)(),UA_info:null===(d=navigator)||void 0===d?void 0:d.userAgent,webdriver:navigator&&navigator.webdriver?1:0,is_long_not_use_refresh_vid:!!(null==e?void 0:null===(s=e.config)||void 0===s?void 0:s.notUseRefreshVid),preplay_stat:(null==e?void 0:e.preplayStat)?1:0,prepause_stat:(null==e?void 0:e.prepauseStat)?1:0,player_start_time:(null==e?void 0:null===(v=e.config)||void 0===v?void 0:v.startTime)||0,is_player_v2:1,player_id:null==e?void 0:e.playerId,vtype:null==e?void 0:null===(_=e.config)||void 0===_?void 0:null===(c=_.shared)||void 0===c?void 0:c.vtype,firstframed:(null==e?void 0:e.firstframe)?1:0,loadstart:(null==e?void 0:e.loadstart)?1:0,loadeddata:(null==e?void 0:e.loadeddata)?1:0,chosenType:null==e?void 0:null===(f=e.curDefinition)||void 0===f?void 0:f.chosenType,chosenReason:null==e?void 0:null===(m=e.curDefinition)||void 0===m?void 0:m.chosenReason,playerError:(null==e?void 0:null===(p=e._core)||void 0===p?void 0:p.playerError)||"",playErrorMessage:(null==e?void 0:null===(g=e._core)||void 0===g?void 0:g.playErrorMessage)||"",stepList:(null==e?void 0:null===(h=e._core)||void 0===h?void 0:h.stepList)||[],danmaku_getbounding_counts:(null==e?void 0:e.danmakuGetBoundingCounts)||0,danmu_el_create_counts:(null==e?void 0:e.danmuElCreateCounts)||0},y||{})}catch(e){return{}}}},824711:function(e,i,t){t.d(i,{B:function(){return r},m:function(){return o}});var l=t(520739),n=t(782563);let o=e=>{var i,t,l,n,o;let{player:r}=e,a=null===(o=r.config)||void 0===o?void 0:null===(n=o.shared)||void 0===n?void 0:null===(l=n.definition)||void 0===l?void 0:null===(t=l.list)||void 0===t?void 0:null===(i=t.find)||void 0===i?void 0:i.call(t,e=>{var i;return(null==e?void 0:e.definition)===(null==r?void 0:null===(i=r.curDefinition)||void 0===i?void 0:i.orgDefinition)});if(r.orgDefinition=a,!a)return{};let{bitrate:u,definition:d,gearName:s,qualityType:v,size:c}=a;return{video_bitrate_origin:u,gear_name_origin:s,video_quality_origin:v,video_size_origin:c,definition_origin:d}},r=e=>{let{player:i}=e;try{var t;if(!(0,n.DT)())return{};if(i.video&&(null===(t=window.TTCommon)||void 0===t?void 0:t.executeWithElement)){let e=JSON.parse(window.TTCommon.executeWithElement(i.video,"getSrCurrentInfo",""))||{};return(0,l._)({is_super_resolution:((null==e?void 0:e.sr_enable)!==3||(null==e?void 0:e.sr_local_error)!==0)&&((null==e?void 0:e.sr_local_error)||!((null==e?void 0:e.proc_avg)>0))?0:1,is_sr_called:(null==i?void 0:i.sr)?1:0},e)}}catch(e){}return{is_super_resolution:0}}},538709:function(e,i,t){t.d(i,{V:function(){return v}});var l=t(88648),n=t(629582),o=t(419631),r=t.n(o),a=t(746864),u=t(637005),d=t(860684);let s=!1,v=e=>{let{awemeInfo:i,isFirst:t,isActive:o,timeout:v=2e3}=e,c=(0,d.n)();return(0,l.useEffect)(()=>{if(!o)return;let e=r()(e=>{let{isDown:l=!1}=e||{};s=!0,u.emit(u.EVENT.firstFrameReady,{firstFrameReadyPlayer:c,vid:null==i?void 0:i.awemeId,playerId:null==c?void 0:c.playerId,isFirst:t,isDown:!!l,isActive:o})});if((null==i?void 0:i.awemeType)!==a.e.Normal){setTimeout(()=>{e({isDown:!0})},0);return}if((null==i?void 0:i.awemeType)===a.e.Normal&&c){if(!1===t&&!s||!c.paused||c.currentTime>0){setTimeout(()=>{e({isDown:!0})},0);return}c.on(n.FP.AUTOPLAY_STARTED,e),c.on(n.FP.AUTOPLAY_WAS_PREVENTED,e);let i=setTimeout(()=>{e({isDown:!0})},v);return()=>{c.off(n.FP.AUTOPLAY_STARTED,e),c.off(n.FP.AUTOPLAY_WAS_PREVENTED,e),clearTimeout(i)}}},[c,i,t,o,v]),null}},123964:function(e,i,t){t.d(i,{I:function(){return p}});var l=t(520739),n=t(563097),o=t(88648),r=t(367366),a=t(637005),u=t(362501),d=t(860684),s=t(122788),v=t(205457);t(239456);var c=t(79307),_=t(171087),f=t(969911);let m=e=>{let{isActive:i,fullScreenTarget:t,scene:l}=e,n=(0,d.n)();return(0,o.useEffect)(()=>{if(n){var e,o,a;(null===(e=n.config)||void 0===e?void 0:e.baseConfig)&&(null===(a=n.config)||void 0===a?void 0:null===(o=a.baseConfig)||void 0===o?void 0:o.fullscreenTarget)!==t&&(l===c.lT.Detail?n.updateConfig({baseConfig:{fullscreenTarget:document.documentElement}}):n.updateConfig({baseConfig:{fullscreenTarget:t}})),i&&(0,r.r)()&&(n.getFullscreen(t),l===c.lT.Detail&&n.getFullscreen(document.documentElement))}},[n,i,t]),(0,o.useEffect)(()=>{if(n&&i){let e=a.listen(a.EVENT.fullScreen,e=>{let{fullScreen:i}=e;!i&&n.exitFullscreen()});return()=>{e()}}},[n,i]),(0,o.useEffect)(()=>{if(n&&i){var e,t,l,o;null===(t=n.plugins.fullscreen)||void 0===t||null===(e=t.updateConfig)||void 0===e||e.call(t,{beforeScreenChange:()=>((0,u.QD)()&&a.emit(a.EVENT.changeMinWindows,{event:"close",isMiniWin:!1,clickMethod:"click_fullScreen"}),!0)});let i=null==n?void 0:null===(o=n.root)||void 0===o?void 0:null===(l=o.querySelector)||void 0===l?void 0:l.call(o,".douyin-player-fullscreen");if(i){let e=()=>{n.emit(_.C.IconMouseleave,{pluginName:f.p7.Fullscreen})};return i.addEventListener("mouseleave",e),()=>{i.removeEventListener("mouseleave",e)}}}},[n,i]),(0,o.useEffect)(()=>{if(i&&n)return a.listen(a.EVENT.syncInteraction,()=>{(0,r.r)()&&n.isUserActive&&n.getFullscreen()})},[n,i]),null},p=e=>{let i=(0,s.N)();return(0,n.jsx)(v.k,{componentName:"FullScrren",Slardar:i,children:(0,n.jsx)(m,(0,l._)({},e))})}},244769:function(e,i,t){t.d(i,{_:function(){return P}}),t(874386);var l=t(563097),n=t(88648),o=t(629582),r=t(713097),a=t.n(r),u=t(596876),d=t(784492),s=t(79307),v=t(746864),c=t(701523),_=t(330746),f=t(161045),m=t(472362),p=t(860684),g=t(675001),h=t(171087),y=t(138593),w=t(763710);let P=e=>{var i,t,r,P,C,I;let{isActive:S,awemeInfo:E,className:T,imgPlaceHolderClassName:L,showImg:N=!0,isPlaying:b=!1,controlHeight:A,abtestData:x}=e,D=(0,p.n)(),[k,R]=(0,n.useState)(!0),[M,F]=(0,n.useState)(!1),[j,O]=(0,n.useState)(b),[U,V]=(0,n.useState)(null),H=(0,n.useRef)(0),B=(0,_.vU)();H.current=(null==E?void 0:null===(i=E.video)||void 0===i?void 0:i.width)/(null==E?void 0:null===(t=E.video)||void 0===t?void 0:t.height);let[K,q]=(0,n.useState)(!1);(0,u.Z)(()=>{q(!0)},[E]);let G=(0,n.useCallback)(()=>{q(!1),U&&H.current&&(U.offsetWidth/H.current>=U.offsetHeight-(null!=A?A:s.fp.Default)?R(!0):R(!1))},[U,A]),Y=(0,n.useCallback)(()=>{M||F(!0)},[M]);(0,n.useEffect)(()=>{if(U&&G){let e=f.Z.bind(U,G);return()=>{e&&e()}}},[U,G]),(0,n.useEffect)(()=>{!S&&O(!1)},[S]);let W=(0,g.l)();return(0,n.useEffect)(()=>{var e,i,t,l;let n=0,r=()=>{n>=1?O(!0):n+=1},a=()=>{O(!0)};if(D)return null===(i=D.on)||void 0===i||i.call(D,o.FP.CANPLAY,a),null===(t=D.once)||void 0===t||t.call(D,o.FP.TIMEUPDATE,a),()=>{var e,i;null===(e=D.off)||void 0===e||e.call(D,o.FP.CANPLAY,a),null===(i=D.off)||void 0===i||i.call(D,o.FP.TIMEUPDATE,a)};{let e=e=>{e.once(o.FP.CANPLAY,a)};return null==W||null===(l=W.on)||void 0===l||l.call(W,h.V.PlayerCreated,e),()=>{var i;null==W||null===(i=W.off)||void 0===i||i.call(W,h.V.PlayerCreated,e)}}},[D]),(0,d.Z)(()=>{F(!1),O(!1)},[E]),(0,l.jsxs)("div",{className:a()(T,m.default.imgBackground,m.default.playerShowInfo,{[m.default.isFirefox]:B,hiddenImgbackgroundPlugin:S&&j&&!(0,w.GP)(E),[m.default.displayNone]:(null==E?void 0:E.awemeType)===v.e.Note&&N,inlinePlayerImgbackgroundPlugin:!1},"imgBackground"),ref:V,children:[!M&&N&&(0,l.jsx)("img",{src:(null==E?void 0:null===(r=E.video)||void 0===r?void 0:r.originCover)||(null==E?void 0:null===(I=E.varietyVideo)||void 0===I?void 0:null===(C=I.cover)||void 0===C?void 0:null===(P=C.url_list)||void 0===P?void 0:P[0]),className:a()("backgroundCover",{[m.default.baseWidth]:!k,[m.default.baseHeight]:k,[m.default.isHide]:K,[m.default.splashAd]:(0,c.p)(E)},m.default.imgPlaceHolder,L),onLoad:G,onError:Y}),(0,l.jsx)(y.T3,{className:a()(m.default.backgroundImg,"background",{[m.default.backgroundImgFirefox]:B}),maskClassName:m.default.backgroundMask,awemeInfo:E,abtestData:x,priorityServerBackupBg:!1})]})}},573879:function(e,i,t){t.d(i,{SD:function(){return H},Yd:function(){return U}});var l=t("134761"),n=t("520739");t("874386"),t("250440");var o=t("563097"),r=t("88648"),a=t("713097"),u=t.n(a),d=t("629582"),s=t("969773"),v=t("597334"),c=t("35730"),_=t("637005"),f=t("782442"),m=t("555106"),p=t("747909"),g=t("410665"),h=t("658065"),y=t("32167"),w=t("428647"),P=t("582117"),C=t("544933"),I=new C.h({openPureToastShow:{eventName:"open_pure_toast_show",params:{enter_from_merge:"",enter_from:""}}}),S=t("254897");let E=()=>{I.sendLog("openPureToastShow",{enter_from_merge:(0,h.yW)(),enter_from:(0,y.vM)()})},T=r.forwardRef(e=>{let{onSwitch:i,isShowTip:t,setIsShowTip:l}=e,n=(0,g.x)(E.bind(null));return(0,o.jsxs)("div",{ref:n,className:u()(P.default.tips,{[P.default.show]:t}),children:[(0,o.jsx)(S.z,{className:u()(P.default.close,"noTransform"),svg:(0,o.jsx)(w.Z,{}),onClick:()=>l(!1)}),(0,o.jsx)("div",{className:P.default.ImmersiveTipTitle,children:(0,o.jsx)("span",{children:"隐藏视频标题"})}),(0,o.jsx)("p",{className:P.default.desc,children:"开启清屏,可隐藏视频标题、作者昵称"}),(0,o.jsx)(p.Button,{theme:"solid",className:P.default.btn,onClick:()=>{null==i||i(),l(!1)},children:"立即开启"})]})});var L=t("205457");t("304428");var N=t("860684"),b=t("122788"),A=t("171087"),x=t("969911"),D=t("102642"),k=t("252376"),R=t("17750");let M="immersive-player-switch-on",F="immersive-player-switch-on-hide-video-info";function j(e){let{isOn:i}=e;return(0,o.jsxs)("div",{className:u()("douyin-playerTips"),children:[i&&(0,o.jsx)("span",{children:"取消清屏"}),!i&&(0,o.jsx)("span",{children:"清屏"}),!!R.SHORTCUT_KEY.immersivePlayer.badgeText&&(0,o.jsx)("span",{className:"shortcutKey",children:R.SHORTCUT_KEY.immersivePlayer.badgeText})]})}function O(e){let{isOn:i,onSwitch:t,hide:l,player:n,updateImmersiveSwitch:a}=e,d=(0,k.H)("pure_mode"),[s,c]=(0,r.useState)(!1),{isMobile:f,isiPad:m}=(0,v.X)();return(0,r.useEffect)(()=>{(l||i)&&c(!1)},[l,i]),(0,r.useEffect)(()=>{let e=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c(e)};return n&&n.on(A.C.ChangeImmersiveSwitchTip,e),()=>{n&&n.off(A.C.ChangeImmersiveSwitchTip,e)}},[n]),(0,r.useEffect)(()=>{let e=_.listen(_.EVENT.closeOtherTip,e=>{"ImmersiveSwitchTip"!==e&&c(!1)});return()=>e()},[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"douyin-player-icon",ref:d,children:[s&&(0,o.jsx)(T,{isShowTip:s,setIsShowTip:c,onSwitch:()=>{a({isOn:!i,logParams:{enter_method:"toast",click_method:"toast"}})}}),(0,o.jsxs)("div",{className:"douyin-player-setting-label",onClick:t,children:[(0,o.jsx)("button",{"aria-checked":"true",className:u()("douyin-player-switch",{"douyin-player-switch-checked":i}),type:"button",children:(0,o.jsx)("span",{className:"douyin-player-switch-inner"})}),(0,o.jsx)("span",{className:"douyin-player-setting-title",children:"清屏"})]})]}),!f&&!m&&!s&&(0,o.jsx)(j,{isOn:i})]})}class U extends d.di{afterPlayerInit(){var e;if(!this._config.disable)this.renderRoot(),this.updateTargetsVisiblity(),null===(e=this._player)||void 0===e||e.on(A.C.UpdateImmersiveSwitch,this.updateImmersiveSwitch),this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseLeave)}beforeDestroy(){var e;this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseLeave),(0,D.v)(this),null===(e=this._player)||void 0===e||e.off(A.C.UpdateImmersiveSwitch,this.updateImmersiveSwitch)}hideTargets(){let e=this._root.closest(".basePlayerContainer");e&&(e.classList.add(M),e.classList.add(F))}showTargets(){let e=this._root.closest(".basePlayerContainer");e&&(e.classList.remove(M),e.classList.remove(F))}updateTargetsVisiblity(){this._config.isOn?this.hideTargets():this.showTargets()}renderRoot(){let e=(0,o.jsx)(O,{isOn:!!this._config.isOn,onSwitch:()=>{this.updateImmersiveSwitch({isOn:!this._config.isOn,logParams:{enter_method:"click_bar",click_method:"button"}})},updateImmersiveSwitch:this.updateImmersiveSwitch,hide:this._config.hide,player:this._player});(0,D.s)(this,e)}render(){return'<dy-icon class="douyin-player-immersive-switch-setting immersive-switch" data-state="normal"></dy-icon>'}constructor(...e){super(...e),(0,l._)(this,"onMouseenter",()=>{this._player.emit(A.C.IconMouseenter,{pluginName:x.p7.ImmersiveSwitchSettingPlugin})}),(0,l._)(this,"onMouseLeave",()=>{this._player.emit(A.C.IconMouseleave,{pluginName:x.p7.ImmersiveSwitchSettingPlugin})}),(0,l._)(this,"updateImmersiveSwitch",e=>{var i,t,l,n,o;let r=null!==(t=null==e?void 0:e.isOn)&&void 0!==t?t:!this._config.isOn,a=null!==(l=null==e?void 0:e.logParams)&&void 0!==l?l:{};if(null===(i=this._player)||void 0===i||i.emit(d.FP.USER_ACTION,{action:"clean_screen",pluginName:x.p7.ImmersiveSwitchSettingPlugin,status:r?"open":"close"}),this._config.showTip=null!==(n=null==e?void 0:e.showTip)&&void 0!==n&&n,this._config.isOn!==r){this._config.isOn=r,this.updateTargetsVisiblity();let i={isOn:r,logParams:a,isInnerReset:e.isInnerReset};null===(o=this._player)||void 0===o||o.emit(A.C.ImmersiveSwitchChange,i),this.renderRoot(),[...this.el.getElementsByTagName("button")].forEach(e=>e.blur())}})}}(0,l._)(U,"pluginName",x.p7.ImmersiveSwitchSettingPlugin);let V=e=>{let{isActive:i,awemeInfo:t,isOnByOuter:l=!1,isInnerFeed:o,abtestData:a,hide:u}=e,v=(0,s.Z)(null==t?void 0:t.awemeId),p=(0,N.n)(),g={position:d.PZ.CONTROL_RIGHT,index:8,className:"douyin-playerimmersive-switch-setting"};return(0,r.useEffect)(()=>{if(!!p&&!p.destroyed)return p.registerPlugin(U,(0,n._)({isOn:l,isInnerFeed:o,abtestData:a,hide:u},g)),()=>{var e;(null==p?void 0:null===(e=p.getPlugin)||void 0===e?void 0:e.call(p,x.p7.ImmersiveSwitchSettingPlugin))&&p.unRegisterPlugin(x.p7.ImmersiveSwitchSettingPlugin)}},[p,o,a,null==t?void 0:t.awemeId]),(0,r.useEffect)(()=>()=>{f.Le.getConfig(f.gI.IsPauseImmersive)||f.Le.setConfig(f.gI.ImmersiveSwitchStatus,!1)},[]),(0,r.useEffect)(()=>{if(p&&i){let e=p.getPlugin(x.p7.ImmersiveSwitchSettingPlugin);null==e||e.updateImmersiveSwitch({isOn:!1})}},[i]),(0,r.useEffect)(()=>{if(!p||!i)return;let e=p.getPlugin(x.p7.ImmersiveSwitchSettingPlugin);null==e||e.updateImmersiveSwitch({isOn:l,isInnerReset:!0})},[l]),(0,r.useEffect)(()=>{if(!!p&&!!i){if((null==t?void 0:t.awemeId)!==v){p.emit(A.C.ChangeImmersiveSwitchTip,!1),f.Le.getConfig(f.gI.ImmersiveSwitchStatus)||f.Le.getConfig(f.gI.IsPauseImmersive),f.Le.setConfig(f.gI.IsPauseImmersive,!1);let e=p.getPlugin(x.p7.ImmersiveSwitchSettingPlugin);null==e||e.updateImmersiveSwitch({isOn:!1,isInnerReset:!0})}}},[p,i,null==t?void 0:t.awemeId,v,o,a]),(0,r.useEffect)(()=>{var e,l,n,o,r;let u=e=>{var i,t;let l=p.config.pluginsConfig[x.p7.ImmersiveSwitchSettingPlugin];!(null==l?void 0:l.isOn)&&(null==p?void 0:p.currentTime)>(null==a?void 0:null===(t=a.immersiveSwitch)||void 0===t?void 0:null===(i=t.show_tip)||void 0===i?void 0:i.player_time)&&!(null==p?void 0:p.paused)&&(null==p?void 0:p.duration)!==p.currentTime&&!(0,m.$o)(c.LocalStorageKeys.ClearScreenGuide)&&((0,m.qQ)(c.LocalStorageKeys.ClearScreenGuide,!0),p.emit(A.C.ChangeImmersiveSwitchTip,!0),_.emit(_.EVENT.closeOtherTip,"ImmersiveSwitchTip"),setTimeout(()=>{p.emit(A.C.ChangeImmersiveSwitchTip,!1),p.off(d.FP.TIMEUPDATE,u)},5e3))},s=(0,m.$o)(c.LocalStorageKeys.ClearScreenGuide);if(p&&i&&!s&&[2,3].includes(null==a?void 0:null===(e=a.immersiveSwitch)||void 0===e?void 0:e.type)&&(null==t?void 0:null===(l=t.video)||void 0===l?void 0:l.height)/(null==t?void 0:null===(n=t.video)||void 0===n?void 0:n.width)<1.5&&(null==t?void 0:null===(o=t.video)||void 0===o?void 0:o.duration)>6e4&&(null==t?void 0:null===(r=t.desc)||void 0===r?void 0:r.length)>30)return p.on(d.FP.TIMEUPDATE,u),()=>{p.off(d.FP.TIMEUPDATE,u)}},[p,i,t,a]),null},H=e=>{let i=(0,b.N)();return(0,o.jsx)(L.k,{componentName:"ImmersiveSwitchPlugin",Slardar:i,children:(0,o.jsx)(V,(0,n._)({},e))})}},502967:function(e,i,t){t.d(i,{zf:function(){return U},iu:function(){return V},Ot:function(){return K},KM:function(){return F},zQ:function(){return j}});var l=t("134761"),n=t("520739"),o=t("878389");t("874386");var r=t("563097"),a=t("88648"),u=t("713097"),d=t.n(u),s=t("629582"),v=t("35730"),c=t("746864"),_=t("147613"),f=t("555106"),m=t("782442"),p=t("362501"),g=t("32167"),h=t("658065"),y=t("54517"),w=t("330746"),P=t("637005"),C=t("875784"),I=t("423780"),S=t("792076"),E=t("903868"),T=t("544933"),L=new T.h({autoPlayModePanelShow:{eventName:"auto_play_mode_panel_show",params:{group_id:"",enter_from_merge:"",enter_from:""}},autoPlayModePanelClick:{eventName:"auto_play_mode_panel_click",params:{group_id:"",enter_from_merge:"",enter_from:"",auto_play_mode:""}}}),N=t("124466"),b=t("860684"),A=t("473677"),x=t("171087"),D=t("969911"),k=t("252376"),R=t("102642"),M=t("17750"),F={Nomal:0,0:"Nomal",Reverse:1,1:"Reverse",Cycle:2,2:"Cycle"};let j=["顺序连播","倒序连播","循环播放"],O=["order","reverse","loop"],U=[C.Z,I.Z,S.Z],V=e=>{let{isSetLog:i,awemeInfo:t,plugin:l,defaultModeRef:n,pipWindow:o,isListenVideoMiniWin:r}=e,[u,d]=(0,a.useState)(()=>{var e;let i=(0,f.$o)(v.LocalStorageKeys.PLAYER_INNER_NEXT_AUTOPLAY),t=null===(e=m.Le.getConfig(m.gI.InnerAutoPlay))||void 0===e?void 0:e.modeIndex;if("number"==typeof t)return t;if(Number(i))return 2===Number(i)?1:0;return null===i?0:2});return(0,a.useEffect)(()=>{var e;let a=e=>{var o,a;let u=null==e?void 0:null===(o=e.target)||void 0===o?void 0:o.tagName;if("INPUT"!==u&&"TEXTAREA"!==u&&(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.contentEditable)!=="true"&&!r)(null==e?void 0:e.code)===M.SHORTCUT_KEY.autoPlay.code&&!(0,p.QD)()&&d(e=>(n&&(n.current=!1),"reverse"===O[(e+1)%3]&&(0,f.qQ)(v.LocalStorageKeys.HasUseFlashBack,!0),i&&L.sendLog("autoPlayModePanelClick",{group_id:null==t?void 0:t.awemeId,enter_from:(0,g.mo)(),enter_from_merge:(0,h.yW)(),auto_play_mode:O[e]}),l.stopFlag=0,(e+1)%3))};return document.addEventListener("keydown",a),null==o||null===(e=o.addEventListener)||void 0===e||e.call(o,"keydown",a),()=>{var e;document.removeEventListener("keydown",a),null==o||null===(e=o.removeEventListener)||void 0===e||e.call(o,"keydown",a)}},[o,t,i,l,r]),(0,a.useEffect)(()=>{!n.current&&(0===u?(0,f.qQ)(v.LocalStorageKeys.PLAYER_INNER_NEXT_AUTOPLAY,"1"):1===u?(0,f.qQ)(v.LocalStorageKeys.PLAYER_INNER_NEXT_AUTOPLAY,"2"):(0,f.qQ)(v.LocalStorageKeys.PLAYER_INNER_NEXT_AUTOPLAY,"0")),m.Le.setConfig(m.gI.InnerAutoPlay,{modeIndex:u,mode:O[u]})},[u]),[u,d]},H=e=>{let{playPrevFunc:i,playNextFunc:t,ablePlayPrev:l,ablePlayNext:o,player:u,isActive:_,innerAutoPlayWeight:p,awemeInfo:C,onMouseLeave:I,hide:S=!1,plugin:E,pipWindow:T,isListenVideoMiniWin:b}=e,D=(0,a.useRef)(!0),[R,F]=V({isSetLog:!0,awemeInfo:C,plugin:E,defaultModeRef:D,pipWindow:T,isListenVideoMiniWin:b}),[H,B]=(0,a.useState)(!1),K=(0,k.H)("auto_play"),q=(0,a.useRef)(null),G=(0,a.useRef)(null),Y=(0,a.useRef)(),W=(0,a.useRef)(null),Q=(0,a.useCallback)(()=>{if(p>=0&&0===R&&t&&o&&(null==E?void 0:E.stopFlag)===0)(0,y.i0)(y.CK.Auto),null==t||t({from:"auto"}),m.Le.setConfig(m.gI.VideoPlayMethod,"auto_play_open");else if(p>=0&&1===R&&l&&i&&(null==E?void 0:E.stopFlag)===0)(0,y.i0)(y.CK.Auto),null==i||i({from:"auto"}),m.Le.setConfig(m.gI.VideoPlayMethod,"auto_play_open");else{let e=()=>{u.replay(),u.replayed=!0,m.Le.setConfig(m.gI.VideoPlayMethod,"auto")};(0,w.G6)()?setTimeout(e,50):e()}},[u,o,l,i,t,R,p]);(0,a.useEffect)(()=>{if(u&&_&&(null==C?void 0:C.awemeType)===c.e.Note){let e=()=>{var e;null==u||null===(e=u.replay)||void 0===e||e.call(u)};return u.on(s.FP.ENDED,e),()=>{u.off(s.FP.ENDED,e)}}},[u,_,C]),(0,a.useEffect)(()=>{if(u&&_&&Q&&(null==C?void 0:C.awemeType)!==c.e.Note)return u.on(s.FP.ENDED,Q),()=>{u.off(s.FP.ENDED,Q)}},[u,_,Q,C]),(0,a.useEffect)(()=>{if(u&&_){u.replayed=!1;let e=P.listen(P.EVENT.changeInnerAutoPlay,e=>{"reverse"===O[e]&&(0,f.qQ)(v.LocalStorageKeys.HasUseFlashBack,!0),F(e),D.current=!1});return()=>{e()}}},[_,u,R]);let z=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};E.stopFlag=0,null==I||I(),B(!1),L.sendLog("autoPlayModePanelClick",(0,n._)({group_id:null==C?void 0:C.awemeId,enter_from:(0,g.mo)(),enter_from_merge:(0,h.yW)(),auto_play_mode:O[e]},i)),"reverse"===O[e]&&(0,f.qQ)(v.LocalStorageKeys.HasUseFlashBack,!0),m.Le.getConfig(m.gI.IsInMixCard)&&m.Le.setConfig(m.gI.AutoPlayChanged,{changed:!0}),F(e),D.current=!1};return(0,a.useEffect)(()=>{let e=e=>{let{index:i,logParams:t}=e;z(i,t)};if(u)return null==u||u.on(x.C.UpdateAutoPlay,e),()=>{null==u||u.off(x.C.UpdateAutoPlay,e)}},[u]),(0,a.useEffect)(()=>{if(W.current){let e=()=>{var e;clearTimeout(Y.current),B(!0),!H&&L.sendLog("autoPlayModePanelShow",{group_id:null==C?void 0:C.awemeId,enter_from:(0,g.mo)(),enter_from_merge:(0,h.yW)()}),null===(e=G.current)||void 0===e||e.close()};return W.current.addEventListener("mouseenter",e),()=>{var i,t;null===(t=W.current)||void 0===t||null===(i=t.removeEventListener)||void 0===i||i.call(t,"mouseenter",e)}}},[H]),(0,a.useEffect)(()=>{if(q.current){let e=()=>{Y.current=setTimeout(()=>{B(!1)},200)},i=()=>{clearTimeout(Y.current)};return q.current.addEventListener("mouseleave",e),q.current.addEventListener("mouseenter",i),()=>{var t,l,n,o;null===(l=q.current)||void 0===l||null===(t=l.removeEventListener)||void 0===t||t.call(l,"mouseleave",e),null===(o=q.current)||void 0===o||null===(n=o.removeEventListener)||void 0===n||n.call(o,"mouseenter",i)}}},[]),(0,r.jsx)("div",{className:d()("douyin-player-icon",N.default.innerAutoplay,N.default.iconBox),ref:K,children:(0,r.jsxs)("div",{ref:q,className:N.default.innerContainer,children:[H&&(0,r.jsxs)("div",{className:d()(N.default.itemContainer,"isDark"),children:[j.map((e,i)=>(0,r.jsxs)("div",{className:d()(N.default.innerItem,{[N.default.selected]:i===R}),onClick:e=>{e.stopPropagation(),z(i)},children:[(0,r.jsx)(A.Z,{className:"noTransform",width:24,height:24,viewBox:"0 0 24 24",src:U[i]}),(0,r.jsx)("span",{children:e})]},e)),!!M.SHORTCUT_KEY.autoPlay.badgeText&&(0,r.jsxs)("div",{className:N.default.label,children:[M.SHORTCUT_KEY.autoPlay.badgeText,"键快捷切换"]})]}),(0,r.jsxs)("div",{ref:W,className:d()("inner-autoplay-item",N.default.outerContent),children:[(0,r.jsx)(A.Z,{className:"noTransform",width:24,height:24,viewBox:"0 0 24 24",src:U[R]}),(0,r.jsx)("div",{className:"inner-autoplay-name",children:j[R]})]})]})})};class B extends s.di{configDidUpdate(){this.renderRoot()}afterPlayerInit(){this.el&&(this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseleave)),this.renderRoot()}beforeDestroy(){this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseleave),(0,R.v)(this)}renderRoot(){(0,R.s)(this,(0,r.jsx)(H,(0,o._)((0,n._)({onMouseEnter:this.onMouseenter,onMouseLeave:this.onMouseleave},this._config),{player:this._player,plugin:this})))}render(){return'<dy-icon class="douyin-player-inner-autoplay automatic-continuous" data-state="normal"></dy-icon>'}constructor(...e){super(...e),(0,l._)(this,"onMouseleave",()=>{this._player.emit(x.C.IconMouseleave,{pluginName:D.p7.InnerAutoPlayPlugin})}),(0,l._)(this,"onMouseenter",()=>{this._player.emit(x.C.IconMouseenter,{pluginName:D.p7.InnerAutoPlayPlugin})})}}(0,l._)(B,"pluginName",D.p7.InnerAutoPlayPlugin);let K=e=>{let{playPrevFunc:i,playNextFunc:t,ablePlayPrev:l,ablePlayNext:r,isActive:u,hide:d,awemeInfo:v}=e,{pipWindow:c,isListenVideoMiniWin:f}=(0,E.Iq)(e=>{let{pipWindow:i,isListenVideoMiniWin:t}=e;return{pipWindow:i,isListenVideoMiniWin:t}}),m=(0,b.n)();return(0,_.o)(()=>{if(m&&u)return m.registerPlugin(B,(0,o._)((0,n._)({},e),{player:m,innerAutoPlayWeight:0,position:s.PZ.CONTROL_RIGHT,index:9,className:"douyin-player-inner-autplay"})),()=>{if(!m.destroyed)m.getPlugin(D.p7.InnerAutoPlayPlugin)&&m.unRegisterPlugin(D.p7.InnerAutoPlayPlugin)}},[m,null==v?void 0:v.awemeId]),(0,a.useEffect)(()=>{m&&u&&m.updatePluginConfig(D.p7.InnerAutoPlayPlugin,(0,o._)((0,n._)({},e),{pipWindow:c,isListenVideoMiniWin:f}))},[m,u,t,i,r,l,d]),(0,a.useEffect)(()=>{var e;let i=null==m?void 0:null===(e=m.getPlugin)||void 0===e?void 0:e.call(m,D.p7.InnerAutoPlayPlugin);m&&u&&i&&(i.stopFlag=0)},[v]),(0,a.useEffect)(()=>{if(m&&u){var e;let i=null==m?void 0:null===(e=m.getPlugin)||void 0===e?void 0:e.call(m,D.p7.InnerAutoPlayPlugin);if(i){let e=P.listen(P.EVENT.videoStopPlayNext,e=>{if(!1===m.isUserActive)return;let{openSideCard:t}=e||{};t?i.stopFlag+=1:m.updatePluginConfig(D.p7.InnerAutoPlayPlugin,{innerAutoPlayWeight:i._config.innerAutoPlayWeight>-1?i._config.innerAutoPlayWeight-1:-1})}),t=P.listen(P.EVENT.videoRemoveStopPlayNext,e=>{if(!1===m.isUserActive)return;let{openSideCard:t}=e||{};t?i.stopFlag=Math.max(i.stopFlag-1,0):m.updatePluginConfig(D.p7.InnerAutoPlayPlugin,{innerAutoPlayWeight:i._config.innerAutoPlayWeight<0?i._config.innerAutoPlayWeight+1:0})});return()=>{null==e||e(),null==t||t(),m.updatePluginConfig(D.p7.InnerAutoPlayPlugin,{innerAutoPlayWeight:0})}}}},[m,u,d]),null}},183610:function(e,i,t){t.d(i,{p:function(){return v}});var l=t(520739),n=t(563097),o=t(88648),r=t(860684),a=t(122788),u=t(205457);t(537958);var d=t(631493);let s=e=>{let i=(0,r.n)(),{scene:t,onRegisterSuccess:l,isActive:n,disableShortCut:a}=e;return(0,o.useEffect)(()=>{let e;if(i&&t&&n){let n=d.s.register({player:i,scene:t});e=n,void 0!==n&&(null==l||l({scene:t,playerId:n}))}return()=>{d.s.unRegister({id:e})}},[i,t,n]),null},v=e=>{let i=(0,a.N)();return(0,n.jsx)(u.k,{componentName:"MultiPlayer",Slardar:i,children:(0,n.jsx)(s,(0,l._)({},e))})}},642701:function(e,i,t){t.d(i,{V:function(){return B}});var l=t("134761"),n=t("520739");t("874386"),t("250440");var o=t("563097"),r=t("88648"),a=t("629582"),u=t("713097"),d=t.n(u),s=t("784492"),v=t("597334"),c=t("79307"),_=t("35730"),f=t("256277"),m=t("325982"),p=t("452894"),g=t("602394"),h=t("637005"),y=t("555106"),w=t("782563"),P=t("32167"),C=t("945977"),I=t("367366"),S=t("782442"),E=t("208987"),T=t("690001"),L=t("18950"),N=t("544933"),b=new N.h({fullscreenBubbleShow:{eventName:"fullscreen_bubble_show",params:{author_id:"",group_id:"",enter_from:"recommend"}},enterFullWebscreen:{eventName:"enter_full_webscreen",params:{author_id:"",group_id:"",enter_from:"recommend",enter_from_merge:"",item_duration_ms:0,click_from:"",player_display_mode:""}},exitFullWebscreen:{eventName:"exit_full_webscreen",params:{author_id:"",group_id:"",enter_from:"recommend",click_from:"",player_display_mode:""}}}),A=t("205457"),x=t("860684"),D=t("122788"),k=t("631493"),R=t("102642");t("361133");var M=t("151681"),F=t("171087"),j=t("969911"),O=t("17750");function U(e){let{player:i,isCtxCssFullScreen:t}=e,{isMobile:l,isiPad:n}=(0,v.X)(),[u,s]=(0,r.useState)(k.s.getPlayerScene(null==i?void 0:i.playerId)===c.lT.Modal?k.s.getPlayerIsPageFullscreen(null==i?void 0:i.playerId):k.s.getIsPageFullscreen()||t);return(0,r.useEffect)(()=>{if(!i)return;let e=h.listen(h.EVENT.pageFullScreen,e=>{let{playerId:t,fullScreen:l}=e||{};k.s.getPlayerScene(null==i?void 0:i.playerId)===c.lT.Modal?t===(null==i?void 0:i.playerId)&&(s(l),k.s.setPageFullscreen({playerId:i.playerId,isPageFullscreen:l})):(s(l),k.s.setPageFullscreen({playerId:i.playerId,isPageFullscreen:l}))});return()=>{e()}},[i]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{onMouseEnter:()=>{(0,y.qQ)(_.LocalStorageKeys.ShowPageFullScreenGuide,!0)},onClick:()=>{var e;if(null==i?void 0:null===(e=i.openGeneralSearchModalSlide)||void 0===e?void 0:e.call(i,{from:"pageFullscreen"}))return;let t=k.s.getPlayerIsPageFullscreen(null==i?void 0:i.playerId);s(!t),k.s.setPageFullscreen({playerId:i.playerId,isPageFullscreen:!t}),h.emit(h.EVENT.pageFullScreen,{clickMethod:"icon",fullScreen:!t,playerId:i.playerId}),i.emit(a.FP.USER_ACTION,{action:"page_fullscreen_change"})},className:"douyin-player-icon",children:u?(0,o.jsx)(T.Z,{width:32,height:32,color:"#fff"}):(0,o.jsx)(L.Z,{width:32,height:32})}),!l&&!n&&(0,o.jsxs)("div",{className:d()("douyin-playerTips"),children:[u&&(0,o.jsx)("span",{children:"退出"}),(0,o.jsx)("span",{children:(0,w.DT)()?"窗口全屏":"网页全屏"}),!!O.SHORTCUT_KEY.pageFullScreen.badgeText&&(0,o.jsx)("span",{className:"shortcutKey",children:O.SHORTCUT_KEY.pageFullScreen.badgeText})]})]})}class V extends a.di{configDidUpdate(){this.renderRoot()}afterPlayerInit(){this.el&&(this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseLeave)),this.renderRoot()}beforeDestroy(){this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseLeave),(0,R.v)(this)}renderRoot(){let e=(0,o.jsx)(U,{player:this._config.player,isCtxCssFullScreen:this._config.isCtxCssFullScreen});(0,R.s)(this,e)}render(){return'<dy-icon class="douyin-player-page-full-screen" data-state="normal" data-e2e="douyin-player-page-full-screen"></dy-icon>'}constructor(...e){super(...e),(0,l._)(this,"onMouseenter",()=>{this._player.emit(F.C.IconMouseenter,{pluginName:j.p7.PageFullScreenPlugin})}),(0,l._)(this,"onMouseLeave",()=>{this._player.emit(F.C.IconMouseleave,{pluginName:j.p7.PageFullScreenPlugin})})}}(0,l._)(V,"pluginName",j.p7.PageFullScreenPlugin);let H=e=>{let{awemeInfo:i,logParams:t,isActive:l,lastLoaded:o=l,defaultIsPageFullScreen:u,modalEnterFrom:d}=e,v=(0,r.useRef)(),{isCssFullScreen:_}=(0,r.useContext)(E.C)||{},y=(0,x.n)(),{awemeFeed:w}=(0,M.j)();return(0,r.useEffect)(()=>{if(y){let e={position:a.PZ.CONTROL_RIGHT,index:.8,className:"douyin-player-page-full-screen"};return!y.destroyed&&y.registerPlugin(V,(0,n._)({player:y,isCtxCssFullScreen:_},e)),(null!=u?u:_)&&k.s.setPageFullscreen({playerId:y.playerId,isPageFullscreen:null!=u?u:_}),()=>{if(!y.destroyed)y.getPlugin(j.p7.PageFullScreenPlugin)&&(null==y||y.unRegisterPlugin(j.p7.PageFullScreenPlugin))}}},[y,i]),(0,r.useEffect)(()=>{y&&l&&[c.lT.Follow,c.lT.Friend,c.lT.Recommend,c.lT.Topic].includes(k.s.getPlayerScene(y.playerId))&&y.updatePluginConfig(j.p7.PageFullScreenPlugin,{player:y,isCtxCssFullScreen:_})},[_]),(0,r.useEffect)(()=>{if(i&&y&&l){let e=h.listen(h.EVENT.pageFullScreen,e=>{var l,n;let{clickMethod:o,fullScreen:r,oldFullScreen:a}=e||{},u=null!==(n=null!=a?a:k.s.getIsPageFullscreen())&&void 0!==n&&n,s=null!=r?r:!u,v={author_id:null==i?void 0:i.authorUserId,group_id:null==i?void 0:i.groupId,enter_from:null==t?void 0:t.enter_from,enter_from_merge:null==t?void 0:t.enter_from_merge,item_duration_ms:(null==i?void 0:null===(l=i.video)||void 0===l?void 0:l.duration)||0,click_from:o,player_display_mode:(0,P.Ok)()};if(s){if("inner_player"!==o&&b.sendLog("enterFullWebscreen",v),(0,f.Jt)(i)){let e=(0,f.Rx)(i);(0,m.E)("full_screen",{tag:(0,C.f)(),value:e.creative_id,log_extra:e.log_extra,player_form:"web_full"})}}else if(!1!==u&&(b.sendLog("exitFullWebscreen",v),(0,f.Jt)(i))){let e=(0,f.Rx)(i);(0,m.E)("full_screen",{tag:(0,C.f)(),value:e.creative_id,log_extra:e.log_extra,player_form:"normal"})}if((0,I.r)()&&s){if(k.s.getPlayersByScene(c.lT.Modal).length>0&&d!==p.a.RecommendUpdateWindow)return;y.exitFullscreen(),y.emit(F.C.SwitchFullScreen,{fullscreen:!0,cssFullScreen:!0})}S.Le.setConfig(S.gI.IsPageFullScreen,{type:s})});return()=>{null==e||e()}}},[t,y,i,l,d]),(0,r.useEffect)(()=>{if(y&&l){let e=e=>{e&&k.s.getIsPageFullscreen()&&(k.s.setPageFullscreen({playerId:y.playerId,isPageFullscreen:!1}),h.emit(h.EVENT.pageFullScreen,{clickMethod:"fullscreen",fullScreen:!1,playerId:y.playerId}))};return y.on(a.FP.FULLSCREEN_CHANGE,e),()=>{null==y||y.off(a.FP.FULLSCREEN_CHANGE,e)}}},[y,l]),(0,r.useEffect)(()=>{let e=e=>{if(e.shiftKey||e.metaKey||e.ctrlKey)return;let i=S.Le.getConfig(S.gI.DisableExit);"Escape"===e.code&&k.s.getPlayerIsPageFullscreen(null==y?void 0:y.playerId)&&y.isUserActive&&!i&&(k.s.setPageFullscreen({playerId:y.playerId,isPageFullscreen:!1}),h.emit(h.EVENT.pageFullScreen,{clickMethod:"esc",fullScreen:!1,playerId:y.playerId}))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[y]),(0,s.Z)(()=>{if(l){var e,i;let t=null===(e=S.Le.getConfig(S.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal;if(_){if(!t&&!w.getValue("modalAwemeInfo")){let e=O.SHORTCUT_KEY.pageFullScreen.badgeText;v.current=g.F.info({text:`ESC${e?`或${e}`:""}可退出网页全屏`,zIndex:1e4})}}else null===(i=v.current)||void 0===i||i.call(v)}},[_]),null},B=e=>{let i=(0,D.N)();return(0,o.jsx)(A.k,{componentName:"PageFullScreen",Slardar:i,children:(0,o.jsx)(H,(0,n._)({},e))})}},907662:function(e,i,t){t.d(i,{P:function(){return p}});var l=t("520739");t("874386");var n=t("563097"),o=t("88648"),r=t("784492"),a=t("713097"),u=t.n(a),d=t("637005"),s=t("761733"),v=t("878389");let c=(0,o.forwardRef)((e,i)=>(0,n.jsxs)("svg",(0,v._)((0,l._)({width:10,height:6,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:i},e),{children:[(0,n.jsx)("g",{clipPath:"url(#down_svg__clip0_8458_8595)",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M.32 0h9.36L6.645 4.383a2 2 0 0 1-3.288 0L.319 0z",fill:"#fff"})}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"down_svg__clip0_8458_8595",children:(0,n.jsx)("path",{fill:"#fff",transform:"rotate(-180 5 3)",d:"M0 0h10v6H0z"})})})]})));var _=t("205457"),f=t("122788");let m=e=>{let{isActive:i,controlHeight:t,isMini:l}=e,[a,v]=(0,o.useState)(null),_=(0,o.useRef)(()=>{});return((0,o.useEffect)(()=>{let e=d.listen(d.EVENT.MountPausePopover,e=>{v(null==e?void 0:e.children),_.current=null==e?void 0:e.onClose});return()=>{var i;e(),null===(i=_.current)||void 0===i||i.call(_)}},[]),(0,r.Z)(()=>{var e;null===(e=_.current)||void 0===e||e.call(_)},[i]),i&&a)?(0,n.jsxs)("div",{className:u()(s.default.container,{[s.default.hidden]:l}),style:{bottom:t},children:[(0,n.jsx)("div",{className:s.default.content,children:a}),(0,n.jsx)(c,{className:s.default.down})]}):null},p=e=>{let i=(0,f.N)();return(0,n.jsx)(_.k,{componentName:"PausePopoverPlugin",Slardar:i,children:(0,n.jsx)(m,(0,l._)({},e))})}},407148:function(e,i,t){t.d(i,{W8:function(){return k},oY:function(){return A}});var l=t("520739");t("874386"),t("777180");var n=t("563097"),o=t("629582"),r=t("155067"),a=t("88648"),u=t("713097"),d=t.n(u),s=t("358003"),v=t("205457");t("499824");var c=t("491362"),_=t("35730"),f=t("147613"),m=t("746864"),p=t("820303"),g=t("658065"),h=t("362501"),y=t("32167"),w=t("637005"),P=t("782442"),C=t("544933"),I=new C.h({clickVideoSpeed:{eventName:"click_video_speed",params:{author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",speed:"",item_duration_ms:0,is_small_window:""}},clickHoverLogin:{eventName:"click_hover_login",params:{enter_method:"",enter_from:"",params_for_special:"",player_display_mode:""}}}),S=t("860684"),E=t("122788"),T=t("171087"),L=t("969911"),N=t("252376"),b=t("226355");let A={[c.$.Normal]:["0.75","1.0","1.25","1.5","1.75","2.0","3.0"],[c.$.Safari]:["0.75","1.0","1.25","1.5","1.75","2.0"]},x=!1,D=(0,r.rW)(e=>{let{defaultPlaybackRate:i,disable:t,loginBlock:r,loginDispatch:u,isActive:v,showTip:f=!1,speedType:m=c.$.Normal,abtest:C,awemeInfo:E,logParams:x}=e,D=(0,N.H)("speed"),[k,R]=(0,a.useState)(!1),[M,F]=(0,a.useState)(!1),[j,O]=(0,a.useState)(!1),[U,V]=(0,a.useState)(i),H=(0,a.useRef)(),B=(0,a.useRef)(),K=(0,a.useRef)(null),q=(0,S.n)(),G=e=>{if(!t)q&&(q.updateConfig({baseConfig:{defaultPlaybackRate:Number(e)}}),q.playbackRate=Number(e),B.current=Number(e)),V(Number(e)),F(!1)},Y=e=>{var i,t;let{rate:n,click_method:o,notStorage:r}=e||{};if(Number(n)===Number(B.current))return!1;"longPress"!==o&&I.sendLog("clickVideoSpeed",(0,l._)({urlParamList:["previous_page"],author_id:null==E?void 0:null===(i=E.authorInfo)||void 0===i?void 0:i.uid,group_id:null==E?void 0:E.awemeId,log_pb:null==E?void 0:E.logPb,item_duration_ms:(null==E?void 0:null===(t=E.video)||void 0===t?void 0:t.duration)||0,enter_from:(0,g.yW)(),speed:Number(n).toFixed(2),is_small_window:(0,h.QD)()?"1":"0",small_window_scene:(0,h.QD)()?b.h.getState().smallWindowScene:"",click_method:o,player_display_mode:(0,y.Ok)()},x)),!r&&(0,p.t_)(_.SessionStorageKeys.PlayerPlaybackratio,Number(n)),G(n)};(0,a.useEffect)(()=>{if(q&&v){let e=e=>{let{rate:i,notStorage:t,click_method:l}=e;q&&v&&Y({rate:i,notStorage:t,click_method:l})};return q.on(T.C.ChangePlayRate,e),()=>{!q.destroyed&&q.off(T.C.ChangePlayRate,e)}}},[q,v,Y]),(0,a.useEffect)(()=>{let e=e=>{let{rate:i,click_method:t}=e;Y({rate:i,click_method:t}),q.emit(o.FP.USER_ACTION,{action:"speed_change",pluginName:L.p7.PlayBackSettingPlugin})};if(q)return null==q||q.on(T.C.UpdateRadio,e),()=>{null==q||q.off(T.C.UpdateRadio,e)}},[q,Y]);let W=(0,a.useCallback)(e=>{var i,t,l;null==e||null===(i=e.stopPropagation)||void 0===i||i.call(e),w.emit(w.EVENT.videoStopPlayNext),((0,h.QD)()||document.querySelector(".isMiniWindow"))&&w.emit(w.EVENT.changeMinWindows,{event:"close",isMiniWin:!1,clickMethod:"control_speed_block"}),I.sendLog("clickHoverLogin",{enter_method:"speed_up",enter_from:(0,g.yW)(),params_for_special:"uc_login"}),(0,s.default)({headerText:"登录后即可切换倍速",success:async()=>{null==u||u({type:"updateUserInfo"}),w.emit(w.EVENT.videoRemoveStopPlayNext),P.Le.setConfig(P.gI.disableSpeed,!1),R(!1),(null==e?void 0:e.callback)&&(null==e||e.callback())},next:`https://${null===(l=window)||void 0===l?void 0:null===(t=l.location)||void 0===t?void 0:t.host}`,enterMethod:"speed_up",onClose:()=>{w.emit(w.EVENT.videoRemoveStopPlayNext)}})},[r,u,C]);(0,a.useEffect)(()=>{f&&(O(!0),setTimeout(()=>{O(!1)},3e3))},[f]),(0,a.useEffect)(()=>{if(q&&v){let e=w.listen(w.EVENT.loginBlockKeyBoard,e=>{let{speed:i,callback:t}=e;i&&q.isUserActive&&W({callback:t})});return()=>e()}},[W,q,v]),(0,a.useEffect)(()=>{if(q&&v){let e=(0,p.G)(_.SessionStorageKeys.PlayerPlaybackratio)||1;null==G||G(e);let i=w.listen(w.EVENT.syncInteraction,()=>{let e=(0,p.G)(_.SessionStorageKeys.PlayerPlaybackratio)||1;null==G||G(e)});return()=>{i()}}},[v,q,r]),(0,a.useEffect)(()=>{if(q&&v){let e=()=>{if(t)return;let e=q.playbackRate;e>3&&(e=1,q.playbackRate=e),V(Number(e)),(0,p.t_)(_.SessionStorageKeys.PlayerPlaybackratio,e)};return q.on(o.FP.RATECHANGE,e),()=>{q.off(o.FP.RATECHANGE,e)}}},[q,v]),(0,a.useEffect)(()=>{q&&v&&!t&&void 0===A[m].find(e=>Number(e)===Number(U))&&(q.playbackRate=1)},[U,m,q,v,t]),(0,a.useEffect)(()=>{q&&t&&(q.updateConfig({baseConfig:{defaultPlaybackRate:1}}),q.playbackRate=1)},[q,t]);let Q=(0,a.useCallback)(()=>{F(!1),q.emit(T.C.IconMouseleave,{pluginName:L.p7.PlayBackSettingPlugin})},[q]),z=(0,a.useCallback)(()=>{q.emit(T.C.IconMouseenter,{pluginName:L.p7.PlayBackSettingPlugin}),H.current&&(clearTimeout(H.current),H.current=null),F(!0),q.emit(T.C.PlayRatioPanelShow,q.playbackRate)},[q]);return((0,a.useEffect)(()=>{q&&v&&(r?(R(!0),P.Le.setConfig(P.gI.disableSpeed,!0)):(R(!1),P.Le.setConfig(P.gI.disableSpeed,!1)))},[r,q,v]),(0,a.useEffect)(()=>{if(K.current)return K.current.addEventListener("mouseenter",z),K.current.addEventListener("mouseleave",Q),()=>{var e,i,t,l;null===(i=K.current)||void 0===i||null===(e=i.removeEventListener)||void 0===e||e.call(i,"mouseenter",z),null===(l=K.current)||void 0===l||null===(t=l.removeEventListener)||void 0===t||t.call(l,"mouseleave",Q)}},[z,Q]),t)?(0,n.jsxs)("div",{className:d()("douyin-player-playback-setting",{"slide-show":M,"login-slide-show":j}),"data-state":"normal",ref:K,children:[(0,n.jsx)("div",{className:"douyin-player-setting-playbackRatio disabled",children:"倍速"}),(0,n.jsx)("div",{className:"douyin-playerTips",children:"广告视频不支持倍速功能"})]}):k?(0,n.jsxs)("div",{className:d()("douyin-player-playback-setting",{"slide-show":M,"login-slide-show":j}),"data-state":"normal",ref:K,children:[(0,n.jsx)("div",{onClick:W,className:"douyin-player-setting-playbackRatio",children:"倍速"}),(0,n.jsx)("div",{className:d()("douyin-playerTips",{showTip:!0}),children:(0,n.jsxs)("div",{className:d()("blockLoginText"),children:["登录后即可切换倍速",(0,n.jsx)("span",{className:"blockLoginBtn",onClick:W,children:"立即登录"})]})})]}):(0,n.jsxs)("div",{className:d()("douyin-player-playback-setting",{"slide-show":M,"login-slide-show":j}),"data-state":"normal",ref:K,children:[(0,n.jsx)("div",{ref:D,className:"douyin-player-setting-playbackRatio",children:((e,i)=>{let t=null!==(0,p.G)(_.SessionStorageKeys.PlayerPlaybackratio),l=A[i].find(i=>Number(i)===Number(e));return t&&void 0!==l?`${l}x`:"倍速"})(U,m)}),(0,n.jsx)("div",{className:"douyin-player-slider douyin-player-box-douyin ",children:(0,n.jsx)("div",{className:"douyin-player-setting-content",children:(0,n.jsx)("div",{className:"douyin-player-playratio-wrap",children:A[m].map(e=>(0,n.jsxs)("div",{"data-id":e,className:d()({select:Number(U)===Number(e)},"douyin-player-playratio-item"),onClick:i=>{i.stopPropagation(),Y({rate:e}),q.emit(o.FP.USER_ACTION,{action:"speed_change",pluginName:L.p7.PlayBackSettingPlugin})},children:[e,"x"]},e))})})})]})},{position:o.PZ.CONTROL_RIGHT,index:6}),k=e=>{let i=(0,E.N)(),{awemeInfo:t}=e,o=(0,S.n)(),[r,u]=(0,a.useState)(!1);return((0,f.o)(()=>{if(o){if((null==t?void 0:t.awemeType)!==m.e.Note)return u(!0),()=>{u(!1)};o.playbackRate=1}},[o,t]),r)?(0,n.jsx)(v.k,{componentName:"PlayBackSetting",Slardar:i,children:(0,n.jsx)(D,{props:(0,l._)({defaultPlaybackRate:(0,p.G)(_.SessionStorageKeys.PlayerPlaybackratio)||1},e)})}):null}},129906:function(e,i,t){t.d(i,{I:function(){return w}});var l=t(520739),n=t(563097),o=t(88648),r=t(713097),a=t.n(r),u=t(637005),d=t(782442),s=t(54517),v=t(647645),c=t(450344),_=t(507217),f=t(205457);t(813451);var m=t(860684),p=t(122788),g=t(254897),h=t(903868);let y=e=>{let{playPrevFunc:i,playNextFunc:t,disablePrev:l,disableNext:r,className:f,style:p,playSwitchRef:h,mouseHandler:y,playSwitchCb:w}=e,P=(0,m.n)(),C=(0,o.useRef)(null),I=(0,o.useRef)(null),S=(0,o.useCallback)(e=>{if(!l){if(i&&P){var t;null===(t=P.emit)||void 0===t||t.call(P,"playSwitchPrevBefore",!1),u.emit(u.EVENT.reportPlayPrev,{clickFrom:"click_button"}),null==w||w(),i()}}},[P,i,l]),E=(0,o.useCallback)(e=>{if(!r){if(t&&P){var i;null===(i=P.emit)||void 0===i||i.call(P,"playSwitchNextBefore",!1),u.emit(u.EVENT.reportPlayNext,{clickFrom:"click_button"}),null==w||w(),t()}}},[P,t,r]);return(0,o.useEffect)(()=>{if(C.current&&I.current){let e=e=>{(0,d.Vv)(_.PagingType.click),(0,s.i0)(s.CK.User),S(e)},i=e=>{(0,d.Vv)(_.PagingType.click),(0,s.i0)(s.CK.User),E(e)};return C.current.addEventListener("click",e),I.current.addEventListener("click",i),()=>{C.current&&I.current&&(C.current.removeEventListener("click",e),I.current.removeEventListener("click",i))}}},[S,E]),(0,n.jsx)("div",{ref:h,onMouseMove:y,onClick:y,className:a()("douyin-player-playswitch",f),"data-state":"normal",style:p,children:(0,n.jsx)("div",{className:"douyin-player-icon",children:(0,n.jsxs)("div",{className:"douyin-player-playswitch-tab",children:[(0,n.jsx)("div",{"data-e2e":"video-switch-prev-arrow",className:a()("douyin-player-playswitch-prev",{disabled:l}),ref:C,children:(0,n.jsx)(g.z,{svg:(0,n.jsx)(v.Z,{}),needRenderInSSR:!0})}),(0,n.jsx)("div",{"data-e2e":"video-switch-next-arrow",className:a()("douyin-player-playswitch-next",{disabled:r}),ref:I,children:(0,n.jsx)(g.z,{svg:(0,n.jsx)(c.Z,{}),needRenderInSSR:!0})})]})})})},w=e=>{let i=(0,p.N)(),{removeSlideListButton:t}=(0,h.Iq)(e=>{let{removeSlideListButton:i}=e;return{removeSlideListButton:i}});return t?null:(0,n.jsx)(f.k,{componentName:"PlaySwitch",Slardar:i,children:(0,n.jsx)(y,(0,l._)({},e))})}},151884:function(e,i,t){t.d(i,{r:function(){return v}});var l=t(520739),n=t(563097);t(88648);var o=t(713097),r=t.n(o),a=t(699290),u=t(122788),d=t(205457);let s=e=>{let{children:i,style:t={},className:l}=e;return(0,n.jsx)("div",{className:r()(a.default.customPluginBottomWrapNew,null==l?void 0:l.bottom),style:t,children:i})},v=e=>{let i=(0,u.N)();return(0,n.jsx)(d.k,{componentName:"PositionBoxBottom",Slardar:i,children:(0,n.jsx)(s,(0,l._)({},e))})}},340501:function(e,i,t){let l;t.d(i,{n:function(){return w}});var n=t(520739);t(874386);var o=t(563097),r=t(88648),a=t(713097),u=t.n(a),d=t(629582),s=t(79307),v=t(161045),c=t(330746),_=t(903868),f=t(699290),m=t(860684),p=t(122788),g=t(205457);let h={isHideChangeGlobal:!1,newMiniAvatarGlobal:!1,newMiniFontSizeGlobal:!1,newMiniSpacingGlobal:!1,newMiniIconGlobal:!1,initializated:!1},y=e=>{let[i,t]=(0,r.useState)(!1),{children:a,awemeInfo:p,style:g={},className:y,from:w,isMiniWin:P=!1}=e,[C,I]=(0,r.useState)(null==h?void 0:h.newMiniIconGlobal),[S,E]=(0,r.useState)(null==h?void 0:h.newMiniAvatarGlobal),[T,L]=(0,r.useState)(null==h?void 0:h.newMiniFontSizeGlobal),[N,b]=(0,r.useState)(null==h?void 0:h.newMiniSpacingGlobal),[A,x]=(0,r.useState)(null==h?void 0:h.newMiniIconGlobal),D=(0,m.n)(),[k,R]=(0,r.useState)({}),M=(0,r.useRef)(),{isWebMiniWin:F}=(0,_.Iq)(e=>{let{isWebMiniWin:i}=e;return{isWebMiniWin:i}}),j=e=>{var i,t,l,n;if(null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)return;let{contentRect:o}=(null==e?void 0:e[0])||{},a=(null==o?void 0:o.height)||(null==D?void 0:null===(t=D.root)||void 0===t?void 0:t.offsetHeight)||(null===(n=M.current)||void 0===n?void 0:null===(l=n.parentNode)||void 0===l?void 0:l.offsetHeight);if(!a)return;let{MaxHeight:u,MiniAvatar:d,MiniText:v,MiniPadding:c,MiniIocn:_,OldHideChangeVideo:f}=s.nl;R({transformOrigin:"bottom",transform:`scale(${a>u?a/2/425:1})`});let m=72,p=a<f+72,g=a<=d+72,y=a<=v+72,w=a<=c+72,P=a<=_+72;(0,r.startTransition)(()=>{I(p),E(g),L(y),b(w),x(P)}),h={isHideChangeGlobal:p,newMiniAvatarGlobal:g,newMiniFontSizeGlobal:y,newMiniSpacingGlobal:w,newMiniIconGlobal:P,initializated:!0}};return(0,r.useEffect)(()=>{var e;let i=(null==D?void 0:D.root)||(null===(e=M.current)||void 0===e?void 0:e.parentNode);if(!(null==h?void 0:h.initializated)&&D&&j(i),i&&!P){let e=v.Z.bind(i,j);return()=>{e&&(null==e||e())}}},[D,P,w]),(0,r.useEffect)(()=>{if(void 0===l&&(l=(0,c.vU)()),l&&D)return D.on(d.FP.FULLSCREEN_CHANGE,t),()=>{D.off(d.FP.FULLSCREEN_CHANGE,t)}},[D]),(0,o.jsx)("div",{className:u()(f.default.customPluginRightWrap,null==y?void 0:y.right,"positionBox",{[f.default.isFireFox]:l&&!i&&(null==p?void 0:p.awemeType)!==68,[f.default.customPluginRightWrapMini]:F,hideChangeVideo:C,newMiniAvatar:S,newMiniFontSize:T,newMiniSpacing:N,newMiniIcon:A}),style:(0,n._)({},g,k),ref:M,children:a})},w=e=>{let i=(0,p.N)();return(0,o.jsx)(g.k,{componentName:"PositionBoxRight",Slardar:i,children:(0,o.jsx)(y,(0,n._)({},e))})}},274622:function(e,i,t){t.d(i,{I:function(){return y}});var l=t("520739"),n=t("563097"),o=t("88648"),r=t("128231"),a=t.n(r),u=t("877639"),d=t.n(u),s=t("782563"),v=t("32167"),c=t("488656"),_=t("914815"),f=t("844581"),m=t("205457"),p=t("860684"),g=t("122788");t("82463");let h=e=>{let i=(0,p.n)(),{isActive:t,awemeInfo:n,logParams:r}=e;return(0,o.useEffect)(()=>{var e,o,u,m,p,g,h;let y=(null===(e=navigator)||void 0===e?void 0:e.hardwareConcurrency)||0,w=!(0,s.tq)()||y>=8,P=(null==n?void 0:null===(o=n.video)||void 0===o?void 0:o.duration)>=18e4,C=e=>{var t,o,u,s,m;let{img_num:p,img_x_len:g,img_y_len:h,img_y_size:y,img_x_size:w}=(null==n?void 0:null===(o=n.video)||void 0===o?void 0:null===(t=o.bigThumbs)||void 0===t?void 0:t[0])||{},P=w/y;let C={thumbnail:{urls:e,pic_num:p,row:h,col:g,height:y,width:w},progresspreview:{width:P<1?68:90*P,height:P<1?68/P:90},chapters:(null===(m=(s=n).chapterInfo)||void 0===m?void 0:m.status)?(s.chapterInfo.list||[]).map(e=>{let{timestamp:i,desc:t}=e;return{timestamp:i,desc:t}}):[]},I=null==i?void 0:null===(u=i.plugins)||void 0===u?void 0:u.progress,S=a()(e=>{var i,t;f.Z.sendLog("progressPreview",(0,l._)({play_current_time:Math.floor(e||0),enter_from:(0,v.mo)(),enter_from_merge:(0,v.vM)(),enter_method:"hover",video_time:(0,c.n)(null==n?void 0:null===(i=n.video)||void 0===i?void 0:i.duration),chapter_index:(0,_.P)({awemeInfo:n,currentTime:e}),is_chapter_bar:(null==n?void 0:null===(t=n.chapterInfo)||void 0===t?void 0:t.status)?1:0,group_id:null==n?void 0:n.awemeId},r))},500),E=d()(e=>{let{currentTime:i}=e;S(i)},50),T=e=>{var i,t;let{currentTime:o}=e;f.Z.sendLog("progressPreview",(0,l._)({play_current_time:Math.floor(o||0),enter_from:(0,v.mo)(),enter_from_merge:(0,v.vM)(),enter_method:"click",video_time:(0,c.n)(null==n?void 0:null===(i=n.video)||void 0===i?void 0:i.duration),chapter_index:(0,_.P)({awemeInfo:n,currentTime:o}),is_chapter_bar:(null==n?void 0:null===(t=n.chapterInfo)||void 0===t?void 0:t.status)?1:0,group_id:null==n?void 0:n.awemeId},r))};return null==I||I.updateConfig(C),null==I||I.addCallBack("dragmove",E),null==I||I.addCallBack("click",T),()=>{null==I||I.updateConfig({thumbnail:{}}),null==I||I.removeCallBack("dragmove",E),null==I||I.removeCallBack("click",T)}},I=null==n?void 0:null===(m=n.video)||void 0===m?void 0:null===(u=m.bigThumbs)||void 0===u?void 0:u[0];if(w&&P&&i&&t&&I)return(null==I?void 0:null===(p=I.img_urls)||void 0===p?void 0:p.length)>0?C(null==I?void 0:I.img_urls):C(null==n?void 0:null===(h=n.video)||void 0===h?void 0:null===(g=h.bigThumbs)||void 0===g?void 0:g.map(e=>e.img_url))},[i,t,n,r]),null},y=e=>{let i=(0,g.N)();return(0,n.jsx)(m.k,{componentName:"ProgressPreview",Slardar:i,children:(0,n.jsx)(h,(0,l._)({},e))})}},844581:function(e,i,t){var l=t(544933);i.Z=new l.h({progressPreview:{eventName:"progress_preview",params:{enter_from:"",enter_method:"",video_time:0,enter_from_merge:"",tab_name:"",group_id:"",chapter_index:0,is_chapter_bar:0,play_current_time:0}},progressClick:{eventName:"progress_click",params:{position:0,enter_from:"",enter_from_merge:"",tab_name:"",group_id:"",click_method:"hot_key",rate:-1,action:"",is_small_window:"0",small_window_scene:"",chapter_index:0,is_chapter_bar:0,vduration:0,before_rate:0,if_continued_play:"",before_position:0,player_display_mode:"",play_current_time:0}},chapterContentShow:{eventName:"chapter_content_show",params:{enter_from_merge:"",enter_from:"",tab_name:"",group_id:"",chapter_num:0}},chapterContentClick:{eventName:"chapter_content_click",params:{enter_from_merge:"",enter_from:"",tab_name:"",group_id:"",chapter_num:0,chapter_index:0}},chapterContentExit:{eventName:"chapter_content_exit",params:{enter_from_merge:"",enter_from:"",tab_name:"",group_id:"",chapter_num:0,duration:0}}})},58764:function(e,i,t){t.d(i,{t:function(){return c},v:function(){return v}}),t(874386);var l=t(88648),n=t(629582),o=t(746864),r=t(782442),a=t(860684);let u=(e,i)=>(null==i?void 0:i.awemeType)!==o.e.Note&&(null==e?void 0:e.duration)>60&&(null==e?void 0:e.currentTime)>30&&(null==e?void 0:e.duration)-(null==e?void 0:e.currentTime)>=10,d=e=>{let{awemeId:i,time:t,maxLength:l,scene:n}=e,o={awemeId:i,time:t,recordTime:Date.now(),scene:n},a=(r.Le.getConfig(r.gI.PlayRecord)||[]).filter(e=>e.scene===n&&e.awemeId!==i);if(a.length>=l){let e=[...a.slice(1),o];r.Le.setConfig(r.gI.PlayRecord,e)}else{let e=[...a,o];r.Le.setConfig(r.gI.PlayRecord,e)}},s=e=>{let i=(r.Le.getConfig(r.gI.PlayRecord)||[]).filter(i=>i.awemeId!==e);r.Le.setConfig(r.gI.PlayRecord,i)},v=e=>{if("undefined"==typeof location)return 0;let i=(r.Le.getConfig(r.gI.PlayRecord)||[]).filter(i=>i.awemeId===e&&i.scene===location.pathname&&i.recordTime+864e5>Date.now());return i.length>0?i[0].time:0},c=e=>{let{awemeInfo:i,isActive:t,from:o}=e,c=(0,a.n)(),_=(0,l.useRef)(t),f=(0,l.useRef)(i.awemeId),m=(0,l.useRef)(i),p=(0,l.useRef)(c),g=(0,l.useRef)(t),h=(0,l.useRef)("");return m.current=i,p.current=c,g.current=t,(0,l.useEffect)(()=>{h.current=location.pathname},[]),(0,l.useEffect)(()=>{r.Le.getConfig(r.gI.PlayRecord)||r.Le.setConfig(r.gI.PlayRecord,[])},[]),(0,l.useEffect)(()=>{var e,l;let n=v(i.awemeId);c&&t&&n&&!(null==c?void 0:null===(l=c.config)||void 0===l?void 0:null===(e=l.baseConfig)||void 0===e?void 0:e.startTime)&&(c.seek(n),c.updateConfig({baseConfig:{startTime:n}}))},[i,c,t]),(0,l.useEffect)(()=>{let e=t!==_.current&&!t,l=t===_.current&&t&&i.awemeId!==f.current;(e||l)&&(u(c,i)?(d({awemeId:f.current,time:null==c?void 0:c.currentTime,maxLength:15,scene:h.current}),c.isPlaying=!1):v(null==i?void 0:i.awemeId)&&(null==c?void 0:c.currentTime)!==0&&s(f.current)),f.current=i.awemeId,_.current=t},[t,i,c]),(0,l.useEffect)(()=>{let e=()=>{let e=m.current,t=p.current,l=g.current||"searchPlayer"===o&&_.current;if(!!e&&!!t&&!!l)u(t,e)?(d({awemeId:e.awemeId,time:null==t?void 0:t.currentTime,maxLength:15,scene:h.current}),t.isPlaying=!1):v(null==i?void 0:i.awemeId)&&(null==c?void 0:c.currentTime)!==0&&s(f.current)};return null==c||c.on(n.FP.DESTROY,e),()=>{null==c||c.off(n.FP.DESTROY,e)}},[c,o]),null}},258153:function(e,i,t){t.d(i,{V:function(){return u}}),t(874386);var l=t(563097),n=t(88648),o=t(629582),r=t(38753),a=t(860684);let u=e=>{var i,t,u,d,s,v,c,_,f,m,p,g,h,y;let{awemeInfo:w,isActive:P}=e,[C,I]=(0,n.useState)(!1),S=(0,a.n)();return((0,n.useEffect)(()=>{var e,i;let t=()=>{var e,i,t,l;if((null==S?void 0:S.currentTime)>=(null==w?void 0:null===(i=w.seriesInfo)||void 0===i?void 0:null===(e=i.seriesIcp)||void 0===e?void 0:e.disappear_time_sec)&&P){I(!1);return}if((null==S?void 0:S.currentTime)>=(null==w?void 0:null===(l=w.seriesInfo)||void 0===l?void 0:null===(t=l.seriesIcp)||void 0===t?void 0:t.start_time_sec)&&P){I(!0);return}};if(S&&(null==w?void 0:null===(i=w.seriesInfo)||void 0===i?void 0:null===(e=i.seriesIcp)||void 0===e?void 0:e.icp_number))return S.on(o.FP.TIMEUPDATE,t),()=>{S.off(o.FP.TIMEUPDATE,t)}},[w,S,P]),(null==w?void 0:null===(t=w.seriesInfo)||void 0===t?void 0:null===(i=t.seriesIcp)||void 0===i?void 0:i.icp_number)&&C)?(0,l.jsx)("div",{className:r.default.container,style:{top:`${(null==w?void 0:null===(s=w.seriesInfo)||void 0===s?void 0:null===(d=s.seriesIcp)||void 0===d?void 0:null===(u=d.horizonal_pos)||void 0===u?void 0:u.y_pos)||16}px`,left:`${(null==w?void 0:null===(_=w.seriesInfo)||void 0===_?void 0:null===(c=_.seriesIcp)||void 0===c?void 0:null===(v=c.horizonal_pos)||void 0===v?void 0:v.x_pos)||16}px`,fontSize:(null==w?void 0:null===(m=w.seriesInfo)||void 0===m?void 0:null===(f=m.seriesIcp)||void 0===f?void 0:f.font_size)||"16px",color:(null==w?void 0:null===(g=w.seriesInfo)||void 0===g?void 0:null===(p=g.seriesIcp)||void 0===p?void 0:p.font_color)||"#fff"},children:null==w?void 0:null===(y=w.seriesInfo)||void 0===y?void 0:null===(h=y.seriesIcp)||void 0===h?void 0:h.icp_number}):null}},7185:function(e,i,t){t.d(i,{g:function(){return e_}});var l=t("134761"),n=t("520739"),o=t("878389");t("874386"),t("179133"),t("826893");var r=t("563097"),a=t("88648"),u=t("629582"),d=t("713097"),s=t.n(d),v=t("35730"),c=t("491362"),_=t("658065"),f=t("32167"),m=t("820303"),p=t("782442"),g=t("330746"),h=t("637005"),y=t("362555"),w=t("857078"),P=t("747909"),C=t("256229"),I=t("538710"),S=t("729075"),E=t("171087");let T=e=>{let{autoPlayInit:i,player:t,isActive:l,logFn:n}=e,[o,u]=(0,a.useState)(i),d=(0,a.useCallback)(()=>{n("auto_play");let e={switchBy:S.l7.Shortcut,logParams:{enter_method:"play_setting_panel"}};null==t||t.emit(E.C.UpdateAutoPlaySwitch,e),(0,C.hB)()},[t,n]);return(0,a.useEffect)(()=>{let e=()=>{u(e=>!e)};if(t&&l)return null==t||t.on(E.C.UpdateAutoPlaySwitch,e),()=>{null==t||t.off(E.C.UpdateAutoPlaySwitch,e)}},[t,l]),(0,r.jsxs)("div",{className:I.default.switchBox,children:[(0,r.jsx)("div",{className:I.default.switchLabel,children:"连播"}),(0,r.jsx)(P.Switch,{checked:o,onChange:d})]})},L=e=>{let{isOnInit:i,player:t,isActive:l,logFn:n}=e,[o,u]=(0,a.useState)(!!i),d=(0,a.useCallback)(()=>{null==t||t.emit(E.C.UpdateImmersiveSwitch,{logParams:{enter_method:"play_setting_panel"}}),(0,C.hB)(),n("pure_mode")},[t]);return(0,a.useEffect)(()=>{let e=()=>{u(e=>!e)};if(t&&l)return null==t||t.on(E.C.UpdateImmersiveSwitch,e),()=>{null==t||t.off(E.C.UpdateImmersiveSwitch,e)}},[t,l]),(0,r.jsxs)("div",{className:I.default.switchBox,children:[(0,r.jsx)("div",{className:I.default.switchLabel,children:"清屏"}),(0,r.jsx)(P.Switch,{checked:o,onChange:d})]})};var N=t("929582"),b=t("254897");let A=e=>{let{onChange:i,logFn:t}=e;return(0,r.jsxs)("div",{className:I.default.switchBox,onClick:()=>{null==i||i(),null==t||t("auto_play")},children:[(0,r.jsx)("div",{className:I.default.switchLabel,children:"连播"}),(0,r.jsx)("div",{className:I.default.select,children:(0,r.jsx)(b.z,{svg:(0,r.jsx)(N.Z,{className:"noTransform"}),className:"noTransform",style:{fontSize:"12px",display:"flex",alignItems:"center"}})})]})};var x=t("544933"),D=new x.h({clickHoverLogin:{eventName:"click_hover_login",params:{enter_method:"",enter_from:"",params_for_special:""}}}),k=t("407148");let R=(e,i,t)=>{let l=k.oY[t].find(i=>Number(i)===Number(e));return i&&void 0!==l?`${l}x`:"倍速"},M=e=>{let{playbackRate:i,hasSelect:t,onChange:l,disable:n,logFn:o,player:u,disableSpeed:d,setIsShowPlayBackRatio:v,speedType:c}=e,[f,m]=(0,a.useState)(i);return(0,a.useEffect)(()=>{if(u){let e=e=>{let{rate:i}=e;m(i)};return null==u||u.on(E.C.ChangePlayRate,e),()=>{null==u||u.off(E.C.ChangePlayRate,e)}}},[u]),(0,a.useEffect)(()=>{m(i)},[i]),(0,r.jsxs)("div",{className:s()(I.default.switchBox,{[I.default.disable]:n}),onClick:()=>{if(!n){if(d){D.sendLog("clickHoverLogin",{enter_method:"speed_up",enter_from:(0,_.yW)(),params_for_special:"uc_login"}),h.emit(h.EVENT.loginBlockKeyBoard,{speed:!0,callback:()=>{null==l||l(),null==o||o("speed"),setTimeout(()=>{v(!1)},3e3)}});return}null==l||l(),null==o||o("speed")}},children:[(0,r.jsx)("div",{className:I.default.switchLabel,children:"倍速"}),(0,r.jsx)("div",{className:I.default.select,children:!d||n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:n?"1.0x":R(f,t,c)}),(0,r.jsx)(b.z,{svg:(0,r.jsx)(N.Z,{className:"noTransform"}),className:"noTransform",style:{fontSize:"12px",display:"flex",alignItems:"center"}})]}):(0,r.jsx)(P.Button,{theme:"solid",className:I.default.loginBtn,children:"登录即享"})})]})};var F=t("873175");let j=e=>{let{onChange:i,logFn:t}=e,{currentState:[l]}=(0,F.Jy)(e);return(0,r.jsxs)("div",{className:I.default.switchBox,onClick:()=>{null==i||i(),null==t||t("clarity")},children:[(0,r.jsx)("div",{className:I.default.switchLabel,children:"清晰度"}),(0,r.jsxs)("div",{className:I.default.select,children:[(0,r.jsx)("div",{children:l}),(0,r.jsx)(b.z,{svg:(0,r.jsx)(N.Z,{className:"noTransform"}),className:"noTransform",style:{fontSize:"12px",display:"flex",alignItems:"center"}})]})]})};var O=t("410665"),U=t("97199"),V=t("349998"),H=new x.h({clarityNotifyShow:{eventName:"clarity_notify_show",params:{group_id:"",clarity:"",is_auto:1,gear_name:""}},clarityNotifyClick:{eventName:"clarity_notify_click",params:{group_id:"",action:"",clarity:"",is_auto:1,gear_name:""}},clarityCellShow:{eventName:"clarity_cell_show",params:{group_id:"",clarity:"",is_auto:1,gear_name:""}},clarityCellClick:{eventName:"clarity_cell_click",params:{group_id:"",action:"",clarity:"",is_auto:1,gear_name:"",enter_from_merge:"",enter_from:"",item_duration_ms:0,player_display_mode:""}},clarityBubbleShow:{eventName:"clarity_bubble_show",params:{group_id:"",clarity:"",is_auto:1,method:"",gear_name:""}}}),B=t("846844");let K=e=>{H.sendLog("clarityCellShow",(0,n._)({},e))},q=e=>{let{awemeInfo:i,onMouseLeave:t,player:l,userInfo:u,lists:d,indexSelected:v,setIndexSelected:c,setCurrentState:_}=e,f=(0,O.x)(K.bind(null,(0,o._)((0,n._)({group_id:null==i?void 0:i.awemeId},(0,V.t)()),{enter_method:"play_setting_panel"}))),m=(0,a.useCallback)(e=>{var i;null==l||l.emit(E.C.UpdateClarity,{item:e,logParams:{enter_method:"play_setting_panel"}}),c(e.key),null==_||_(e.label),null==t||t(),h.emit(null==h?void 0:null===(i=h.EVENT)||void 0===i?void 0:i.clarityRel,{exitInner:!0})},[l,t]);return(0,r.jsxs)("div",{ref:f,className:s()(B.default.panel,"clarityPanel",{[B.default.notLogin]:!(null==u?void 0:u.isLogin)}),children:[(0,r.jsxs)("div",{className:B.default.title,children:[(0,r.jsx)(b.z,{onClick:t,svg:(0,r.jsx)(U.Z,{}),style:{marginRight:"4px",fontSize:"12px",height:"12px"}}),(0,r.jsx)("span",{children:"清晰度"})]}),(0,r.jsx)("div",{className:B.default.virtual,children:null==d?void 0:d.map(e=>(0,r.jsx)("div",{className:s()(B.default.item,{[B.default.selected]:e.key===v}),onClick:()=>m(e),children:e.val},e.key))})]})};function G(e){let{player:i,ratio:t,awemeInfo:l,logParams:n,onMouseLeave:o,speedType:u}=e,[d,v]=(0,a.useState)(t),c=e=>{null==i||i.emit(E.C.UpdateRadio,{rate:e,click_method:"play_setting_panel"}),v(Number(e)),null==o||o()};return(0,a.useEffect)(()=>{if(i){let e=()=>{null==o||o()};return null==i||i.on(E.C.ChangePlayRate,e),()=>{null==i||i.off(E.C.ChangePlayRate,e)}}},[i]),(0,r.jsxs)("div",{className:B.default.panel,children:[(0,r.jsxs)("div",{className:s()(B.default.title,B.default.playRatioSettingTitle),children:[(0,r.jsx)(b.z,{onClick:o,svg:(0,r.jsx)(U.Z,{}),style:{marginRight:"4px",fontSize:"12px",height:"12px"}}),(0,r.jsx)("span",{children:"倍速"})]}),(0,r.jsx)("div",{className:B.default.virtual,children:k.oY[u].map(e=>(0,r.jsxs)("div",{className:s()(B.default.item,{[B.default.selected]:Number(d)===Number(e)}),onClick:()=>c(Number(e)),children:[e,"x"]},e))})]})}var Y=t("834669"),W=t("969911"),Q=t("502967"),z=t("473677");function Z(e){var i;let{player:t,onMouseLeave:l,awemeInfo:n}=e,o=(0,a.useRef)(!0),[u,d]=(0,Q.iu)({isSetLog:!0,awemeInfo:n,plugin:null==t?void 0:null===(i=t.getPlugin)||void 0===i?void 0:i.call(t,W.p7.InnerAutoPlayPlugin),defaultModeRef:o}),v=e=>{null==t||t.emit(E.C.UpdateAutoPlay,{index:e,logParams:{enter_method:"play_setting_panel"}}),d(e),null==l||l()};return(0,r.jsxs)("div",{className:Y.default.panel,children:[(0,r.jsxs)("div",{className:Y.default.title,children:[(0,r.jsx)(b.z,{onClick:l,svg:(0,r.jsx)(U.Z,{}),style:{marginRight:"4px",fontSize:"12px",height:"12px"}}),(0,r.jsx)("span",{children:"连播"})]}),(0,r.jsx)("div",{className:Y.default.virtual,children:Q.zQ.map((e,i)=>(0,r.jsxs)("div",{className:s()(Y.default.innerItem,{[Y.default.selected]:i===u}),onClick:()=>v(i),children:[(0,r.jsx)(z.Z,{width:24,height:24,viewBox:"0 0 24 24",src:Q.zf[i],onMouseEnter:()=>{}}),(0,r.jsx)("span",{children:e})]},e))})]})}var $=new x.h({playSettingPanelShow:{eventName:"play_setting_panel_show",params:{enter_from_merge:"",enter_from:""}},playSettingPanelClick:{eventName:"play_setting_panel_click",params:{enter_from_merge:"",enter_from:"",click_position:""}},playSettingIconShow:{eventName:"play_setting_icon_show",params:{enter_from_merge:"",enter_from:"",icon:""}}}),J=t("890256"),X=t("860684"),ee=t("122788"),ei=t("205457"),et=t("573879"),el=t("102642"),en=t("356650"),eo=t("755964"),er=t("69921");let ea=new Map([[W.QG.AutoPlayer,e=>(0,r.jsx)(T,(0,n._)({},e))],[W.QG.Clear,e=>(0,r.jsx)(L,(0,n._)({},e))],[W.QG.InnerAutoPlayer,e=>(0,r.jsx)(A,(0,n._)({},e))],[W.QG.PlayBackRatio,e=>(0,r.jsx)(M,(0,n._)({},e))],[W.QG.FakeScreen,e=>(0,r.jsx)(j,(0,n._)({},e))],[W.QG.WatchLater,e=>(0,r.jsx)(J.n,(0,o._)((0,n._)({},e),{isMini:!0}))]]),eu=()=>{$.sendLog("playSettingPanelShow",{enter_from_merge:(0,_.yW)(),enter_from:(0,f.vM)()})},ed=e=>{$.sendLog("playSettingPanelClick",{enter_from_merge:(0,_.yW)(),enter_from:(0,f.vM)(),click_position:e})},es=e=>{var i,t,l,u,d,_,f,P,C,I,S,E,T,L,N,A,x,D,k,R;let{hideList:M,awemeInfo:j,player:O,isActive:U,userInfo:V,dispatch:H,abtestData:B,isAdAweme:K,search33PxUnify:Y}=e,[Q,z]=(0,a.useState)(!0),[$,J]=(0,a.useState)(!1),[X,ee]=(0,a.useState)(!1),[ei,el]=(0,a.useState)(!1),es=(0,a.useRef)(!1),ev=(0,a.useRef)(null),ec=(0,a.useRef)(null),e_=new Map([[W.QG.AutoPlayer,{autoPlayInit:(null===(t=O.getPlugin(W.p7.AutoPlaySettingPlugin))||void 0===t?void 0:null===(i=t._config)||void 0===i?void 0:i.nextAutoPlay)||!1,player:O,isActive:U,logFn:ed}],[W.QG.Clear,{isOnInit:(null===(u=O.getPlugin(et.Yd.pluginName))||void 0===u?void 0:null===(l=u.config)||void 0===l?void 0:l.isOn)||!1,player:O,isActive:U,logFn:ed}],[W.QG.InnerAutoPlayer,{onChange:()=>{z(!0),el(!0)},logFn:ed}],[W.QG.PlayBackRatio,{onChange:()=>{z(!0),ee(!0)},setIsShowPlayBackRatio:ee,hasSelect:null!==(0,m.G)(v.SessionStorageKeys.PlayerPlaybackratio),playbackRate:(0,m.G)(v.SessionStorageKeys.PlayerPlaybackratio)||1,disable:K,logFn:ed,player:O,disableSpeed:p.Le.getConfig(p.gI.disableSpeed),speedType:(0,g.G6)()?c.$.Safari:c.$.Normal}],[W.QG.FakeScreen,{onChange:()=>{z(!0),J(!0)},userInfo:V,abtestData:B,awemeInfo:j,currentDefinition:null==O?void 0:null===(f=O.getPlugin)||void 0===f?void 0:null===(_=f.call(O,W.p7.BitrateSelector))||void 0===_?void 0:null===(d=_.curBitRate)||void 0===d?void 0:d.definition,userSelectDefinition:null==O?void 0:null===(I=O.config)||void 0===I?void 0:null===(C=I.shared)||void 0===C?void 0:null===(P=C.definition)||void 0===P?void 0:P.userSelectDefinition,userSelectUpdate:null==O?void 0:null===(E=O.config)||void 0===E?void 0:null===(S=E.shared)||void 0===S?void 0:S.userSelectUpdate,logFn:ed,player:O}],[W.QG.WatchLater,{player:O,isActive:U,logFn:ed,awemeInfo:j,loginDispatch:H,isLogin:null==V?void 0:V.isLogin}]]),ef=(0,a.useCallback)(e=>{var i,t,l;if(!e.target.closest(".semi-portal"))clearTimeout(ec.current),((null==e?void 0:e.target)===(null==ev?void 0:ev.current)||(null==ev?void 0:null===(i=ev.current)||void 0===i?void 0:i.contains(null==e?void 0:e.target))||(null==e?void 0:e.target)===(null==O?void 0:null===(l=O.root)||void 0===l?void 0:null===(t=l.querySelector)||void 0===t?void 0:t.call(l,".setting-icon")))&&(z(!1),eu()),!es.current&&(h.emit(h.EVENT.videoStopPlayNext),es.current=!0)},[]);(0,a.useEffect)(()=>()=>h.emit(h.EVENT.videoRemoveStopPlayNext),[]);let em=(0,en.zJ)(j),{indexSelectedState:[ep,eg],lists:eh,swichStatus:ey,currentState:[ew,eP]}=(0,F.Jy)(e),eC=-1!==M.findIndex(e=>e[0]===W.QG.FakeScreen),eI=(0,a.useRef)(null);return(0,r.jsxs)("div",{className:w.default.container,onMouseEnter:ef,ref:ev,onMouseLeave:()=>{ec.current=setTimeout(()=>{z(!0)},300),J(!1),ee(!1),el(!1),h.emit(h.EVENT.videoRemoveStopPlayNext),es.current=!1},children:[Q?null:(0,r.jsx)("div",{className:s()(w.default.panel,"semi-always-dark",{[w.default.search]:Y}),children:M.map(e=>{let i=ea.get(e[0]),t=e_.get(e[0]);return null==i?void 0:i((0,o._)((0,n._)({},t),{key:e[0]}))})}),$&&(0,r.jsx)(q,{awemeInfo:j,userInfo:V,onMouseLeave:()=>{z(!1),J(!1),z(!0)},dispatch:H,player:O,isActive:U,currentDefinition:null==O?void 0:null===(N=O.getPlugin)||void 0===N?void 0:null===(L=N.call(O,W.p7.BitrateSelector))||void 0===L?void 0:null===(T=L.curBitRate)||void 0===T?void 0:T.definition,userSelectDefinition:null==O?void 0:null===(D=O.config)||void 0===D?void 0:null===(x=D.shared)||void 0===x?void 0:null===(A=x.definition)||void 0===A?void 0:A.userSelectDefinition,abtestData:B,userSelectUpdate:null==O?void 0:null===(R=O.config)||void 0===R?void 0:null===(k=R.shared)||void 0===k?void 0:k.userSelectUpdate,lists:eh,indexSelected:ep,setIndexSelected:eg,setCurrentState:eP}),X&&(0,r.jsx)(G,{player:O,ratio:(0,m.G)(v.SessionStorageKeys.PlayerPlaybackratio)||1,awemeInfo:j,logParams:{},onMouseLeave:()=>{z(!1),ee(!1),z(!0)},speedType:(0,g.G6)()?c.$.Safari:c.$.Normal}),ei&&!em&&(0,r.jsx)(Z,{onMouseLeave:()=>{z(!1),el(!1)},player:O,isActive:U,awemeInfo:j}),(0,r.jsx)(eo.A,{visible:ey!==er.N.Off&&eC,current:ew,swichStatus:ey,getPopupContainer:()=>eI.current,children:(0,r.jsx)("div",{className:w.default.iconContainer,ref:eI,children:(0,r.jsx)(b.z,{svg:(0,r.jsx)(y.Z,{className:"noTransform"}),className:"setting-icon"})})})]})};class ev extends u.di{afterPlayerInit(){this.renderRoot()}beforeDestroy(){(0,el.v)(this)}renderRoot(){this.el&&(0,el.s)(this,(0,r.jsx)(es,(0,n._)({},this._config)))}render(){return'<dy-icon class="douyin-player-setting-list" data-state="normal"></dy-icon>'}}(0,l._)(ev,"pluginName",W.p7.SettingListPlugin);let ec=e=>{let{awemeInfo:i,hideList:t,userInfo:l}=e,r=(0,X.n)(),d={position:u.PZ.CONTROL_RIGHT,index:10,className:"douyin-player-setting-list"};return(0,a.useEffect)(()=>{if(r)return r.registerPlugin(ev,(0,n._)((0,o._)((0,n._)({},e),{player:r}),d)),()=>{if(!r.destroyed)r.getPlugin(W.p7.SettingListPlugin)&&r.unRegisterPlugin(W.p7.SettingListPlugin)}},[r,i,t,l]),null},e_=e=>{let i=(0,ee.N)();return(0,r.jsx)(ei.k,{componentName:"SettingListPlugin",Slardar:i,children:(0,r.jsx)(ec,(0,n._)({},e))})}},798626:function(e,i,t){t.d(i,{n:function(){return P}});var l=t("520739"),n=t("878389"),o=t("563097"),r=t("88648"),a=t("713097"),u=t.n(a),d=t("629582"),s=t("410665"),v=t("702726"),c=t("28237"),_=t("7305"),f=t("656454");t("874386");var m=t("860684"),p={SingleLine:0,0:"SingleLine",TowLine:1,1:"TowLine"},g=t("122788"),h=t("473677"),y=t("205457");let w=e=>{var i,t,a;let{awemeInfo:g,onClick:y,isActive:w,className:P,onMouseEnter:C,onMouseLeave:I}=e,{displayState:S}=function(e){let{awemeInfo:i,isActive:t}=e,l=(0,m.n)(),n=(0,r.useRef)(!0),o=(0,r.useRef)(!1),[a,u]=(0,r.useState)(0),s=(0,r.useCallback)(()=>{if(!o.current){var e,i;null==l||null===(e=l.on)||void 0===e||e.call(l,d.FP.TIMEUPDATE,_),null==l||null===(i=l.on)||void 0===i||i.call(l,d.FP.SEEKING,f)}o.current=!0},[l]),v=(0,r.useCallback)(()=>{if(o.current){var e,i;null==l||null===(e=l.off)||void 0===e||e.call(l,d.FP.TIMEUPDATE,_),null==l||null===(i=l.off)||void 0===i||i.call(l,d.FP.SEEKING,f)}o.current=!1},[l]),c=(0,r.useCallback)(()=>{n.current=!0},[]),_=(0,r.useCallback)(e=>{let{currentTime:i}=e||{};i>=16&&(n.current=!1,u(1),v())},[l,i,v]),f=(0,r.useCallback)(()=>{(null==l?void 0:l.currentTime)>=16&&(u(1),v()),n.current=!1},[v,l]),p=(0,r.useCallback)(()=>{u(1),c(),s()},[s,c]);return(0,r.useEffect)(()=>{if(p&&l)return null==l||l.on(d.FP.ENDED,p),()=>{null==l||l.off(d.FP.ENDED,p)}},[p,l]),(0,r.useEffect)(()=>{c()},[t,c]),(0,r.useEffect)(()=>{u(0),c()},[i.awemeId,c]),(0,r.useEffect)(()=>{if(!!t){if(l&&n.current)return s(),()=>{v()}}},[l,i,t,s,v]),(0,r.useEffect)(()=>{(null==l?void 0:l.currentTime)&&_({currentTime:l.currentTime})},[l]),{displayState:a}}({isActive:w,awemeInfo:g}),E=(null==g?void 0:null===(t=g.anchorInfo)||void 0===t?void 0:null===(i=t.extra)||void 0===i?void 0:i[0])||{},T=(0,m.n)(),L=(0,s.x)(()=>{v.logInstance.sendLog("productEntranceShow",(0,n._)((0,l._)({},(0,c.R)(g)),{ecom_entrance_form:"video_cart_tag",if_qianchuan_ad:0}))}),N=(null==E?void 0:E.tags)||[],b=S===p.TowLine&&N.length>0;return(0,o.jsx)("div",{className:u()("douyin-player-shop-anchor",f.default.container,f.default.shopAnchor,{[f.default.more]:b},P),onClick:()=>{null==y||y(),null==T||T.emit(d.FP.USER_ACTION,{action:"shop_anchor_click"}),v.logInstance.sendLog("productEntranceClick",(0,n._)((0,l._)({},(0,c.R)(g)),{ecom_entrance_form:"video_cart_tag",if_qianchuan_ad:0}))},onMouseEnter:()=>{null==C||C()},onMouseLeave:()=>{null==I||I()},ref:L,children:(0,o.jsxs)("div",{className:f.default.subContainer,children:[(0,o.jsx)(h.Z,{src:_.Z,className:f.default.icon,width:20,height:20,viewBox:"0 0 20 20"}),(0,o.jsxs)("div",{className:f.default.desc,children:[(0,o.jsxs)("div",{className:f.default.firstLine,children:[null==g?void 0:null===(a=g.anchorInfo)||void 0===a?void 0:a.titleTag,(null==E?void 0:E.elastic_title)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:f.default.delimiter,children:" | "})," ",null==E?void 0:E.elastic_title]})]}),b&&(0,o.jsx)("div",{className:f.default.secondLine,children:N.map((e,i)=>(0,o.jsxs)("span",{className:f.default.towLineItem,children:[e," ",i<N.length-1&&(0,o.jsxs)(o.Fragment,{children:[" ",(0,o.jsx)("span",{className:f.default.delimiter,children:" | "})]})]},e))})]})]})})},P=e=>{let i=(0,g.N)();return(0,o.jsx)(y.k,{componentName:"ShopAnchor",Slardar:i,children:(0,o.jsx)(w,(0,l._)({},e))})}},132905:function(e,i,t){t.d(i,{q:function(){return en}});var l=t("520739"),n=t("878389");t("874386"),t("338172"),t("250440");var o=t("563097"),r=t("88648"),a=t("713097"),u=t.n(a),d=t("629582"),s=t("567754"),v=t("17750"),c=t("746864"),_=t("788418"),f=t("122691"),m=t("102337"),p=t("256277"),g=t("325982"),h=t("371260"),y=t("14108"),w=t("367366"),P=t("176638"),C=t("637005"),I=t("658065"),S=t("32167"),E=t("555106"),T=t("945977"),L=t("702726"),N=t("35730"),b=t("598116"),A=t("77172");let x=e=>{let{player:i,showContextMenu:t,awemeInfo:l,hideContextMenu:n,containerStatus:o}=e;(0,r.useEffect)(()=>{if(i){var e;let l=(0,A.H)(i),o=e=>{var l,n;(null==i?void 0:null===(n=i.video)||void 0===n?void 0:null===(l=n.parentElement)||void 0===l?void 0:l.contains(null==e?void 0:e.target))&&t(e)};return null===(e=i.root)||void 0===e||e.addEventListener("contextmenu",o,!0),null==l||l.addEventListener("contextmenu",t),document.addEventListener("click",n,!0),()=>{var e;null===(e=i.root)||void 0===e||e.removeEventListener("contextmenu",o,!0),document.removeEventListener("click",n,!0),null==l||l.removeEventListener("contextmenu",t)}}},[i,l,t]),(0,r.useEffect)(()=>{if(o)return o.addEventListener("contextmenu",t),()=>{o.removeEventListener("contextmenu",t)}},[o,t])};var D=t("368200");t("779788"),t("268917"),t("950331");var k=t("146914"),R=t("547189"),M=t("100928"),F=t("842517"),j=t("919780"),O=t("408749"),U=t("782442"),V=t("782563"),H=t("687297"),B=t("801849"),K=t("734017"),q=t("929582"),G=t("642793"),Y=t("906499"),W=t("456128"),Q=t("171087"),z=t("254897");let Z=e=>{var i;return!((null!==(i=(0,E.$o)(e))&&void 0!==i?i:0)>0)&&!0},$=e=>{let{shortcut:i,emitEvent:t,position:a,showEnterDetail:u,setIsShow:d,awemeInfo:v,userInfo:w,modalEnterFrom:P,abtestData:S,showRecommendToFriend:E=!1}=e,L=(0,r.useMemo)(()=>{if(v){var e,i;let t=v.awemeType!==c.e.Note&&v.awemeType!==c.e.XgVideo,l=null==v?void 0:null===(e=v.download)||void 0===e?void 0:e.allowDownload,n=(null===(i=v.status)||void 0===i?void 0:i.reviewStatus)===1,o=(0,p.Jt)(v);return t&&l&&!n&&!o}return!1},[v]),A=(0,r.useMemo)(()=>{if(!v)return"";let e={},i=(0,K.zD)();if(null==v?void 0:v.logParams){let t=v.logParams,{enter_from:l,previous_page:n,tab_name:o}=t,r=(0,D._)(t,["enter_from","previous_page","tab_name"]);o&&(i=o),e[R.LOG_PASS_THROW_PARAMS]=JSON.stringify(r)}let t="";switch(v.awemeType){case c.e.Note:t=(0,y.Wr)(v.awemeId,(0,s.stringify)((0,l._)({tab_name:i,previous_page:(0,I.yW)()},(0,O.U)(),e)));break;case c.e.XgVideo:t=(0,y.Tl)({videoid:null==v?void 0:v.awemeId});break;default:let n="";if("search"===P)n=M.VideoDetailModeFrom.SearchResult;else if("hot"===P){n=M.VideoDetailModeFrom.HotDetail;let i=null==v?void 0:v.hotList;e.trending_topic=null==i?void 0:i.sentence,e.sentenceId=null==i?void 0:i.sentenceId,e.position=null==i?void 0:i.rank,e.hotValue=null==i?void 0:i.hotScore}if(t=(0,y.JF)(v.awemeId,(0,s.stringify)((0,l._)({tab_name:i,modeFrom:n,previous_page:(0,I.yW)()},(0,O.U)(),e))),["userLike","userPost","userCollection"].includes(P)){var o;let e=null===(o=U.Le.getConfig(U.gI.EnterDetailUrl))||void 0===o?void 0:o[v.awemeId];e&&(t=e)}}return t},[v,P]),x=(0,r.useMemo)(()=>{var e,o,r,u,d,s,c;return[{text:"清屏",key:null===(e=i.immersivePlayer)||void 0===e?void 0:e.badgeText,handler:()=>t(Q.C.UpdateImmersiveSwitch,{logParams:{enter_method:"long_press"}})},{text:"评论",key:null===(o=i.comment)||void 0===o?void 0:o.badgeText,handler:()=>t(Q.C.ShowComment)},{text:"赞",key:null===(r=i.like)||void 0===r?void 0:r.badgeText,handler:e=>t(Q.C.OnStar,{event:(0,n._)((0,l._)({},e),{offsetX:a.x,offsetY:a.y}),clickMethod:"mouse"})},{text:"进入作者主页",key:null===(u=i.avatar)||void 0===u?void 0:u.badgeText,handler:()=>t(Q.C.Avatar)},...(null==v?void 0:null===(d=v.status)||void 0===d?void 0:d.allowSelfRecommendToFriend)&&E?[{text:"推荐给朋友",key:null===(s=i.recommend)||void 0===s?void 0:s.badgeText,handler:()=>t(Q.C.MenuRecommend)}]:[],{text:"分享",key:null===(c=i.share)||void 0===c?void 0:c.badgeText,handler:()=>t(Q.C.ShowShareCode,{clickMethod:"mouse"})}].filter(e=>e.key)},[t,a,i]),Z=(0,r.useMemo)(()=>{var e;let i=(0,V.DT)(),t=null!==(e=(0,V.FJ)().awemePcClient)&&void 0!==e?e:"";return i&&t&&(0,H.y)(t,">=","3.7.1")&&L},[S,L]),$=(0,r.useMemo)(()=>(0,G.T)(),[]),J=(0,r.useMemo)(()=>{var e,l;let n=[{text:"不感兴趣",key:i.dislike.badgeText,handler:()=>t(Q.C.Dislike)},{text:"意见反馈",handler:()=>t(Q.C.Feedback)}];return(null==v?void 0:null===(e=v.authorInfo)||void 0===e?void 0:e.uid)!==(null==w?void 0:null===(l=w.info)||void 0===l?void 0:l.uid)&&!(0,p.Kf)(v)&&n.push({text:"举报",handler:()=>t(Q.C.ShowReportModal)}),Z&&n.push({text:"下载视频",handler:()=>t(Q.C.DownloadVideo)}),$&&n.push({text:"独立窗口显示",useRedDot:!0,redDotKey:N.LocalStorageKeys.MultiWindowMenuListRedDot,handler:()=>t(Q.C.CreateMultitaskingWindow,A)}),n},[t,v,i,Z,w]),X=(0,r.useMemo)(()=>{if(!v)return"";let e={},i=(0,K.zD)();if(null==v?void 0:v.logParams){let t=v.logParams,{enter_from:l,previous_page:n,tab_name:o}=t,r=(0,D._)(t,["enter_from","previous_page","tab_name"]);o&&(i=o),e[R.LOG_PASS_THROW_PARAMS]=JSON.stringify(r)}let t="";switch(v.awemeType){case c.e.Note:t=(0,y.Wr)(v.awemeId,(0,s.stringify)((0,l._)({tab_name:i,previous_page:(0,I.yW)()},(0,O.U)(),e)));break;case c.e.XgVideo:t=(0,y.Tl)({videoid:null==v?void 0:v.awemeId});break;default:let n="";if("search"===P)n=M.VideoDetailModeFrom.SearchResult;else if("hot"===P){n=M.VideoDetailModeFrom.HotDetail;let i=null==v?void 0:v.hotList;e.trending_topic=null==i?void 0:i.sentence,e.sentenceId=null==i?void 0:i.sentenceId,e.position=null==i?void 0:i.rank,e.hotValue=null==i?void 0:i.hotScore}if(t=(0,y.JF)(v.awemeId,(0,s.stringify)((0,l._)({tab_name:i,modeFrom:n,previous_page:(0,I.yW)()},(0,O.U)(),e))),["userLike","userPost","userCollection"].includes(P)){var o;let e=null===(o=U.Le.getConfig(U.gI.EnterDetailUrl))||void 0===o?void 0:o[v.awemeId];e&&(t=e)}}return t},[v,P]),ee=(0,r.useCallback)(e=>{(0,B.$)(S)?(e.preventDefault(),C.emit(C.EVENT.changeRoute,{to:X})):t(Q.C.EnterDetail)},[X,t,S]),ei=(0,r.useMemo)(()=>[{component:(0,o.jsx)(Y.a,{href:X,target:"_blank",className:b.default.enterDetail,rel:"opener",onClick:ee,children:"进入详情页"},"enterDetail"),handler:()=>t(Q.C.EnterDetail)}],[ee,X,t]),et=(0,r.useMemo)(()=>[...x,...J,...u?ei:[]],[x,J,u,ei]);return{menuList:et,adMenuList:(0,r.useMemo)(()=>{let e=[{text:"不感兴趣",handler:()=>t(Q.C.Dislike)},{text:"喜欢该广告",handler:()=>t(Q.C.AdLike)},{text:"举报",handler:()=>t(Q.C.AdReport)},{text:"为什么看到广告",handler:()=>t(Q.C.AdIntroduce)}];if((0,f.L)(v)||(0,m.u)(v)||(0,_.A)(v)||(0,h.o4)(v)){let i=(0,F.rQ)(v);e.unshift({component:(0,o.jsxs)("div",{className:b.default.viewAdDetail,children:[(0,o.jsxs)("div",{className:b.default.innerContainer,onClick:e=>{C.emit(C.EVENT.openAdSideCard);let i=(0,p.Rx)(v);(0,g.E)("realtime_click",{tag:(0,T.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:"feedback"}),d(!1)},children:[(0,o.jsx)(W.Q,{src:(null==i?void 0:i.image_url)||j.DEFAULT_AD_IMAGE_URL,iconHeight:28,iconWidth:28,className:b.default.adIcon}),(0,o.jsxs)("div",{className:b.default.word,children:[(0,o.jsx)("span",{children:i.button_text||"查看详情"}),(0,o.jsx)(z.z,{svg:(0,o.jsx)(q.Z,{style:{fontSize:"12px",height:"12px",width:"12px"}}),className:b.default.icon})]})]}),(0,o.jsx)(k.i,{className:b.default.divider})]})})}return e},[t,v,d])}};var J=t("860684"),X=t("122788"),ee=t("205457"),ei=t("527965"),et=t("966648");let el=e=>{let{isActive:i=!1,shortcutDisable:t,shortcutInclude:a,shortcutExclude:A,awemeInfo:D,shortCutFiltered:k=[],showEnterDetail:R=!1,showAdMenu:M=!1,modalEnterFrom:F,userInfo:j,abtestData:O,directJumpToUser:U,showRecommendToFriend:V=!1}=e,H=(0,J.n)(),{awemeId:B}=D||{},[K,q]=(0,r.useState)(!1),[G,W]=(0,r.useState)({x:0,y:0}),[z,X]=(0,r.useState)(null),ee=(0,r.useRef)(null),{isShortcutListShow:el}=(0,et.y)({isNoPlayer:!0,isLogin:null==j?void 0:j.isLogin}),en=(0,r.useMemo)(()=>v.getShortcut({disable:t,include:a,exclude:A}),[t,a,A,el]),eo=e=>{var i;if(!(e&&(null===(i=ee.current)||void 0===i?void 0:i.contains(e.target))))q(!1)},er=(0,r.useCallback)(()=>{var e,i;let t=(null==D?void 0:D.awemeType)===c.e.XgVideo?(0,y.GN)(null==D?void 0:null===(e=D.authorInfo)||void 0===e?void 0:e.uid):(0,y.HC)(null==D?void 0:null===(i=D.authorInfo)||void 0===i?void 0:i.secUid,(0,s.stringify)({is_full_screen:(0,w.r)()?"1":"0",enter_method:"video_title",from_gid:D.groupId,vid:null==D?void 0:D.awemeId}));window.open(t,(0,P.f)()?"_self":"_blank","noopener")},[D]),ea=(0,r.useCallback)(function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e===Q.C.Feedback&&C.emit(C.EVENT.showFeedback),e===Q.C.MenuRecommend&&H.emit(d.FP.USER_ACTION,{action:"recommend",source:"menu_list"}),e===Q.C.EnterDetail&&C.emit(C.EVENT.videoPause),e===Q.C.ShowComment&&"video_detail"===(0,I.yW)()&&!(0,w.r)()&&C.emit(C.EVENT.commentFocus),e===Q.C.DownloadVideo&&(C.emit(C.EVENT.downloadVideo,D),L.logInstance.sendLog("download",{enter_from:(0,S.mo)(),enter_from_merge:(0,S.vM)(),group_id:null==D?void 0:D.awemeId,click_from:"right_click",boost_task_id:(null==D?void 0:D.boostTaskId)||""})),e===Q.C.CreateMultitaskingWindow){let e=i;"string"==typeof e&&e.startsWith("//")?e=`https:${i}`:"string"==typeof e&&e.startsWith("/video")&&(e=`https://www.douyin.com${i}`),(0,E.qQ)(N.LocalStorageKeys.MultiWindowMenuListRedDot,1),(0,ei.handleCreateMultitaskWindow)(O,e,"right_click_menu",!0)}U&&e===Q.C.Avatar?er():null==H||H.emit(e,i),q(!1)},[H,D,er,O,U]);(0,r.useEffect)(()=>{if(U&&H)return H.on(Q.C.Avatar,er),()=>{H.off(Q.C.Avatar,er)}},[er,H,U]);let{menuList:eu,adMenuList:ed}=$({shortcut:en,emitEvent:ea,position:G,showEnterDetail:R,setIsShow:q,awemeInfo:D,userInfo:j,modalEnterFrom:F,abtestData:O,showRecommendToFriend:V}),es=(0,r.useMemo)(()=>(M?ed:eu).filter(e=>!k.includes(e.key)),[M,ed,eu,k]),ev=e=>{switch(!0){case!!e.link:return(0,r.createElement)(Y.a,(0,n._)((0,l._)({},e.link),{className:b.default.itemText,key:e.text}),e.text);case!!e.component:return e.component;default:return(0,o.jsxs)("div",{className:b.default.contextMenuItem,onClick:e.handler,children:[(0,o.jsx)("div",{className:b.default.itemText,children:e.text}),e.key&&(0,o.jsxs)("div",{className:b.default.itemTip,children:["（",e.key,"）"]}),e.useRedDot&&Z(e.redDotKey)&&(0,o.jsx)("div",{className:u()(b.default.itemRedDotBox,{[b.default.itemMarginLeft]:!e.key}),children:(0,o.jsx)("div",{className:b.default.itemRedDot})})]},e.text)}};(0,r.useEffect)(()=>{eo()},[B,i]),(0,r.useEffect)(()=>{null==H||H.on(d.FP.FULLSCREEN_CHANGE,eo);let e=C.listen(C.EVENT.pageFullScreen,()=>{eo()});return()=>{null==H||H.off(d.FP.FULLSCREEN_CHANGE,eo),null==e||e()}},[H]);let ec=(0,r.useCallback)(e=>{e.preventDefault();let{width:i,height:t,left:l,right:n,top:o,bottom:r}=H.root.getBoundingClientRect();if(ee.current&&ee.current.contains(e.target))return;let a=ee.current?ee.current.clientWidth:224,u=ee.current?ee.current.clientHeight:26*es.length+32-6,d=(null==e?void 0:e.clientX)+a>n?(null==e?void 0:e.clientX)-a-l:(null==e?void 0:e.clientX)-l;if(W({x:d,y:(null==e?void 0:e.clientY)+u>r?(null==e?void 0:e.clientY)-u-o:(null==e?void 0:e.clientY)-o}),q(!0),(0,_.A)(D)||(0,f.L)(D)||(0,m.u)(D)){let e=(0,p.Rx)(D);(0,g.E)("othershow",{tag:(0,T.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback"})}},[H,D,ee,es]);return x({player:H,showContextMenu:ec,awemeInfo:D,hideContextMenu:eo,containerStatus:z}),K?(0,o.jsx)("div",{className:b.default.container,ref:X,children:(0,o.jsx)("div",{className:u()(b.default.contextMenuContainer,{[b.default.isAd]:(0,_.A)(D)||(0,h.o4)(D)||(0,f.L)(D)||(0,m.u)(D)}),style:{top:G.y,left:G.x},ref:ee,children:es.map(e=>ev(e))})}):null},en=e=>{let i=(0,X.N)();return(0,o.jsx)(ee.k,{componentName:"MenuList",Slardar:i,children:(0,o.jsx)(el,(0,l._)({},e))})}},432695:function(e,i,t){t.d(i,{I:function(){return w},V:function(){return h}});var l=t(134761),n=t(520739);t(602157);var o=t(563097),r=t(629582),a=t(88648),u=t(747909),d=t(948375),s=t(428647),v=t(291773),c=t(637005),_=t(841249),f=t(254897),m=t(860684),p=t(969911);let g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.useRef)(e);return(0,a.useEffect)(()=>{i.current=e},[e]),i};function h(e){let{onOpen:i,onClose:t,description:l}=e,n=(0,d.Z)(t);return(0,a.useEffect)(()=>{c.emit(c.EVENT.closeOtherTip,"SoundGuideTooltip")},[]),(0,a.useEffect)(()=>{let e=c.listen(c.EVENT.closeOtherTip,e=>{"SoundGuideTooltip"!==e&&(null==n||n())});return()=>e()},[t]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:_.default.item,children:[(0,o.jsx)("span",{className:_.default.text,children:l}),(0,o.jsx)(u.Button,{type:"primary",size:"small",theme:"solid",onClick:i,className:_.default.button,children:"打开声音"}),(0,o.jsx)(f.z,{svg:(0,o.jsx)(s.Z,{}),onClick:t,className:_.default.close}),(0,o.jsx)(f.z,{svg:(0,o.jsx)(v.Z,{}),className:_.default.down})]})})}class y extends r.di{afterPlayerInit(){if(this._config.disable)return}render(){return'<dy-icon class="douyin-player-sound-guide" data-state="normal"></dy-icon>'}}(0,l._)(y,"pluginName",p.p7.SoundGuideTooltipPlugin);let w=e=>{let{isActive:i,disable:t,logParams:l}=e,o=(0,m.n)(),u=g(l),d={position:r.PZ.CONTROL_RIGHT,index:.99,className:"douyin-player-sound-guide"};return(0,a.useEffect)(()=>{if(o)return o.registerPlugin(y,(0,n._)({disable:t,isActive:i,player:o,logParams:u.current},d)),()=>{if(!o.destroyed)o.getPlugin(p.p7.SoundGuideTooltipPlugin)&&o.unRegisterPlugin(p.p7.SoundGuideTooltipPlugin)}},[o,i,t]),(0,a.useEffect)(()=>{if(o)return o.registerPlugin(y,(0,n._)({disable:t,isActive:!0,player:o,logParams:u.current},d)),()=>{if(!o.destroyed)o.getPlugin(p.p7.SoundGuideTooltipPlugin)&&o.unRegisterPlugin(p.p7.SoundGuideTooltipPlugin)}},[o,t]),null}},120458:function(e,i,t){t.d(i,{P:function(){return f}});var l=t(520739),n=t(563097),o=t(88648),r=t(79307),a=t(189370),u=t(648557),d=t(860684),s=t(122788),v=t(205457),c=t(969911);let _=e=>{let{isActive:i,awemeInfo:t,abtestData:l}=e,n=(0,d.n)(),s=(0,o.useRef)(t||null);return(0,o.useEffect)(()=>{var e,o;if(n&&t&&s.current&&(null==t?void 0:t.awemeId)!==(null===(e=s.current)||void 0===e?void 0:e.awemeId)){!i&&n.pause();let e=(0,u.i)({awemeInfo:t,abtestData:l,enableDash:!0,scene:r.lT.Recommend});null===(o=n.playNext)||void 0===o||o.call(n,e),n.updatePluginConfig(c.p7.PlayClaritySettingPlugin,{awemeInfo:t}),n.crossOrigin=(0,a.S)(t)?"use-credentials":"anonymous"}s.current=t},[n,i,t.awemeId,l]),null},f=e=>{let i=(0,s.N)();return(0,n.jsx)(v.k,{componentName:"VideoSrcChange",Slardar:i,children:(0,n.jsx)(_,(0,l._)({},e))})}},686207:function(e,i,t){t.d(i,{g:function(){return w}});var l=t(520739);t(250440);var n=t(563097),o=t(88648),r=t(629582),a=t(870105),u=t(35730),d=t(637005),s=t(555106),v=t(860684),c=t(122788),_=t(516599),f=t(205457),m=t(962820),p=t(171087),g=t(969911);let h=e=>{let{isActive:i,abtestData:t}=e,l=(0,v.n)(),n=(0,a.U)();return(0,o.useEffect)(()=>{if(l&&i){let e=()=>{if(null==l?void 0:l.video){let{volume:e,autoplayMuted:i}=(0,m.J)(t);l.video.volume=e,l.video.muted=i}};e();let i=d.listen(d.EVENT.syncInteraction,e);return()=>{i()}}},[l,i,t,n]),(0,o.useEffect)(()=>{if(i&&l){let e=e=>{((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume")&&setTimeout(()=>{(0,m.c)({isUserMute:!0===l.muted||0===l.volume,isMute:l.muted,volume:l.volume}),(0,s.qQ)(u.LocalStorageKeys.PLAYER_VOLUME,l.volume),(0,s.qQ)(u.LocalStorageKeys.PLAYER_IS_MUTE,l.muted?1:0)})};return l.on(r.FP.USER_ACTION,e),()=>{l.off(r.FP.USER_ACTION,e)}}},[l,t,i]),(0,o.useEffect)(()=>{if(i&&l){let e=e=>{("volumeDown"===e.action||"volumeUp"===e.action)&&setTimeout(()=>{(0,m.c)({isUserMute:0===l.volume,isMute:l.muted,volume:l.volume})})};return l.on(p.C.CustomShortCut,e),()=>{l.off(p.C.CustomShortCut,e)}}},[l,t,i]),null},y=e=>{let{isActive:i,scene:t="",toast:l}=e,n=(0,v.n)();return(0,o.useEffect)(()=>{if(n&&i){let e=setTimeout(()=>{var e,i,t;n.muted=!0,n.volume=0,n.musicMute=!0,null===(t=n.plugins)||void 0===t||null===(i=t.volume)||void 0===i||null===(e=i.updateConfig)||void 0===e||e.call(i,{disabled:!0})});return()=>{var i,t,l;clearTimeout(e),n.musicMute=!1,null===(l=n.plugins)||void 0===l||null===(t=l.volume)||void 0===t||null===(i=t.updateConfig)||void 0===i||i.call(t,{disabled:!1})}}},[n,i]),(0,o.useEffect)(()=>{if(n&&i&&["modal","detail"].includes(t)){if(l){l("该声音不可用");return}_.F.info("该声音不可用")}},[n,i,t]),null},w=e=>{var i,t;let r=(0,c.N)(),{awemeInfo:a,isActive:u}=e,d=(0,v.n)();return((0,o.useEffect)(()=>{if(d&&u){var e,i,t;let l=null==d?void 0:null===(i=d.root)||void 0===i?void 0:null===(e=i.querySelector)||void 0===e?void 0:e.call(i,".douyin-player-volume"),n=()=>{d.emit(p.C.IconMouseleave,{pluginName:g.p7.Volume})};return null==l||null===(t=l.addEventListener)||void 0===t||t.call(l,"mouseleave",n),()=>{var e;null==l||null===(e=l.removeEventListener)||void 0===e||e.call(l,"mouseleave",n)}}},[d,u]),null==a?void 0:null===(t=a.status)||void 0===t?void 0:null===(i=t.videoMute)||void 0===i?void 0:i.isMute)?(0,n.jsx)(y,(0,l._)({},e)):(0,n.jsx)(f.k,{componentName:"VolumePlugin",Slardar:r,children:(0,n.jsx)(h,(0,l._)({},e))})}},279023:function(e,i,t){t.d(i,{k:function(){return v}});var l=t(520739),n=t(563097),o=t(88648),r=t(860684),a=t(122788),u=t(171087),d=t(205457);let s=e=>{let{isActive:i,onVolumeShortCutChange:t}=e,l=(0,r.n)();return(0,o.useEffect)(()=>{let e=e=>{t(e)};if(i&&l){var n;null===(n=l.on)||void 0===n||n.call(l,u.C.CustomShortCut,e)}return()=>{var i;null==l||null===(i=l.off)||void 0===i||i.call(l,u.C.CustomShortCut,e)}},[l,i,t]),null},v=e=>{let i=(0,a.N)();return(0,n.jsx)(d.k,{componentName:"VolumeShortCutPlugin",Slardar:i,children:(0,n.jsx)(s,(0,l._)({},e))})}},941725:function(e,i,t){t.d(i,{b:function(){return g}});var l=t(520739);t(777180),t(897860),t(250440);var n=t(563097),o=t(88648),r=t(629582),a=t(782442),u=t(860684),d=t(122788),s=t(205457),v=t(171087),c=t(531471);function _(e){let{click_method:i,player:t}=e;null==t||t.emit(r.FP.USER_ACTION,{action:"change_volume",logData:{click_method:i,is_mute:t.muted?"1":"0"},props:{volume:{to:t.volume}}})}let f=(e,i)=>{if(!e)return;if(e.muted){e.muted=!1,e.volume="up"===i?.05:0,_({click_method:"keyboard",player:e});return}let t="up"===i?e.volume+.05:e.volume-.05;t=Math.max(t=Math.min(t,1),0),e.volume=Number(t.toFixed(2)),0===t&&(e.muted=!0),_({click_method:"keyboard",player:e})},m=(e,i)=>{if(!e)return;if(e.muted){e.muted=!1,e.volume=Math.max(i/100,0),_({click_method:"wheel",player:e});return}let t=e.volume+i/100;t=Math.max(t=Math.min(t,1),0),e.volume=Number(t.toFixed(2)),0===t&&(e.muted=!0),_({click_method:"wheel",player:e})},p=e=>{let{isActive:i,currentPlayer:t}=e,l=(0,u.n)(),n=t||l;return(0,o.useEffect)(()=>{if(n&&i){var e,t;let i=null==n?void 0:null===(t=n.root)||void 0===t?void 0:null===(e=t.querySelector)||void 0===e?void 0:e.call(t,".douyin-player-volume");if(!i)return;let l=e=>{let i=(0,c.G1)();e.stopPropagation(),e.preventDefault();let t=(i?1:-1)*parseInt(String(e.deltaY/20),10);0!==t&&m(n,t)},o=e=>{a.Le.getConfig(a.gI.DisableNextPre)&&([38,40].includes(e.keyCode)&&(e.stopPropagation(),e.preventDefault()),38===e.keyCode?(f(n,"up"),null==n||n.emit(v.C.CustomShortCut,{action:"volumeUp"})):40===e.keyCode&&(f(n,"down"),null==n||n.emit(v.C.CustomShortCut,{action:"volumeDown"})))},r=()=>{a.Le.setConfig(a.gI.DisableNextPre,!0)},u=()=>{a.Le.setConfig(a.gI.DisableNextPre,!1)};return i.addEventListener("wheel",l),i.addEventListener("mouseover",r),i.addEventListener("mouseout",u),document.addEventListener("keydown",o),()=>{i.removeEventListener("wheel",l),i.removeEventListener("mouseover",r),i.removeEventListener("mouseout",u),document.removeEventListener("keydown",o)}}},[n,i]),(0,o.useEffect)(()=>()=>{a.Le.setConfig(a.gI.DisableNextPre,!1)},[]),(0,o.useEffect)(()=>{let e=e=>{var i,t;let l=null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.tagName;if("INPUT"!==l&&"TEXTAREA"!==l&&(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.contentEditable)!=="true")e.shiftKey&&((null==e?void 0:e.code)==="Equal"||(null==e?void 0:e.code)==="Minus")&&("Equal"===e.code?(f(n,"up"),null==n||n.emit(v.C.CustomShortCut,{action:"volumeUp"})):"Minus"===e.code&&(f(n,"down"),null==n||n.emit(v.C.CustomShortCut,{action:"volumeDown"})))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[n]),null},g=e=>{let i=(0,d.N)();return(0,n.jsx)(s.k,{componentName:"VolumePlugin",Slardar:i,children:(0,n.jsx)(p,(0,l._)({},e))})}},890256:function(e,i,t){t.d(i,{v:function(){return q},n:function(){return H}});var l=t("134761"),n=t("520739"),o=t("878389");t("250440"),t("874386");var r=t("563097"),a=t("629582"),u=t("88648"),d=t("713097"),s=t.n(d),v=t("747909"),c=t("597334"),_=t("17750"),f=t("32167"),m=t("150566"),p=t("782442"),g=t("637005"),h=t("658065"),y=t("667557"),w=t("734017"),P=t("39579"),C=t("892821"),I=t("474160"),S=t("674779"),E=t("538710"),T=t("516599"),L=t("358003"),N=t("205457");t("832747");var b=t("860684"),A=t("122788"),x=t("102642"),D=t("252376"),k=t("544933"),R=new k.h({watchLaterAdd:{eventName:"watch_later_add",params:{enter_from:"",enter_from_merge:"",group_id:"",author_id:"",tab_name:"",search_params:{search_id:"",search_result_id:""},status:0,failure_reason:"",click_method:"",if_first_big_card:0}},clickHoverLogin:{eventName:"click_hover_login",params:{enter_method:"",enter_from:"",params_for_special:""}}}),M=t("171087"),F=t("969911");function j(e){let{disableShortcut:i=!1}=e;return(0,r.jsxs)("div",{className:"douyin-playerTips",children:[(0,r.jsx)("span",{children:"稍后再看"}),!i&&!!(null==_?void 0:_.SHORTCUT_KEY.watchLater.badgeText)&&(0,r.jsx)("span",{className:"shortcutKey",children:null==_?void 0:_.SHORTCUT_KEY.watchLater.badgeText})]})}let O=e=>{var i,t,l;return{group_id:null!==(t=null==e?void 0:e.awemeId)&&void 0!==t?t:"",author_id:null!==(l=null==e?void 0:null===(i=e.authorInfo)||void 0===i?void 0:i.uid)&&void 0!==l?l:""}},U=e=>({enter_from_merge:(null==e?void 0:e.enter_from_merge)||"",enter_from:(null==e?void 0:e.enter_from)||(0,f.mo)()||"",tab_name:(null==e?void 0:e.tab_name)||(0,w.zD)()||(0,m.Rs)("tab_name")||"",search_params:(null==e?void 0:e.search_params)||{},player_display_mode:(0,f.Ok)()}),V=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,u.useRef)(e);return(0,u.useEffect)(()=>{i.current=e},[e]),i};function H(e){let{player:i,isLogin:t,loginDispatch:l,isActive:d,awemeInfo:_,isMini:f,isPreview:m,toast:y,disableShortcut:w,logParams:N,abtest:b}=e,A=(0,D.H)("watch_later"),{isMobile:x,isiPad:k}=(0,c.X)(),F=(0,u.useRef)(null),H=(0,u.useRef)(null),B=(0,u.useCallback)(e=>"function"==typeof y?y(e):T.F.info(e),[y]),K=V(N),q=(0,u.useCallback)(async e=>{var i,t,l,r,a;let u={DUPLICATE:"已添加过该视频",SUCCESS:"添加成功，可在“我的-稍后再看”中查看",FAIL:"添加失败，请稍后再试",OFFLINE:"网络异常，请稍后再试",MAX_LIMIT:"已达上限"},{list:d=""}=null!==(t=p.Le.getConfig(p.gI.WatchLater))&&void 0!==t?t:{};if(_.watchLaterInfo||d.includes(_.awemeId)){B(u.DUPLICATE),R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},O(_),U(K.current)),{click_method:e,status:0}));return}if(!navigator.onLine){B(u.OFFLINE),R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},U(K.current),O(_)),{click_method:e,status:0}));return}let{statusCode:s=-1}=await (0,I.ih)({actionType:1,itemToPlayinfo:{[_.awemeId]:{play_duration:0,loop_status:null!==(l=null==_?void 0:null===(i=_.playProgress)||void 0===i?void 0:i.watch_times)&&void 0!==l?l:0}}});if(0===s){B(u.SUCCESS);let i=null!==(r=p.Le.getConfig(p.gI.WatchLater))&&void 0!==r?r:{},t=null!==(a=i.list)&&void 0!==a?a:"";p.Le.setConfig(p.gI.WatchLater,(0,o._)((0,n._)({},i),{list:`${t}${t?",":""}${_.awemeId}`})),R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},U(K.current),O(_)),{click_method:e,status:1}));return}if(4===s){B(u.MAX_LIMIT),R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},O(_),U(K.current)),{failure_reason:"overlimit",click_method:e,status:0}));return}B(u.FAIL),R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},U(K.current),O(_)),{click_method:e,status:0}))},[_]),G=(0,u.useRef)(!1),Y=(0,u.useCallback)(async e=>{G.current=!1,(0,L.default)({headerText:"登录后可添加稍后再看",success:async()=>{G.current=!0,null==l||l({type:"updateUserInfo"}),q(e)},enterMethod:"watch_later_add",onClose:()=>{g.emit(g.EVENT.videoRemoveStopPlayNext),!G.current&&(G.current=!0,R.sendLog("watchLaterAdd",(0,o._)((0,n._)({},U(K.current),O(_)),{failure_reason:"not_login",click_method:e,status:0})))}})},[q,l,_,b]),W=(0,u.useCallback)(async e=>{let{clickMethod:n="icon"}=e||{};if(!!d&&!!_&&!F.current&&(!!(null==i?void 0:i.isUserActive)||!!m))null==i||i.emit(a.FP.USER_ACTION,{action:"click_view_later"}),F.current=setTimeout(()=>{F.current&&(F.current=null)},3e3),t?q(n):(null==l||l({type:"updateUserInfo"}),Y(n))},[l,Y,q,t,d,_,i]);return((0,u.useEffect)(()=>()=>{clearTimeout(F.current)},[]),(0,u.useEffect)(()=>d&&i&&!w?(null==i||i.on(M.C.OnWatchLater,W),()=>{null==i||i.off(M.C.OnWatchLater,W)}):()=>{},[i,d,W,w]),m)?(0,r.jsx)("div",{className:S.default.preview,onClick:e=>{e.stopPropagation(),e.preventDefault(),W({clickMethod:`${(0,h.yW)()}_preview`})},children:(0,r.jsx)(v.Tooltip,{position:"bottomRight",content:(0,r.jsx)("div",{className:S.default.text,children:"添加到稍后再看"}),getPopupContainer:()=>H.current||document.body,children:(0,r.jsx)("div",{ref:H,style:{position:"relative"},children:(0,r.jsx)(C.Z,{width:24,height:24,className:S.default.newIcon})})})}):f?(0,r.jsxs)("div",{className:E.default.switchBox,onClick:e=>W({clickMethod:"icon"}),children:[(0,r.jsx)("div",{className:E.default.switchLabel,children:"稍后再看"}),(0,r.jsxs)("div",{className:s()(E.default.select,E.default.textSelect),children:["添加",(0,r.jsx)(P.Z,{className:"noTransform"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:A,className:"douyin-player-watch-later-item douyin-player-icon",onClick:e=>W({clickMethod:"icon"}),children:(0,r.jsx)(C.Z,{width:32,height:32,className:S.default.newIcon})}),!x&&!k&&(0,r.jsx)(j,{disableShortcut:w})]})}class B extends a.di{afterPlayerInit(){if(!this._config.disable)this.renderRoot(),this.el.addEventListener("mouseenter",this.onMouseenter),this.el.addEventListener("mouseleave",this.onMouseleave)}beforeDestroy(){this.el.removeEventListener("mouseenter",this.onMouseenter),this.el.removeEventListener("mouseleave",this.onMouseleave),(0,x.v)(this)}renderRoot(){var e;let i=null!==(e=this._config)&&void 0!==e?e:{};this.el&&(0,x.s)(this,(0,r.jsx)(H,(0,n._)({},i)))}configDidUpdate(){this.renderRoot()}render(){return'<dy-icon class="douyin-player-watch-later" data-state="normal"></dy-icon>'}constructor(...e){super(...e),(0,l._)(this,"onMouseleave",()=>{this._player.emit(M.C.IconMouseleave,{pluginName:F.p7.WatchLaterPlugin})}),(0,l._)(this,"onMouseenter",()=>{this._player.emit(M.C.IconMouseenter,{pluginName:F.p7.WatchLaterPlugin})})}}(0,l._)(B,"pluginName",F.p7.WatchLaterPlugin);let K=e=>{let{awemeInfo:i,isActive:t,disable:l,loginDispatch:o,isLogin:r,toast:d,disableShortcut:s,logParams:v,abtest:c}=e,_=(0,b.n)(),f=V(v),m={position:a.PZ.CONTROL_RIGHT,index:5.6,className:"douyin-player-watch-later"};return(0,u.useEffect)(()=>{if(_&&(0,y.D)(i)&&!(null==c?void 0:c.advanceLoad))return _.registerPlugin(B,(0,n._)({disable:l,loginDispatch:o,isActive:t,awemeInfo:i,isLogin:r,player:_,toast:d,disableShortcut:s,logParams:f.current,abtest:c},m)),()=>{if(!_.destroyed)_.getPlugin(F.p7.WatchLaterPlugin)&&_.unRegisterPlugin(F.p7.WatchLaterPlugin)}},[_,i,c]),(0,u.useEffect)(()=>{_&&_.updatePluginConfig(F.p7.WatchLaterPlugin,{isActive:null!=c&&!!c.advanceLoad||t,awemeInfo:i,loginDispatch:o,disable:l,isLogin:r,toast:d,disableShortcut:s,abtest:c,player:_})},[_,t,i,o,l,r,d,s,c]),(0,u.useEffect)(()=>{if(_&&(0,y.D)(i)&&(null==c?void 0:c.advanceLoad))return _.registerPlugin(B,(0,n._)({disable:l,loginDispatch:o,isActive:!0,awemeInfo:i,isLogin:r,player:_,toast:d,disableShortcut:s,logParams:f.current,abtest:c},m)),()=>{if(!_.destroyed)_.getPlugin(F.p7.WatchLaterPlugin)&&_.unRegisterPlugin(F.p7.WatchLaterPlugin)}},[_,i,o,l,r,d,s,c]),null},q=e=>{let i=(0,A.N)();return(0,r.jsx)(N.k,{componentName:"WatchLater",Slardar:i,children:(0,r.jsx)(K,(0,n._)({},e))})}},653208:function(e,i,t){t.d(i,{On:function(){return w},ad:function(){return E},OS:function(){return S},Xo:function(){return P},pK:function(){return C},w:function(){return y}}),t("250440");var l=t("35730"),n=t("823685"),o=t("782563"),r=t("555106"),a=t("381266"),u=t("668598"),d=t("726406");t("527785");var s=t("702726"),v=t("330746"),c=t("820303"),_=t("32167"),f=t("782442"),m=t("383212");let p=e=>{var i,t,n,o,a,u;if((0,v.G6)())return(null!==(a=(0,c.G)(l.SessionStorageKeys.DecodeError))&&void 0!==a?a:0)>=2;if(!(0,v.un)()||(null==e?void 0:null===(i=e.newPlayerConfig)||void 0===i?void 0:i.enableEdgeHevcAll))return!1;if((0,v.un)()&&(0,v.Lq)().browser_version<"124.0.0.0")return!0;if(null==e?void 0:null===(t=e.newPlayerConfig)||void 0===t?void 0:t.enableEdgeHevcRecent)return!1;let d=(0,r.$o)(l.LocalStorageKeys.IsSupportHevc);if(!d||d.has_detect&&!1===d.is_support||3>(0,m.G)())return!0;let p=null!==(u=(0,r.$o)(l.LocalStorageKeys.FrameInfoList))&&void 0!==u?u:[],g=p.filter(e=>0===e.isH265),h=p.filter(e=>1===e.isH265);if(h.length>=2&&h.every(e=>0===e.total))return s.logInstance.sendLog("hevcFrameList",{type:"fail",h264_list:g,h265_list:h,enter_from:(0,_.vM)()}),(0,r.qQ)(l.LocalStorageKeys.IsSupportHevc,{has_detect:!0,is_support:!1,pure_support:!0,type:"fail"}),!0;let y=g.filter(e=>e.total>20),w=h.filter(e=>e.total>20),P=y.reduce((e,i)=>e+i.rate,0)/y.length,C=w.reduce((e,i)=>e+i.rate,0)/w.length,I=(null===(o=f.Le.getConfig(f.gI.AbtestData))||void 0===o?void 0:null===(n=o.newPlayerConfig)||void 0===n?void 0:n.edgeThreshold)||10;return!!(w.length>=2)&&!!(C-P>=I)&&(s.logInstance.sendLog("hevcFrameList",{type:"drop",h264_list:g,h265_list:h,h264_drop:P,h265_drop:C,enter_from:(0,_.vM)()}),(0,r.qQ)(l.LocalStorageKeys.IsSupportHevc,{has_detect:!0,is_support:!1,pure_support:!0,type:"drop"}),!0)},g=e=>{var i,t,l;let{awemeInfo:r,abtestData:a}=e;return!!(0,o.DT)()&&(!!((null==r?void 0:null===(l=r.video)||void 0===l?void 0:null===(t=l.bitRateList)||void 0===t?void 0:null===(i=t.some)||void 0===i?void 0:i.call(t,e=>2===e.isH265))&&(0,d.Yk)())&&(null==a?void 0:a.useClientH266)===n.UseClientH266.On||!1)};var h=t("996503");let y=e=>{var i,t,d,s;if((0,o.DT)()||p(null==e?void 0:e.abtestData))return!1;let{awemeInfo:v,abtestData:c}=e;return((null==c?!void 0:!c.noStartedDowngrade)||!!(null===(i=(0,r.$o)(l.LocalStorageKeys.IsSupportHevc))||void 0===i?void 0:i.pure_support))&&(!!((null==v?void 0:null===(s=v.video)||void 0===s?void 0:null===(d=s.bitRateList)||void 0===d?void 0:null===(t=d.some)||void 0===t?void 0:t.call(d,e=>1===e.isH265))&&(null==c?void 0:c.use265HardParse)===n.Use265HardParse.On&&(0,a.E)())&&!(0,u.p)()||!1)},w=e=>{var i,t;let{awemeInfo:l}=e;if(!(0,o.DT)()||!(null==l?void 0:null===(i=l.video)||void 0===i?void 0:i.bitRateList.some(e=>1===e.isH265))||!(0,d.Ko)())return!1;let n=null===(t=navigator)||void 0===t?void 0:t.hardwareConcurrency;if(n&&n>=8)return!0;if((0,d._u)())return!0;if((0,d.b4)())return!1;if(n<=4)return!1;else return!0},P=e=>{var i,t,l,n;let{player:o}=e;if(null==o?void 0:null===(i=o.curDefinition)||void 0===i?void 0:i.isH265)return(null==o?void 0:null===(n=o.src)||void 0===n?void 0:null===(l=n.includes)||void 0===l?void 0:l.call(n,"downgrade_264"))?0:1;return(null==o?void 0:null===(t=o.curDefinition)||void 0===t?void 0:t.isH265)===0?0:w(e)||(0,h.if)(e)?1:0},C=e=>{let{player:i}=e;return(null==i?void 0:i.curDefinition)?!(2!==i.curDefinition.isH265):!!g(e)||!1},I=e=>{var i,t,l;let{player:n}=e;return(null==n?void 0:null===(i=n.curDefinition)||void 0===i?void 0:i.isH265)&&(null==n?void 0:null===(l=n.src)||void 0===l?void 0:null===(t=l.includes)||void 0===t?void 0:t.call(l,"downgrade_264"))?1:0},S=e=>(0,o.DT)()||1!==I(e)?0:1,E=e=>(0,o.DT)()&&1===I(e)?1:0},851563:function(e,i,t){t.d(i,{A:function(){return l}});let l={PLAYER_CREATE:"PLAYER_CREATE"}},631841:function(e,i,t){t.d(i,{K:function(){return l}});function l(e){var i,t;if(null==e?void 0:null===(t=e.plugins)||void 0===t?void 0:null===(i=t.keyboard)||void 0===i?void 0:i.keyCodeMap){let i=e.plugins.keyboard.keyCodeMap||{},t={};return Object.keys(i).forEach(e=>{i[e]&&(t[e]=i[e].disable,i[e].disable=!0)}),()=>{var i,l;let n=(null==e?void 0:null===(l=e.plugins)||void 0===l?void 0:null===(i=l.keyboard)||void 0===i?void 0:i.keyCodeMap)||{};n&&Object.keys(n).forEach(e=>{n[e]&&(n[e].disable=t[e])})}}}},504426:function(e,i,t){t.d(i,{G:function(){return o},o:function(){return n}}),t(675373),t(268917);var l=t(88648);let n={START:"beforePlayer",END:"afterPlayer",CHILDREN:"children"},o=e=>{let i={[n.START]:[],[n.END]:[],[n.CHILDREN]:[]};return l.Children.toArray(e).forEach(e=>{var t;let l=null==e?void 0:null===(t=e.props)||void 0===t?void 0:t.slot;l===n.START?i[n.START].push(e):l===n.END?i[n.END].push(e):i[n.CHILDREN].push(e)}),{SLIDES:i}}},303587:function(e,i,t){t.d(i,{d:function(){return $}}),t("874386"),t("268917"),t("429532");var l=t("746864"),n=t("520739");t("413806"),t("826893"),t("250440");var o=t("567754"),r=t("907831"),a=t.n(r),u=t("358354");let d=e=>{let{url:i="",target:t}=e,l=i;try{let[e,r]=i.split("?");if(i.includes("/aweme/v1/play")&&r){let i=(0,o.parse)(r);l=`${e}?${(0,o.stringify)((0,n._)({},i,(0,u.F)({target:t})))}`}}catch(e){}return l},s=e=>{let i=a()(e),{video:t}=i,{playApi:l,playApiH265:n,playAddr:o,playAddrH265:r}=t;return l&&(i.video.playApi=d({url:l,target:null==i?void 0:i.awemeId})),n&&(i.video.playApiH265=d({url:n,target:null==i?void 0:i.awemeId})),Array.isArray(o)&&o.forEach(e=>{e.src=d({url:e.src,target:null==i?void 0:i.awemeId})}),Array.isArray(r)&&r.forEach(e=>{e.src=d({url:e.src,target:null==i?void 0:i.awemeId})}),i};var v=t("35730"),c=t("820303");let _=e=>{var i,t,l,n,o;let{awemeInfo:r}=e,a=(null==r?void 0:null===(i=r.video)||void 0===i?void 0:i.bitRateList)||[],u=null===(t=(0,c.G)(v.SessionStorageKeys.manualSwitch))||void 0===t?void 0:t.gearType;return 20===u&&!(null==a?void 0:null===(l=a.find)||void 0===l?void 0:l.call(a,e=>"adapt_lowest_4_1"===e.gearName))&&(u=(null==a?void 0:null===(o=a.find)||void 0===o?void 0:o.call(a,e=>"adapt_lowest_1440_1"===e.gearName))?10:1),10===u&&!(null==a?void 0:null===(n=a.find)||void 0===n?void 0:n.call(a,e=>"adapt_lowest_1440_1"===e.gearName))&&(u=1),u};var f=t("782563"),m=t("782442"),p=t("399796"),g=t("375944"),h=t("726406"),y=t("555106"),w=t("356650");let P=e=>{var i;let t={open:!0,openAdaptRange:!0,timeout:3e3,removeBufferLen:60,removeBufferWhenSeekInBuffer:!1,replayReset:!1,waitingInBufferTimeOut:5e3,maxBufferLength:30,useProgressiveAppend:!0,useProgressiveAppendAll:!0,videoDuration:24e4,usePCDNProgressiveCheck:!0,resetStateUpdrade:!0,useSeparationMode:!0,useCDNProgressiveCheck:!1,loader:{loaderCount:1,onProcessMinLen:0,enableDynamicMinLen:!1},dashPcdnConfig:{openPCDN:!0,adaptPCDNConfig:{PCDNBufferControl:!0}},dashAdaptRangeConfig:null};(0,f.DT)()&&(t.dashAdaptRangeConfig={adaptRange:{rangeControl:!0,targetCacheControl:!0,rangeMaxDuration:20,rangeMinDuration:5,rangeMinSize:409600,safeFactor:.1,cacheSafeFactor:5,minDangerThreshold:6,estPlayTime:12,minBandwidth:1e6,estPTcontrol:!0,minTargetCacheDur:40,maxTargetCacheDur:60}});let l={},n=null==e?void 0:null===(i=e.dashConfigServer)||void 0===i?void 0:i.applySide;return n&&("web"!==n||(0,f.DT)())?"client"===n&&(0,f.DT)()&&(l=null==e?void 0:e.dashConfigServer):l=null==e?void 0:e.dashConfigServer,Object.assign({},t,null==e?void 0:e.dashConfig,l,m.Le.getConfig(m.gI.IsMainland)?{}:{dashPcdnConfig:{openPCDN:!1}})},C=p.Q.getItem({sKey:v.CookieKeys.isDashUser}),I=e=>{var i,t,l,n;let{abtestData:o,awemeInfo:r}=e;if((0,g.O)()||(!(0,h.Ko)()||!(0,f.DT)()&&!(null===(i=(0,y.$o)(v.LocalStorageKeys.IsSupportHevc))||void 0===i?void 0:i.pure_support))&&((null==o?void 0:null===(l=o.useH264Dash)||void 0===l?void 0:l.enable)!==!0||(null==o?void 0:null===(n=o.useH264Dash)||void 0===n?void 0:n.pathname)&&!1===location.pathname.includes(o.useH264Dash.pathname)))return!1;!C&&p.Q.setItem(v.CookieKeys.isDashUser,1);let a=P(o),u=null==a?void 0:a.videoDuration;return(null==a?!!void 0:!!a.open)&&!!((null==r?void 0:null===(t=r.video)||void 0===t?void 0:t.duration)>=u)&&!(0,w.Ni)(r)||!1};var S=t("44216");let E=e=>{let{bitrateList:i,abtestData:t,userselection:l,disableBitrateFilter:n}=e;return(null==t?void 0:t.manualFilter)&&(l||n)?i:i.filter(e=>1!==e.manualOnly)};var T=t("734123");let L=()=>T.Sniffer.isHdrSupported()&&(0,h._u)(),N=e=>{let{bitrateList:i,abtestData:t,userselection:l,disableBitrateFilter:n}=e,o=i.filter(e=>!e.HDRBit);if((null==t?void 0:t.hasHDR)===1&&L()){if(l||n){let e=i.filter(e=>72===e.qualityType&&e.HDRBit);if(e.length>0)return o.concat(e)}}else if((null==t?void 0:t.hasHDR)===2&&L()){let e=i.filter(e=>72===e.qualityType&&e.HDRBit);if(e.length>0)return o.concat(e)}return o},b={"-2":["adapt_lowest_4_1"],"-1":["adapt_lowest_1440_1"],1:["adapt_lowest_1080_1","normal_1080_0"],2:["adapt_lowest_720_2","adapt_lowest_720_1","low_720_0","normal_720_0"],3:["adapt_540_2","adapt_540_1","normal_540_0","adapt_lower_540_2","adapt_lowest_540_2","adapt_lower_540_1","adapt_lowest_540_1","lower_540_0","normal_480_0","normal_360_0","low_540_0"],4:["adapt_lower_540_2","adapt_lowest_540_2","adapt_lower_540_1","adapt_lowest_540_1","lower_540_0","normal_480_0","normal_360_0","adapt_low_540_0","low_480_0","low_360_0"]},A={"1080_":1,"720_":2,"540_":3,"480_":4,"360_":4,adapt_lowest_1440_1:-1,adapt_lowest_4_1:-2},x=e=>{let{bitrateList:i,useDash:t,abtestData:l}=e,n=[],o=i.filter(e=>(null==e?void 0:e.videoFormat)==="dash"),r=i.filter(e=>(null==e?void 0:e.videoFormat)==="mp4"),u=(null==o?void 0:o.length)>0&&t?o:r;if(null==l?void 0:l.bitrateCombine)return(u.forEach(e=>{var i,t;let l=a()(e);if(null==e?void 0:null===(t=e.gearName)||void 0===t?void 0:null===(i=t.includes)||void 0===i?void 0:i.call(t,"adapt_low_540_0")){l.definition=4,n.push(l);return}Object.keys(A).forEach(i=>{var t,o;(null==e?void 0:null===(o=e.gearName)||void 0===o?void 0:null===(t=o.includes)||void 0===t?void 0:t.call(o,i))&&(l.definition=A[i],n.push(l))})}),n.length>0)?n:u;return(Object.keys(b).forEach(e=>{let i=b[e];for(let t=0;t<i.length;t++){let l=u.find(e=>{var l;return null==e?void 0:null===(l=e.gearName)||void 0===l?void 0:l.includes(i[t])});if(l){let i=a()(l);i.definition=e,n.push(i);break}}}),n.length>0)?n:u};t("954372");var D=t("925847");let k=e=>{var i,t,l,n,o,r,a,u;let{bitrateList:d,awemeInfo:s,abtestData:v}=e,c=null===(i=(0,D.z1)({abtestData:v}))||void 0===i?void 0:i.white_list;if((null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:t.quality)===1&&(null==v?void 0:null===(l=v.excellentBitrateSelector)||void 0===l?void 0:l.enable)&&(c=null!==(o=null==v?void 0:null===(n=v.excellentBitrateSelector)||void 0===n?void 0:n.white_list)&&void 0!==o?o:c),null==v?void 0:v.bitrateCombine){let e=/^(1080|720|540)_[0-9]_[0-2]$/;if(d.some(i=>e.test(i.gearName))){if((null==v?void 0:null===(r=v.excellentBitrateSelector)||void 0===r?void 0:r.enableWhitelist)&&(null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:a.quality)===1){let e=d.filter(e=>/^(1080|720)_[0-9]_[0-2]$/.test(e.gearName));return e.length>0?e:d}if((null===(u=navigator)||void 0===u?void 0:u.hardwareConcurrency)<=3){let e=d.filter(e=>/^(720|540)_[0-9]_[0-2]$/.test(e.gearName));return e.length>0?e:d}if((0,g.fR)()){let e=d.filter(e=>/^(1080|720|540)_[0-9]_[0-2]|(adapt_lowest_1440_1)|(adapt_lowest_4_1)$/.test(e.gearName));return e.length>0?e:d}let e=d.filter(e=>/^(1080|720|540)_[0-9]_[0-2]$/.test(e.gearName));return e.length>0?e:d}}(0,g.fR)()&&(c=c.concat(["adapt_lowest_1440_1","adapt_lowest_4_1"]));let _=d.filter(e=>c.some(i=>{var t;return null==e?void 0:null===(t=e.gearName)||void 0===t?void 0:t.includes(i)}));return _.length>0?_:d};t("527785");let R=e=>{var i;let{abtestData:t,bitrateList:l}=e,n=null===(i=(0,D.z1)({abtestData:t}))||void 0===i?void 0:i.quality_filter;if(l.find(e=>[10,20].includes(e.definition)))return l;let o=l.filter(e=>{let i=!0;for(let[l,o]of Object.entries(n)){var t;if(null==e?void 0:null===(t=e.gearName)||void 0===t?void 0:t.includes(l)){let{lower:t,upper:l}=null!=o?o:{};(e.realBitrate<t||e.realBitrate>l)&&(i=!1)}}return i});if(0===o.length&&l.length>0){let e=l.reduce((e,i)=>e.realBitrate&&e.realBitrate<i.realBitrate?e:i,{});o.push(e)}return o};t("981168");var M=t("32167"),F=t("367366");let j={1:{width:1920,height:1080},2:{width:1280,height:720},3:{width:1024,height:576},4:{width:1024,height:576},"-1":{width:0,height:0},"-2":{width:0,height:0}},O=()=>{if("general_search"===(0,M.vM)())return{width:1114,height:660};let e=window.innerWidth>=1240?228:140,i=window.innerWidth-e;return{width:i,height:window.innerHeight-128}},U=e=>{var i,t,l,n,o;let{awemeInfo:r,list:a,abtestData:u,userselection:d,disableBitrateFilter:s}=e;if(d||(0,F.r)()||s||(null==u?void 0:u.disableOverRect)||(null==u?void 0:u.revertOverRect)===1&&window.devicePixelRatio>1)return{};let v=m.Le.getConfig(m.gI.VideoRect);!v&&(v=O(),m.Le.setConfig(m.gI.VideoRect,v));let c=null!==(l=m.Le.getConfig(m.gI.VideoRectList))&&void 0!==l?l:[],_=c.find(e=>e.id===r.awemeId);if(_&&_.rect.width!==(null==v?void 0:v.width))return _.config;let f=null==a?void 0:a.sort((e,i)=>i.definition-(null==e?void 0:e.definition)),p=(null==r?void 0:null===(i=r.video)||void 0===i?void 0:i.width)/(null==r?void 0:null===(t=r.video)||void 0===t?void 0:t.height),g=[],h={width:null==v?void 0:v.width,height:null==v?void 0:v.height};if((null==u?void 0:u.revertOverRect)===2&&window.devicePixelRatio>1&&(h.width=h.width*window.devicePixelRatio,h.height=h.height*window.devicePixelRatio),f&&p>1)for(let e=0;e<f.length;e++){let i=j[null!==(n=f[e].definition)&&void 0!==n?n:1];if((null==h?void 0:h.width)>(null==i?void 0:i.width)&&(null==h?void 0:h.height)>(null==i?void 0:i.height)){g.push(f[e]);continue}g.push(f[e]);break}if(f&&p<1)for(let e=0;e<f.length;e++){let i=j[null!==(o=f[e].definition)&&void 0!==o?o:1];if((null==h?void 0:h.width)>(null==i?void 0:i.height)&&(null==h?void 0:h.height)>(null==i?void 0:i.width)){g.push(f[e]);continue}g.push(f[e]);break}let y=f.find(e=>-1===e.definition),w=g.find(e=>-1===e.definition);y&&!w&&g.push(y);let P=f.find(e=>-2===e.definition),C=g.find(e=>-2===e.definition);if(P&&!C&&g.push(P),0===g.length)return{};let I={isOverRect:g.length!==a.length?1:0,overRectList:g};return _?(_.config=I,_.rect={width:null==v?void 0:v.width,height:null==v?void 0:v.height},I):(c.push({id:r.awemeId,config:I,rect:{width:null==v?void 0:v.width,height:null==v?void 0:v.height}}),m.Le.setConfig(m.gI.VideoRectList,c),I.overRectList||[])},V=e=>{let{bitrateList:i,abtestData:t,awemeInfo:l,userselection:n,disableBitrateFilter:o,codecType:r,isUseDash:a=!1}=e,u=E({bitrateList:i,abtestData:t,userselection:n,disableBitrateFilter:o}),d=x({bitrateList:u=N({bitrateList:u,abtestData:t,userselection:n,disableBitrateFilter:o}),abtestData:t,useDash:a});d.length>0&&(u=d),!n&&!o&&(u=R({bitrateList:u=k({bitrateList:u,awemeInfo:l,abtestData:t}),abtestData:t}));let{overRectList:s=[]}=U({list:u,awemeInfo:l,abtestData:t,userselection:n,disableBitrateFilter:o});return(null==s?void 0:s.length)>0&&(u=s),u.map(e=>{var i,t;return{size:null==e?void 0:e.dataSize,uri:null==e?void 0:e.uri,url:[...(null==e?void 0:e.playAddr)||[],{src:null==e?void 0:e.playApi}],bitrate:null==e?void 0:e.bitRate,definition:Number(null==e?void 0:e.definition),qualityType:null==e?void 0:e.qualityType,duration:(null==l?void 0:null===(i=l.video)||void 0===i?void 0:i.duration)/1e3,isH265:e.isH265,gearName:e.gearName,pktOffsetMap:(null==e?void 0:e.pktOffsetMap)||[],featureId:null==e?void 0:e.featureId,isH266:(null==e?void 0:e.isH265)===2?1:0,vtype:null==e?void 0:null===(t=e.videoFormat)||void 0===t?void 0:t.toUpperCase(),mediaType:"video",codecType:r,fps:null==e?void 0:e.fps,file_id:null==e?void 0:e.fileId,index_range:null==e?void 0:e.indexRange,init_range:null==e?void 0:e.initRange,audio_file_id:null==e?void 0:e.audioFileId,first_segment_range:null==e?void 0:e.firstSegmentRange,realBitrate:(null==e?void 0:e.realBitrate)||(null==e?void 0:e.bitRate),width:null==e?void 0:e.width,height:null==e?void 0:e.height,manualOnly:null==e?void 0:e.manualOnly,audioChannels:null==e?void 0:e.audioChannels,audioSampleRate:null==e?void 0:e.audioSampleRate}})},H=e=>{let{audioList:i}=e;return i.map(e=>{let{bitrate:i,codecType:t,fileId:l,quality:n,size:o,indexRange:r,initRange:a,urlList:u,firstSegmentRange:d,audioQuality:s}=e;return{bitrate:i,quality:n,size:o,codecType:"bytevc1"===t?"h265":"h264",file_id:l,index_range:r,init_range:a,first_segment_range:d,vtype:S.l0.DASH,fps:e.FPS,gearName:e.gear_name,mediaType:"audio",url:u,audioQuality:s}})};t("950331");let B=["normal_1440_0","normal_1080_0","normal_720_0","normal_540_0","normal_480_0","normal_360_0","lower_540_0"],K=["low_1080_0","low_720_0","low_540_0","low_480_0","low_360_0","adapt_low_540_0"],q={NORMAL_1080:"normal_1080_0",LOW_1080:"low_1080_0"},G=e=>{var i,t,l;let n=null==e?void 0:null===(i=e.filter)||void 0===i?void 0:i.call(e,e=>0===e.isH265),o=null==n?void 0:null===(t=n.filter)||void 0===t?void 0:t.call(n,e=>B.includes(e.gearName)),r=null==n?void 0:null===(l=n.filter)||void 0===l?void 0:l.call(n,e=>K.includes(e.gearName)),a=(null==o?void 0:o.length)>0?o:r;if((null==r?void 0:r.length)>0&&!r.find(e=>e.gearName===q.LOW_1080)){let e=o.find(e=>e.gearName===q.NORMAL_1080);e&&r.unshift(e)}return(null==r?void 0:r.length)>0?r:a};var Y=t("653208"),W=t("738712"),Q=t.n(W),z=t("804487");let Z=()=>{var e,i,t,l;let n=new(Q())().getResult(),o=null==n?void 0:null===(e=n.browser)||void 0===e?void 0:e.name,r=Number(null==n?void 0:null===(i=n.browser)||void 0===i?void 0:i.major),a="Chrome"===o&&r<=100||"MetaSr"===o,u=navigator.hardwareConcurrency,d=null!==(l=null===(t=(0,z.$)())||void 0===t?void 0:t.score)&&void 0!==l?l:-1,s={isBan1080:!1,isBan720:!1};return u>=8&&a&&(s.isBan1080=!0),u<8&&u>=4&&(a&&(s.isBan1080=!0),a&&d>0&&d<6&&(s.isBan720=!0)),u<4&&a&&(s.isBan1080=!0,s.isBan720=!0),s},$=e=>{var i,t,n,o,r,a,u,d,v,c,f,m,p,g;let h;let{awemeInfo:y,abtestData:w,disableBitrateFilter:P,enableDash:C=!1}=e,S=s(y),E=_({awemeInfo:S}),{bitRateList:T=[],bitRateAudioList:L=[],playApi:N,playAddr:b,playApiH265:A,playAddrH265:x}=(null==S?void 0:S.video)||{},D={awemeType:null==S?void 0:S.awemeType,mediaInfo:{videoWidth:null==S?void 0:null===(i=S.video)||void 0===i?void 0:i.width,videHeight:null==S?void 0:null===(t=S.video)||void 0===t?void 0:t.height,vid:null==S?void 0:S.awemeId,id:null==S?void 0:S.awemeId,size:(null==S?void 0:null===(n=S.video)||void 0===n?void 0:n.dataSize)||0,duration:(null==S?void 0:null===(o=S.video)||void 0===o?void 0:o.duration)/1e3||0,vtype:(null==S?void 0:S.awemeType)===l.e.Note?"MP3":"MP4",bizType:(null==S?void 0:S.isAds)?1:0,bitrate:Math.floor((null==S?void 0:null===(r=S.video)||void 0===r?void 0:r.dataSize)*8/((null==S?void 0:null===(a=S.video)||void 0===a?void 0:a.duration)/1e3))||0,codecType:"h265"},userSelectDefinition:E,focusUserDefinition:!0,url:[],h265DownGradeUrl:A,h264DownGradeUrl:N,h265DownGradeList:[...x,{src:A}],h264DownGradeList:[...b,{src:N}]},k=C&&I({abtestData:w,awemeInfo:S}),R=V({bitrateList:G(T),codecType:"h264",abtestData:w,awemeInfo:S,userselection:E,disableBitrateFilter:P,isUseDash:k}),M={};if((0,Y.w)({awemeInfo:S,abtestData:w})){let e=V({bitrateList:null==T?void 0:T.filter(e=>1===e.isH265),codecType:"h265",abtestData:w,awemeInfo:S,userselection:E,disableBitrateFilter:P,isUseDash:k}),i=Z();if(i.isBan1080){e=e.filter(e=>1!==e.definition);let i=R.find(e=>1===e.definition);i&&e.push(i)}if(i.isBan720){e=e.filter(e=>2!==e.definition);let i=R.find(e=>2===e.definition);i&&e.push(i)}null==e||e.map(e=>(Array.isArray(e.url)&&h&&e.url.push(h),e)),Object.assign(M,D,{definition:{list:e,defaultDefinition:(null==e?void 0:null===(f=e[0])||void 0===f?void 0:f.definition)||-1,defaultBitrate:(null==e?void 0:null===(m=e[0])||void 0===m?void 0:m.bitrate)||"",userSelectDefinition:E},codecType:"h265",mediaType:"video"})}else if((0,Y.On)({awemeInfo:S})){let e=V({bitrateList:null==T?void 0:T.filter(e=>1===e.isH265),codecType:"h265",abtestData:w,awemeInfo:S,userselection:E,disableBitrateFilter:P});return Object.assign({},D,{definition:{list:e,defaultDefinition:(null==e?void 0:null===(p=e[0])||void 0===p?void 0:p.definition)||-1,defaultBitrate:(null==e?void 0:null===(g=e[0])||void 0===g?void 0:g.bitrate)||""},codecType:"h265",mediaType:"video"})}let F=Object.assign({protocol:"mp4"},D,{definition:{list:R,defaultDefinition:(null==R?void 0:null===(u=R[0])||void 0===u?void 0:u.definition)||-1,defaultBitrate:(null==R?void 0:null===(d=R[0])||void 0===d?void 0:d.bitrate)||""},codecType:"h264",mediaType:"video"},M),j=null==F?void 0:null===(v=F.definition)||void 0===v?void 0:v.list;if(null==j?void 0:null===(c=j.find)||void 0===c?void 0:c.call(j,e=>(null==e?void 0:e.vtype)==="DASH")){let e=H({audioList:L});F.definition.list=[...j||[],...e||[]],F.mediaInfo.vtype="DASH",F.protocol="dash"}return(null==S?void 0:S.awemeType)===l.e.Note&&(F.protocol="mp3"),F}},648557:function(e,i,t){t.d(i,{i:function(){return x}});var l=t("520739");t("429532");var n=t("18263"),o=t("303587"),r=t("925847"),a=t("827480"),u=t("35730"),d=t("820303"),s=t("291051"),v=t.n(s),c=t("555106"),_=t("399796"),f=t("782442"),m=t("713702");let p=e=>{var i,t,l,n,o,r,a;let d=(null!==(l=(0,c.$o)(u.LocalStorageKeys.PLAYER_IS_MUTE))&&void 0!==l?l:0)===1,s=null!==(n=(0,c.$o)(u.LocalStorageKeys.PLAYER_VOLUME))&&void 0!==n?n:.5,v=_.Q.getItem({sKey:u.CookieKeys.VolumeInfo})||{},p=f.Le.getConfig(f.gI.InitStartVolume),g=(null==e?void 0:null===(i=e.startPlayDefaultVolume)||void 0===i?void 0:i.isOpen)||(null==e?void 0:null===(t=e.startPlayDefaultVolumeGradient)||void 0===t?void 0:t.isOpen);return(!v.isMute||v.isMute&&v.isUserMute)&&(!g&&(s=null!==(o=v.volume)&&void 0!==o?o:s),d=null!==(r=v.isMute)&&void 0!==r?r:d),g&&!p&&((!v.isMute||v.isMute&&v.isUserMute)&&(s=null!==(a=v.volume)&&void 0!==a?a:s),(0,m.F)(()=>{f.Le.setConfig(f.gI.InitStartVolume,!0),s=(0,m.m)({abtestData:e,volume:s})})),{volume:s,muted:d}};t("927234"),t("338172"),t("455663");var g=t("23902"),h=t.n(g);let y=(e,i)=>(null==e?!!void 0:!!e.length)&&(null==i?!!void 0:!!i.length)&&(null==e?void 0:e.some(e=>null==i?void 0:i.some(i=>{var t,l;return null==e?void 0:null===(l=e.tagId)||void 0===l?void 0:null===(t=l.toString())||void 0===t?void 0:t.startsWith(null==i?void 0:i.toString())}))),w=e=>{let{abtestData:i,awemeInfo:t}=e;return(()=>{var e,l,n,o,r,a;if(h()(t)||h()(i))return null;let u=(null==t?void 0:t.videoTag)||[],d=null==i?void 0:i.videoTagsForIncrease,s=null==i?void 0:i.playerVolumeLoudUnityExp,v=y(u,d),c=0;c=v&&s||-12;let _=JSON.parse((null==t?void 0:null===(l=t.video)||void 0===l?void 0:null===(e=l.meta)||void 0===e?void 0:e.volume_info)||"{}");return Object.assign({peak:parseFloat((null==t?void 0:null===(o=t.video)||void 0===o?void 0:null===(n=o.meta)||void 0===n?void 0:n.peak)||(null==_?void 0:_.Peak))||0,loudness:parseFloat((null==t?void 0:null===(a=t.video)||void 0===a?void 0:null===(r=a.meta)||void 0===r?void 0:r.loudness)||(null==_?void 0:_.Loudness))||0,targetLufs:c},{duration:0,metaData:"",libraData:""})})()},P=e=>{let{abtestData:i,awemeInfo:t}=e,l=w({awemeInfo:t,abtestData:i});return{source_peak:(null==l?void 0:l.peak)||.99,source_lufs:(null==l?void 0:l.loudness)||-12,target_lufs:(null==l?void 0:l.targetLufs)||-12,debugger:!1,duration:(null==l?void 0:l.duration)||0,vcloud_json_str:(null==l?void 0:l.metaData)||"",libra_json_str:(null==l?void 0:l.libraData)||""}},C=e=>{var i,t;let{volume:l,muted:n}=p(null==e?void 0:e.abtestData),{protocol:o="mp4",width:r="100%",height:s="100%",awemeInfo:v,urlList:c,abtestData:_}=e;return{disableDefaultPoster:!0,defaultPlaybackRate:(0,d.G)(u.SessionStorageKeys.PlayerPlaybackratio)||1,protocol:o,url:null==v?void 0:null===(i=v.video)||void 0===i?void 0:i.playAddr,urlList:c,volume:l,autoplay:!1,muted:n,width:r,height:s,referrerPolicy:"origin",mediaInfo:{id:null==v?void 0:v.awemeId,duration:(null==v?void 0:null===(t=v.video)||void 0===t?void 0:t.duration)/1e3||0,volumebalance:P({awemeInfo:v,abtestData:_})},loaderConfig:{referrer:"https://www.douyin.com",referrerPolicy:"origin"},preProcessUrl:e=>(0,a.preProcessUrl)(e).url,transferDefinition:!0,useProgressiveAppend:!0,dashMode:1,worker:{useSharedWorkingGroup:!0}}};t("874386");var I=t("629582"),S=t("844375"),E=t("155067"),T=t("871212"),L=t("44905"),N=t("658065");let b=e=>{var i,t;let{plugins:l=[],pluginsConfig:o={},abtestData:r={}}=e;return{plugins:[S.c_,E.Gz,E.l1,E.Zh,S.Ns,E.ar,E.Cm,E.hj,n.VodLoggerPlugin,...l],pluginsConfig:v()({[E.l1.pluginName]:{position:I.PZ.CONTROL_LEFT,index:1},[E.ar.pluginName]:{position:I.PZ.CONTROL_LEFT,index:2},[E.Gz.pluginName]:{autoHide:!1,orderCounterintuitive:!0,marginControls:!0},[E.Zh.pluginName]:{text:!1,enter:!1},[E.Cm.pluginName]:{checkVisible:!1,disableRootTrigger:!0,disableBodyTrigger:!1,seekStep:5,keyCodeMap:{up:{disable:!0},down:{disable:!0}}},[E.hj.pluginName]:{},VodLoggerPlugin:{line_app_id:T.APP_ID,line_user_id:(null===(i=(0,L.Es)())||void 0===i?void 0:i.user_unique_id)||"",tag:(0,N.yW)(),loadstartDelay:null!=r&&null!==(t=r.newPlayerConfig)&&void 0!==t&&!!t.vodLoggerLoadstartDelay}},o)}};var A=t("9756");let x=e=>{var i,t,a,u,d,s,v,c,_,f,m;let{awemeInfo:p,abtestData:g,strategyConfig:h,enableDash:y=!1,scene:w}=e,P=(0,o.d)({awemeInfo:p,abtestData:g,enableDash:y}),I=h||{};if((null==p?void 0:null===(i=p.webRawData)||void 0===i?void 0:i.quality)===1&&(null==g?void 0:null===(t=g.excellentBitrateSelector)||void 0===t?void 0:t.enable)){let e=(0,l._)({},(0,r.z1)({abtestData:g}),(null==g?void 0:g.excellentBitrateSelector)||{});I=Object.assign({},I,{[n.$Z.strategyName]:e})}let S=[];S="h265"===P.codecType?null==P?void 0:null===(v=P.h265DownGradeList)||void 0===v?void 0:v.map(e=>({src:e.src,codecType:P.codecType})):null==P?void 0:null===(c=P.h264DownGradeList)||void 0===c?void 0:c.map(e=>({src:e.src,codecType:P.codecType})),Object.assign(I,{[n.li.strategyName]:{sourceList:S}});let E=C(e);Object.assign(E,{audioWorkerLetInWorker:!0},null==g?void 0:g.newPlayerConfig),w&&(null==g?void 0:null===(a=g.webcodecRecommend)||void 0===a?void 0:a.scene)===w&&Object.assign(E,(null==g?void 0:g.webcodecRecommend.baseConfig)||{}),(null==P?void 0:P.protocol)&&(E.protocol=P.protocol);let T={baseConfig:E,preset:b({abtestData:g}),shared:{definition:P.definition,vtype:P.mediaInfo.vtype,bizType:P.mediaInfo.bizType,codecType:P.codecType},awemeType:null==p?void 0:p.awemeType};return(null==p?void 0:null===(s=p.video)||void 0===s?void 0:null===(d=s.bitRateList)||void 0===d?void 0:null===(u=d[0])||void 0===u?void 0:u.playerAccessKey)&&(T.baseConfig.decryption={entry:"https://unpkg.byted-static.com/byted/webplayer-extensions/0.0.8-beta.6/dist/vod-decrytion.js",keyStr:null==p?void 0:null===(m=p.video)||void 0===m?void 0:null===(f=m.bitRateList)||void 0===f?void 0:null===(_=f[0])||void 0===_?void 0:_.playerAccessKey}),(0,A.xp)({playerConfig:T,strategyConfig:I})}},763710:function(e,i,t){t.d(i,{GP:function(){return o},Ni:function(){return n},zJ:function(){return r}});var l=t(881155);let n=e=>{var i,t,l,n,o,r;return(null==e?void 0:null===(l=e.video)||void 0===l?void 0:null===(t=l.bitRateList)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.format)==="mp4"&&(null==e?void 0:null===(r=e.video)||void 0===r?void 0:null===(o=r.bitRateList)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.playerAccessKey)},o=e=>{var i,t,n,o;if(!e)return!1;let r=null==e?void 0:null===(i=e.chargeInfo)||void 0===i?void 0:i.is_charge_content,a=null==e?void 0:null===(n=e.chargeInfo)||void 0===n?void 0:null===(t=n.preview_config)||void 0===t?void 0:t.is_preview,u=null==e?void 0:null===(o=e.chargeInfo)||void 0===o?void 0:o.has_paid,d=(0,l.$m)(e);return r&&!a&&!u&&"limited"!==d},r=e=>{var i,t;let n=(0,l.$m)(e);return(null==e?void 0:null===(i=e.chargeInfo)||void 0===i?void 0:i.is_charge_content)&&!(null==e?void 0:null===(t=e.chargeInfo)||void 0===t?void 0:t.has_paid)&&"limited"!==n}},637261:function(e,i,t){t.d(i,{t:function(){return l}});let l=e=>{var i,t,l,n;if(!!e)null===(t=e.plugins.volume)||void 0===t||null===(i=t.focus)||void 0===i||i.call(t),null===(n=e.plugins.volume)||void 0===n||null===(l=n.unFocus)||void 0===l||l.call(n,1e3,!0,null)}},502100:function(e,i,t){t.d(i,{V:function(){return a}}),t(250440);var l=t(88648),n=t(669201),o=t(831202),r=t(658065);let a=e=>{let{awemeInfo:i}=e;(0,l.useEffect)(()=>{var e,t,l,a,u,d,s,v,c;(null==i?void 0:null===(e=i.anchorInfo)||void 0===e?void 0:e.type)===n.as.AnchorShop&&!(null==i?void 0:null===(a=i.anchorInfo)||void 0===a?void 0:null===(l=a.extra)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.product_detail_schema)&&[1,4].includes(Number(null==i?void 0:null===(s=i.anchorInfo)||void 0===s?void 0:null===(d=s.extra)||void 0===d?void 0:null===(u=d[0])||void 0===u?void 0:u.platform))&&o.oe.event.error({name:o.Mo.ShopAnchorDataError,report:{logId:i.logPb,erroData:null==i?void 0:null===(c=i.anchorInfo)||void 0===c?void 0:null===(v=c.extra)||void 0===v?void 0:v[0],enterFromMerge:(0,r.yW)()}})},[i])}},789926:function(e,i,t){t(874386);var l=t(563097),n=t(88648),o=t(801103),r=t(276541),a=t(647571),u=t(474379),d=t(713097),s=t.n(d),v=t(899152);t(459903),a.Z.use([u.Z]);i.Z=e=>{let{slideItems:i,className:t,width:a,height:u=20,isStartPlay:d=!1}=e,[c,_]=(0,n.useState)(),f=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(c&&d&&(null==i?void 0:i.length)>1){if(!f.current){var e;null==c||null===(e=c.slideNext)||void 0===e||e.call(c),f.current=setInterval(()=>{var e;null==c||null===(e=c.slideNext)||void 0===e||e.call(c)},3e3)}}else f.current&&clearInterval(f.current),f.current=null},[d,i,c]),(0,n.useEffect)(()=>()=>{f.current&&clearInterval(f.current),f.current=null},[]),(0,l.jsx)("div",{className:s()(v.default.adSwiper,t),children:(0,l.jsx)(o.t,{allowTouchMove:!1,direction:"vertical",slidesPerView:1,spaceBetween:0,loop:!0,onInit:_,width:a,height:u,autoplay:!1,children:i.map((e,i)=>(0,l.jsx)(r.o,{children:(0,l.jsx)("div",{className:v.default.slideContent,children:e})},i))})})}},419941:function(e,i,t){var l=t(563097);t(88648);var n=t(713097),o=t.n(n),r=t(894306);i.Z=e=>{let{className:i,children:t,style:n,onClick:a}=e;return(0,l.jsx)("span",{style:n,className:o()(r.default.adTag,i),onClick:a,children:t})}},887063:function(e,i,t){var l=t(563097);t(88648);var n=t(713097),o=t.n(n),r=t(919780),a=t(256855),u=t(789926),d=t(456128),s=t(918484);i.Z=e=>{let{className:i,title:t,imageUrl:n,isBackupImgUrl:v=!1,slideItems:c,buttonText:_,buttonBgColor:f=r.DEFAULT_BUTTON_COLOR,onClick:m,isStartPlay:p}=e;return(0,l.jsxs)("div",{className:o()(a.default.doubleLineAdCard,i),onClick:e=>m(e,{refer:s.tU.Blank}),children:[(0,l.jsxs)("div",{className:a.default.adInfo,children:[(0,l.jsx)("div",{onClick:e=>m(e,{refer:s.tU.Photo,click_type:v?s.Kw.AdBackupProduct:s.Kw.AdProduct}),children:(0,l.jsx)(d.Q,{src:n,iconHeight:40,iconWidth:40,className:a.default.adIcon})}),(0,l.jsxs)("div",{className:a.default.detail,children:[(0,l.jsx)("div",{className:a.default.title,onClick:e=>m(e,{refer:s.tU.Name}),children:t}),(0,l.jsx)(u.Z,{isStartPlay:p,className:a.default.swiperContainer,width:108,slideItems:c})]})]}),(0,l.jsx)("div",{className:a.default.adButton,onClick:e=>m(e,{refer:s.tU.Button}),style:{background:f},children:_})]})}},876774:function(e,i,t){var l=t(563097);t(88648);var n=t(713097),o=t.n(n),r=t(697021),a=t(830500),u=t(789926),d=t(456128),s=t(918484),v=t(254897);i.Z=e=>{let{className:i,imageUrl:t,isBackupImgUrl:n=!1,slideItems:c,buttonText:_,onClick:f,isStartPlay:m}=e;return(0,l.jsxs)("div",{className:o()(a.default.singleLineAdCard,i),onClick:e=>f(e,{refer:s.tU.Blank}),children:[(0,l.jsxs)("div",{className:a.default.adInfo,children:[(0,l.jsx)("div",{onClick:e=>f(e,{refer:s.tU.Photo,click_type:n?s.Kw.AdBackupProduct:s.Kw.AdProduct}),children:(0,l.jsx)(d.Q,{src:t,iconHeight:28,iconWidth:28,className:a.default.adIcon})}),(0,l.jsx)("div",{onClick:e=>f(e,{refer:s.tU.Name}),children:(0,l.jsx)(u.Z,{isStartPlay:m,className:a.default.swiperContainer,width:136,slideItems:c})})]}),(0,l.jsxs)("div",{className:a.default.btnBox,onClick:e=>f(e,{refer:s.tU.Button}),children:[(0,l.jsx)("span",{className:a.default.text,children:_}),(0,l.jsx)(v.z,{svg:(0,l.jsx)(r.Z,{}),className:a.default.icon})]})]})}},928516:function(e,i,t){var l=t(563097);t(88648);var n=t(713097),o=t.n(n),r=t(919780),a=t(153612),u=t(789926),d=t(456128),s=t(419941),v=t(918484);i.Z=e=>{var i;let{className:t,title:n,imageUrl:c,isBackupImgUrl:_=!1,slideItems:f,buttonText:m,buttonBgColor:p=r.DEFAULT_BUTTON_COLOR,tags:g=[],onClick:h,isStartPlay:y}=e;return(0,l.jsxs)("div",{className:o()(a.default.strongStyleAdCard,t),onClick:e=>h(e,{refer:v.tU.Blank}),children:[(0,l.jsxs)("div",{className:a.default.adInfo,children:[(0,l.jsx)("div",{onClick:e=>h(e,{refer:v.tU.Photo,click_type:_?v.Kw.AdBackupProduct:v.Kw.AdProduct}),children:(0,l.jsx)(d.Q,{src:c,iconHeight:72,iconWidth:72,className:a.default.adIcon})}),(0,l.jsxs)("div",{className:a.default.detail,children:[(0,l.jsx)("div",{className:a.default.title,onClick:e=>h(e,{refer:v.tU.Name}),children:n}),(null==g?void 0:g.length)>0&&(0,l.jsx)("div",{className:a.default.tagLine,children:null==g?void 0:null===(i=g.slice(0,2))||void 0===i?void 0:i.map((e,i)=>(0,l.jsx)(s.Z,{className:a.default.tag,onClick:i=>h(i,{refer:v.tU.Pull,product_tags:e}),children:e},i))}),(0,l.jsx)(u.Z,{isStartPlay:y,className:a.default.swiperContainer,width:156,slideItems:f})]})]}),(0,l.jsx)("div",{className:a.default.adButton,style:{background:p},onClick:e=>h(e,{refer:v.tU.Button}),children:m})]})}},754141:function(e,i,t){t.d(i,{VD:function(){return l},Wc:function(){return a},_u:function(){return u},k1:function(){return n},lg:function(){return o},vv:function(){return r}});let l=["不容错过的优品","值得买的好物","优选心仪好物","精选超值好货"],n=["人气热卖","优选好物"],o=["优选好物"],r=5,a=7,u=8},175428:function(e,i,t){t.d(i,{l:function(){return v}});var l=t(520739),n=t(563097),o=t(88648),r=t(919780),a=t(55426),u=t(368763),d=t(419941),s=t(754141);let v=e=>{var i,t;let{adData:v,onClickElement:c}=e,_=null==v?void 0:null===(i=v.lynx_components)||void 0===i?void 0:i.find(e=>(null==e?void 0:e.lynx_type)===r.AD_FEED_TYPE),f=null==_?void 0:null===(t=_.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info,m=(0,a.As)(null==v?void 0:v.log_extra),{product_phrase:p,product_name:g,image_url:h,product_tags:y,return_vistors:w,favorable_rate:P,sell_num:C,button_text:I,button_background_color:S,live_product_infos:E}=f||{},T=(0,o.useMemo)(()=>{var e,i,t,l,o;let r;let s=p?(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsx)("span",{onClick:e=>c(e,{refer:"sow",product_short_phrase:p}),children:p})}):null,v=(0,a.Hy)(C)?(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsxs)("span",{onClick:e=>c(e,{refer:"sow",sell_num:C}),children:["爆卖",(0,a.Hy)(C),"件"]})}):null,_=(null==y?void 0:y.length)>0?(0,n.jsx)("div",{className:u.default.tagLine,children:y.slice(0,2).map((e,i)=>(0,n.jsx)(d.Z,{className:u.default.tag,style:0===i?{marginRight:"4px"}:{},onClick:i=>c(i,{refer:"sow",product_tags:e}),children:e},e))}):null;return(null==E?void 0:null===(e=E[0])||void 0===e?void 0:e.product_feedback)?r=(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsx)("span",{onClick:e=>{var i;return c(e,{refer:"sow",product_feedback:null==E?void 0:null===(i=E[0])||void 0===i?void 0:i.product_feedback})},children:null==E?void 0:null===(l=E[0])||void 0===l?void 0:l.product_feedback})}):w?r=(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsx)("span",{onClick:e=>c(e,{refer:"sow",product_feedback:w}),children:w})}):P?r=(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsxs)("span",{onClick:e=>c(e,{refer:"sow",product_feedback:`商品好评率${Math.round(P)}%`}),children:["商品好评率",Math.round(P),"%"]})}):(null==E?void 0:null===(i=E[0])||void 0===i?void 0:i.collection_num)&&(r=(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsx)("span",{onClick:e=>{var i;return c(e,{refer:"sow",product_feedback:null==E?void 0:null===(i=E[0])||void 0===i?void 0:i.collection_num})},children:null==E?void 0:null===(o=E[0])||void 0===o?void 0:o.collection_num})})),{productName:g,phrase:s,sellInfo:v,tagsElement:_,tagsText:y,feedbackInfo:r,componentIds:null==m?void 0:m.component_ids,productGallery:null==E?void 0:null===(t=E[0])||void 0===t?void 0:t.product_gallery}},[e]),L=(0,o.useMemo)(()=>{let e=s.VD[Math.floor(Math.random()*s.VD.length)];return(0,n.jsx)("div",{className:u.default.swiperText,children:(0,n.jsx)("span",{onClick:i=>c(i,{refer:"sow",live_product_info_backup:e}),children:e})})},[c]);return(0,l._)({imageUrl:h||r.DEFAULT_AD_IMAGE_URL,isBackupImgUrl:!h,buttonText:I,buttonBackgroundColor:S,productPhrase:p,defaultPhraseElement:L},T)}},63062:function(e,i,t){t.d(i,{X:function(){return y}}),t("602157");var l=t("563097"),n=t("88648"),o=t("713097"),r=t.n(o),a=t("103104"),u=t("287844"),d=t("970224"),s=t("32167"),v=t("782442"),c=t("918262"),_=t("544933");let f={mediaNotSupportClientDownload:{eventName:"media_not_support_client_download",params:{group_id:"",channel_id:""}},addToDesktopShow:{eventName:"add_to_desktop_show",params:{enter_from:"",channel_id:u.g.LowVersionDowngrade,ug_channel_id:""}},addToDesktopClick:{eventName:"add_to_desktop_click",params:{enter_from:"",channel_id:u.g.LowVersionDowngrade,ug_channel_id:""}}};var m=new _.h(f),p=t("733507"),g=t("426798"),h=t("254897");let y=(0,g.X)(e=>{let{awemeId:i,isLive:t}=e,{downloadHref:o,downloadAttr:_}=(0,p.o)({channelId:u.g.LowVersionDowngrade});(0,n.useEffect)(()=>{m.sendLog("addToDesktopShow",{enter_from:(0,s.vM)(),channel_id:u.g.LowVersionDowngrade,ug_channel_id:v.Le.getConfig(v.gI.WebUgChannelId)||""})},[]);let f=(0,n.useCallback)(()=>{m.sendLog("addToDesktopClick",{enter_from:(0,s.vM)(),channel_id:u.g.LowVersionDowngrade,ug_channel_id:v.Le.getConfig(v.gI.WebUgChannelId)||""});let e=document.createElement("a");e.setAttribute("href",o),e.setAttribute("download",_),e.click()},[o,_]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:r()({[c.default.checkMediaNotSupportContainer]:!0,[c.default.checkMediaNotSupportContainerFullScreen]:t}),children:[(0,l.jsx)("div",{children:(0,l.jsx)(h.z,{svg:(0,l.jsx)(d.Z,{}),style:{color:"#33343F",fontSize:"120px"}})}),(0,l.jsx)("div",{className:c.default.title,children:"浏览器版本过低"}),(0,l.jsxs)("div",{className:c.default.description,children:[(0,l.jsx)("div",{children:"你当前使用的浏览器版本过低或浏览器本身不支持。"}),(0,l.jsx)("div",{children:"你可以「升级/更换浏览器」或「下载抖音桌面端」继续访问，感谢支持与陪伴"})]}),(0,l.jsx)("div",{children:(0,l.jsx)(a.z,{className:c.default.downloadBtn,onClick:f,children:"下载电脑客户端"})})]}),(0,l.jsx)("div",{className:r()({[c.default.checkMediaNotSupportToolbar]:!0,checkMediaNotSupportToolbarFullScreen:t})})]})})},475004:function(e,i,t){t.d(i,{V:function(){return v}});var l=t(88648),n=t(734123),o=t(419631),r=t.n(o),a=t(746864),u=t(637005),d=t(860684);let s=!1,v=e=>{let{awemeInfo:i,isFirst:t,isActive:o,timeout:v=2e3}=e,c=(0,d.n)();return(0,l.useEffect)(()=>{if(!o)return;let e=r()(e=>{let{isDown:l=!1}=e||{};s=!0,u.emit(u.EVENT.firstFrameReady,{firstFrameReadyPlayer:c,vid:null==i?void 0:i.awemeId,playerId:null==c?void 0:c.playerId,isFirst:t,isDown:!!l,isActive:o})});if((null==i?void 0:i.awemeType)!==a.e.Normal){setTimeout(()=>{e({isDown:!0})},0);return}if((null==i?void 0:i.awemeType)===a.e.Normal&&c){if(!1===t&&!s||c.isPlaying||c.currentTime>0){setTimeout(()=>{e({isDown:!0})},0);return}c.on(n.Events.AUTOPLAY_STARTED,e),c.on(n.Events.AUTOPLAY_PREVENTED,e);let i=setTimeout(()=>{e({isDown:!0})},v);return()=>{c.off(n.Events.AUTOPLAY_STARTED,e),c.off(n.Events.AUTOPLAY_PREVENTED,e),clearTimeout(i)}}},[c,i,t,o,v]),null}},33723:function(e,i,t){t.d(i,{n:function(){return I}});var l=t("520739"),n=t("878389"),o=t("563097"),r=t("88648"),a=t("713097"),u=t.n(a),d=t("734123"),s=t("410665"),v=t("702726"),c=t("28237"),_=t("7305"),f=t("618209");t("874386");var m=t("597321"),p=t("860684"),g=t("288679"),h={SingleLine:0,0:"SingleLine",TowLine:1,1:"TowLine"},y=t("894416"),w=t("473677"),P=t("205457");let C=e=>{var i,t,a;let{awemeInfo:y,onClick:P,isActive:C,className:I,onMouseEnter:S,onMouseLeave:E}=e,{displayState:T}=function(e){let{awemeInfo:i,isActive:t}=e,l=(0,p.n)(),n=(0,r.useRef)(!0),o=(0,r.useRef)(!1),[a,u]=(0,r.useState)(0),s=(0,r.useCallback)(()=>{if(!o.current){var e,i;null==l||null===(e=l.on)||void 0===e||e.call(l,m.B.TimeUpdate,_),null==l||null===(i=l.on)||void 0===i||i.call(l,d.Events.SEEKING,f)}o.current=!0},[l]),v=(0,r.useCallback)(()=>{if(o.current){var e,i;null==l||null===(e=l.off)||void 0===e||e.call(l,m.B.TimeUpdate,_),null==l||null===(i=l.off)||void 0===i||i.call(l,d.Events.SEEKING,f)}o.current=!1},[l]),c=(0,r.useCallback)(()=>{n.current=!0},[]),_=(0,r.useCallback)(e=>{let{currentTime:i}=e||{};i>=16&&(n.current=!1,u(1),v())},[l,i,v]),f=(0,r.useCallback)(e=>{let{currentTime:i}=e;i>=16&&(u(1),v()),n.current=!1},[v]),h=(0,r.useCallback)(()=>{u(1),c(),s()},[s,c]);return(0,g.u)(l,m.B.Ended,h),(0,r.useEffect)(()=>{c()},[t,c]),(0,r.useEffect)(()=>{u(0),c()},[i.awemeId,c]),(0,r.useEffect)(()=>{if(!!t){if(l&&n.current)return s(),()=>{v()}}},[l,i,t,s,v]),(0,r.useEffect)(()=>{(null==l?void 0:l.currentTime)&&_({currentTime:l.currentTime})},[l]),{displayState:a}}({isActive:C,awemeInfo:y}),L=(null==y?void 0:null===(t=y.anchorInfo)||void 0===t?void 0:null===(i=t.extra)||void 0===i?void 0:i[0])||{},N=(0,p.n)(),b=(0,s.x)(()=>{v.logInstance.sendLog("productEntranceShow",(0,n._)((0,l._)({},(0,c.R)(y)),{ecom_entrance_form:"video_cart_tag",if_qianchuan_ad:0}))}),A=(null==L?void 0:L.tags)||[],x=T===h.TowLine&&A.length>0;return(0,o.jsx)("div",{className:u()("xgplayer-shop-anchor",f.default.container,f.default.shopAnchor,{[f.default.more]:x},I),onClick:()=>{null==P||P(),null==N||N.emit(d.Events.USER_ACTION,{action:"shop_anchor_click"}),v.logInstance.sendLog("productEntranceClick",(0,n._)((0,l._)({},(0,c.R)(y)),{ecom_entrance_form:"video_cart_tag",if_qianchuan_ad:0}))},onMouseEnter:()=>{null==S||S()},onMouseLeave:()=>{null==E||E()},ref:b,children:(0,o.jsxs)("div",{className:f.default.subContainer,children:[(0,o.jsx)(w.Z,{src:_.Z,className:f.default.icon,width:20,height:20,viewBox:"0 0 20 20"}),(0,o.jsxs)("div",{className:f.default.desc,children:[(0,o.jsxs)("div",{className:f.default.firstLine,children:[null==y?void 0:null===(a=y.anchorInfo)||void 0===a?void 0:a.titleTag,(null==L?void 0:L.elastic_title)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:f.default.delimiter,children:" | "})," ",null==L?void 0:L.elastic_title]})]}),x&&(0,o.jsx)("div",{className:f.default.secondLine,children:A.map((e,i)=>(0,o.jsxs)("span",{className:f.default.towLineItem,children:[e," ",i<A.length-1&&(0,o.jsxs)(o.Fragment,{children:[" ",(0,o.jsx)("span",{className:f.default.delimiter,children:" | "})]})]},e))})]})]})})},I=e=>{let i=(0,y.N)();return(0,o.jsx)(P.k,{componentName:"ShopAnchor",Slardar:i,children:(0,o.jsx)(C,(0,l._)({},e))})}},680366:function(e,i,t){t.d(i,{P:function(){return r}});var l=t(88648),n=t(734123),o=t(782442);let r=e=>{let{player:i}=e;(0,l.useEffect)(()=>{if(i){let e=()=>{var e,t;let l=null==i?void 0:null===(t=i.root)||void 0===t?void 0:null===(e=t.getBoundingClientRect)||void 0===e?void 0:e.call(t);l&&l.width&&l.height&&o.Le.setConfig(o.gI.VideoRect,{width:l.width,height:l.height-48,heightOrigin:l.height})};return i.once(n.Events.TIME_UPDATE,e),()=>i.off(n.Events.TIME_UPDATE,e)}},[i])}},7305:function(e,i,t){var l=t(520739),n=t(878389),o=t(563097),r=t(88648);let a=(0,r.forwardRef)((e,i)=>(0,o.jsxs)("svg",(0,n._)((0,l._)({width:20,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:i},e),{children:[(0,o.jsx)("rect",{width:20,height:20,rx:2,fill:"#FF851D"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.158 5.41a1 1 0 0 1-.985-.828L5.97 3.414A.5.5 0 0 0 5.476 3H3a.5.5 0 0 0-.5.5v1A.5.5 0 0 0 3 5h.934a.5.5 0 0 1 .5.475l.359 7.076a1 1 0 0 0 .998.949H14.5a.5.5 0 0 0 .5-.5v-.5a.5.5 0 0 0-.5-.5H7a.5.5 0 0 1-.5-.5V11a.5.5 0 0 1 .5-.5h8.111a.5.5 0 0 0 .485-.377l1.04-4.09a.5.5 0 0 0-.484-.624H7.158zM6.25 17a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5zm7.25-1.25a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0z",fill:"#fff"})]})));i.Z=a}}]);