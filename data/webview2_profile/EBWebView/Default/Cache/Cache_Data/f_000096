"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["41482"],{161106:function(e,t){t.Z={privilegeSelectPopContainer:"E1YjKUD5",tabList:"yJGdEMqo",tabItem:"qqeAjM98",active:"bJ6xwKHg",lock:"rqkCmjVY",grey:"Co8KcbOn",dropdownWrap:"SCshWvv3",selectList:"o63UZH3H"}},876599:function(e,t){t.Z={content:"fn173YRd",text:"JJ9f53Hq",checkbox:"Mnck4HYZ"}},159344:function(e,t){t.Z={cancelMute:"zHAnOnkV"}},40699:function(e,t){t.Z={chatroomWrap:"jwnMl3nD",isSpringSkin:"TkexV7Hl",skinBack:"RbNHnI2Z",app:"rIvabFtl",leftContainer:"M4RpOriL",main:"wcXMy5k3",categoryTab:"GFwGNQ8V",xiguaHeader:"VjDffERA",scroll:"N7XZk46N",detailScroll:"N4NS9EoK",loadingStyle:"w3UDn0RD",no_scroll:"eM0_0C_Z",portal:"ecvzSYrh",asianGamesLive:"Asq9DpSF",xiguaPadding:"QdMXnPs9",xiguaBgColor:"tF0HH61w",xiguaNormal:"ne8wyn1N",error:"TGBGB9ZS",hideIcon:"QEs_xTvt",bkgImg:"MADA4HJt"}},414655:function(e,t){t.Z={userCount:"zmNdaKsN",count:"sbv2eU0T"}},103423:function(e,t){t.Z={liveShare:"ELbpDhJS",isInClient:"xK7xQKxV",container:"ZVzzBcU5",shareCode:"kSHH4CK4",failed:"lupPuoGm",defaultContainer:"d6bGezXa",crossContainer:"_hk5K8vP",columnContainer:"H2nt6J5u",disabledContent:"gaIZW0jh",shareToastWrap:"VDCN6go2",hidden:"z5yOmzoj"}},35841:function(e,t){t.Z={commentEditorWrap:"GD0HXVAI",focus:"hfNEFzJm",focusOrNoEmpty:"FUS9TvJk",danmakuSwitch:"M7sGLJbI",commentEditor:"z5vPqdzf"}},706652:function(){},414621:function(){},780977:function(e,t,i){i(954372),i(826893);var n=i(88648),o=i(174430),r=i(565024),l=i(987475);t.Z=function(){(0,n.useEffect)(()=>{if(/iframe/.test(window.location.pathname)){let e=/^http(s)?:\/\/(.*?)\//.exec(document.referrer)||[];window.LiveSlardar&&window.LiveSlardar("sendEvent",{name:"iframe_top_domain_event",metrics:{count:1},categories:{topDomain:e[2]}})}r.Q.setItem(l.CookieKeys.LiveUseVVC,(0,o.ue)()?"true":"false",1/0,"/")},[])}},96166:function(e,t,i){i.d(t,{W:function(){return r}});var n=i(919195),o=i(138871);let r=e=>{let{room_id_str:t,content:i,episode_id:r,stage:l,team_id:s,camera_id:a,type:u,emoji_id:d,rtf_content:c,paste_edit_method:v}=e,_=(()=>{try{if(r&&l)return(0,o.stringify)({episode_id:BigInt(r),stage:l});return}catch(e){return}})();return n.ZP.get("/webcast/room/chat/",{params:{room_id:t,content:i,type:u||0,episode_info_str:_,flow_time:_&&Date.now(),team_id:s,camera_id:a,emoji_id:d,rtf_content:c,paste_edit_method:v}})}},794739:function(e,t,i){i.d(t,{Ew:function(){return l},Zj:function(){return o},nr:function(){return r}});var n=i(919195);let o=(0,n.eH)({url:"/webcast/privilege/screen_chat/tab/",method:"post"}),r=(0,n.eH)({url:"/webcast/privilege/screen_chat/send/",method:"post"}),l=(0,n.eH)({url:"/webcast/screen_chat/",method:"post"})},881243:function(e,t,i){i.d(t,{I:function(){return m}}),i("874386");var n=i("563097"),o=i("88648"),r=i("713097"),l=i.n(r),s=i("720573"),a={autoplayPreventTip:"iSPyC4ya",text:"lGZRzfyd",limitText:"azdmS8VV",openText:"Snxin9P4",key:"CMsHKKFk",closeIcon:"ds5PfrsO",maskContainer:"GVA4okPw",maskMain:"dFvPrq8b",maskHeader:"_6GPzCR8",maskTitle:"OTPhpkbv",maskClose:"RS_C3_wf",maskContent:"Ij9m5vOW",maskText:"UqWiFkiE",maskConfirm:"i9OmRW9F"},u=i("520739"),d=i("878389");let c=(0,o.forwardRef)((e,t)=>(0,n.jsx)("svg",(0,d._)((0,u._)({width:36,height:36,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,n.jsx)("path",{d:"M24.601 24.6a1.362 1.362 0 0 1-1.927 0L18.5 20.427l-4.174 4.175a1.362 1.362 0 1 1-1.927-1.927l4.174-4.174-4.174-4.175a1.362 1.362 0 0 1 1.927-1.926l4.174 4.174 4.174-4.174a1.362 1.362 0 0 1 1.927 1.926L20.427 18.5l4.174 4.174a1.362 1.362 0 0 1 0 1.927z",fill:"#fff",fillOpacity:".8"})})));var v=i("115627"),_=i("146725");let m=e=>{let{className:t,onClose:i,onOpen:r,preventModalVisible:u,onModalVisibleChange:d}=e,[m,h]=(0,o.useState)(!1),f=()=>{h(!1),null==d||d(!1)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:l()(a.autoplayPreventTip,t),children:[(0,n.jsx)("span",{className:a.text,children:"因"}),(0,n.jsx)("span",{className:a.limitText,onClick:()=>{h(!0),null==d||d(!0)},children:"浏览器限制静音"}),(0,n.jsx)("span",{className:a.text,children:",按"}),(0,n.jsx)("span",{className:a.key,children:"P"}),(0,n.jsx)("span",{className:a.text,children:"或"}),(0,n.jsx)("span",{className:a.openText,onClick:r,children:"点击打开声音"}),(0,n.jsx)(v.Z,{className:a.closeIcon,height:36,width:36,src:c,onClick:i})]}),(void 0===u?m:u)&&(0,n.jsx)(s.h,{children:(0,n.jsx)(_.T6,{className:a.maskContainer,children:(0,n.jsxs)("div",{className:a.maskMain,children:[(0,n.jsxs)("div",{className:a.maskHeader,children:[(0,n.jsx)("div",{className:a.maskTitle,children:"浏览器限制"}),(0,n.jsx)(v.Z,{className:a.maskClose,width:36,height:36,src:c,onClick:f})]}),(0,n.jsxs)("div",{className:a.maskContent,children:[(0,n.jsx)("div",{className:a.maskText,children:"当你访问抖音次数较少，或经常静音播放时，浏览器可能会限制网站音量，使网站无法有声播放"}),(0,n.jsx)("div",{className:a.maskConfirm,onClick:f,children:"我知道了"})]})]})})})]})}},687040:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i("563097");i("88648");var o="KkFN8Skm",r=i("713097"),l=i.n(r),s=e=>{let{val:t,className:i,style:r}=e;return(0,n.jsx)("div",{style:r,className:l()(o,{[null!=i?i:""]:i}),children:t})}},243321:function(e,t,i){i.d(t,{k:function(){return u}});var n=i(563097),o=i(88648),r=i(222406),l=i(914104),s=i(742401);let a=function(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"component",r=arguments.length>5?arguments[5]:void 0;null==n||n(e,t),"module"===o&&(null==r||r("report",{ev_type:"blank_screen",payload:{timestamp:Date.now(),score:0,error:{type:"js_error",message:e.message}}})),null==r||r("sendEvent",{name:"live_component_error_boundary",categories:{componentName:i,message:e.message,stack:e.stack,componentStack:t,isNewProject:!0},type:"event"})},u=e=>{let{onError:t,beforeCapture:i,fallback:u,children:d,type:c="component",componentName:v,_slardarInstance:_}=e,m=(0,o.useMemo)(()=>{if(!s.s)return _||(0,l.OK)()},[_]),h=o.useCallback((e,i)=>{a(e,i,v,t,c,m)},[c,t,v,m]);return(0,n.jsx)(r.SV,{onError:h,beforeCapture:i,fallback:u,Slardar:m,children:d})}},147413:function(e,t,i){i.d(t,{w:function(){return s}});var n=i(520739),o=i(878389),r=i(368200),l=i(563097);function s(e){var{imageData:t={},style:i={}}=e,s=(0,r._)(e,["imageData","style"]);let{url_list:a,width:u,height:d}=t,c=null==a?void 0:a[0];return c?(0,l.jsx)("img",(0,o._)((0,n._)({},s),{src:c,style:(0,o._)((0,n._)({},i),{width:u||void 0,height:d||void 0})})):null}i(88648)},740824:function(e,t,i){let n;i.d(t,{K:function(){return _}});var o=i(563097),r=i(88648),l=i(218805),s=i(713097),a=i.n(s),u=i(517054),d=i(436071),c=i(504625);let v=(n=0,()=>{let e=Date.now();return!(e-n<100)&&(n=e,!0)});function _(e){let{className:t=""}=e,{showPanel:i,toggleShowPanel:n,enable:s,loading:_}=(0,u.B3)(e=>({showPanel:e.showPanel,toggleShowPanel:e.toggleShowPanel,enable:e.enable,loading:e.loading})),m=(0,d.$)();return((0,r.useEffect)(()=>{s&&v()&&m("livesdk_danmu_button_show")},[s]),s)?(0,o.jsx)(l.Switch,{size:"large",loading:_,checked:i,onChange:()=>{let e=!i;n(e),!e&&m("livesdk_danmu_collection_icon_click")},className:a()(c.Z.switch,i&&c.Z.checked,t)}):null}},415846:function(e,t,i){i.d(t,{J:function(){return d},_:function(){return u}});var n=i(563097);i(88648);var o=i(517054),r=i(713097),l=i.n(r),s=i(161106);let a=()=>{let e=(0,o.B3)(e=>e.scene);return`${e}-PrivilegeSelectPopContainer`},u=()=>{let e=a();return()=>"undefined"!=typeof document&&(document.getElementById(e)||document.fullscreenElement||document.body)};function d(e){let{zIndex:t}=e,i=a(),r=(0,o.B3)(e=>e.showPanel);return(0,n.jsx)("div",{id:i,style:{zIndex:t},className:l()(s.Z.privilegeSelectPopContainer,r&&s.Z.showPanel,"privilege-select-pop-container")})}},118788:function(e,t,i){i.d(t,{NL:function(){return p},pM:function(){return g}});var n=i(563097),o=i(88648),r=i(966563),l=i(218805),s=i(713097),a=i.n(s),u=i(517054),d=i(147413),c=i(509090),v=i(672129),_=i(415846),m=i(161106),h=i(436071);function f(e){var t,i,r;let{width:l}=e,s=null!==(t=(0,u.B3)(e=>e.tabItems))&&void 0!==t?t:[],_=null!==(i=(0,u.B3)(e=>e.setStoragedStyle))&&void 0!==i?i:[],f=null!==(r=(0,u.B3)(e=>e.selectedStyle))&&void 0!==r?r:[],g=(0,h.$)();(0,o.useEffect)(()=>{g("livesdk_danmu_tab_show")},[]);let p=e=>{if(g("livesdk_danmu_tab_click",{click_results:e.toast?"fail":"success",danmu_level:e.style,results_reason:e.toast}),e.toast){c.F.info(e.toast);return}_(e.style)},y=e=>e.style===f;return(0,n.jsx)("div",{className:m.Z.tabList,style:{width:l},children:s.map(e=>(0,n.jsx)("div",{onClick:()=>p(e),className:a()(m.Z.tabItem,(0,v.as)(e)&&m.Z.lock,(0,v._y)(e)&&m.Z.grey,y(e)&&m.Z.active),children:(0,n.jsx)(d.w,{imageData:e.img_v2})},e.style))})}function g(e){let{children:t,getChildrenElement:i}=e,o=(0,u.B3)(e=>e.showPanel),{width:s,height:a}=(0,r.Z)(()=>i())||{},d=(0,_._)();return(0,n.jsx)(l.Dropdown,{rePosKey:`${s}-${a}`,position:"top",trigger:"custom",visible:o,autoAdjustOverflow:!1,getPopupContainer:d,className:m.Z.dropdownWrap,content:(0,n.jsx)(f,{width:s}),children:t})}function p(){return(0,u.B3)(e=>e.showPanel)?(0,n.jsx)("div",{className:m.Z.selectList,children:(0,n.jsx)(f,{})}):null}},517054:function(e,t,i){i.d(t,{B3:function(){return P},MW:function(){return L},ke:function(){return S},xo:function(){return E}});var n=i(520739),o=i(878389),r=i(368200);i(874386),i(981168);var l=i(563097),s=i(88648),a=i(110479),u=i(191769),d=i(639307),c=i(797973),v=i(911349),_=i(70360),m=i(794739),h=i(914104),f=i(96008),g=i.n(f),p=i(672129),y=i(509090);let{Context:b,useCtxSelector:P}=(0,a.q)({showPanel:!1,tabItems:[],enable:!1,toggleShowPanel:g(),setStoragedStyle:g(),scene:"chatroom",roomId:"",anchorId:"",userId:"",liveStatus:"normal",loading:!1});function I(e){let{children:t,isAdmin:i}=e,a=(0,r._)(e,["children","isAdmin"]),{roomId:f,anchorId:g}=a,[P,I]=(0,u.Z)(`selected_privilege_danmaku_style_${g}`,{listenStorageChange:!0}),[E,S]=(0,s.useState)(void 0!==P),{data:L,run:C,loading:w}=(0,d.Z)(m.Zj,{manual:!0,debounceWait:1e3,debounceLeading:!0,debounceTrailing:!0,onFinally(t,i){if((null==i?void 0:i.status_code)!==0){var r;let l=null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.prompts;l&&y.F.info(l),(0,h.OK)().sendEvent({name:"getPrivilegeScreenChatTabApiError",categories:(0,n._)((0,o._)((0,n._)({},t,i),{toast:l}),e)})}}}),N=(0,s.useMemo)(()=>{var e;return(null==L?void 0:null===(e=L.data)||void 0===e?void 0:e.item)||[]},[L]),k=w&&0===N.length,T=(0,s.useMemo)(()=>N.filter(e=>(0,p.iC)(e)),[N]),R=T.length<=0,x=(0,s.useMemo)(()=>{var e;let t=[...T];return t.find(e=>e.style===P)?P:(t.sort((e,t)=>Number(t.diamond_count)-Number(e.diamond_count)),null===(e=t[0])||void 0===e?void 0:e.style)},[P,T]),O=(0,c.Z)(()=>{f&&g&&C({room_id:f,anchor_id:g,send_admin_tab:i})});(0,v.Z)(()=>{E&&O()}),(0,_.Z)(()=>{E&&O()},[i]);let A=E&&N.length>0,F=(0,c.Z)(e=>{S(e),e&&O(),!e&&I(void 0)});return(0,l.jsx)(b.Provider,{value:(0,n._)({showPanel:A,tabItems:N,toggleShowPanel:F,enable:!0,selectedStyle:x,setStoragedStyle:I,loading:k,disabled:R},a),children:t})}function E(e){let{anchorId:t,hasDanmuAuth:i,children:o}=e;return i?(0,l.jsx)(I,(0,n._)({},e),t):(0,l.jsx)(l.Fragment,{children:o})}function S(){return P(e=>{let{tabItems:t,selectedStyle:i,showPanel:n,enable:o}=e;if(!!n&&!!o)return t.find(e=>(0,p.iC)(e)&&e.style===i)})}function L(){var e;return null===(e=S())||void 0===e?void 0:e.comment_toast}},436071:function(e,t,i){i.d(t,{$:function(){return u}});var n=i(520739),o=i(595814),r=i.n(o),l=i(517054),s=i(983253),a=i(742740);let u=()=>{let e=(0,l.B3)(e=>r()(e,["roomId","anchorId","userId","privilegeLevel","liveStatus"])),t=()=>({enter_method:(0,s.Rs)("enter_method"),action_type:"click",anchor_id:e.anchorId,room_id:e.roomId,privilege_level:e.privilegeLevel,live_status:e.liveStatus,request_id:(0,s.Rs)("request_id"),user_id:e.userId,enter_from_merge:(0,s.Rs)("enter_from_merge")||(0,a.yW)()});return(e,i)=>{var o;null===(o=window)||void 0===o||o.collectEvent(e,(0,n._)({},t(),i))}}},262415:function(e,t,i){i.d(t,{j:function(){return a}});var n=i(520739),o=i(563097);i(88648);var r=i(517054),l=i(818597),s=i(618618);function a(e){var t,i,a,u;let{roomStore:{roomInfo:d,liveStatus:c},userStore:{userInfo:v}}=(0,l.o)(),_=null==v?void 0:v.id_str,m=null==d?void 0:d.room,h=null==v?void 0:null===(t=v.user_attr)||void 0===t?void 0:t.is_admin,f=null==m?void 0:null===(i=m.room_auth)||void 0===i?void 0:i.Danmaku,g=null==v?void 0:null===(a=v.pay_grade)||void 0===a?void 0:a.level;return(0,o.jsx)(r.xo,(0,n._)({roomId:null==d?void 0:d.roomId,anchorId:null==d?void 0:null===(u=d.anchor)||void 0===u?void 0:u.id_str,hasDanmuAuth:f,isAdmin:h,liveStatus:s.EY[c]||"normal",privilegeLevel:g,userId:_},e))}},672129:function(e,t,i){i.d(t,{BC:function(){return c},MO:function(){return v},P7:function(){return _},_y:function(){return d},as:function(){return u},fH:function(){return m},iC:function(){return a}}),i(250440),i(779788);var n=i(217713),o=i(794739),r=i(409913),l=i(96008),s=i.n(l);function a(e){return 0===e.status}function u(e){return 1===e.status}function d(e){return 2===e.status}function c(e){return e===n.Qz.Admin}function v(e){var t;let{privilegeTab:i,roomId:r,anchorId:l,content:a,rtf_content:u,left_diamond:d,enter_from_merge:v,enter_method:_,request_id:m,onSuccess:h=s(),onRecharge:f}=e,g=null==i?void 0:i.style;if(c(g))return{isScreentChat:!0,sendPromise:(0,o.Ew)({room_id:r,content:a,rtf_content:u,enter_source:v,request_id:m})};if(t=g,[n.Qz.Advanced,n.Qz.Base,n.Qz.Supreme].includes(t)){let e=(0,o.nr)({room_id:r,anchor_id:l,content:a,style:g,left_diamond:d,tags_extra:JSON.stringify({enter_from_merge:v,action_type:"click",enter_method:_}),rtf_content:u});return e.then(e=>{let t=null==e?void 0:e.data;if(!t||0!==e.status_code)return;let i={is_mock:!0,method:"WebcastPrivilegeScreenChatMessage",msg_id:t.msg_id,show_identity:t.show_identity,identity_label:t.identity_label,payload:{content:a,common:{msg_id:t.msg_id},user:t.user,style:g}};null==h||h({mockMsg:i,data:t})}),{isScreentChat:!0,sendPromise:e}}return{isScreentChat:!1,sendPromise:null}}function _(e){var t;return"style"in(null==e?void 0:e.payload)&&Number(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.style)===n.Qz.Supreme}function m(e){let{msg:t,lineMaxHeight:i=40}=e,n={width:"fit-content",height:"fit-content"};if(_(t)){let e=Number((0,r.nE)("area")||0)+1;n.maxHeight=`${i*e}px`}else n.height="1em";return n}},529437:function(e,t,i){i.d(t,{l:function(){return v}});var n=i("520739"),o=i("878389"),r=i("563097"),l=i("88648"),s=i("683571"),a={icon:"EjH5NcSF"},u=i("713097"),d=i.n(u);let c={0:{key:"unknow_value",render:()=>null},1:{key:"string_value",render(e,t){if(e&&"string"!=typeof e){var i,l,a;t=(0,o._)((0,n._)({},t),{color:(0,s.HW)(null==e?void 0:null===(i=e.format)||void 0===i?void 0:i.font_color),fontSize:null==e?void 0:null===(l=e.format)||void 0===l?void 0:l.font_size,fontWeight:(null==e?void 0:null===(a=e.format)||void 0===a?void 0:a.font_type)?500:400}),e=null==e?void 0:e.string_value}return e?(0,r.jsx)("span",{style:t,children:e}):null}},11:{key:"user_value",render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,{user:n,left_additional_content:o="",right_additional_content:l="",self_show_real_name:s}=e;if(!n)return null;let a=n.nickname;return(0,r.jsx)("span",{className:"hts-live-text-user",style:t,onClick:null==i?void 0:i.onClick,children:`${o}${a}${l}`})}},12:{key:"gift_value",render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name_ref:t}=e,i=null==t?void 0:t.default_pattern;return i?(0,r.jsx)("span",{children:i}):null}},13:{key:"heart_value",render(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],null}},14:{key:"pattern_ref_value",render(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],null}},15:{key:"image_value",render(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,{image:s}=t,u=null==s?void 0:null===(e=s.url_list)||void 0===e?void 0:e[0],c=(0,o._)((0,n._)({},i),{height:null==s?void 0:s.height,width:null==s?void 0:s.width});return u?(0,r.jsx)("img",{className:d()(a.icon,"hts-live-text-img"),style:c,src:u,onClick:null==l?void 0:l.onClick}):null}},2:{key:"image_value",render(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,{image:l}=t,s=null==l?void 0:null===(e=l.url_list)||void 0===e?void 0:e[0],u=(0,o._)((0,n._)({},i),{height:null==l?void 0:l.height,width:null==l?void 0:l.width});return s?(0,r.jsx)("img",{className:d()(a.icon,"hts-live-text-img"),style:u,src:s}):null}}};function v(e){let{text:t,customRenderPiece:i,onPieceClick:n}=e,{pieces:o=[]}=t;return(0,r.jsx)(r.Fragment,{children:o.map((e,t)=>{let{type:o,format:a}=e,{color:u,use_remote_clor:d,weight:v,font_size:_,italic:m}=a||{},h=null==i?void 0:i(e);if(h)return h;let f=c[o];if(!f)return null;let{key:g,render:p}=f,y=e[g],b={fontSize:_||14,fontWeight:v,color:d&&u?(0,s.HW)(u):void 0,fontStyle:m?"italic":void 0};return(0,r.jsx)(l.Fragment,{children:p(y,b,{onClick:t=>{null==n||n({event:t,piece:e})}})},`${g}-${t}`)})})}},142589:function(e,t,i){var n=i(520739),o=i(563097);i(88648);var r=i(169094),l=i(53562);t.Z=(0,l.Pi)(e=>(0,o.jsx)(r.C,(0,n._)({},e)))},591614:function(e,t,i){var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(142589);let v=(0,d.n)(c.Z,{name:r.l.CancelMutePlugin,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.CancelMutePlugin,condition:e=>{let{pipContext:t}=e;return!(null==t?void 0:t.isLivingPip)},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.CancelMutePlugin}),layoutName:o.t.TipsLayout,ComponentName:r.l.CancelMutePlugin,index:0})},160104:function(e,t,i){i.r(t),i.d(t,{InPicturePlaceholder:function(){return b},default:function(){return P},InPicturePlugin:function(){return y}}),i("874386");var n=i("563097"),o=i("88648"),r=i("710199"),l=i("828782"),s=i("455499"),a=i("465769"),u="AdBbB2h2",d="Xv69Fl1I",c="aa4MHXlo",v="z0hqdMFg",_={smallWindowExit:{eventName:"small_window_exit",params:{enter_from:"",action:"",action_type:"",stream_type:""}}},m=i("505575"),h=i("818597"),f=i("367271"),g=i("872136");let p=e=>{let{onClick:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:u}),(0,n.jsxs)("div",{className:d,children:[(0,n.jsx)("div",{className:c,children:"正在「小窗」模式下播放"}),(0,n.jsx)("div",{className:v,onClick:t,children:"返回大窗播放"})]})]})},y=e=>{let{isActive:t,playerRef:i,handelIsInPic:u}=e,[d,c]=(0,o.useState)(!1),{player:v}=(0,m.n)(),h=(0,o.useRef)(new g.h(_));return(0,o.useEffect)(()=>{let e;let i=null==v?void 0:v.video;if(i&&t&&v){let t=()=>{var t,i,n;!(0,l.DT)()&&(0,s.DJ)()&&((null==v?void 0:null===(t=v.video)||void 0===t?void 0:t.readyState)>2||v.currentTime)&&!(null==v?void 0:v.isInPicture)&&(null==v||null===(n=v.video)||void 0===n||null===(i=n.requestPictureInPicture)||void 0===i||i.call(n).then(()=>{c(!0),v.isInPicture=!0,clearTimeout(e)}).catch(e=>{v.isInPicture=!0,c(!1)}))};e=setTimeout(t,0),null==v||v.on(r.FP.LOADED_DATA,t);let n=()=>{c(!0)},o=()=>{c(!1)};return i.addEventListener("enterpictureinpicture",n),i.addEventListener("leavepictureinpicture",o),()=>{i.removeEventListener("leavepictureinpicture",o),i.removeEventListener("enterpictureinpicture",n),null==v||v.off(r.FP.LOADED_DATA,t),v.isInPicture=!1,clearTimeout(e)}}},[t,v]),(0,o.useEffect)(()=>{u&&u(d)},[d]),(0,o.useEffect)(()=>{var e,t},[!1,!1,d]),d?(0,n.jsx)(p,{onClick:e=>{if(e.stopPropagation(),(0,s.DJ)()){var t,i;null===(t=(i=document).exitPictureInPicture)||void 0===t||t.call(i)}c(!1),h.current.sendLog("smallWindowExit",{enter_from:(0,a.vM)()})}}):null},b=()=>{let{isLivingPip:e,closeLivingPip:t}=(0,f.ds)(),{eventStore:{playerEvent:i}}=(0,h.o)();return e?(0,n.jsx)(p,{onClick:()=>{t(),i.livesdkMiniWindowExit({click_position:"web_icon_exit"})}}):null};var P=()=>{let{feedStore:{isActive:e},roomStore:{setIsPip:t}}=(0,h.o)();return(0,n.jsx)(y,{isActive:e,handelIsInPic:t})}},540293:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,160104)),{ssr:!1}),{name:r.l.INPICTURE_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.INPICTURE_PLUGIN,condition:()=>!0,Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.INPICTURE_PLUGIN}),layoutName:o.t.LinkMicAnimationLayout,ComponentName:r.l.INPICTURE_PLUGIN,index:0})},550131:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(700061),l=i(246647),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(736579),v=i(338426),_=i(828782),m=i(455499);let h=(0,d.n)((0,v.ZP)(()=>i.e("11049").then(i.bind(i,712897)),{ssr:!1}),{name:l.l.PIP_PLUGIN,renderWhen:c.d.afterComponent(l.l.ChatRoom),taskPriority:"background"});(0,s.GI)({name:l.l.PIP_PLUGIN,condition:e=>{let{store:t,pipContext:i}=e,{feedStore:{isActive:n},roomStore:{roomStatus:r,playerCoverText:l},linkmicStore:{linkRoomType:s}}=t||{},{isLivingPip:a,isNewLivingPipEnabled:u}=i;return n&&r!==o.LV.END&&"audio"!==s&&!l&&((0,_.DT)()?u:u||(0,m.Kv)())&&!a},Component:h,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:l.l.PIP_PLUGIN}),layoutName:r.t.PlayerControlLayout,ComponentName:l.l.PIP_PLUGIN,index:0})},700464:function(e,t,i){i.d(t,{C:function(){return s}});var n=i("134761"),o=i("520739"),r=i("509090"),l="FhJtsotO";class s{}(0,n._)(s,"info",e=>{let t=document.querySelector(".__livingPlayer__");if(!t)return;let i={className:l,root:t};"string"==typeof e?i.text=e:i=(0,o._)({},i,e),r.F.info(i)})},168334:function(e,t,i){i.d(t,{S:function(){return u}});var n=i("520739"),o=i("368200");i("675373");var r=i("218805"),l=i("713097"),s=i.n(l),a="UX6Kbyjl";function u(e){let{title:t,className:i}=e,l=(0,o._)(e,["title","className"]);return new Promise(i=>{r.Modal.confirm((0,n._)({className:s()("noSemiGlobal","semi-always-dark",a,e.className),width:400,centered:!0,mask:!1,icon:null,title:t,okText:"确定",cancelText:"取消",preventScroll:!0,onOk:()=>{i(!0)},onCancel:()=>{i(!1)},closeOnEsc:!0,getPopupContainer:()=>document.fullscreenElement||document.body,zIndex:1e5},l))})}},662381:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i("563097");i("88648");var o="cMpsmvn_",r="HP4k8iEk",l=i("687040"),s=i("713097"),a=i.n(s),u=e=>{let{info:t,btn:i,keyClassName:s}=e;return(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:o,children:t}),(0,n.jsx)(l.Z,{className:a()(r,s),val:i})]})}},385187:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i("563097");i("88648");var o={tooltips:"Z4vrjOCq",popup:"E6ZfKYFn",top:"z0pfNfh4",bottom:"X4pMIbr2",left:"F3OmQzm6",right:"y1ZNHl5U"},r=i("713097"),l=i.n(r);function s(e){let{content:t,children:i,position:r="top",className:s,tooltipStyle:a={}}=e;return(0,n.jsxs)("div",{className:o.tooltips,children:[(0,n.jsx)("div",{className:l()(o.popup,o[r],s),style:a,children:t}),i]})}},459198:function(e,t,i){i.d(t,{n:function(){return s}});var n=i(563097);i(88648);var o=i(713097),r=i.n(o),l=i(40699);function s(e){let{children:t}=e;return(0,n.jsx)("div",{style:{background:"transparent"},className:r()("app-container",l.Z.app,{}),children:(0,n.jsx)("main",{className:r()(l.Z.main,"live-main"),children:t})})}},171091:function(e,t,i){var n=i(563097);i(88648);var o=i(791483),r=i(632766),l=i(818597),s=i(212502);t.Z=function(e){let{websocketKey:t}=e,{singletonStore:{message:i}}=(0,l.o)();return(0,o.C)(()=>{if(t)null==i||i.setWebsocketKey(t);else{let e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,r.ZP)({service_name:"webcast.douyin.live_pc",key:"message_websocket_params"}).then(e=>{null==i||i.setWebsocketKey(e)}).catch(i=>{t>1&&e(t-1)})};e(2)}},[]),(0,s.q)({message:i,socketData:t}),(0,n.jsx)(n.Fragment,{})}},755262:function(e,t,i){i.d(t,{H:function(){return l}});var n=i(32754),o=i(945388),r=i(527459);let l=(e,t)=>!!(t&&-1!==[o.LIVE_XIGUA_DOMAIN].indexOf(t)&&[n.m.HOME].some(t=>!!(0,r.m)(t,e)))},251015:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("58992").then(i.bind(i,622576)),{ssr:!1}),{name:r.l.ChangeDynamicBg,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.ChangeDynamicBg,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.ChangeDynamicBg}),layoutName:o.t.ContainerBackgroundLayout,ComponentName:r.l.ChangeDynamicBg,index:0})},135591:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("22670").then(i.bind(i,186352)),{ssr:!1}),{name:r.l.DoubleScreenPlugin,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.DoubleScreenPlugin,condition:e=>{let{store:t,pipContext:i}=e,{roomStore:{isDoubleScreen:n}}=t;return n&&!i.isLivingPip},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.DoubleScreenPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.DoubleScreenPlugin,index:0})},521411:function(e,t,i){i.d(t,{a:function(){return o},w:function(){return n}});let n="INSERT_AT_USER_COMMAND",o="INSERT_EMOJI_COMMAND"},653059:function(e,t,i){i.d(t,{O:function(){return o},s:function(){return n}});let n="live_at_user",o="live_emoji"},591265:function(e,t,i){i.d(t,{_i:function(){return E},tz:function(){return I}}),i(874386);var n=i(563097),o=i(158041),r=i(110479),l=i(88648),s=i(914858),a=i(521411),u=i(379928),d=i(797973),c=i(96008),v=i.n(c),_=i(545137),m=i(56486),h=i(862439),f=i(509090),g=i(168334),p=i(818597),y=i(639272);let b="non_paste",P=(0,o.kr)({editor:null,insertAtUser:v(),insertEmoji:()=>!1,setEditor:v(),getTextInfo:()=>({plainText:"",rtfElements:[]}),isEmpty:!0,setIsEmpty:v(),markPaste:v(),markPasteEdit:v(),getPasteEditMethod:()=>b,resetPasteEditMethod:v()}),I=(0,l.memo)(e=>{let{children:t}=e,[i,o]=(0,l.useState)(null),[r,c]=(0,l.useState)(!1),v=(0,l.useRef)(b),I=(0,l.useRef)(!1),{roomStore:{foldChatroom:E,setFoldChatroom:S}}=(0,p.o)(),L=(0,y.o)(),C=(0,u.Z)(async e=>{let{userInfo:t,triggerType:n}=e;if("number"==typeof(null==t?void 0:t.uid)&&(t.uid=String(t.uid)),!i)return;let o=(0,s.X9)(i.getContent()),r=()=>{E&&S(!1)},l=()=>{i.execCommand(a.w,t),L("livesdk_at_reply",{trigger_type:n,to_user_id:null==t?void 0:t.uid})},u=o&&(null==o?void 0:o.uid)===(null==t?void 0:t.uid)&&(null==o?void 0:o.webcastUid)===(null==t?void 0:t.webcastUid);if(o){if(u)r(),i.focus();else{if(!await (0,g.S)({title:"单次只支持艾特一个人，艾特其他人会清空内容，是否继续？",width:600}))return;r(),i.reset(),l()}}else r(),l()},{leading:!0}).run,w=(0,d.Z)(e=>{let{emojiInfo:t,limitCount:n=3,onlyLimitActivity:o}=e;return!!i&&((t.isActivity||!o)&&(0,h.jj)({deltaSet:i.getContent(),onlyActivity:o}).length>=n?(f.F.info(`最多可添加${n}个${o?"活动":""}表情`),!1):(i.execCommand(a.a,t),!0))}),N=(0,d.Z)(()=>{if(!i)return{plainText:"",rtfElements:[]};let{plainText:e,rtfElements:t}=(0,_.$U)(i);return{plainText:e,rtfElements:t}}),k=(0,d.Z)(()=>{v.current=b,I.current=!1}),T=(0,d.Z)(()=>{v.current="pure_paste",I.current=!1}),R=(0,d.Z)(()=>{if("pure_paste"===v.current){if(I.current){v.current="edit_with_paste";return}I.current=!0}}),x=(0,d.Z)(()=>v.current);(0,m.n)(i?C:void 0);let O=(0,l.useMemo)(()=>({editor:i,setEditor:o,insertAtUser:C,getTextInfo:N,insertEmoji:w,isEmpty:r,setIsEmpty:c,markPaste:T,markPasteEdit:R,getPasteEditMethod:x,resetPasteEditMethod:k}),[i,o,C,N,w,r,c,T,R,x,k]);return(0,n.jsx)(P.Provider,{value:O,children:t})}),E=(0,r.Z)(P)},914858:function(e,t,i){i.d(t,{HV:function(){return s},Rs:function(){return u},X9:function(){return a},o7:function(){return l}}),i(284961),i(826893),i(268917);var n=i(866152),o=i(11622),r=i(653059);let l=e=>{var t;return null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[r.s]},s=e=>{try{var t;return JSON.parse((null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[r.s])||"")}catch(e){return null}},a=e=>{try{let t=null;if(e.forEach(e=>{if(!t)t=e.ops.find(e=>l(e))||null}),t)return s(t);return null}catch(e){return null}},u=e=>{try{e.forEach((t,i)=>{if(t.zoneType!==n.Ak.Content)return;let r=t.ops.filter(e=>!l(e));e.replace(i,new o.I({zoneId:i,ops:r}))})}catch(e){}return e}},862439:function(e,t,i){i.d(t,{Wi:function(){return r},_$:function(){return l},bn:function(){return a},jj:function(){return s}}),i(268917),i(874386);var n=i(653059);let o=e=>{var t;return null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[n.O]},r=e=>{try{var t;return JSON.parse((null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[n.O])||"")}catch(e){return null}},l=e=>{var t;return o(e)&&!!(null===(t=r(e))||void 0===t?void 0:t.isActivity)},s=e=>{let{deltaSet:t,onlyActivity:i}=e,n=[];try{return t.forEach(e=>{let t=e.ops.filter(i?l:o);n.push(...t)}),n}catch(e){return n}},a=e=>{var t,i;let{editor:n,onlyActivity:o}=e;return null===(t=s({deltaSet:null==n?void 0:null===(i=n.getContent)||void 0===i?void 0:i.call(n),onlyActivity:o}))||void 0===t?void 0:t.length}},56486:function(e,t,i){i.d(t,{n:function(){return u}});var n=i(520739),o=i(878389),r=i(754089),l=i(797973),s=i(88648);let a=(()=>{let e=null,t=null,i=()=>e=null;return{get:()=>e,clear:i,set:n=>{e=n,t&&clearTimeout(t),t=setTimeout(()=>{i()},1e4)}}})();function u(e){let t=(0,l.Z)(t=>{a.clear(),null==e||e(t)}),i=(0,r.Z)("AT_USER_BUS_EVENT",t),u=(0,l.Z)(e=>(a.set(e),i.trigger(e)));return(0,s.useEffect)(()=>{let i=a.get();i&&e&&(t(i),a.clear())},[e]),(0,o._)((0,n._)({},i),{trigger:u})}},545137:function(e,t,i){i.d(t,{$U:function(){return s}});var n=i(520739);i(268917),i(284961),i(826893),i(874386),i(779788);var o=i(914858),r=i(862439);let l=e=>{let t=[];try{for(let o of e.getContentState().getZoneState("0"))for(let r of o.hasLineMarker()?o.getOps().slice(1):o.getOps()){var i;let o={text:r.insert,attributes:(0,n._)({},r.attributes)};e.pluginManager.call("editorCollectText",o),t.push({text:null===(i=o.text)||void 0===i?void 0:i.replace(/\n/g,""),attributes:o.attributes})}}catch(e){}return t},s=e=>{let t=0,i="",n=[];try{l(e).forEach(e=>{let{text:l}=e,s=(0,o.o7)(e);if(s){let i=(0,o.HV)(e);(null==i?void 0:i.uid)&&n.push({type:2,value:JSON.stringify({uid:i.uid,webcast_uid:i.webcastUid}),start:t,length:l.length})}if((0,r._$)(e)){let i=(0,r.Wi)(e);(null==i?void 0:i.emojiId)&&n.push({type:1,value:null==i?void 0:i.emojiId,start:t,length:l.length})}t+=l.length,i+=l,s&&(t+=1,i=`${i} `)})}catch(e){}return{plainText:i.trim(),rtfElements:n}}},910417:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("25986").then(i.bind(i,787452)),{ssr:!1}),{name:r.l.DANMAKU_SETTINGS,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.DANMAKU_SETTINGS,condition:e=>{let{pipContext:t,store:i}=e,{roomStore:{isDanmakuFeatureOn:n}}=i;return!(null==t?void 0:t.isLivingPip)&&n},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.DANMAKU_SETTINGS}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.DANMAKU_SETTINGS,index:0})},541403:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("55756").then(i.bind(i,838837)),{ssr:!1}),{name:r.l.DANMAKU_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.DANMAKU_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},vrStore:{isImmersive:n}}=t;return i&&!n},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.DANMAKU_PLUGIN}),layoutName:o.t.DanmakuLayout,ComponentName:r.l.DANMAKU_PLUGIN,index:0})},174911:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("58983").then(i.bind(i,301888)),{ssr:!1}),{name:r.l.DetailContextMenuPlugin,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.DetailContextMenuPlugin,condition:e=>{var t;let{store:i}=e;return null==i?void 0:null===(t=i.feedStore)||void 0===t?void 0:t.isActive},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.DetailContextMenuPlugin}),layoutName:o.t.TipsLayout,ComponentName:r.l.DetailContextMenuPlugin,index:0})},767859:function(e,t,i){i.r(t),i.d(t,{FoldChatRoomCommentPlugin:function(){return G},default:function(){return j}}),i("874386"),i("954372"),i("826893"),i("284961");var n=i("563097"),o=i("75978"),r=i("674379"),l=i("505575"),s=i("559947"),a=i("130047");let u=e=>{let t=0;if(document.selection){e.focus();let i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||0===e.selectionStart)&&(t="backward"===e.selectionDirection?e.selectionStart||0:e.selectionEnd||0);return t},d=(e,t)=>{if(null!==e){if(e.createTextRange){let i=e.createTextRange();i.move("character",t),i.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()}};var c=i("88648"),v={comment:"PgVT8Ztc",comment_input:"tiACYL3k",danmuSwitch:"LCz9svpA",text:"RwmH74lR",fixed_text:"YDHlZrcb",emoji_icon:"MTqhrWD0",fixed_chat:"otdxvxjC",no_login:"bZHW1Zsl",login:"DuGKGgUg"},_=i("713097"),m=i.n(_),h=i("818597"),f=i("520739"),g=i("878389");let p=(0,c.forwardRef)((e,t)=>(0,n.jsxs)("svg",(0,g._)((0,f._)({width:20,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,n.jsx)("path",{d:"M8 8c0 1.105-.672 2-1.5 2S5 9.105 5 8s.672-2 1.5-2S8 6.895 8 8zM13.5 10c.828 0 1.5-.895 1.5-2s-.672-2-1.5-2-1.5.895-1.5 2 .672 2 1.5 2zM10 14.53c-1.657 0-3-.96-3-2.143 0-1.183 6-1.183 6 0 0 1.184-1.343 2.143-3 2.143z",fill:"#fff",fillOpacity:".5"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zM2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0z",fill:"#fff",fillOpacity:".5"})]})));var y=i("794006"),b=i("710199"),P=i("53562"),I=i("842197"),E=i("509090"),S=i("517054"),L=i("722107"),C=i("415846"),w=i("118788"),N=i("740824"),k=i("262415"),T=i("254575"),R=i("797973"),x=i("821897"),O=i("782580"),A=i("169961"),F=i("616003");let M=()=>!1,D=(0,P.Pi)(e=>{var t,i,s;let{onSend:_,isLogin:f,isIframe:g,activity:b}=e,{roomStore:{emojiList:P,roomInfo:k,activityEmojiGroup:D},eventStore:{chatEvent:G}}=(0,h.o)(),j=c.useRef(null),[V,U]=c.useState(""),Z=c.useRef(!1),B=c.useRef(null),{player:W}=(0,l.n)(),[H,K]=c.useState(!1),Y=c.useRef(32),$=c.useRef(null),Q=(0,S.ke)(),q=Q?15:50,[J,z]=c.useState(!1),X=c.useRef(),ee=c.useRef("click"),{liveJuneOptimize:et}=(0,A.T)(),ei=c.useMemo(()=>1===et,[et]),en=c.useCallback(e=>{let{value:t}=e.target;U(t)},[]);c.useEffect(()=>{(null==V?void 0:V.length)>q&&U(V.slice(0,q))},[q]),c.useEffect(()=>{if(ei&&!J){let e=e=>{"Enter"===e.key&&!e.shiftKey&&(clearTimeout(X.current),e.preventDefault(),null==W||W.focus({isLock:!0}),X.current=setTimeout(()=>{B.current.focus(),ee.current="hotkey"},1e3))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e),clearTimeout(X.current)}}},[B,J,ei,W]);let eo=()=>{g?(0,r.dn)({headerText:"登录后即可参与互动"}):(0,o.p)().then(e=>{var t,i;b&&W.exitFullscreen(),e({headerText:"登录后即可参与互动",success:()=>{!M()&&window.location.reload()},next:`https://${null===(i=window)||void 0===i?void 0:null===(t=i.location)||void 0===t?void 0:t.host}`})})},er=(0,T.Z)((0,R.Z)(async()=>{if(!f){W.exitFullscreen(),eo();return}let e=V&&""!==V.trim();if(!!e&&!!_&&(!Q||!!await (0,L.o)(Q,{text:V})))e&&_(V,(0,I.BQ)(V,D[0]),Q,ee.current),U("")})),el=c.useCallback(()=>{Z.current=!0},[]),es=c.useCallback(()=>{Z.current=!1},[]),ea=c.useCallback(()=>{null==W||W.focus({isLock:!0}),z(!0)},[]),eu=c.useCallback(()=>{null==W||W.focus({isLock:!1}),z(!1),ee.current="click"},[]),ed=c.useCallback(e=>{if(K(!1),B.current.focus(),q&&(V+e.display_name).length>q)return;if(e.isEmojiGroup&&(0,I.yO)(V,D[0]).length>=3){E.F.info("最多只能输入三个活动表情");return}let t=u(B.current);B.current.value=V.substring(0,t)+e.display_name+V.substring(t),U(B.current.value),d(B.current,t+e.display_name.length)},[V,q]),ec=c.useCallback(e=>{let t=/\[[^\[\]\n]*?]$/,i=u(B.current),n=V.substring(0,i),o=n.lastIndexOf("["),r=n.lastIndexOf("]"),l=V.substring(i,V.length),s=o>r&&-1!==l.indexOf("]"),a=t.test(n)||s;if(-1!==l.indexOf("]")&&"]"!==V[i-1]&&(i=l.indexOf("]")+i+1),"Backspace"===e.key&&a){e.preventDefault(),e.stopPropagation();let n=V.substring(0,i).replace(t,"");B.current.value=n+V.substring(i),U(B.current.value),d(B.current,n.length)}else"Enter"===e.key&&!Z.current&&(e.preventDefault(),er())},[V,B.current]),ev=(0,S.MW)()||ei?"回车键(enter)输入评论":"说点什么";(0,x.Z)(()=>{let e=B.current;if(!!e)e.style.height="1em",e.style.height=`${e.scrollHeight}px`},[V,ev],{wait:200});c.useEffect(()=>{var e},[!1,!1]);let e_=(0,O.useGetLoginLimitAB)();return f?(0,n.jsxs)("div",{className:m()(v.comment,{[v.activity]:b}),onKeyDown:e=>e.stopPropagation(),style:{marginLeft:void 0},children:[(0,n.jsx)(C.J,{zIndex:1}),(0,n.jsx)(w.pM,{getChildrenElement:()=>j.current,children:(0,n.jsxs)("div",{className:v.comment_input,ref:j,children:[(0,n.jsx)(N.K,{className:v.danmuSwitch}),(0,n.jsx)("textarea",{className:m()(v.text,F.nk),ref:B,maxLength:q,style:{lineHeight:"24px"},value:V,rows:1,onChange:en,placeholder:ev,onFocus:ea,onBlur:eu,onKeyDown:ec,onCompositionStart:el,onCompositionEnd:es}),(0,n.jsx)(p,{className:v.emoji_icon,onClick:e=>{var t;K(e=>!e),null==e||e.stopPropagation(),null==$||null===(t=$.current)||void 0===t||t.toggle()}}),(null==k?void 0:null===(s=k.room)||void 0===s?void 0:null===(i=s.owner)||void 0===i?void 0:null===(t=i.subscribe)||void 0===t?void 0:t.open)===1?(0,n.jsx)(y._,{ref:$,emojiList:P,onEmojiClick:ed,emojiTea:G}):H?(0,n.jsx)(a.Z,{className:m()("webcast-chatroom___emoji-panel",{hidden_emoji:!H}),style:{bottom:Y.current?`${Y.current+10}px`:`${52}px`},emojiList:P,showEmoji:H,onEmojiClick:ed,setShowEmoji:K,emojiTea:G}):null]})})]}):e_?(0,n.jsxs)("div",{className:v.no_login,children:[(0,n.jsx)("span",{className:v.login,onClick:eo,children:"登录"}),"后查看榜单和更多评论"]}):(0,n.jsxs)("div",{className:v.no_login,children:["需先",(0,n.jsx)("span",{className:v.login,onClick:eo,children:"登录"}),"，才能开始聊天"]})}),G=(0,s.rW)(D);var j=(0,P.Pi)(()=>{let{userStore:{userInfo:e},chatStore:{onSend:t},roomStore:{isFixedChat:i}}=(0,h.o)(),o=c.useMemo(()=>({isLogin:!!(null==e?void 0:e.id_str),onSend:null==t?void 0:t.current,isFixedChat:i}),[e.id_str,t,i]);return(0,n.jsx)(k.j,{scene:"chatroom",children:(0,n.jsx)(G,{props:o,position:b.PZ.CONTROL_LEFT})})})},12488:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(700061),l=i(246647),s=i(595902),a=i(446042),u=i(770732),d=i(669556),c=i(300253),v=i(338426);let _=(0,c.n)((0,v.ZP)(()=>Promise.resolve().then(i.bind(i,767859)),{ssr:!1}),{name:l.l.FOLD_CHAT_ROOM_COMMENT_PLUGIN,renderWhen:s._.FirstFrame,taskPriority:"background"});(0,a.GI)({name:l.l.FOLD_CHAT_ROOM_COMMENT_PLUGIN,condition:e=>{let{pipContext:t,store:i}=e,{roomStore:{foldChatroom:n,isFixedChat:r,roomStatus:l},playerStore:{isFullScreen:s,isTheaterOn:a}}=i;return(s||a)&&n&&!r&&!(null==t?void 0:t.isLivingPip)&&l!==o.LV.END},Component:_,index:0}),t.Z=(0,d.OV)({Component:()=>(0,n.jsx)(u.Z,{name:l.l.FOLD_CHAT_ROOM_COMMENT_PLUGIN}),layoutName:r.t.PlayerControlLayout,ComponentName:l.l.FOLD_CHAT_ROOM_COMMENT_PLUGIN,index:0})},427950:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("32284").then(i.bind(i,748050)),{ssr:!1}),{name:r.l.LeadingLoginPlugin,renderWhen:l._.FirstFrame,taskPriority:"user-visible"});(0,s.GI)({name:r.l.LeadingLoginPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.LeadingLoginPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.LeadingLoginPlugin,index:0})},92639:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(736579),v=i(338426);let _=(0,d.n)((0,v.ZP)(()=>i.e("67337").then(i.bind(i,191283)),{ssr:!1}),{name:r.l.LiveFromAppTips,renderWhen:c.d.after(l._.FirstFrame),taskPriority:"user-visible"});(0,s.GI)({name:r.l.LiveFromAppTips,condition:()=>!0,Component:_,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.LiveFromAppTips}),layoutName:o.t.TipsLayout,ComponentName:r.l.LiveFromAppTips,index:0})},185067:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("44143").then(i.bind(i,926556)),{ssr:!1}),{name:r.l.Live_Like,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"user-blocking"});(0,l.GI)({name:r.l.Live_Like,condition:e=>{let{store:t,pipContext:i}=e,{feedStore:{isActive:n}}=t;return n&&!(null==i?void 0:i.isLivingPip)},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.Live_Like}),layoutName:o.t.LikeLayout,ComponentName:r.l.Live_Like,index:0})},577630:function(e,t,i){i.d(t,{Z:function(){return E}});var n=i("563097"),o=i("88648"),r=i("700061"),l=i("246647"),s=i("446042"),a=i("770732"),u=i("669556"),d=i("520739"),c=i("878389");i("675373"),i("874386");var v=i("818597"),_=i("53562"),m=i("367271"),h=i("645260"),f=i.n(h),g=i("338426"),p=i("300253"),y=i("595902");let b=(0,p.n)((0,g.ZP)(()=>i.e("46668").then(i.bind(i,454373)),{ssr:!1}),{name:l.l.LiveReserveCard,renderWhen:y._.LivingInit,taskPriority:"background"}),P=(0,_.Pi)(e=>{let{singletonStore:{message:t}}=(0,v.o)(),[i,r]=o.useState(""),[l,s]=o.useState(""),[a,u]=o.useState(""),[_,m]=o.useState(!1);(0,o.useEffect)(()=>null==t?void 0:t.wrds.on("RoomDataSyncMessage","",e=>{var t,i,n,o,l,a,d,c;let v=null==e?void 0:null===(i=e.payload)||void 0===i?void 0:null===(t=i.payload)||void 0===t?void 0:t.highlight_items;if(null==v?void 0:null===(n=v[0])||void 0===n?void 0:n.appointment_data){let e=null==v?void 0:null===(o=v[0])||void 0===o?void 0:o.appointment_data;r(null!==(a=null==e?void 0:e.appointment_id)&&void 0!==a?a:""),s(null!==(d=null==e?void 0:e.date_text)&&void 0!==d?d:""),u(null!==(c=null==e?void 0:e.time_text)&&void 0!==c?c:""),m((null==e?void 0:null===(l=e.scheduled_weekdays)||void 0===l?void 0:l.length)>0)}else(null==v?void 0:v.length)===0&&r("")}),[t]);let h=(0,c._)((0,d._)({},e),{appointmentId:i,dateText:l,timeText:a,isCycle:_});return(0,n.jsx)(b,(0,d._)({},h))});var I=(0,_.Pi)(()=>{let{roomStore:{liveStatus:e},userStore:{userInfo:t},playerStore:{isFullScreen:i,isTheaterOn:o}}=(0,v.o)(),{isLivingPip:r}=(0,m.ds)();return(0,n.jsx)(P,{isNormalScreen:!(i&&!o),uid:f()(t,"id_str",""),isPip:r})});(0,s.GI)({name:l.l.LiveReserveCard,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},roomStore:{hideBanner:n}}=t;return i&&!n},Component:I,index:0});var E=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:l.l.LiveReserveCard}),layoutName:r.t.ShortTouchLayout,ComponentName:l.l.LiveReserveCard,index:0})},357720:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("624").then(i.bind(i,486992)),{ssr:!1}),{name:r.l.NewPlayerErrorCover,renderWhen:d.d.afterComponent(r.l.ChatRoom)});(0,l.GI)({name:r.l.NewPlayerErrorCover,condition:e=>{var t;let{store:i}=e;return null==i?void 0:null===(t=i.roomStore)||void 0===t?void 0:t.isShowRefreshPage},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.NewPlayerErrorCover}),layoutName:o.t.TipsLayout,ComponentName:r.l.NewPlayerErrorCover,index:0})},642029:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(700061),l=i(246647),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(736579),v=i(338426);let _=(0,d.n)((0,v.ZP)(()=>i.e("5393").then(i.bind(i,953109)),{ssr:!1}),{name:l.l.PausePop,renderWhen:c.d.afterComponent(l.l.ChatRoom),taskPriority:"background"});(0,s.GI)({name:l.l.PausePop,condition:e=>{let{store:t}=e,{roomStore:{roomStatus:i},paidLiveStore:{isPaidLive:n},linkmicStore:{linkStatus:r}}=t;return!!(i!==o.LV.END&&!n&&r!==o.cK.LINKED)},Component:_,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:l.l.PausePop}),layoutName:r.t.TipsLayout,ComponentName:l.l.PausePop,index:0})},322604:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(616003),r=i(700061),l=i(246647),s=i(595902),a=i(446042),u=i(770732),d=i(669556),c=i(300253),v=i(338426);let _=(0,c.n)((0,v.ZP)(()=>Promise.resolve().then(i.bind(i,340619)),{ssr:!1}),{name:l.l.PlayerEndCover,renderWhen:s._.FirstFrame,taskPriority:"background"});(0,a.GI)({name:l.l.PlayerEndCover,condition:e=>{let{store:t}=e,{roomStore:{playerCoverText:i},linkmicStore:{linkRoomType:n}}=t;return!!(i&&!(i===o.kx.ANCHOR_BAN&&n))},Component:_,index:0}),t.Z=(0,d.OV)({Component:()=>(0,n.jsx)(u.Z,{name:l.l.PlayerEndCover}),layoutName:r.t.TipsLayout,ComponentName:l.l.PlayerEndCover,index:0})},393840:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,843722)),{ssr:!1}),{name:r.l.PlayerLoggerPlugin,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.PlayerLoggerPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.PlayerLoggerPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.PlayerLoggerPlugin,index:0})},960109:function(e,t,i){i.r(t),i.d(t,{default:function(){return s}});var n=i(88648),o=i(505575),r=i(818597),l=i(710199);function s(e){let{eventStore:{playerEvent:t}}=(0,r.o)(),{player:i}=(0,o.n)(),s=(0,n.useCallback)(i=>{switch(i.action){case"switch_danmu":null==t||t.liveDanmakuBtnClickEvent(!i.isOpen,e.logObj);break;case"switch_play_pause":null==t||t.livePlayBtnClickEvent(!i.paused,e.logObj);break;case"switch_fullscreen":null==t||t.liveFullScreenBtnEvent(i.fullscreen,e.logObj)}},[e.logObj]);return(0,n.useEffect)(()=>(null==i||i.on(l.FP.USER_ACTION,s),()=>{null==i||i.off(l.FP.USER_ACTION,s)}),[s]),null}},113810:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,960109)),{ssr:!1}),{name:r.l.PlayerTeaLogPlugin,renderWhen:l._.FirstFrame,taskPriority:"background"});(0,s.GI)({name:r.l.PlayerTeaLogPlugin,condition:e=>{var t;let{store:i}=e;return null==i?void 0:null===(t=i.feedStore)||void 0===t?void 0:t.isActive},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.PlayerTeaLogPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.PlayerTeaLogPlugin,index:0})},692283:function(e,t,i){i.d(t,{X7:function(){return n},xU:function(){return o}});let n={auto:"自动",origin:"原画",fhd:"1440P",uhd:"蓝光",hd:"超清",sd:"高清",ld:"标清"},o={uhd:"4K",hd:"超清1080P",sd:"高清720P",ld:"标清480P"}},700045:function(e,t,i){i.d(t,{F:function(){return x}}),i("874386"),i("250440");var n=i("563097"),o=i("88648"),r=i("713097"),l=i.n(r),s=i("692283"),a=i("818597"),u=i("645260"),d=i.n(u),c=i("802913"),v=i("828782"),_=i("509090"),m=i("75978"),h=i("18043"),f=i("867204"),g=i("53562");let p={uhd:{high:"4K高帧率",low:"超高清4K"},hd:"超清1080P",sd:"高清720P",ld:"标清480P"};Object.keys(p);var y=i("809218");let b={uhd:"超高清4K 高帧率",hd:"超清1080P",sd:"高清720P",ld:"标清480P"};var P=i("525613"),I=i("773768"),E=i("816933"),S=i("182794"),L=i("42872"),C=i("358472"),w=i("140695"),N=i("19670");let k=()=>((0,o.useEffect)(()=>{window.collectEvent("add_to_desktop_show",{type:"4k",channel_id:c.g.Lv4k,enter_from:"live_detail"})},[]),(0,n.jsxs)("span",{children:["去下载",(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.5005 0.499939L4.50052 5.17743L2.17907 3.03518L1.5009 3.77008L4.66145 6.68667L5.00054 6.99958L5.33963 6.68667L8.50018 3.77008L7.82201 3.03518L5.50052 5.17747L5.5005 0.499939H4.5005ZM1.5 9.5H8.5V8.5H1.5V9.5Z",fill:"white"})})]})),T="abr_auto",R=e=>e===T,x=(0,g.Pi)(e=>{let{qualityList:t=[],quality:i="",interceptedQuality:r="",openIntercepted:u=!1,player:c,qualityHandler:g={},openTryWatching:x=!1,screenMode:O="",streamOptions:A={},streamInfo:F}=e,{userStore:{userInfo:M},streamStore:{leadingData:D,setLocalQuality:G},eventStore:{playerEvent:j},roomStore:{isAsianGames:V},playerStore:{playerLoggerInstance:U}}=(0,a.o)(),Z=(0,C.iC)(F),{abrEnable:B,isAbrOpen:W,setIsAbrOpen:H,abrQuality:K}=(0,S.K6)(e=>({abrEnable:e.enable,isAbrOpen:e.isAbrOpen,setIsAbrOpen:e.setIsAbrOpen,abrQuality:e.abrQuality})),Y=d()(D,"items.label_lead.lead_content.label",""),{enableOlympic4k:$,openOrDownloadClient:Q}=(0,y.M)(),q=(0,o.useMemo)(()=>t.filter(e=>!$||!!b[e]).reverse(),[t,$]),J=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];g&&(null==g?void 0:g.setCurrentQuality)&&(null==g||g.setCurrentQuality(e),V&&G(e),null==j||j.liveBitRateSwitchEvent({before_definition:`${t?"auto_":""}${f.Kt[i]}`,select_definition:f.Kt[e],screen_model:O}))},z=(0,o.useMemo)(()=>new Set(q.filter(e=>(!u||!r||!(E.p[r]<=E.p[e]))&&(!$||!!(0,v.DT)()||"uhd"!==e)&&!0)),[q,u,r,$]);(0,P.Z)(()=>{let e=(0,v.DT)();$&&(!b[i]||"uhd"===i&&!e)&&J(q.find(e=>z.has(e)))},[$,q,i,null==g?void 0:g.setCurrentQuality,z]);let{itemRef:X,panelRef:ee,show:et}=(0,w.h)(c);(0,o.useEffect)(()=>{var e;if(!!et)j.liveSdkDefinitionPanelShow({definition:(W?"auto_":"")+f.Kt[i],definition_set_type:W?"auto":"manual"}),(0,N.WH)("QualitySwitchContainer_showSelector",{quality:i,originUrlRealQuality:Z,qualityList:q,willMergeQuality:(null==q?void 0:null===(e=q.includes)||void 0===e?void 0:e.call(q,"origin"))&&(null==q?void 0:q.includes(Z))})},[et]);let ei=(e,t)=>{if(R(e)){let e=s.X7[K||i];return`自动${e&&W?`(${e})`:""}`}if($)return b[e];if(V&&A){if("uhd"!==e)return p[e];{var n,o,r,l;let i=null==A?void 0:null===(r=A.qualities)||void 0===r?void 0:null===(o=r.find)||void 0===o?void 0:null===(n=o.call(r,t=>(null==t?void 0:t.sdk_key)===e))||void 0===n?void 0:n.fps,s=null===(l=p.uhd)||void 0===l?void 0:l[i>25?"high":"low"];return`${s}${t?"（限免）":""}`}}else return Z===e?s.X7.origin:s.X7[e]},en=()=>!1,eo=e=>e===i||"origin"===e&&Z===i,er=(0,o.useCallback)((e,t)=>{try{let n=eo(e);if(t&&n&&(null==j||j.liveBitRateSwitchEvent({before_definition:`auto_${f.Kt[i]}`,select_definition:f.Kt[i],screen_model:O})),x&&!n){L.t4.set(e),J(e,t),_.F.info(`已为您切换到${ei(e)}画质`,c.root),null==U||U.updateExt({definition:e});return}if(e&&u&&r&&E.p[r]<=E.p[e]){null==c||c.exitFullscreen(),(0,m.p)().then(t=>{var i,n;t({success:()=>{L.t4.set(e),(0,h.QX)(e),!en()&&window.location.reload()},next:`https://${null===(n=window)||void 0===n?void 0:null===(i=n.location)||void 0===i?void 0:i.host}`,headerText:"登录后免费畅享超高清画质",enterMethod:"hd_live",clarity:e})});return}if(!n){L.t4.set(e),J(e,t),_.F.info(`已为您切换到${ei(e)}画质`,c.root),null==U||U.updateExt({definition:e});return}}catch(e){}},[r,i,q,u,g,M.id_str]),[el,es]=(0,o.useState)(""),ea=e=>{let t=el===e,o=eo(e),r=o&&!W||t;if(R(e))return{labelJSX:null,clickHandler:()=>{if(!W)H(!0),null==j||j.liveBitRateSwitchEvent({before_definition:`${W?"auto_":""}${f.Kt[i]}`,select_definition:`auto_${f.Kt[i]}`,screen_model:O})},isActiveItem:W||t};if(!(0,v.DT)()&&$&&(0,y.K)(e))return{labelJSX:(0,n.jsx)("div",{className:l()(I.Z.label,t&&I.Z.goDownload),children:t?(0,n.jsx)(k,{}):"客户端专享"}),clickHandler:Q,isActiveItem:r};let s=!z.has(e);return{labelJSX:s?(0,n.jsx)("div",{className:I.Z.label,style:{visibility:t?"visible":"hidden"},children:Y}):null,clickHandler:()=>{if(!!W||!o)s||H(!1),er(e,W)},isActiveItem:r}},eu=(0,o.useMemo)(()=>{let e=new Set(q);return(Z&&"origin"!==Z&&e.has("origin")&&e.has(Z)&&e.delete(Z),B)?[T,...e]:[...e]},[B,W,q,Z]);return(0,n.jsx)("div",{className:I.Z.container,children:(0,n.jsxs)("div",{className:I.Z.toolbar,children:[(0,n.jsx)("div",{ref:X,className:I.Z.quality,"data-e2e":"quality",children:W?"自动":ei(i,!0)}),(0,n.jsx)("div",{className:l()(I.Z.menu,et?I.Z.show:I.Z.hidden),ref:ee,children:(0,n.jsx)("div",{className:I.Z.tags_container,"data-e2e":"quality-selector",children:eu.map(e=>{let{labelJSX:t,clickHandler:i,isActiveItem:o}=ea(e);return(0,n.jsx)("div",{className:I.Z.tags,onMouseEnter:()=>es(e),onMouseLeave:()=>es(""),onClick:i,children:(0,n.jsxs)("div",{className:I.Z.tips,style:{color:o?"#FFFFFF":"#FFFFFF99",background:o?"#f2f2f414":""},children:[(0,n.jsx)("div",{className:I.Z.text,style:{color:o?"#FFFFFF":"#FFFFFF99"},children:ei(e,!0)}),t]},e)},e)})})})]})})})},865778:function(e,t,i){i.d(t,{T:function(){return u}});var n=i(520739),o=i(88648),r=i(182794),l=i(358472),s=i(867204),a=i(797973);let u=e=>{let{preQuality:t,quality:i,playerEvent:u,screenMode:d,enable:c}=e,v=(0,r.K6)(e=>e.getIsAbrOpen),_=(0,r.K6)(e=>e.getShouldDisableManualHandler),m=(0,r.K6)(e=>e.isAbrOpen),h=o.useRef(!1);(0,o.useEffect)(()=>{if(m){h.current=!0;return}},[m]);let f=(0,a.Z)(()=>`${h.current?"auto_":""}${s.Kt[t.current]}`);return(0,o.useEffect)(()=>{let o=t.current;if(c&&v()&&o!==i){null==u||u.liveBitRateSwitchSuccessEvent((0,n._)({before_definition:f(),now_definition:`auto_${s.Kt[i]}`,definition_automatic_type:(0,l.gW)(o,i)?"up":"down",definition_set_type:"auto",screen_model:d,change_mode:s.r6.AUTO},e.logObj||{})),t.current=i;return}},[i]),{getIsAbrOpen:v,getShouldDisableManualHandler:_,preIsAbrQualityRef:h,getBeforeDefinition:f}}},88478:function(e,t,i){i.d(t,{$:function(){return w}});var n=i("520739");i("882732"),i("544943"),i("874386"),i("413806"),i("826893");var o=i("88648"),r=i("867204"),l=i("443646"),s=i("914104"),a=i("669417"),u=i("629163"),d=i("700464"),c=i("62302"),v=i("818597"),_=i("954909"),m=i("624390"),h=i("875257"),f=i("623527"),g=i("828782"),p=i("710199"),y=i("865778");i("927234"),i("268917");var b=i("782580"),P=i("797973"),I=i("983096"),E=i("358472"),S=i("19670");let L=(e,t)=>{try{if(!t)return e;let i=new URL(e),{searchParams:n}=i;return n.set("abr_pts",String(t)),null==i?void 0:i.toString()}catch(e){}return e},C=(e,t)=>{if(!e||!t)return!1;let i=new URL(e),n=new URL(t);return i.pathname===n.pathname},w=e=>{let{eventStore:{playerEvent:t},streamStore:{setIsH265Error:i,useBackUp:w},roomStore:{setIsShowRefreshPage:N}}=(0,v.o)(),{stream:k,quality:T,onSwitch:R,isUse:x,sessionId:O,player:A,screenMode:F,qualityList:M,isActivity:D,setNoStream:G,showRefreshPage:j,roomId:V}=e,{ishNewH265:U,addH265ErrorNum:Z}=(0,h.Z)({quality:T}),B=o.useRef(T),W=o.useRef(!1),H=o.useRef(!1),[K,Y]=o.useState(!1),$=o.useRef(null),{abrPts:Q}=(0,m.Z)(),q=o.useRef(!1),J=o.useRef({}),z=async e=>{if(J[e])return J[e];try{let t=await (0,u.Zb)(e,1);return J[e]=t,t}catch(t){return e}},X=o.useRef(()=>{}),ee=o.useRef(),{getShouldDisableManualHandler:et,preIsAbrQualityRef:ei,getBeforeDefinition:en}=(0,y.T)({playerEvent:t,quality:T,screenMode:F,preQuality:B,enable:x}),eo=function(e){let t=(0,b.useInLivePlayerSeamlessSwitchAB)(),i=(0,o.useRef)([]),n=(0,P.Z)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];i.current.forEach(e=>e()),i.current=e});return(0,I.Z)(()=>n([])),(0,P.Z)(i=>{var o;let{url:r}=i;if(!e||!r)return;let l=[];if(!t||"function"!=typeof e.seamlessSwitch||e.paused||(null===(o=e.baseConfig)||void 0===o?void 0:o.coreType)!=="mediastream"||(0,E.aN)(r)!==(0,E.aN)(e.src)?1:0)e.src=r;else l.push(e.once(p.FP.KEYFRAME,t=>{if("number"!=typeof(null==t?void 0:t.pts)){e.src=r;return}let i=L(r,Number(t.pts));l.push(e.once(p.FP.SWITCH_ERROR,t=>{if((0,S.WH)("useSwitchPlayerUrlFn_switch_error",{message:null==t?void 0:t.message,stack:null==t?void 0:t.stack,url:null==t?void 0:t.url,finnalUrl:i}),(0,E.$R)((null==t?void 0:t.url)||"",i)){e.src=i;return}})),e.seamlessSwitch(i)}));n(l)})}(A),er=(e,t,i)=>{if(e){let n=(0,l.uC)(e.flv||"");(0,c.sw)(n)&&(A.src=n,A.retry()),A._isBack=!0,R(!1),t&&A.off(p.FP.CANPLAY,t),i&&A.on(p.FP.ERROR,i);return}},el=async()=>{var o,u;if(et()){q.current=!0;return}if(!V||!x)return;let v=k[T];if(!v)return;if(!q.current){q.current=!0;return}let{main:m,backup:h}=v;C(m.flv,ee.current);let y=await z(m.flv),b=(0,c.GT)((0,l.uC)(y),{abr_pts:Q}),P=e=>{},I=()=>{if(Y(!0),A.off(p.FP.CANPLAY,I),clearTimeout(null==$?void 0:$.current),T!==B.current){let i=r.j9.UP;M.indexOf(T)>M.indexOf(B.current)&&(i=r.j9.DOWN),null==t||t.liveBitRateSwitchSuccessEvent((0,n._)({before_definition:en(),now_definition:r.Kt[T],definition_automatic_type:i,screen_model:F,change_mode:r.r6.MANUAL,definition_set_type:"manual"},e.logObj||{})),ei.current=!1,B.current=T}R(!1),j&&j(!1);try{$.current=setTimeout(()=>{var e,t,i,n;let o=null==A?void 0:null===(i=A.plugins)||void 0===i?void 0:null===(t=i.flvlive)||void 0===t?void 0:null===(e=t.loader)||void 0===e?void 0:e.finnalUrl;if(!o)return;let r=null==o?void 0:null===(n=o.indexOf)||void 0===n?void 0:n.call(o,".flv"),l="number"==typeof Number(o[r-1])?null==o?void 0:o.substring(r-3,r-1):null==o?void 0:o.substring(r-2),s="origin"!==T||-1===o.indexOf("or")&&-1===M.indexOf(l)||-1!==o.indexOf("or");(T!==_.t.origin&&-1===o.indexOf(T)||!s)&&a.kg.event(`[${f.Tn.Error}]${f.Mo.LivePlayerQualityError}`,{url:o,is_client:(0,g.DT)(),quality:T}),W.current=!0},W.current?0:5e3)}catch(e){}},E=()=>{if(A._isBack){G&&G(!0),R(!1),A.off(p.FP.CANPLAY,I);return}};P=e=>{var t;A.isBack&&E(),U()&&(i(!0),Z()),er(h,I,E),a.kg.event(`[${f.Tn.Error}]${f.Mo.LiveSwitchFailed}`,{statusCode:null==e?void 0:e.code,errorType:null==e?void 0:e.errorType,message:null==e?void 0:e.ex,is_client:(0,g.DT)(),quality:T}),A.off(p.FP.CANPLAY,I),d.C.info("切换失败"),j&&j(!0);let n=(0,s.OK)();null==n||null===(t=n.sendEvent)||void 0===t||t.call(n,{name:"webcast_quality_switch_failed",categories:{code:(null==e?void 0:e.code)||-1,errorType:(null==e?void 0:e.errorType)||"unknown",message:null==e?void 0:e.ex,url:b,quality:T}})},A&&(null==A?void 0:A.once)&&A.once(p.FP.CANPLAY,I),A&&(null==A?void 0:A.once)&&A.once(p.FP.ERROR,P);let S=null==A?void 0:null===(u=A.config)||void 0===u?void 0:null===(o=u.baseConfig)||void 0===o?void 0:o.url;if(!S||(null==S?void 0:S.indexOf(b))>-1&&!D)return;let L=null==b?void 0:b.split("?")[1],w=null==S?void 0:S.split("?")[1],N=new URL(S),O=new URL(b);N.pathname!==O.pathname?eo({player:A,url:b}):N.pathname===O.pathname&&((null==L?void 0:L.indexOf("only_audio=1"))>-1||(null==w?void 0:w.indexOf("only_audio=1"))>-1)&&eo({player:A,url:b}),X.current=()=>{A&&(null==A?void 0:A.off)&&A.off("canplay",I),A&&(null==A?void 0:A.off)&&A.off("error",P),R(!1),clearTimeout(null==$?void 0:$.current)}};o.useEffect(()=>{var e,t;el();let i=null!==(t=null==k?void 0:null===(e=k[T])||void 0===e?void 0:e.backup)&&void 0!==t?t:null;return w&&!H.current&&(i?er(i):N(!0),H.current=!0),()=>{var e;null==X||null===(e=X.current)||void 0===e||e.call(X)}},[A,T,x,k,R,j,V,w])}},892814:function(e,t,i){i.d(t,{v:function(){return d}});var n=i("867204"),o=i("443646"),r=i("700464"),l=i("818597"),s=i("88648");let a={auto:"自动",origin:"原画",uhd:"蓝光",hd:"超清",sd:"高清",ld:"标清"};var u=i("865778");let d=e=>{let{eventStore:{playerEvent:t}}=(0,l.o)(),{stream:i,quality:d,onSwitch:c,isUse:v,qualityList:_,player:m,screenMode:h}=e,f=s.useRef(d),{getShouldDisableManualHandler:g,preIsAbrQualityRef:p,getBeforeDefinition:y}=(0,u.T)({playerEvent:t,quality:d,screenMode:h,preQuality:f,enable:v});s.useEffect(()=>{var e,l,s;if(!v||g())return;let u=i[d];if(!u)return;let{main:b}=u,P=(0,o.uC)(b.hls||"");if((null===(l=m.config.url)||void 0===l?void 0:null===(e=l.indexOf)||void 0===e?void 0:e.call(l,P))>-1)return;let I=()=>{},E=()=>{if(m.off("error",I),d!==f.current){let e=n.j9.UP;_.indexOf(d)>_.indexOf(f.current)&&(e=n.j9.DOWN),null==t||t.liveBitRateSwitchSuccessEvent({before_definition:y(),now_definition:n.Kt[d],definition_automatic_type:e,screen_model:h,change_mode:n.r6.MANUAL,definition_set_type:"manual"}),p.current=!1}(null==m?void 0:m.paused)&&m.play(),m.config.url=P,c(!1)};return I=()=>{m.off("canplay",E),r.C.info("切换失败"),c(!1)},m.once("canplay",E),m.once("error",I),r.C.info(`正在切换到${a[d]}`),m.src=P,c(!0),null===(s=m.video)||void 0===s||s.load(),()=>{m.off("canplay",E),m.off("error",I)}},[m,d,v,i,c])}},772750:function(e,t,i){i.r(t),i.d(t,{RefreshPlugin:function(){return b},default:function(){return I},RefreshPluginWrap:function(){return P}});var n=i("563097"),o=i("520739"),r=i("878389"),l=i("88648");let s=(0,l.forwardRef)((e,t)=>(0,n.jsx)("svg",(0,r._)((0,o._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,n.jsx)("path",{d:"M24.932 16.444c0-4.687-3.89-8.444-8.634-8.444a8.679 8.679 0 0 0-7.207 3.79v-1.558a.99.99 0 0 0-1.98 0v4.038c0 .547.444.99.99.99h4.038a.99.99 0 0 0 0-1.98h-1.646c1.137-1.963 3.304-3.3 5.804-3.3 3.7 0 6.655 2.918 6.655 6.464 0 3.547-2.956 6.465-6.655 6.465-2.963 0-5.459-1.88-6.326-4.453a.99.99 0 0 0-1.876.633c1.138 3.38 4.39 5.8 8.202 5.8 4.746 0 8.635-3.758 8.635-8.445z",fill:"#fff"})})));var a=i("616003"),u=i("505575"),d=i("559947"),c=i("710199"),v=i("385187"),_=i("818597"),m=i("662381"),h=i("128231"),f=i.n(h),g=i("53562"),p=i("618618"),y=i("367271");function b(e){let{eventStore:{playerEvent:t}}=(0,_.o)(),{player:i}=(0,u.n)(),{playerCoverText:o}=e,r=f()(()=>{window.location.reload()},200),{Icon:d}=e,c=(0,l.useCallback)(()=>{var n;if(o&&o===a.kx.KICK_OUT){r();return}null==i||i.emit(a.Cw.REFRESH),null==i||i.retry(),null==t||null===(n=t.liveRefreshBtnClickEvent)||void 0===n||n.call(t,e.logObj)},[t,o,i]),h=()=>!1;return(0,l.useEffect)(()=>{let e=e=>{var t,i;if(h())return;let n=null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.tagName;if("INPUT"!==n&&"TEXTAREA"!==n&&(null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.contentEditable)!=="true")(null==e?void 0:e.code)==="KeyR"&&!(e.shiftKey||e.metaKey||e.ctrlKey)&&c()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[c,!1,!1,h]),(0,n.jsx)(v.Z,{content:(0,n.jsx)(m.Z,{btn:"R",info:"刷新"}),children:(0,n.jsx)("div",{onClick:c,style:{position:"relative",bottom:-1},children:d?(0,n.jsx)(d,{}):(0,n.jsx)(s,{})})})}let P=(0,g.Pi)((0,d.rW)(b));var I=(0,g.Pi)(()=>{let{roomStore:{playerCoverText:e,roomStatus:t},linkmicStore:{linkStatus:i}}=(0,_.o)(),{isLivingPip:o}=(0,y.ds)();return o||i===p.cK.LINKED||t===p.LV.END?null:(0,n.jsx)(P,{props:{playerCoverText:e},position:c.PZ.CONTROL_LEFT,index:1})})},450360:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,772750)),{ssr:!1}),{name:r.l.RefreshPlugin,renderWhen:d.d.afterComponent(r.l.ChatRoom)});(0,l.GI)({name:r.l.RefreshPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.RefreshPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.RefreshPlugin,index:0})},54762:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("23881").then(i.bind(i,387456)),{ssr:!1}),{name:r.l.ROTATE_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.ROTATE_PLUGIN,condition:e=>{var t,i,n;let{store:o}=e,r=!0;try{!CSS.supports("rotate","none")&&(null==o?void 0:null===(n=o.roomStore)||void 0===n?void 0:n.isDoubleScreen)&&(r=!1)}catch(e){}return(null==o?void 0:null===(t=o.feedStore)||void 0===t?void 0:t.isActive)&&r&&!(null==o?void 0:null===(i=o.vrStore)||void 0===i?void 0:i.isInVrView)},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.ROTATE_PLUGIN}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.ROTATE_PLUGIN,index:0})},476068:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("74792"),i.e("3805")]).then(i.bind(i,88407)),{ssr:!1}),{name:r.l.SHORT_CUT,renderWhen:l._.FirstFrame,taskPriority:"user-blocking"});(0,s.GI)({name:r.l.SHORT_CUT,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},roomStore:{hideBanner:n,roomInfo:o},vrStore:{isImmersive:r}}=t;return i&&!n&&(null==o?void 0:o.roomId)&&!r},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.SHORT_CUT}),layoutName:o.t.ShortTouchLayout,ComponentName:r.l.SHORT_CUT,index:0})},421632:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("88424").then(i.bind(i,916288)),{ssr:!1}),{name:r.l.TheaterPlugin,renderWhen:l._.FirstFrame,taskPriority:"user-visible"});(0,s.GI)({name:r.l.TheaterPlugin,condition:e=>{let{pipContext:t}=e;return!0},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.TheaterPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.TheaterPlugin,index:0})},180894:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(700061),l=i(246647),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(736579),v=i(338426),_=i(645260),m=i.n(_);let h=(0,d.n)((0,v.ZP)(()=>i.e("3047").then(i.bind(i,944541)),{ssr:!1}),{name:l.l.TRIPLE_SCREEN_PLUGIN,renderWhen:c.d.afterComponent(l.l.ChatRoom),taskPriority:"background"});(0,s.GI)({name:l.l.TRIPLE_SCREEN_PLUGIN,condition:e=>{let{store:t,pipContext:i}=e,{roomStore:{isDoubleScreen:n,roomInfo:r},pkStore:{pkStatus:l},paidLiveStore:{isPaidLive:s},linkmicStore:{linkRoomTypeHooks:a,isNewVideoLinkmicRoom:u},feedStore:{isActive:d},playerStore:{playerInstance:c},ecomStore:{cartVisible:v},vrStore:{isVrLive:_}}=t,h=m()(r,"room.status"),f=null==i?void 0:i.isLivingPip,g=Object.keys(m()(r,"room.linker_map")||{}).length>=1;if(!(null==r?void 0:r.room)||!(null==r?void 0:r.roomId))return!1;if(!(d&&h!==o.LV.END&&!l&&!n&&!s&&!f&&!a&&!g&&!v&&!_))try{null==c||c.updateConfig({pluginsConfig:{tripleVideo:{enable:!1}}})}catch(e){}return d&&h!==o.LV.END&&!l&&!n&&!s&&!f&&!a&&!g&&!v&&!_&&!u},Component:h,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:l.l.TRIPLE_SCREEN_PLUGIN}),layoutName:r.t.PlayerControlLayout,ComponentName:l.l.TRIPLE_SCREEN_PLUGIN,index:0})},949235:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("46701").then(i.bind(i,998258)),{ssr:!1}),{name:r.l.UgcAvatar,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.UgcAvatar,condition:e=>{let{pipContext:t}=e;return!(null==t?void 0:t.isLivingPip)},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.UgcAvatar}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.UgcAvatar,index:0})},475274:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,778531)),{ssr:!1}),{name:r.l.VolumeWheelPlugin,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"user-visible"});(0,l.GI)({name:r.l.VolumeWheelPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.VolumeWheelPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.VolumeWheelPlugin,index:0})},584366:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,816627)),{ssr:!1}),{name:r.l.VrPlugin,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.VrPlugin,condition:e=>{let{pipContext:t,store:i}=e;return!0},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.VrPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.VrPlugin,index:0})},726028:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("98716").then(i.bind(i,854362)),{ssr:!1}),{name:r.l.WaterMark,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.WaterMark,condition:e=>{let{store:t,pipContext:i}=e,{feedStore:{isActive:n}}=t;return n},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.WaterMark}),layoutName:o.t.WaterMarkLayout,ComponentName:r.l.WaterMark,index:0})},279910:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(616003),l=i(700061),s=i(246647),a=i(446042),u=i(770732),d=i(669556),c=i(300253),v=i(736579),_=i(338426);let m=(0,c.n)((0,_.ZP)(()=>Promise.all([i.e("3556"),i.e("21083"),i.e("66660")]).then(i.bind(i,680464)),{ssr:!1}),{name:s.l.TOOL_BAR_PLUGIN,renderWhen:v.d.afterComponent(s.l.ChatRoom),taskPriority:"background"});(0,a.GI)({name:s.l.TOOL_BAR_PLUGIN,condition:e=>{let{store:t}=e,{roomStore:{roomStatus:i,playerCoverText:n},vrStore:{isImmersive:l}}=t;return i!==o.LV.END&&n!==r.kx.KICK_OUT&&!l},Component:m,index:0}),t.Z=(0,d.OV)({Component:()=>(0,n.jsx)(u.Z,{name:s.l.TOOL_BAR_PLUGIN}),layoutName:l.t.EcmoCardLayout,ComponentName:s.l.TOOL_BAR_PLUGIN,index:0})},839274:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("64995").then(i.bind(i,461132)),{ssr:!1}),{name:r.l.ADMIN_PRIVILEGE_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.ADMIN_PRIVILEGE_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i}}=t;return i},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.ADMIN_PRIVILEGE_PLUGIN}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.ADMIN_PRIVILEGE_PLUGIN,index:0})},624207:function(e,t,i){i.d(t,{Z:function(){return g},F:function(){return f}});var n=i("563097"),o=i("88648"),r=i("980981"),l=i("818597"),s=i("645260"),a=i.n(s),u=i("53562"),d=i("520739"),c=i("878389");let v=(0,o.forwardRef)((e,t)=>(0,n.jsx)("svg",(0,c._)((0,d._)({width:26,height:26,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,n.jsx)("path",{d:"M3.373 20.11v-2.502h-1.75v2.502a4.265 4.265 0 0 0 4.266 4.266h2.502v-1.75H5.89a2.519 2.519 0 0 1-2.516-2.516zM20.11 1.624h-2.502v1.75h2.502a2.519 2.519 0 0 1 2.516 2.516v2.5h1.75v-2.5a4.265 4.265 0 0 0-4.266-4.266zM3.373 5.89A2.518 2.518 0 0 1 5.89 3.374h2.502v-1.75H5.89A4.265 4.265 0 0 0 1.623 5.89v2.5h1.75v-2.5zm19.253 14.22a2.519 2.519 0 0 1-2.516 2.516h-2.502v1.75h2.502a4.265 4.265 0 0 0 4.266-4.266v-2.502h-1.75v2.502zM1.623 12.134h22.753v1.731H1.623v-1.732z",fill:"#fff"})})));var _=i("713097"),m=i.n(_);let h=o.createRef(),f=()=>h;var g=(0,u.Pi)(function(e){let{className:t,qrcode:i,avatar:s}=e,{roomStore:{notSupportReason:u,roomInfo:d},eventStore:{playerEvent:c}}=(0,l.o)(),_=a()(d,"web_rid");return(0,o.useEffect)(()=>{if(_){var e;null==c||null===(e=c.liveAppOnlyEvent)||void 0===e||e.call(c,u)}},[u,_]),(0,n.jsx)("div",{className:m()(r.Z.app_only,t),style:{backgroundImage:`url("${s}")`},ref:h,children:(0,n.jsxs)("div",{className:r.Z.content,children:[(0,n.jsx)("p",{className:r.Z.toast,children:"该直播类型或玩法电脑端暂未支持"}),(0,n.jsx)("p",{className:r.Z.toast,children:"请先在手机上查看吧"}),(0,n.jsxs)("p",{className:r.Z.guide,children:[(0,n.jsx)(v,{className:r.Z.scan_icon}),"打开抖音，扫一扫"]}),(0,n.jsx)("img",{className:r.Z.qrcode,src:i,alt:""})]})})})},94667:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("74792"),i.e("28251"),i.e("76746"),i.e("26848"),i.e("14473"),i.e("95395"),i.e("45366"),i.e("51385"),i.e("7406"),i.e("81387")]).then(i.bind(i,676128)),{ssr:!1}),{name:r.l.AUDIO_ROOM_PLUGIN,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.AUDIO_ROOM_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{useNewLinkMicRender:n,linkRoomType:o}}=t;return i&&!n&&"audio"===o},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.AUDIO_ROOM_PLUGIN}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.AUDIO_ROOM_PLUGIN,index:0})},154692:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("1977").then(i.bind(i,403741)),{ssr:!1}),{name:r.l.GroupFightPlugin,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.GroupFightPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{isGroupFight:n}}=t;return i&&n},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.GroupFightPlugin}),layoutName:o.t.LinkMicAnimationLayout,ComponentName:r.l.GroupFightPlugin,index:0})},287454:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("9613").then(i.bind(i,228469)),{ssr:!1}),{name:r.l.GROUP_LIVE_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom)});(0,l.GI)({name:r.l.GROUP_LIVE_PLUGIN,condition:e=>{let{store:t,pipContext:i}=e,{feedStore:{isActive:n},linkmicStore:{isGroupLive:o}}=t,{isLivingPip:r}=i;return!r&&n&&o},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.GROUP_LIVE_PLUGIN}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.GROUP_LIVE_PLUGIN,index:0})},925025:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("76746"),i.e("95395"),i.e("51385"),i.e("35473")]).then(i.bind(i,907895)),{ssr:!1}),{name:r.l.LINK_MIC_DYNAMIC_CONFIG,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.LINK_MIC_DYNAMIC_CONFIG,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{useNewLinkMicRender:n}}=t;return!!(i&&n)},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.LINK_MIC_DYNAMIC_CONFIG}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.LINK_MIC_DYNAMIC_CONFIG,index:0})},394063:function(e,t,i){i.r(t),i.d(t,{getEnlargeShowTypeParams:function(){return es},default:function(){return eu},getFunctionType:function(){return er},LinkMicLayoutPlugin:function(){return ea},getLayoutParams:function(){return el}}),i("250440");var n=i("563097"),o=i("53562"),r=i("520739"),l=i("878389");i("874386"),i("268917"),i("429532"),i("675373"),i("819117");var s=i("39738"),a=i("618618"),u=i("505424"),d=i("727795"),c=i("443646"),v=i("669417"),_=i("513081"),m=i("614316"),h=i("668363"),f=i("783350"),g=i("271242"),p=i("615323"),y=i("810724"),b={TPYE_MESSAGE_UNKNOWN:0,0:"TPYE_MESSAGE_UNKNOWN",TYPE_MESSAGE_CREATE:1,1:"TYPE_MESSAGE_CREATE",TYPE_MESSAGE_FINISH:2,2:"TYPE_MESSAGE_FINISH",TYPE_MESSAGE_SING_ACTION_TOAST:3,3:"TYPE_MESSAGE_SING_ACTION_TOAST",TYPE_MESSAGE_SING_ACTION:4,4:"TYPE_MESSAGE_SING_ACTION",TYPE_MESSAGE_MV_ACTION:5,5:"TYPE_MESSAGE_MV_ACTION",TYPE_MESSAGE_AI_LYRICS:6,6:"TYPE_MESSAGE_AI_LYRICS"},P=i("829021"),I=i("581954"),E=i("505575"),S=i("745618"),L=i("907831"),C=i.n(L),w=i("645260"),N=i.n(w),k=i("332630"),T=i.n(k),R=i("410204"),x=i.n(R),O=i("128231"),A=i.n(O),F=i("779145"),M=i.n(F),D=i("96008"),G=i.n(D),j=i("88648"),V=i("904082"),U=i("818597"),Z=i("509090"),B=i("632766"),W=i("828782"),H=i("838096"),K=i("624207"),Y=i("305272"),$=i("767299"),Q=i("499198"),q=i("544845"),J=i("955386"),z=i("608261");let X=!1,ee=A()(function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];Z.F.info(...t)},1e3);var et=e=>{let{isVerifyed:t}=e,{isLiveModal:i,linkmicStore:{setFloatModal:n,imLinkMicLayout:o,linkMicConfig:L,linkMicLayout:w,seiLinkMicLayout:k,setEnlargeSeatApplyUid:R,setEnlargeSeatImage:O,setEnlargeGuestType:A,teamfightInfo:F,setIsPlayModeNotSupport:D,isSing:et,linkRoomType:ei,sceneNum:en,setSceneNum:eo,playModes:es,playModesPC:ea,setPlayModes:eu,setTeamfightInfo:ed,guestBattleInfo:ec,setGuestBattleInfo:ev,orderSingInfo:e_,setOrderSingInfo:em,updateLinkMicConfig:eh,linkMicSeats:ef,linkMicSeatsRaw:eg,setImLinkMicSeats:ep,setSeiLinkMicSeats:ey,setLinkStatus:eb,setImLinkMicLayout:eP,setUiLayout:eI,setSeiLinkMicLayout:eE,setOtherRoomLinkSilenceStatus:eS,linkStatus:eL,setLinkMicConfig:eC,selfLinkMicId:ew,resetStore:eN,setOrderSingUserScore:ek,dressListInfo:eT,setDressListInfo:eR,linkMicLayout:ex,setLinkMicSettings:eO,dressMvpInfo:eA,setDressMvpInfo:eF,dressListAll:eM,layoutConfig:eD,setAgcAnchor:eG,setEggModeInfo:ej,functionType2:eV,setIsCrossLink:eU,setCrossLinkTimerStart:eZ,crossLinkTimerStart:eB,isCrossLink:eW,setRoomBattleType:eH,uiLayout:eK,setOpenUiLayout:eY,setAsrSubtitle:e$,lastLayout:eQ,setLastLayout:eq,setShowGiftInfo:eJ,linkmicVideoEqualLayoutFrameOpt:ez,setLinkmicVideoEqualLayoutFrameOpt:eX},roomStore:{roomInfo:e0,setNotSupportReason:e1},userStore:{userInfo:e6},singletonStore:{message:e7,audioPower:e3},eventStore:{linkmicEvent:e4}}=(0,U.o)(),{player:e5}=(0,E.n)(),e2=j.useRef(eB);j.useEffect(()=>{eZ(e2.current||0)},[e2.current]);let{leave:e8}=(0,V.Z)(),{isGuestBattle:e9}=(0,$.Z)(),{isGroupFight:te,isRoomBattle:tt}=(0,Q.Z)();N()(e0,"room.linker_map",{});let ti=j.useRef(!1),tn=j.useRef({}),to=j.useRef({}),tr=j.useRef(),tl=j.useRef({}),ts=j.useRef(void 0);j.useRef([]);let ta=j.useRef(void 0),tu=j.useRef(void 0),td=j.useRef(void 0),tc=j.useRef(""),tv=j.useCallback(()=>eg,[eg]);j.useEffect(()=>{td.current=ef},[ef]),j.useEffect(()=>{tc.current=eV},[eV]);let t_=j.useCallback((e,t)=>{let i=[];return null==e||e.map(e=>{!(null==t?void 0:t.some(t=>(null==t?void 0:t.linkmic_id_str)===(null==e?void 0:e.linkmic_id_str)))&&i.push(e)}),i},[]),tm=j.useCallback(()=>{var e;return ew&&tr.current?(0,l._)((0,r._)({},null!==(e=to.current)&&void 0!==e?e:{}),{[ew]:tr.current}):to.current},[ew]),th=j.useCallback(()=>tl.current,[]),tf=j.useCallback(e=>{eE(e)},[eE]);(0,I.wz)({selfLinkMicId:ew,setLayout:tf,setSeats:ey,layout:k,getUsers:tm,getPositions:th,getSeats:tv,enable:!0,roomIdStr:e0.roomId,audioPower:e3,linkRoomType:ei,uiLayout:eK,setUiLayout:eI,linkStatus:eL});let tg=j.useCallback(e=>{let t=void 0===e?o:e;void 0===t&&eK===s.V_.LINKMICUILAYOUT_LIVE_PARTNER_DYNAMIC&&(t=P.yP.MATE_CUSTOM);let i=C()(h.Fk);return t===P.yP.VIDEO_DYNAMIC||t===P.yP.MATE_CUSTOM?i={}:t===P.yP.AUDIO_DOUBLE_C&&(i=(0,I.Lq)(10)),Object.values(tn.current).forEach(e=>{"number"==typeof e.user_position&&(i[e.user_position]={idx:e.user_position,user:e})}),Object.keys(tl.current).forEach(e=>{tl.current[e]&&(i[e].info=(0,r._)({},tl.current[e]))}),1===Object.keys(i).length&&t===P.yP.VIDEO_DYNAMIC&&(i[1]={idx:1}),t===P.yP.AUDIO_DOUBLE_C&&9===Object.keys(i).length&&(i[9]={idx:9}),i},[o,eK]),tp=j.useCallback(e=>{let{listUsers:t,type:i,linkUsers:n,version:l}=e,s=void 0===i?o:i,a=(e,t)=>{let i={};return e.forEach(e=>{var n,o,r,l,a,u;if(e&&"number"==typeof e.user_position&&("number"!=typeof e.is_background&&(e.is_background=Number(e.is_background)),null===(o=e.content)||void 0===o?void 0:null===(n=o.linkmic_audience_content)||void 0===n?void 0:n.rank_contributor_ids)){let t=null===(l=e.content)||void 0===l?void 0:null===(r=l.linkmic_audience_content)||void 0===r?void 0:r.rank_contributor_ids;t[0],t&&(e.content.linkmic_audience_content.rank_contributor_ids=t)}e&&e.linkmic_id_str&&((null==e6?void 0:e6.id_str)&&(null===(a=e.user)||void 0===a?void 0:a.id_str)===(null==e6?void 0:e6.id_str)&&(tr.current=e),e.user_position=Number(null!==(u=null==e?void 0:e.user_position)&&void 0!==u?u:0),s===P.yP.VIDEO_6V6&&!t&&(e.user_position=e.user_position+P.Lf[s]),i[e.linkmic_id_str]=e)}),s===P.yP.VIDEO_6V6&&0===Object.keys(i).length&&Object.keys(tn.current).forEach(e=>{var n,o;let r=null==tn?void 0:tn.current[e];t&&(null!==(n=null==r?void 0:r.user_position)&&void 0!==n?n:0)<P.Lf[s]?i[e]=r:!t&&(null!==(o=null==r?void 0:r.user_position)&&void 0!==o?o:0)>=P.Lf[s]&&(i[e]=r)}),i},u=a(null!=t?t:[],!0),d=s===P.yP.VIDEO_6V6?a(null!=n?n:[],!1):[],c=(0,r._)({},u,d);to.current=Object.assign({},to.current,tn.current,c),tn.current=c;let v=tg(s);return ep(v,l),v},[ep,tg,e6,o]),ty=j.useCallback(e=>{let t={};return null==e||e.forEach(e=>{void 0!==e.key&&void 0!==e.value&&(t[e.key]=e.value)}),t},[]),tb=j.useMemo(()=>0!==M()(ef).filter(e=>!!(null==e?void 0:e.user)).length,[ef]);j.useEffect(()=>{ts.current=o},[tb]);let tP=j.useMemo(()=>x()(ef).filter(e=>e.user).length,[ef]);j.useEffect(()=>{"1"===ez&&z.qK.includes(w)?e5.position((0,J.PS)(w,tP)):w===P.yP.AUDIO_1V8||w===P.yP.AUDIO_GRID||w===P.yP.VIDEO_GRID||w===P.yP.VIDEO_DYNAMIC?e5.position({y:.203,h:.5}):w===P.yP.VIDEO_6V6?e5.position({y:.183,h:.52}):[w===P.yP.VIDEO_1V6,w===P.yP.VIDEO_1V8,w===P.yP.VIDEO_1_V_8].some(Boolean)?e5.position({y:1-.7375,h:.7375}):w===P.yP.VIDEO_DYNAMIC_FLOAT||w===P.yP.MATE_CUSTOM?e5.position({y:0,h:1}):w===P.yP.VIDEO_1_V_6?e5.position({y:.203,h:.5}):w===P.yP.VIDEO_1_V_3?e5.position({y:.203,h:.5}):w===P.yP.VIDEO_T1_V_B8?e5.position({y:.11,h:.7375}):w===P.yP.VIDEO_2V4V4&&e5.position({y:.203,h:.625})},[w,ez,tP]);let tI=(0,H.Z)();j.useEffect(()=>{if((null==tI?void 0:tI.data)&&(null==tI?void 0:tI.status_code)===0){var e;let{teamfight_info:t,guest_battle_info:i,linkmic_play_mode_info:n}=null==tI?void 0:tI.data,r=t||(null==n?void 0:n.teamfight_info);r&&ed(r);let l=i||(null==n?void 0:n.guest_battle_info);l&&ev(l),n&&eJ((null==n?void 0:null===(e=n.order_sing_info)||void 0===e?void 0:e.show_gift_info)||!1),o===P.yP.VIDEO_6V6&&(null==e4||e4.liveAudiencePlayModeRoomEvent(ts.current))}},[tI]),j.useEffect(()=>{var e;let t=null!==(e=null==ec?void 0:ec.dress_id)&&void 0!==e?e:"",i=(null==F?void 0:F.dressId)||(null==F?void 0:F.dress_id)||"";if(t!==(null==eT?void 0:eT.dress_id)&&""!==t){let e=eM.find(e=>e.dress_id===t);e?eR(e):(0,d.VT)({dress_id:t}).then(e=>{var t,i,n,o;if(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.data){let t=null!==(o=null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.dress_list)&&void 0!==o?o:[];t.length&&eR(t[0])}})}if(i!==(null==eA?void 0:eA.dress_id)&&""!==i){let e=eM.find(e=>e.dress_id===i);e?eF(e):(0,d.VT)({dress_id:e}).then(e=>{var t,i,n,o;if(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.data){let t=null!==(o=null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:i.dress_list)&&void 0!==o?o:[];t.length&&eF(t[0])}})}},[null==ec?void 0:ec.battle_id_str,F]);let tE=j.useCallback(async()=>{var e,t,i,n,s,a,u,c,v,_,m,h;let g=N()(e0,"roomId",""),p=N()(e0,"anchor.sec_uid",""),y=N()(e0,"anchor.id_str",""),b=N()(e0,"room.AnchorABMap.live_linkmic_order_sing_micro_opt","");eX(N()(e0,"room.AnchorABMap.linkmic_video_equal_layout_frame_opt","0"));let[I,E]=await Promise.all([(0,d.lx)({room_id:g,anchor_id:y}),(0,d.$s)(g,p)]);if(E.data&&0===E.status_code){let o=ty(null===(e=E.data)||void 0===e?void 0:e.settings),u=(0,l._)((0,r._)({},E.data),{config:o});eC(u);let d=(u.settings||[]).find(e=>e.key===f.V9.AU_AudioSubtitle);d&&e$({isOpen:(null==d?void 0:null===(i=d.content)||void 0===i?void 0:null===(t=i.audio_subtitle_content)||void 0===t?void 0:t.audio_subtitle_value)===1,type:(null==d?void 0:null===(a=d.content)||void 0===a?void 0:null===(s=a.audio_subtitle_content)||void 0===s?void 0:null===(n=s.linkmic_subtitle_status)||void 0===n?void 0:n.subtitle_type)||S.rFD.SubtitleType_Room})}if(I.data.data&&0===I.data.status_code){let{user:e,locked_positions:t,linker_content_map:i,linker_base_info:n={}}=I.data.data,{scene:r,play_modes:l=[],cross_link_timer_start:s}=n;if(16!==r||l.map(e=>Number(e)).includes(16)?16===r&&l.map(e=>Number(e)).includes(16)&&s&&(eU(!0),eH("pk"),e2.current=Number(s)):(eU(!0),eH("crossLink"),e2.current=Number(s||Math.floor(Date.now()/1e3))),null==t||t.forEach(e=>{void 0!==e.position&&(tl.current[e.position]=e)}),o===P.yP.VIDEO_6V6){let e=null==i?void 0:null===(v=i[null===(_=Object.keys(i))||void 0===_?void 0:_[0]])||void 0===v?void 0:v.room_link_silence_status;void 0!==e&&eS(e)}tp({listUsers:e,type:o,linkUsers:null==i?void 0:null===(u=i[null===(c=Object.keys(i))||void 0===c?void 0:c[0]])||void 0===u?void 0:u.linked_users})}if(es.includes(S.V0x.LinkmicPlayMode_OrderSing)){let[e,t]=await Promise.all([(0,d.RO)({room_id:g}),(0,B.ZP)({service_name:"webcast.douyin.live_pc",key:"order_sing_info"})]);if(e.data.data&&0===e.data.status_code){let i=e.data.data;i.live_linkmic_order_sing_micro_opt=b,i.golden_microphone_icon=null==t?void 0:t.golden_microphone_icon,i.silver_microphone_icon=null==t?void 0:t.silver_microphone_icon,i.user_microphone_list=null!==(h=null===(m=e.data.data.user_microphone_list)||void 0===m?void 0:m.map(e=>{var t,i,n;return(null===(i=null==e?void 0:null===(t=e.microphone_list)||void 0===t?void 0:t.length)||void 0===i||i)&&(e.microphone_list=[...null!==(n=e.microphone_list)&&void 0!==n?n:[],{microphone_type:S.W5X.GOLDEN_MICROPHONE,micro_phone_num:0}]),e}))&&void 0!==h?h:[],em(i),null==e4||e4.liveAudiencePlayModeRoomEvent(ts.current,"request_song")}}(0,B.ZP)({service_name:"webcast.douyin.live_pc",key:"agc_anchor_list"}).then(e=>{e&&(null==e?void 0:e.includes(y))&&eG(!0)})},[tp,e0,eC,o,ty,eS,es,em,eG,eU,eH,eX]);j.useEffect(()=>{!ti.current&&(tE(),ti.current=!0)},[tE]);let tS=(0,K.F)(),tL=j.useRef(eL);j.useEffect(()=>{tL.current=eL},[eL]),j.useEffect(()=>e7.syncOn("ControlMessage",e=>{let{method:t,payload:i}=e;if(!!t&&!!i)switch(Number(i.action)){case a.Rz.FINISH:case a.Rz.FINISH_BY_ADMIN:case a.Rz.ROOM_FINISH_BY_SWITCH:v.kg.info("直播间断播消息下发, 离开聊天室"),X=!0,e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{null==e4||e4.liveLinkMicDurationEvent(ts.current),null==e4||e4.liveVoiceRoomLayoutWatchDuration(el(ts.current,(0,Y.ic)(td.current)),er(ts.current,tc.current)),(0,h.SH)(o,ea)?(null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(ts.current,ta.current),eL===h.cK.LINKED&&(null==e4||e4.liveAudiencePlayModeRoomLinkDurationEvent(void 0,ta.current)),eL===h.cK.LINKED&&(null==e4||e4.liveLeaveLinkMicEvent(u.JW.NONE,u._o.ANCHOR,ta.current))):(e9||te||tt)&&(null==e4||e4.liveLeaveLinkMicEvent(u.JW.NONE,u._o.ANCHOR),null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent()),eN()})}}),[e8,eN,ea,o,eL,t,e7,e4]),j.useEffect(()=>null==e7?void 0:e7.syncOn("MemberMessage",e=>{let{method:t,payload:n}=e;if(!t||!n)return;let r=Number(n.action);switch(r){case a.WU.KICK_OUT:case a.WU.BLOCK:case a.WU.LEAVE:if(r===a.WU.LEAVE&&(null==n?void 0:n.action_description)==="WEB_INITIATIVE"||r===a.WU.LEAVE&&i)return;v.kg.info("直播间用户被踢出, 离开聊天室"),e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{null==e4||e4.liveLinkMicDurationEvent(ts.current),null==e4||e4.liveVoiceRoomLayoutWatchDuration(el(ts.current,(0,Y.ic)(td.current)),er(ts.current,tc.current)),(0,h.SH)(o,ea)&&(null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(ts.current,ta.current)),eN()})}}),[e8,eN,w,ea,o,t,e7,e4,i]),j.useEffect(()=>e7.syncOn("NoticeMessage",e=>{let{method:t,payload:i}=e;if(!!t&&!!i){if(Number(i.notice_type)===a.F3.PAUSE)v.kg.info("直播间被封禁, 离开聊天室"),e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{null==e4||e4.liveLinkMicDurationEvent(ts.current),null==e4||e4.liveVoiceRoomLayoutWatchDuration(el(ts.current,(0,Y.ic)(td.current)),er(ts.current,tc.current)),(0,h.SH)(o,ea)&&(null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(ts.current,ta.current)),eN()})}}),[t]),j.useEffect(()=>e7.syncOn("LinkSettingNotifyMessage",e=>{let{method:t,payload:i}=e;if(!t||!i)return;let n=Number(null==i?void 0:i.message_type);v.kg.info("uselinkmic",t,n,i);let{settings:r}=i;(null==r?void 0:r.find(e=>24===e.value))?o!==P.yP.AUDIO_1V8_STAGE&&eP(P.yP.AUDIO_1V8):(null==r?void 0:r.find(e=>26===e.value))&&eP(P.yP.AUDIO_GRID);try{if(null==r?void 0:r.find(e=>72===e.key)){var l,s;let e=M()(L.settings).findIndex(e=>72===e.key),t=null==r?void 0:r.find(e=>72===e.key);if(e>=0&&Array.isArray(L.settings)&&e<(null===(l=L.settings)||void 0===l?void 0:l.length)){let i=null===(s=L.settings)||void 0===s?void 0:s.slice();i[e]=(0,c._0)(t),eO(i)}}}catch(e){v.kg.info("处理嘉宾大作战设置消息变更异常",e)}eh(ty(r))}),[t,ty,null==L?void 0:L.settings,eP,o,eO,eh]);let tC=j.useCallback((e,t,i)=>{(null==e6?void 0:e6.isReady)&&(0,m.Qz)({anchor_id:N()(e0,"anchor.id_str",""),room_id:null==e0?void 0:e0.roomId,user_id:null==e6?void 0:e6.id_str,scene:e,playmode:t,ui_layout:i})},[e0,e6]);j.useEffect(()=>e7.syncOn("LinkMicMethod",e=>{let{method:t,payload:i}=e;if(!!t&&!!i)switch(Number(i.message_type)){case p.iM.TYPE_KICKOUTED:Z.F.info("你的连线已被断开"),e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{eb(h.cK.NOT_LINK)});break;case p.iM.TYPE_SWITCH_SCENE:let n;let{scene:r,play_modes:l=[],linked_list_users:s=[],linker_content_map:d={},ui_layout:v}=i;if(eI(v),"string"==typeof r){let e=Number(r);if(eo(e),eW&&16!==e&&(eU(!1),e2.current=0,eS(void 0)),!eW&&16===e&&e2.current>0&&(eU(!0),eH("crossLink")),e===a.vX.AUDIO_KTV)D(!0),e1(a.Ly.MULTI_KTV),tC(e,l,v);else{let e=Number(v);n=(0,_.M2)(e,eD)}void 0!==n&&eP(n)}if((n=void 0===n?o:n)===P.yP.VIDEO_6V6){var m,f;let e=null===(f=Object.values(d))||void 0===f?void 0:null===(m=f[0])||void 0===m?void 0:m.linked_users,t=t_(s,e);tp({listUsers:null==t?void 0:t.map(c._0),type:n,linkUsers:null==e?void 0:e.map(c._0)})}else tp({listUsers:null==s?void 0:s.map(c._0),type:n,version:null==i?void 0:i.version});break;case p.iM.TYPE_LINKED_LIST_CHANGED:let g=Number(null==i?void 0:i.ui_layout),y=(0,_.M2)(g,eD);eI(null==i?void 0:i.ui_layout),void 0!==y&&eP(y);case p.iM.TYPE_FINISH:}}),[tS,t_,o,eL,null==e5?void 0:e5.root,eD,eP,D,e1,eo,tp,e8,eb,t,eW,eH]),j.useEffect(()=>e7.syncOn("LinkMessage",e=>{var t,i,n,r,l,s,a,d,m,f,p,y,b,I,E,S,L,C,w,N,k,T,F;let{method:M,payload:D}=e;if(!M||!D)return;let G=Number(D.message_type);switch(v.kg.info("uselinkmic",M,G,D),G){case g.W6.TYPE_LINKER_CLOSE:!X&&e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(void 0,ta.current),null==e4||e4.liveLinkMicDurationEvent(ts.current,ta.current),null==e4||e4.liveVoiceRoomLayoutWatchDuration(el(ts.current,(0,Y.ic)(td.current)),er(ts.current,tc.current)),eL===h.cK.LINKED&&(null==e4||e4.liveAudiencePlayModeRoomLinkDurationEvent(void 0,ta.current)),eL===h.cK.LINKED&&(null==e4||e4.liveLeaveLinkMicEvent(u.JW.NONE,u._o.ANCHOR,ta.current)),eN()});break;case g.W6.TPYE_LINKER_LEAVE:tp({listUsers:null===(i=D.leave_content)||void 0===i?void 0:null===(t=i.linked_users)||void 0===t?void 0:t.map(c._0),version:null==D?void 0:null===(n=D.leave_content)||void 0===n?void 0:n.version});break;case g.W6.TPYE_LINKER_ENTER:tp({listUsers:null==D?void 0:null===(l=D.enter_content)||void 0===l?void 0:null===(r=l.linked_users)||void 0===r?void 0:r.map(c._0),version:null==D?void 0:null===(s=D.enter_content)||void 0===s?void 0:s.version}),(null==e6?void 0:e6.id_str)&&(null===(a=D.enter_content)||void 0===a?void 0:a.user_id)===(null==e6?void 0:e6.id_str)&&ep(tg());break;case g.W6.TYPE_LINKER_UPDATE_USER:tp({listUsers:null===(m=D.update_user_content)||void 0===m?void 0:null===(d=m.linked_users)||void 0===d?void 0:d.map(c._0),version:null==D?void 0:null===(f=D.update_user_content)||void 0===f?void 0:f.version});break;case g.W6.TPYE_LINKER_SYS_KICK_OUT:case g.W6.TPYE_LINKER_KICK_OUT:v.kg.info("接收被踢出房间，更新上麦状态"),e8(u.JW.NONE,u._o.ANCHOR).finally(()=>{eb(h.cK.NOT_LINK)});break;case g.W6.TYPE_LINKER_LOCK_POSITION:let{locked_positions:j}=D.lock_position_content;tl.current={},null==j||j.forEach(e=>{if("string"==typeof e.position){let t=Number(e.position);e.position=t,tl.current[t]=e}else"number"==typeof e.position&&(tl.current[e.position]=e)}),ep(tg());break;case g.W6.TYPE_LINKER_LINKED_LIST_CHANGE:o===P.yP.VIDEO_6V6?tp({listUsers:void 0,type:o,linkUsers:null===(b=Object.values(null===(I=D.linked_list_change_content)||void 0===I?void 0:I.linker_content_map))||void 0===b?void 0:null===(y=b[0])||void 0===y?void 0:null===(p=y.linked_users)||void 0===p?void 0:p.map(c._0)}):tp({listUsers:null===(S=D.linked_list_change_content)||void 0===S?void 0:null===(E=S.linked_users)||void 0===E?void 0:E.map(c._0),version:null===(L=D.linked_list_change_content)||void 0===L?void 0:L.version});break;case g.W6.TYPE_LINKER_CROSS_ROOM_UPDATE:let{linker_content_map:V}=D.cross_room_update_content;eS(null===(w=Object.values(V))||void 0===w?void 0:null===(C=w[0])||void 0===C?void 0:C.room_link_silence_status);break;case g.W6.TYPE_ENLARGE_GUEST_INVITE:R(null==D?void 0:null===(N=D.enlarge_guest_invite_content)||void 0===N?void 0:N.from_user_id),O(((null==D?void 0:null===(T=D.enlarge_guest_invite_content)||void 0===T?void 0:null===(k=T.ui_image)||void 0===k?void 0:k.url_list)||[])[0]||""),A((null==D?void 0:null===(F=D.enlarge_guest_invite_content)||void 0===F?void 0:F.target_enlarge_guest_type)||0);break;case g.W6.TYPE_LINKER_UILAYOUT_CHANGE:let{ui_layout:U}=null==D?void 0:D.linker_ui_layout_change_content,B=Number(U);eI(B),eP((0,_.M2)(B,eD));break;case g.W6.TYPE_LINKER_CROSS_LINK_INFO_UPDATE:let{cross_link_info_update:W={}}=D,{cross_link_timer_start:H=Math.floor(Date.now()/1e3)}=W;e2.current=Number(H),eW?eH("crossLink"):16===en&&(eU(!0),eH("crossLink"));break;case g.W6.TYPE_LINKER_CROSS_LINK_FINISH:let{cross_link_finish:K={}}=D,$=null==e6?void 0:e6.id_str,Q=x()(ef),q=null==Q?void 0:Q.includes($),{finish_toast:J="",guest_finish_toast:z=""}=K;eW&&(eU(!1),e2.current=0,eS(void 0),q&&z?Z.F.info(z,e5.root):J&&Z.F.info(J,e5.root))}}),[t,R,o,tp,eb,e8,eN,tg,ep,eL,eP,eS,e6,eD,eW,eU,eH,ef,null==e5?void 0:e5.root,en]),j.useEffect(()=>e7.syncOn("LinkerContributeMessage",e=>{let{method:t,payload:i}=e;if(!t||!i)return;null==i||i.message_type;let{total_score_str:n,total_score_real_str:o,user_contribute_list:r,user_id:l}=i,s=(null==r?void 0:r.map(e=>String(null==e?void 0:e.user_id)))||[],a=String(l),u=Object.keys(tn.current).find(e=>{var t;return(null===(t=tn.current[e].user)||void 0===t?void 0:t.id_str)===a});if(u&&tn.current[u]){var d;let e=null===(d=tn.current[u].content)||void 0===d?void 0:d.linkmic_audience_content;e&&(e.rank_contributor_ids=s,e.fan_ticket_real_str=o,e.fan_ticket_fuzzy_str=n)}ep(tg())}),[tg,ep,t]),j.useEffect(()=>e7.syncOn("LinkmicTeamfightScoreMessage",e=>{let{method:t,payload:i}=e;if(!t||!i)return;null==i||i.message_type;let{teamfight_info:n}=i,o=(0,c._0)(n);ta.current=F,ed(o,!0)}),[ed,F]),j.useEffect(()=>e7.syncOn("LinkmicTeamfightMessage",e=>{var t,i,n,r,l;let{method:s,payload:a}=e;if(!s||!a)return;let{teamfight_info:u,finish_content:d,settle_content:v}=a,_=(0,c._0)(u),m=null==e6?void 0:e6.id_str,f=T()(null==u?void 0:null===(t=u.team_infos)||void 0===t?void 0:t.map(e=>{var t;return null==e?void 0:null===(t=e.players)||void 0===t?void 0:t.map(e=>String(null==e?void 0:e.user_id))})),g=null==f?void 0:f.includes(m);if(a.msg_type===S.Vql.LinkmicTeamfightMessageType_CREATE&&(null==e4||e4.liveLinkMicRoomShowEvent(ts.current||P.yP.VIDEO_T1_V_B8),(null==a?void 0:null===(i=a.teamfight_info)||void 0===i?void 0:i.type)===y.yw.LinkmicTeamfightType_TWO_TEAM&&("video"===ei?G()():(eq(o),eP(P.yP.AUDIO_1V8)),g&&(null==e4||e4.liveAudiencePlayModeRoomLinkEvent(u)))),a.msg_type===S.Vql.LinkmicTeamfightMessageType_START&&((null==a?void 0:null===(n=a.teamfight_info)||void 0===n?void 0:n.type)===y.yw.LinkmicTeamfightType_TWO_TEAM&&g&&Z.F.info("如不愿参与作战可退出连线",e5.root),(null==a?void 0:null===(r=a.teamfight_info)||void 0===r?void 0:r.type)===y.yw.LinkmicTeamfightType_ROOM_BATTLE&&(eH("pk"),g&&(Z.F.info("跨房对战已开启 如不愿参与对战可退出连线"),null==e4||e4.liveAudiencePlayModeRoomLinkEvent(void 0,"room_grouppk")))),a.msg_type===S.Vql.LinkmicTeamfightMessageType_FINISH){if((null==a?void 0:null===(l=a.teamfight_info)||void 0===l?void 0:l.type)===y.yw.LinkmicTeamfightType_TWO_TEAM){if("video"===ei)G()();else{let e=N()(e0,"room.linker_detail.linker_play_modes",[]);setTimeout(()=>{e.includes(24)?eQ?(eP(eQ),eq(void 0)):eP(P.yP.AUDIO_1V8):e.includes(26)&&eP(P.yP.AUDIO_GRID)},1e3)}}null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(void 0,ta.current)}let p=Number(a.msg_type);p===S.Vql.LinkmicTeamfightMessageType_FINISH&&(eW?(eH("crossLink"),e2.current=0):eS(void 0),eL===h.cK.LINKED&&(null==e4||e4.liveAudiencePlayModeRoomLinkDurationEvent(void 0,ta.current)),setTimeout(()=>{var e,t,i,n;let o=tL.current===h.cK.LINKED;o&&(null!==(e=null==d?void 0:d.guest_finish_toast)&&void 0!==e?e:"")!==""?ee(null!==(i=null==d?void 0:d.guest_finish_toast)&&void 0!==i?i:"",e5.root):!o&&(null!==(t=null==d?void 0:d.finish_toast)&&void 0!==t?t:"")!==""&&ee(null!==(n=null==d?void 0:d.finish_toast)&&void 0!==n?n:"",e5.root)},1e3)),p===S.Vql.LinkmicTeamfightMessageType_PUNISH&&(null==v?void 0:v.disable_show_toast)!==""&&(null==v?void 0:v.disable_show_toast)!==void 0&&Z.F.info(null==v?void 0:v.disable_show_toast),ta.current=F,ed(_)}),[ei,e5.root,e0,o,ef,eL,e6,ed,eP,eS,F,tL,t,eW,eH,eq,eQ]),j.useEffect(()=>e7.syncOn("LinkmicProfitEggMessage",e=>{let{method:t,payload:i}=e;if(!!t&&!!i)ej(i)}),[ej]),j.useEffect(()=>e7.syncOn("LinkmicOrderSingMessage",e=>{let{method:t,payload:i}=e;if(!t||!i)return;let o=Number(null==i?void 0:i.message_type);switch(v.kg.info("uselinkmic",t,o,i),o){case b.TYPE_MESSAGE_CREATE:let{order_sing_create_content:r}=i;(0,B.ZP)({service_name:"webcast.douyin.live_pc",key:"order_sing_info"}).then(e=>{let t=C()(e_)||{};t.golden_microphone_icon=null==e?void 0:e.golden_microphone_icon,t.silver_microphone_icon=null==e?void 0:e.silver_microphone_icon,t.gift_id=Number(null==r?void 0:r.gift_id),t.gift_ids=null==r?void 0:r.gift_ids,t.audition_gift_ids=null==r?void 0:r.audition_gift_ids;let i=Object.keys(ef).map(e=>{var t,i;return{microphone_list:[{microphone_type:S.W5X.GOLDEN_MICROPHONE,micro_phone_num:0},{microphone_type:S.W5X.SILVER_MICROPHONE,micro_phone_num:0}],order_user:{id:null===(i=ef[e].user)||void 0===i?void 0:null===(t=i.user)||void 0===t?void 0:t.id_str}}});t.user_microphone_list=i,tu.current=e_,em(t),eu([...es,S.V0x.LinkmicPlayMode_OrderSing]),eJ((null==r?void 0:r.show_gift_info)||!1),null==e4||e4.liveAudiencePlayModeRoomEvent(ts.current)}),(null==r?void 0:r.open_order_sing_toast)&&Z.F.info(r.open_order_sing_toast);break;case b.TYPE_MESSAGE_FINISH:let{order_sing_finish_content:l}=i;(null==l?void 0:l.close_order_sing_toast)&&Z.F.info(null==l?void 0:l.close_order_sing_toast),tu.current=e_,em(void 0),n(h.uH.NONE),es.includes(S.V0x.LinkmicPlayMode_OrderSing)&&eu(es.filter(e=>e!==S.V0x.LinkmicPlayMode_OrderSing));break;case b.TYPE_MESSAGE_SING_ACTION_TOAST:let{order_sing_action_toast_content:s}=i;(null==s?void 0:s.start_sing_toast)?Z.F.info(s.start_sing_toast):(null==s?void 0:s.oder_sing_toast)?Z.F.info(s.oder_sing_toast):(null==s?void 0:s.finish_sing_toast)&&Z.F.info(s.finish_sing_toast);break;case b.TYPE_MESSAGE_SING_ACTION:(0,d.RO)({room_id:e0.roomId}).then(e=>{if(e.data.data&&0===e.data.status_code){var t,i;let n=C()(e_)||e.data.data;n.user_microphone_list=null!==(i=null===(t=e.data.data.user_microphone_list)||void 0===t?void 0:t.map(e=>{var t,i,n;return(null===(i=null==e?void 0:null===(t=e.microphone_list)||void 0===t?void 0:t.length)||void 0===i||i)&&(e.microphone_list=[...null!==(n=e.microphone_list)&&void 0!==n?n:[],{microphone_type:S.W5X.GOLDEN_MICROPHONE,micro_phone_num:0}]),e}))&&void 0!==i?i:[],n.current_sing_item=e.data.data.current_sing_item,n.auto_enlarge=e.data.data.auto_enlarge,n.gift_id=e.data.data.gift_id,em(n)}})}}),[t,e0.roomId,n,ef,es,eu,e_,em,eJ]),j.useEffect(()=>e7.syncOn("LinkmicOrderSingScoreMessage",e=>{var t,i,n,o,r;let{method:l,payload:s}=e;if(!l||!s)return;let a=Number(null==s?void 0:s.message_type);v.kg.info("uselinkmic",l,a,s);let{order_sing_score_content:u}=s,{user_score:d}=null!=u?u:{},_=C()(e_),m=[{microphone_type:S.W5X.GOLDEN_MICROPHONE,micro_phone_num:null!==(i=null==d?void 0:d.golden_microphone_num)&&void 0!==i?i:0,title_sponsor:null!==(n=null==d?void 0:d.title_sponsor)&&void 0!==n?n:{},hit_toast:null!==(o=null==d?void 0:d.hit_toast)&&void 0!==o&&o},{microphone_type:S.W5X.SILVER_MICROPHONE,micro_phone_num:null!==(r=null==d?void 0:d.silver_microphone_num)&&void 0!==r?r:0}],h=!1;if(null==_||null===(t=_.user_microphone_list)||void 0===t||t.map(e=>{var t;String(null===(t=e.order_user)||void 0===t?void 0:t.id)===(null==d?void 0:d.user_id)&&(h=!0,e.microphone_list=m)}),!h){let e=(null==_?void 0:_.user_microphone_list)?[...null==_?void 0:_.user_microphone_list]:[];e.push({order_user:{id:null==d?void 0:d.user_id},microphone_list:m}),_&&(_.user_microphone_list=e)}tu.current=e_,_&&em(_),d&&ek((0,c._0)(d))}),[e_,em,ek,t]),j.useEffect(()=>e7.syncOn("GuestBattleMessage",e=>{var t,i;let{method:n,payload:o}=e;if(!n||!o)return;let r=Number(null==o?void 0:o.message_type);v.kg.info("uselinkmic",n,r,o);let{battle_info:l,finish_content:s,finish_toast:a}=o,u=null===(i=x()(ef))||void 0===i?void 0:null===(t=i.map(e=>{var t,i;return null==e?void 0:null===(i=e.user)||void 0===i?void 0:null===(t=i.user)||void 0===t?void 0:t.id_str}))||void 0===t?void 0:t.filter(e=>![void 0,""].includes(e)),d=null==e6?void 0:e6.id_str,_=null==u?void 0:u.includes(d),m=Number(o.msg_type);ev((0,c._0)(l)),m===S.$s7.GuestBattle_CREATE&&(localStorage.removeItem("guest_battle_animation"),null==e4||e4.guestBattleLiveConnectionGameTransformEvent(),_&&setTimeout(()=>{Z.F.info("如不愿参与作战可退出连线",e5.root)},1750)),m===S.$s7.GuestBattle_FINISH?(eS(void 0),eL===h.cK.LINKED&&(null==e4||e4.liveAudiencePlayModeRoomLinkDurationEvent(void 0,ta.current)),null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(void 0,void 0,void 0,void 0,ec),""!==a?(Z.F.info(a,e5.root),localStorage.removeItem("guest_battle_animation")):(null==s?void 0:s.reason)===S.GO3.FinishGuestBattleReason_SCENE_CHANGE&&(Z.F.info("本轮作战结束，恢复原始连线记值展示",e5.root),localStorage.removeItem("guest_battle_animation"))):m===S.$s7.GuestBattle_PAUSE?Z.F.info("大作战计时已暂停",e5.root):m===S.$s7.GuestBattle_RESUME&&Z.F.info("大作战计时继续",e5.root)}),[e5.root,ef,eL,e6,ec,ev,eS,t]),j.useEffect(()=>e7.syncOn("GuestBattleScoreMessage",e=>{let{method:t,payload:i}=e;if(!t||!i)return;let n=Number(null==i?void 0:i.message_type);v.kg.info("uselinkmic",t,n,i);let{battle_info:o}=i;ev((0,c._0)(o))}),[ev,t]),j.useEffect(()=>null==e7?void 0:e7.wrds.on("RoomDataSyncMessage","RoomLinkMicSyncData",e=>{let t=N()(e,"payload.payload.linker_base_info.anchor_manual_open_ui_layout");t&&eY(Number(t))}),[eY]),j.useEffect(()=>null==e7?void 0:e7.syncOn("LinkmicPlaymodeMessage",e=>{let{method:t,payload:i}=e;if(!!t&&!!i){if(null==i?void 0:i.linkmic_subtitle_status){var n;e$({isOpen:!0,type:(null==i?void 0:null===(n=i.linkmic_subtitle_status)||void 0===n?void 0:n.subtitle_type)||S.rFD.SubtitleType_Room})}}}),[e$]),j.useEffect(()=>null==e7?void 0:e7.on("LinkmicProfitMessage",e=>{e.forEach(e=>{let{method:t,payload:i}=e;if(!t||!i)return;let n=i.msg_type;if("string"==typeof i.msg_type&&(n=Number(i.msg_type)),7===n&&eu([...es,S.V0x.LinkmicPlayMode_NormalPaidLinkmic]),8===n&&eu(es.filter(e=>e!==S.V0x.LinkmicPlayMode_NormalPaidLinkmic)),20===n){var o,r;e$({isOpen:!0,type:(null==i?void 0:null===(r=i.audio_subtitle_start_content)||void 0===r?void 0:null===(o=r.linkmic_subtitle_status)||void 0===o?void 0:o.subtitle_type)||S.rFD.SubtitleType_Room})}21===n&&e$({isOpen:!1,type:S.rFD.SubtitleType_Room})})}),[e7]);let tw=j.useCallback(()=>{eL===h.cK.LINKED&&(null==e4||e4.liveLeaveLinkMicEvent(u.JW.NONE,u._o.AUDIENCE,ta.current),(0,h.SH)(o,ea)&&(null==e4||e4.liveAudiencePlayModeRoomLinkDurationEvent(o,ta.current))),void 0!==o&&(null==e4||e4.liveLinkMicDurationEvent(ts.current),null==e4||e4.liveVoiceRoomLayoutWatchDuration(el(ts.current,(0,Y.ic)(td.current)),er(ts.current,tc.current)),(0,h.SH)(o,ea)?null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent(void 0,void 0,[],tu.current):(e9||te||tt)&&(null==e4||e4.liveAudiencePlayModeRoomWatchDurationEvent())),e8(u.JW.NONE,u._o.AUDIENCE,!0)},[e8,eL,ea,o]);j.useEffect(()=>{let e="onpagehide"in self?"pagehide":"unload",t=e=>{if(eL===h.cK.LINKED)return e.returnValue="正在连麦中，是否确认离开？","正在连麦中，是否确认离开？"};return(0,W.DT)()?window.addEventListener("beforeunload",tw):(window.addEventListener("beforeunload",t),window.addEventListener(e,tw)),()=>{(0,W.DT)()?window.removeEventListener("beforeunload",tw):(window.removeEventListener("beforeunload",t),window.removeEventListener(e,tw))}},[eL,tw]),(0,q.Z)(()=>{tw()});j.useEffect(()=>{eL===h.cK.LINKED},[!1,!1,eL,tw])},ei=i("270506"),en=i("542601"),eo=i("867204");let er=function(e,t){let i="party";return(e===P.yP.AUDIO_1V8||e===P.yP.AUDIO_DOUBLE_C||e===P.yP.VIDEO_1V6||e===P.yP.VIDEO_DYNAMIC_FLOAT)&&(i="radio"),e===P.yP.MATE_CUSTOM&&(i="audio_audience"),"new_audience"===t&&(i="new_audience"),i},el=(e,t)=>t?e===P.yP.AUDIO_DOUBLE_C?"seat_enlarge_double":"seat_enlarge":[P.yP.VIDEO_DYNAMIC,P.yP.VIDEO_DYNAMIC_FLOAT,P.yP.VIDEO_1_V_3,P.yP.VIDEO_1_V_6].includes(e)?"seat_fit":"normal",es=(e,t)=>e===P.yP.AUDIO_DOUBLE_C&&26===t?"stable_double":eo.i7[e]||"",ea=(0,o.Pi)(e=>{let{isVerifyed:t}=e,{linkmicStore:{linkRoomType:i,linkMicLayout:n,linkMicSeats:o,functionType2:r,openUiLayout:l},userStore:{userInfo:s},eventStore:{linkmicEvent:a},singletonStore:{setAudioPower:u}}=(0,U.o)();(0,j.useEffect)(()=>{u(new en.a)},[]),et({isVerifyed:t}),(0,ei.Z)();let d=j.useRef(""),c=j.useRef(""),v=j.useRef(n),_=j.useRef(r),m=j.useRef(!1),h=j.useMemo(()=>0!==M()(o).filter(e=>!!(null==e?void 0:e.user)).length,[o]),f=j.useMemo(()=>i&&o&&Object.values(o).some(e=>N()(e,"user.user.id_str","")===N()(s,"id_str","")),[i,o,s]);return j.useEffect(()=>{if(!!h)er(n,r)!==_.current&&void 0!==n?(m.current&&(null==a||a.liveVoiceRoomLayoutWatchDuration(d.current,_.current,v.current),null==a||a.liveAudienceRoomLayoutShow(n),null==a||a.liveLinkMicRoomShowEvent(n),null==a||a.liveLinkMicDurationEvent(v.current,void 0,_.current)),f&&(null==a||a.liveLeaveLinkMicEvent(void 0,void 0,void 0,er(v.current)),null==a||a.liveConnectLinkMicEvent(0,0))):el(n,(0,Y.ic)(o))!==d.current?m.current&&(null==a||a.liveVoiceRoomLayoutWatchDuration(d.current,er(n,r),v.current),null==a||a.liveAudienceRoomLayoutShow(n)):es(n,l)!==c.current&&m.current&&(null==a||a.liveVoiceRoomLayoutWatchDuration(d.current,er(n,r),v.current),null==a||a.liveAudienceRoomLayoutShow(n)),!m.current&&(void 0!==n||"new_audience"===r)&&(null==a||a.liveAudienceRoomLayoutShow(n,er(n,r)),null==a||a.liveLinkMicRoomShowEvent(n),m.current=!0),_.current=er(n,r),v.current=n,c.current=es(n,l),d.current=el(n,(0,Y.ic)(o))},[n,r,h,er(n,r),f,el(n,(0,Y.ic)(o)),es(n,l),(0,Y.ic)(o),o,l]),null});var eu=(0,o.Pi)(()=>{let{roomStore:{isVerified:e}}=(0,U.o)();return(0,n.jsx)(ea,{isVerifyed:e})})},231761:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("53051").then(i.bind(i,394063)),{ssr:!1}),{name:r.l.LinkMicLayoutPlugin,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.LinkMicLayoutPlugin,condition:e=>{let{store:t}=e,{linkmicStore:{useNewLinkMicRender:i,linkRoomTypeHooks:n,isNewVideoLinkmicRoom:o},feedStore:{isActive:r}}=t;return r&&!o&&(i||"audio"===n||"video"===n)},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.LinkMicLayoutPlugin}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.LinkMicLayoutPlugin,index:0})},627179:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.resolve().then(i.bind(i,861481)),{ssr:!1}),{name:r.l.LinkMicPlayModeLimitPlugin,renderWhen:l._.FirstFrame,taskPriority:"user-visible"});(0,s.GI)({name:r.l.LinkMicPlayModeLimitPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.LinkMicPlayModeLimitPlugin}),layoutName:o.t.TipsLayout,ComponentName:r.l.LinkMicPlayModeLimitPlugin,index:0})},384184:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("73260").then(i.bind(i,408505)),{ssr:!1}),{name:r.l.NewLinkInitPlugin,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.NewLinkInitPlugin,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.NewLinkInitPlugin}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.NewLinkInitPlugin,index:0})},105326:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("4547").then(i.bind(i,322317)),{ssr:!1}),{name:r.l.NewLinkMicLogicPlugin,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.NewLinkMicLogicPlugin,condition:e=>{let{store:t}=e,{linkmicStore:{useNewLinkMicRender:i,linkRoomTypeHooks:n,isNewVideoLinkmicRoom:o},feedStore:{isActive:r}}=t;return r&&o&&(i||"audio"===n||"video"===n)},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.NewLinkMicLogicPlugin}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.NewLinkMicLogicPlugin,index:0})},271261:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("76746"),i.e("95395"),i.e("51385"),i.e("16489")]).then(i.bind(i,217509)),{ssr:!1}),{name:r.l.NEW_VIDEO_ROOM_PLUGIN,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.NEW_VIDEO_ROOM_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{useNewLinkMicRender:n,linkRoomType:o,isNewVideoLinkmicRoom:r}}=t;return i&&!n&&"video"===o&&r},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.NEW_VIDEO_ROOM_PLUGIN}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.NEW_VIDEO_ROOM_PLUGIN,index:0})},413221:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("15463").then(i.bind(i,353181)),{ssr:!1}),{name:r.l.OrderSingPlugin,renderWhen:l._.FirstFrame,taskPriority:"user-visible"});(0,s.GI)({name:r.l.OrderSingPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{orderSingInfo:n}}=t;return i&&!!n},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.OrderSingPlugin}),layoutName:o.t.LinkMicAnimationLayout,ComponentName:r.l.OrderSingPlugin,index:0})},148541:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("18419").then(i.bind(i,923818)),{ssr:!1}),{name:r.l.PKSEIPlugin,renderWhen:l._.LivingInit});(0,s.GI)({name:r.l.PKSEIPlugin,condition:e=>{var t;let{store:i}=e;return null==i?void 0:null===(t=i.feedStore)||void 0===t?void 0:t.isActive},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.PKSEIPlugin}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.PKSEIPlugin,index:0})},425641:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("67393").then(i.bind(i,444991)),{ssr:!1}),{name:r.l.PK_VIEW_PLUGIN,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.PK_VIEW_PLUGIN,condition:e=>{var t,i;let{store:n}=e;return(null==n?void 0:null===(t=n.pkStore)||void 0===t?void 0:t.pkStatus)&&(null==n?void 0:null===(i=n.feedStore)||void 0===i?void 0:i.isActive)},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.PK_VIEW_PLUGIN}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.PK_VIEW_PLUGIN,index:0})},602956:function(e,t,i){i(675373),i(250440);var n=i(563097);i(88648);var o=i(618618),r=i(616003),l=i(700061),s=i(246647),a=i(595902),u=i(446042),d=i(770732),c=i(669556),v=i(300253),_=i(338426);let m=(0,v.n)((0,_.ZP)(()=>Promise.all([i.e("3556"),i.e("76746"),i.e("56689"),i.e("33772"),i.e("47735"),i.e("86617"),i.e("95395"),i.e("25413")]).then(i.bind(i,968507)),{ssr:!1}),{name:s.l.RTC_LAYER_PLUGIN,renderWhen:a._.FirstFrame,taskPriority:"user-visible"});(0,u.GI)({name:s.l.RTC_LAYER_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{linkRoomType:n,isNewVideoLinkmicRoom:l},roomStore:{roomStatus:s,playerCoverText:a}}=t;return!!(i&&n&&s!==o.LV.END&&!l&&[r.kx.NONE,r.kx.ANCHOR_BAN].includes(a))},Component:m,index:0}),t.Z=(0,c.OV)({Component:()=>(0,n.jsx)(d.Z,{name:s.l.RTC_LAYER_PLUGIN}),layoutName:l.t.LinkMicLayout,ComponentName:s.l.RTC_LAYER_PLUGIN,index:0})},312894:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("64914").then(i.bind(i,715276)),{ssr:!1}),{name:r.l.UpdateFunctionTypePlugin,renderWhen:l._.FirstFrame,taskPriority:"background"});(0,s.GI)({name:r.l.UpdateFunctionTypePlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:i}}=t;return i},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.UpdateFunctionTypePlugin}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.UpdateFunctionTypePlugin,index:0})},466193:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("28251"),i.e("76746"),i.e("26848"),i.e("14473"),i.e("95395"),i.e("45366"),i.e("51385"),i.e("7406"),i.e("64551")]).then(i.bind(i,42909)),{ssr:!1}),{name:r.l.VIDEO_ROOM_PLUGIN,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.VIDEO_ROOM_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i},linkmicStore:{useNewLinkMicRender:n,linkRoomType:o,isNewVideoLinkmicRoom:r}}=t;return i&&!n&&"video"===o&&!r},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.VIDEO_ROOM_PLUGIN}),layoutName:o.t.LinkMicLayout,ComponentName:r.l.VIDEO_ROOM_PLUGIN,index:0})},270506:function(e,t,i){i(250440);var n=i(88648),o=i(818597),r=i(499198),l=i(983253);t.Z=()=>{let{linkmicStore:{linkMicSeats:e,choosePeopleArr:t,setChoosePeopleArr:i,setChoosePeopleAll:s,choosePanelVisible:a,isCrossLink:u,isNewVideoLinkmicRoom:d},roomStore:{roomInfo:c}}=(0,o.o)(),{isRoomBattle:v}=(0,r.Z)(),_=(0,l.Rs)("anchor_id");(0,n.useEffect)(()=>{var n,o,r,l,a,m,h,f,g;if(!(null==e?void 0:null===(n=e[0])||void 0===n?void 0:n.user))return;let p=null==c?void 0:null===(o=c.anchor)||void 0===o?void 0:o.id_str;if(t&&(null==t?void 0:t.length)!==0){let n={};v||u?Object.keys(e).forEach(t=>{t<=5&&(n[t]=e[t])}):n=e;let o=Object.values(n).map(e=>{var t,i;return null==e?void 0:null===(i=e.user)||void 0===i?void 0:null===(t=i.user)||void 0===t?void 0:t.id_str}),r=null==t?void 0:t.filter(e=>o.includes(e));r.length!==t.length&&i((null==r?void 0:r.length)>0?r:[p])}else{let t=[];try{t=JSON.parse(null!==(m=localStorage.getItem(`linkmic-last-choose-people-${null==c?void 0:c.roomId}`))&&void 0!==m?m:"[]")}catch(e){}let n=[];t.length>0?n=t:d&&_?n=[_]:(null==e?void 0:null===(a=e[0])||void 0===a?void 0:null===(l=a.user)||void 0===l?void 0:null===(r=l.user)||void 0===r?void 0:r.id_str)&&(n=[null==e?void 0:null===(g=e[0])||void 0===g?void 0:null===(f=g.user)||void 0===f?void 0:null===(h=f.user)||void 0===h?void 0:h.id_str]),i(n);let o=localStorage.getItem(`linkmic-last-choose-people-all-${null==c?void 0:c.roomId}`);s(void 0!==o&&"true"===o)}},[e,t,u,c,_,d,i,s])}},838096:function(e,t,i){i(874386),i(250440);var n=i(727795),o=i(432431),r=i(645260),l=i.n(r),s=i(88648),a=i(818597);t.Z=()=>{let{roomStore:{roomInfo:e},linkmicStore:{playModes:t}}=(0,a.o)(),i=l()(e,"roomId",""),r=s.useRef(!1),[u,d]=s.useState(),c=s.useMemo(()=>null==t?void 0:t.some(e=>[o.V0.LinkmicPlayMode_GuestBattle,o.V0.LinkmicPlayMode_Teamfight,o.V0.LinkmicPlayMode_RoomBattle,o.V0.LinkmicPlayMode_AudioChat_1_PLUS_8].includes(e)),[]);return s.useEffect(()=>{!r.current&&c&&(0,n.y_)({room_id:i,_point:1,use_play_mode_info:!0}).then(e=>{d(null==e?void 0:e.data),r.current=!0})},[c,i]),u}},471121:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("41299").then(i.bind(i,238790)),{ssr:!1}),{name:r.l.GroupLive,renderWhen:l._.FirstFrame});(0,s.GI)({name:r.l.GroupLive,condition:()=>!0,Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.GroupLive}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.GroupLive,index:0})},354391:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(618618),r=i(616003),l=i(700061),s=i(246647),a=i(595902),u=i(446042),d=i(770732),c=i(669556),v=i(300253),_=i(338426);let m=(0,v.n)((0,_.ZP)(()=>i.e("56362").then(i.bind(i,917748)),{ssr:!1}),{name:s.l.PaidLivePlugin,renderWhen:a._.FirstFrame});(0,u.GI)({name:s.l.PaidLivePlugin,condition:e=>{let{store:t}=e,{paidLiveStore:{isPaidLive:i},roomStore:{roomStatus:n,playerCoverText:l}}=t;return i&&n!==o.LV.END&&l!==r.kx.ANCHOR_BAN&&l!==r.kx.KICK_OUT},Component:m,index:0}),t.Z=(0,c.OV)({Component:()=>(0,n.jsx)(d.Z,{name:s.l.PaidLivePlugin}),layoutName:l.t.TipsLayout,ComponentName:s.l.PaidLivePlugin,index:0})},493153:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>Promise.all([i.e("26835"),i.e("48539")]).then(i.bind(i,258879)),{ssr:!1}),{name:r.l.EFFECT_SWITCH_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.EFFECT_SWITCH_PLUGIN,condition:e=>{let{pipContext:t,store:i}=e,{feedStore:{isActive:n},giftStore:{giftStatus:o}}=i;return!(null==t?void 0:t.isLivingPip)&&n&&o},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.EFFECT_SWITCH_PLUGIN}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.EFFECT_SWITCH_PLUGIN,index:0})},725805:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>Promise.all([i.e("26835"),i.e("72650")]).then(i.bind(i,395761)),{ssr:!1}),{name:r.l.GIFT_EFFECT_PLUGIN,renderWhen:l._.LivingInit,taskPriority:"user-visible"});(0,s.GI)({name:r.l.GIFT_EFFECT_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i}}=t;return i},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.GIFT_EFFECT_PLUGIN}),layoutName:o.t.GiftEffectLayout,ComponentName:r.l.GIFT_EFFECT_PLUGIN,index:0})},368974:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("81913").then(i.bind(i,806228)),{ssr:!1}),{name:r.l.Gift_MENU_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"user-visible"});(0,l.GI)({name:r.l.Gift_MENU_PLUGIN,condition:e=>{let{store:t,abTestData:i}=e,{feedStore:{isActive:n}}=t;return n&&(null==i?void 0:i.giftMenu)},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.Gift_MENU_PLUGIN}),layoutName:o.t.GiftMenuLayout,ComponentName:r.l.Gift_MENU_PLUGIN,index:0})},51526:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>i.e("50008").then(i.bind(i,16698)),{ssr:!1}),{name:r.l.GIFT_TRAY_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"user-visible"});(0,l.GI)({name:r.l.GIFT_TRAY_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:i}}=t;return i},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.GIFT_TRAY_PLUGIN}),layoutName:o.t.GiftTrayLayout,ComponentName:r.l.GIFT_TRAY_PLUGIN,index:0})},741597:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(595902),s=i(446042),a=i(770732),u=i(669556),d=i(300253),c=i(338426);let v=(0,d.n)((0,c.ZP)(()=>i.e("8562").then(i.bind(i,658612)),{ssr:!1}),{name:r.l.SERVICE_CENTER_PLUGIN,renderWhen:l._.FirstFrame,taskPriority:"background"});(0,s.GI)({name:r.l.SERVICE_CENTER_PLUGIN,condition:e=>{let{store:t,abTestData:i}=e,{feedStore:{isActive:n},roomStore:{hideBanner:o,roomInfo:r},userStore:{userInfo:l}}=t;return n&&!o&&(null==r?void 0:r.room)&&l},Component:v,index:0}),t.Z=(0,u.OV)({Component:()=>(0,n.jsx)(a.Z,{name:r.l.SERVICE_CENTER_PLUGIN}),layoutName:o.t.ServiceCenterLayout,ComponentName:r.l.SERVICE_CENTER_PLUGIN,index:0})},917460:function(e,t,i){i(675373);var n=i(563097);i(88648);var o=i(700061),r=i(246647),l=i(446042),s=i(770732),a=i(669556),u=i(300253),d=i(736579),c=i(338426);let v=(0,u.n)((0,c.ZP)(()=>Promise.all([i.e("28251"),i.e("26848"),i.e("30574")]).then(i.bind(i,617232)),{ssr:!1}),{name:r.l.VIP_VIEW_PLUGIN,renderWhen:d.d.afterComponent(r.l.ChatRoom),taskPriority:"background"});(0,l.GI)({name:r.l.VIP_VIEW_PLUGIN,condition:e=>{var t;let{store:i}=e;return null==i?void 0:null===(t=i.feedStore)||void 0===t?void 0:t.isActive},Component:v,index:0}),t.Z=(0,a.OV)({Component:()=>(0,n.jsx)(s.Z,{name:r.l.VIP_VIEW_PLUGIN}),layoutName:o.t.PlayerControlLayout,ComponentName:r.l.VIP_VIEW_PLUGIN,index:0})},655069:function(e,t,i){var n=i(520739),o=i(878389),r=i(368200);i(675373),i(779788),i(250440),i(981168);var l=i(88648),s=i(645260),a=i.n(s),u=i(737271),d=i(40335),c=i(742740),v=i(725887),_=i(544406),m=i(623582),h=i(434144),f=i(565024),g=i(987475),p=i(654533),y=i(509090),b=i(441447),P=i(623527),I=i(828782),E=i(847191),S=i(128487),L=i(934966),C=i(505575),w=i(611243),N=i(472434),k=i(669417),T=i(197911),R=i(418279),x=i(709606),O=i(874005),A=i(818597),F=i(930083),M=i(990530),D=i(797973),G=i(62696),j=i(508269);let V=()=>{if(!(0,u.r)())return Array.from(document.querySelectorAll(".giftRechargeContaner")).find(e=>e.getBoundingClientRect().x>0)};t.Z=e=>{let{isInit:t=!1,processAfterFirstFrame:i=!1}=e||{},{userStore:{userInfo:s},roomStore:{roomInfo:u},linkmicStore:{choosePeopleArr:U,useChoosePeopleFunc:Z,eggModeInfo:B},giftStore:{giftStatus:W,giftList:H,effectList:K,balance:Y,giftPanelShowFrom:$,setGiftComboHint:Q,setGiftMessages:q,setGiftPages:J,setEffectList:z,setBalance:X,setGiftExtra:ee,setGiftLayer:et,setPaygrade:ei},rechargeStore:{rechargeAuthStatus:en},eventStore:{giftEvent:eo,slardarEvent:er}}=(0,A.o)(),{name:el}=(0,L.V)(),{showRecharge:es,hideRecharge:ea,updateRecharge:eu,hideOtherRecharge:ed}=(0,w.y)({container:V}),{showRecharge:ec,hideRecharge:ev}=(0,G.C)(),e_=(0,l.useRef)(!0),{player:em}=(0,C.n)(),eh=a()(s,"id_str",""),ef=!!eh,eg=a()(u,"roomId",""),ep=a()(u,"anchor.sec_uid",""),ey=a()(u,"anchor.id_str",""),eb=(null==U?void 0:U[0])||"",eP=a()(u,"room.episode_extra"),eI=a()(eP,"episode_id_str",0)||0,eE=a()(eP,"mod.episode_stage"),eS=a()(x.$F,eE,x.dq.NORMAL),eL=a()(u,"room.others.group_live_data.is_group_live",0),{rechargeConfig:eC}=(0,d.K)(),ew=(0,l.useCallback)(async function(){var e,t,i,r,l,s;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{type:d="recharge",balance:P=0,amount:I=0,sendGiftParams:E}=a,S={enter_from_merge:(0,c.yW)(),show_reason:null!==(l=x.St[d])&&void 0!==l?l:"other",live_window_type:null!==(s=null===(e=v.Le.getConfig(v.gI.LiveWindowStatus))||void 0===e?void 0:e.type)&&void 0!==s?s:"no_live_window",if_live_play:1,room_id:eg,anchor_id:ey,follow_status:(0,R.qZ)(null==u?void 0:null===(i=u.anchor)||void 0===i?void 0:null===(t=i.follow_info)||void 0===t?void 0:t.follow_status)?1:0},L=H.find(e=>e.id===(null==E?void 0:E.gift_id));null==ed||ed();let C=await (null===(r=_.a.getIAPRechargeParams)||void 0===r?void 0:r.call(_.a)),w=e=>{m.logInstance.sendLog("livesdkRechargeShowDuration",(0,o._)((0,n._)({},S),{charge_reason:d,duration:(null==e?void 0:e.duration)||0,if_recharge_success:(null==e?void 0:e.isSuccess)?1:0}))},N=(0,h.Dr)(f.Q.getItem({sKey:g.CookieKeys.Theme}));(0,p.jo)()?ec({showOfficialEntrance:!1,onShow:()=>{m.logInstance.sendLog("livesdkRechargeShowByContainer",(0,o._)((0,n._)({},S),{load_type:"vmok",charge_reason:d}))},container:V(),requestPublicParams:C,type:d,title:j.B[d],needRechargePrice:P,giftPrice:I,additionalLogParams:S,onClose:w,theme:N,autoNextType:E?"gift":void 0,onAutoNextChange:e=>{E&&(e_.current=e,m.logInstance.sendLog("rechargeSendGiftClick",(0,o._)((0,n._)({},S),{status:e?"on":"off"})))},autoSendGiftParams:{giftImg:null==L?void 0:L.icon,giftName:null==L?void 0:L.name,balance:P,isEnoughMoney:!0},showRechargeResult:!1,onRechargeSuccess:e=>{let{newBalance:t=0}=e;ev(),eA(),m.logInstance.sendLog("livesdkRechargeSuccessByContainer",(0,o._)((0,n._)({},S),{load_type:"vmok",charge_reason:d})),e_.current&&E&&t>=I?eF((0,o._)((0,n._)({},E),{isAutoNext:!0})):y.F.info("充值成功")},onCombosItemClick:e=>{let{type:t,combo:i={}}=e||{};E&&"manual"===t&&b.emit(b.EVENT.updateRechargeAutoNext,{isEnoughMoney:Number(i.diamond_count)>=P,balance:P,giftImg:null==L?void 0:L.icon,giftName:null==L?void 0:L.name})}}):es({requestPublicParams:C,type:d,balance:P,amount:I,additionalLogParams:S,onClose:w,theme:N,onAutoNextChange:e=>{E&&m.logInstance.sendLog("rechargeSendGiftClick",(0,o._)((0,n._)({},S),{status:e?"on":"off"}))},autoNext:!0,autoNextHtml:E?(0,F.w)({giftImg:null==L?void 0:L.icon,giftName:null==L?void 0:L.name,balance:P,coinName:(null==eC?void 0:eC.name)||"抖币",isEnoughMoney:!0}):void 0,onCombosItemClick:e=>{let{type:t,combo:i={}}=e||{};E&&"manual"===t&&eu({autoNextHtml:(0,F.w)({giftImg:null==L?void 0:L.icon,giftName:null==L?void 0:L.name,balance:P,coinName:(null==eC?void 0:eC.name)||"抖币",isEnoughMoney:Number(i.diamond_count)>=P})})},showRechargeResult:!1,onSuccess:e=>{let{autoNext:t,balance:i=0}=e;ea(),eA(),t&&E&&i>=I?eF((0,o._)((0,n._)({},E),{isAutoNext:!0})):y.F.info("充值成功")}}),(0,T.rp)(em)},[em,es,ey,eg,u,eC,H,ec,ev]),eN=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};O.JL((0,n._)({from_room_id:eg,to_room_id:eg,from_anchor_id:ey,to_user_id:eb||ey,gift_ids:null==e?void 0:e.gift_id},e)).then(t=>{let{data:i,logId:n}=t;if(0!==a()(i,"status_code"))return k.kg.error("获取礼物额外信息失败",i,n),Promise.reject(i);{let t=a()(i,"data.gift_extra",[]);return t.length>0&&ee(Number(null==e?void 0:e.gift_id),t),Promise.resolve(t)}})},[eg,ey,ee,eb]),ek=(0,l.useCallback)(e=>O.Hv((0,n._)({},e)).then(e=>{let{data:t,logId:i}=e;if(0!==a()(t,"status_code"))return k.kg.error("获取送礼消费分层失败",t,i),Promise.reject(t);{let e=a()(t,"data.gift_layer",0);return et(e),Promise.resolve(e)}}),[]),eT=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return O.JL((0,n._)({from_room_id:eg,to_room_id:eg,from_anchor_id:ey,to_user_id:ey,gift_ids:null==e?void 0:e.gift_id},e)).then(e=>{let{data:t,logId:i}=e;return 0===a()(t,"status_code")?Promise.resolve(a()(t,"data.gift_extra",[])):(k.kg.error("获取礼物额外信息失败",t,i),Promise.reject(t))})},[eg,ey,ee]),eR=(0,D.Z)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return O.Xq((0,n._)({room_id:eg,to_room_id:eg,sec_anchor_id:ep,sec_to_user_id:ep,gift_scene:eS,to_episode_id:eI,fetch_giftlist_from:3},e)).then(async e=>{var t,i;let{data:n,logId:o}=e,r=a()(n,"status_code"),l=(null==n?void 0:null===(t=n.data)||void 0===t?void 0:t.pages)||[];return 0===r?(J((0,T.Zk)({rawGiftPages:l,giftScene:eS})),await (0,N.v2)(),J((0,T.BU)(l)),Promise.resolve(n)):(y.F.info(a()(n,"data.prompts","获取礼物失败，请稍后重试")),k.ZN.error(P.Mo.LiveGiftListError,{content:{statusCode:r,message:(null==n?void 0:null===(i=n.data)||void 0===i?void 0:i.prompts)||"",logId:null!=o?o:"",is_client:(0,I.DT)(),data:n}}),Promise.reject(n))})}),ex=(0,l.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i&&await (0,N.v2)(),O.ao((0,n._)({is_living:!1,download_assets_from:3},e)).then(e=>{var t;let{data:i,logId:n}=e,o=a()(i,"status_code");if(0===o){let e=a()(i,"data.assets",[]);return z((0,T.Js)(e)),Promise.resolve(i)}return y.F.info(a()(i,"data.prompts","获取特效失败，请稍后重试")),k.ZN.error(P.Mo.LiveGiftEffectError,{content:{statusCode:o,message:(null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.prompts)||"",logId:null!=n?n:"",is_client:(0,I.DT)(),data:i}}),Promise.reject(i)})},[z]),eO=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return O.ao((0,n._)({is_living:!1,download_assets_from:3},e)).then(e=>{var t;let{data:i,logId:n}=e,o=a()(i,"status_code");if(0===o){let e=a()(i,"data.assets",[]);return Promise.resolve((0,T.Js)(e)[0])}return k.ZN.error(P.Mo.LiveSingleEffectError,{content:{statusCode:o,message:(null==i?void 0:null===(t=i.data)||void 0===t?void 0:t.prompts)||"",logId:null!=n?n:"",is_client:(0,I.DT)(),data:i}}),Promise.reject()})},[]),eA=(0,l.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ef?O.sb((0,n._)({},e)).then(e=>{let{data:t,logId:i}=e,o=a()(t,"status_code");return 0===o?(X(a()(t,"data.diamond",0)),Promise.resolve(t)):(k.kg.event(`[${P.Tn.Error}]${P.Mo.LiveBalanceError}`,(0,n._)({statusCode:o,logId:null!=i?i:"",is_client:(0,I.DT)()},t)),y.F.info(a()(t,"data.prompts",`获取${el}余额失败，请稍后重试`)),k.kg.error(`获取${el}余额失败`,t,i),Promise.reject(t))}):0},[ef,el,X]),eF=(0,l.useCallback)(async function(){var e,t,i,o,l,u,d,c,v,_,m;let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!ef)return await (0,T.m8)("登录后即可送礼","live_gift"),(0,T.rp)(em),Promise.reject();if(!W)return y.F.info("暂无送礼权限，请稍后重试"),(0,T.rp)(em),Promise.reject();if(eh===ey)return y.F.info("不可为自己送礼"),(0,T.rp)(em),Promise.reject();let{isToAnchor:g,giftSource:p,pageType:L,isAutoNext:C,isFromContainer:w=0}=h,N=(0,r._)(h,["isToAnchor","giftSource","pageType","isAutoNext","isFromContainer"]);if(null==er||null===(e=er.sendGiftApiEvent)||void 0===e||e.call(er,{params:h}),Z&&!g){let{count:e,price:t}=h;if(t*e*(null!==(u=null==U?void 0:U.length)&&void 0!==u?u:0)>x.sF)return y.F.info("该礼物不支持成组送全麦"),h.count>1&&(null==eo||null===(d=eo.liveGiftGroupClick)||void 0===d||d.call(eo,{peopleCount:null!==(c=null==U?void 0:U.length)&&void 0!==c?c:1,giftId:null==h?void 0:h.gift_id,pageType:L,result:"fail"})),Promise.reject()}let A="request_song_list"===p?[]:Z&&!g&&null!==(v=null==U?void 0:U.map(e=>e))&&void 0!==v?v:[ey];return eg?O.hF((0,n._)({room_id:eg,to_room_id:eg,to_user_id:Z&&!g&&(null==A?void 0:A.length)===1?null==A?void 0:A[0]:ey,to_user_ids:Z&&!g&&(null==A?void 0:A.length)!==1?JSON.stringify(A):"",room_anchor_id:ey,to_episode_id:eI,send_type:4,send_scene:eL?128:Z&&!g?2:1,gift_source:0,buff_level:0,tags_extra:JSON.stringify({gift_source:p,enter_from_merge:null!==(_=null===(i=window)||void 0===i?void 0:null===(t=i.__INVISIBLE_QUERY__)||void 0===t?void 0:t.enter_from_merge)&&void 0!==_?_:"",enter_method:null!==(m=null===(l=window)||void 0===l?void 0:null===(o=l.__INVISIBLE_QUERY__)||void 0===o?void 0:o.enter_method)&&void 0!==m?m:""})},N)).then(async e=>{var t,i,o,r,l,u,d,c,v,_,m,g,O;let F;let{data:D,logId:G}=e,j=a()(D,"status_code"),V=h.price*h.count;null==er||null===(t=er.sendGiftApiCbEvent)||void 0===t||t.call(er,{params:h,data:D}),h.count>1&&(null==eo||null===(i=eo.liveGiftGroupClick)||void 0===i||i.call(eo,{peopleCount:null!==(o=null==U?void 0:U.length)&&void 0!==o?o:1,giftId:a()(D,"data.gift_id"),pageType:L,result:0===j?"success":"fail"}));try{let e=a()(D,"data.diy_item_info","[]");e&&(F=JSON.parse(e))}catch(e){}if(0===j){let e=(0,T.mL)(a()(D,"data"),H,K,s,F,a()(N,"count"));(null==D?void 0:null===(r=D.data)||void 0===r?void 0:r.combo_hint)&&(null==D?void 0:null===(l=D.data)||void 0===l?void 0:l.gift_id)&&Q({[D.data.gift_id]:{comboHint:null==D?void 0:null===(v=D.data)||void 0===v?void 0:v.combo_hint,curCount:null==D?void 0:null===(_=D.data)||void 0===_?void 0:_.combo_count}}),ei(2);let t=null===(u=null!==(m=null==B?void 0:null===(c=B.egg_info)||void 0===c?void 0:null===(d=c.teamfight_egg_info)||void 0===d?void 0:d.team_egg_map)&&void 0!==m?m:{})||void 0===u?void 0:u[`${eg}`];(0,E.qQ)(S.storage.LocalStorageKeys.SendGiftTime,new Date().getTime()),q(e),eA(),A.forEach(e=>{var i,o,r,l,s,u,d,c;null==eo||null===(l=eo.liveGiftSendEvent)||void 0===l||l.call(eo,(0,n._)({gift_id:a()(D,"data.gift_id"),combo_cnt:a()(D,"data.combo_count"),group_cnt:a()(D,"data.group_count"),gift_source:p,money_per_unit:a()(D,"data.gift_struct.diamond_count"),gift_cnt:h.count,money:h.count*a()(D,"data.gift_struct.diamond_count"),is_fans_club_gift:(0,R.dU)(a()(D,"data.gift_id"))?"1":"0",to_user_id:String(e),full_seats_cnt:A.length,is_from_container:w,gift_show_from:$,if_gold_series:(null==h?void 0:h.buff_level)>0||(null==h?void 0:h.plugin_id)?1:0,customize:(null==h?void 0:h.buff_level)>0||(null==h?void 0:h.plugin_id)?2:0,price:h.originPrice,customize_price:h.price-h.originPrice,pageType:L,tab_name:x.BS[L]||L,if_mini_window:(0,M.OL)(),mission_period:(null==t?void 0:t.status)?[2,3,4,5].includes(null==t?void 0:t.status)?"challenge":(null==t?void 0:t.status)===6?"buff":"":"",mission_id:null!==(s=null==t?void 0:t.egg_id)&&void 0!==s?s:"",mission_type:(null==t?void 0:t.egg_type)?(null==t?void 0:t.egg_type)===1?"moneymission":"cntmission":"",mission_target:null!==(u=null==t?void 0:null===(i=t.task_info)||void 0===i?void 0:i.target_score)&&void 0!==u?u:"",mission_time:null!==(d=null==t?void 0:null===(o=t.task_info)||void 0===o?void 0:o.task_duration)&&void 0!==d?d:"",mission_start_from_pkend:null!==(c=null==t?void 0:null===(r=t.task_info)||void 0===r?void 0:r.task_begin_relative_battle_end_time)&&void 0!==c?c:"",gift_position:null==h?void 0:h.sort,combo_position:null==h?void 0:h.combo_position,is_hotkey:null==h?void 0:h.is_hotkey},L===x.kQ.GIFT&&h.sortType?{order_type:h.sortType}:{}))}),C&&b.emit(b.EVENT.RechargeAutoSuccess,{giftId:a()(D,"data.gift_id")}),eo.liveConsumeEvent({statusCode:j,amount:V,is_client:(0,I.DT)(),type:"gift_send"})}else 20003===j?await (0,T.m8)("登录后即可送礼","live_gift"):40001===j?f&&(en?(y.F.info(`${el}余额不足`),ew({type:"balance",balance:V-Y,amount:V,sendGiftParams:h})):y.F.info(`${el}余额不足，请充值后再试`)):42201===j?y.F.info("为保障账号和资金安全，请先前往抖音app完成身份验证"):42202===j?y.F.info("为保障账号和资金安全，请先前往抖音app完成身份核对"):(y.F.info(a()(D,"data.prompts","送礼失败，请稍后重试")),k.ZN.fatal(P.Mo.LiveSendGiftError,{content:{statusCode:j,message:(null==D?void 0:null===(g=D.data)||void 0===g?void 0:g.prompts)||"",logId:null!=G?G:"",is_client:(0,I.DT)(),data:D}}));return 0===j?Promise.resolve(D):(k.ZN.error(P.Mo.LiveGiftSendCodeNotZero,{content:{statusCode:j,message:(null==D?void 0:null===(O=D.data)||void 0===O?void 0:O.prompts)||"",logId:null!=G?G:"",is_client:(0,I.DT)(),data:D}}),(0,T.rp)(em),Promise.reject(D))}):Promise.reject()},[ef,W,s,eg,eI,H,K,Y,em,eA,q,ew,U,$,Z,ey,eo,er,el,en,eh,ei]),eM=t&&W;(0,l.useEffect)(()=>{eM&&(eR(),ex())},[eM]);let eD=t&&ef;return(0,l.useEffect)(()=>{eD&&eA()},[eD]),{getGifts:eR,getEffects:ex,getSingleEffect:eO,getBalance:eA,sendGift:eF,handleRecharge:ew,giftScene:eS,getGiftExtra:eN,getMultiGiftExtra:eT,getGiftLayer:ek}}},692532:function(e,t,i){i.d(t,{o:function(){return d}});var n=i(948375),o=i(88648),r=i(710199),l=i(669417),s=i(19670),a=i(358472),u=i(782580);let d=e=>{let{playerInstance:t,playerLoggerInstance:i,streamInfo:d,isRoomError:c,onH265Degrade:v,onUnablePlay:_,onPlayerDegrade:m,onRetryEnd:h,onError:f,disable:g}=e,{isH265:p,isH265Error:y,setIsH265Error:b,playerUrl:P,useBackUp:I,setUseBackUp:E}=d,S=o.useRef(2),L=(0,n.Z)((e,t)=>{l.ZP.event("playerDegradeMethod",{method:"265Degrade",code:e.code,isH265:p,isFlvPlayer:t}),b(!0),null==i||i.updateExt({h265_degrade:1}),v(e)}),C=(0,n.Z)((e,t,i)=>{var n;l.ZP.event("playerDegradeMethod",{method:"retry",code:e.code,isH265:p,isFlvPlayer:i}),S.current--,null==t||null===(n=t.retry)||void 0===n||n.call(t),null==h||h()}),w=(0,n.Z)((e,t,i)=>{var n;l.ZP.event("playerDegradeMethod",{method:"playerDegrade",code:e.code,isH265:p,isFlvPlayer:i}),null==t||null===(n=t._changeCore)||void 0===n||n.call(t,r.ry,{}),null==m||m()}),N=(0,n.Z)((e,t)=>{l.ZP.event("playerDegradeMethod",{method:"unablePlay",code:e.code,isH265:p,isFlvPlayer:t}),null==_||_()}),k=(0,n.Z)((e,t)=>{l.ZP.event("playerDegradeMethod",{method:"backup",code:e.code,isH265:p,isFlvPlayer:t}),null==E||E(!0)}),T=(0,n.Z)((e,t,i)=>{((0,u.getUseNew265Logic)()?(0,a.aN)(null==t?void 0:t.src):p)?L(e,i):I?N(e,i):k(e,i)}),R=(0,n.Z)((e,t,i)=>{i?T(e,t,i):w(e,t,i)}),x=(0,n.Z)((e,t,i)=>{var n;if(null==t?void 0:null===(n=t.error)||void 0===n?void 0:n.code){R(e,t,i);return}S.current>0?C(e,t,i):I?N(e,i):k(e,i)}),O=[{codes:[1e3,1001,2100,2101,3100],method:(e,t,i)=>{x(e,t,i)}},{codes:[3e3],method:(e,t,i)=>{T(e,t,i)}},{codes:[3001,3002,3003,3004,3005,3006,4e3,5e3,5001,5002,5003,5004,6001],method:(e,t,i)=>{R(e,t,i)}}],A=(0,n.Z)(e=>{try{if(null==c?void 0:c()){var i,n,o;let l=t;!l&&(0,u.getInLiveSearchRefactorAB)()&&(l=null==e?void 0:e.player);let a=(null==e?void 0:null===(i=e.player)||void 0===i?void 0:i.src)||(null==t?void 0:t.src);if(!P&&a&&(0,s.WH)("streamPlayerUrl_not_equal_playerUrl",{streamPlayerUrl:P,playerUrl:a}),!a)return;let{code:d}=e||{},c=(0,u.getUseNewDegradeLogic)()?(null==l?void 0:null===(n=l.baseConfig)||void 0===n?void 0:n.coreType)===r.ry:!!(null==l?void 0:null===(o=l.error)||void 0===o?void 0:o.code),v=String(d),_=O.find(e=>e.codes.some(e=>String(e)===v));((null==_?void 0:_.method)||R)(e,l,c),null==f||f(e)}}catch(e){}}),F=(0,n.Z)(()=>{S.current=2});return o.useEffect(()=>{if(!g&&t)return null==t||t.on(null===r.FP||void 0===r.FP?void 0:r.FP.ERROR,A),null==t||t.on(null===r.FP||void 0===r.FP?void 0:r.FP.CANPLAY,F),()=>{null==t||t.off(null===r.FP||void 0===r.FP?void 0:r.FP.ERROR,A),null==t||t.off(null===r.FP||void 0===r.FP?void 0:r.FP.CANPLAY,F)}},[t,g]),{errorHandle:A}}},236732:function(e,t,i){i.d(t,{Z:function(){return i1}});var n,o,r={};i.r(r),i.d(r,{AudioCheatTips:function(){return is},AutoRunModal:function(){return ir},ChatRoom:function(){return tH.Z},LandPageContainer:function(){return t0},LiveShare:function(){return t7},LiveTDK:function(){return ii},LivingPlayer:function(){return tW},OperatingBar:function(){return t3.Z},ProgrammeWrapper:function(){return t5},RightPanelContainer:function(){return t$},RoomInfoBar:function(){return tz},RoomLogic:function(){return eu}});var l=i("520739");i("874386"),i("250440"),i("954372"),i("826893");var s=i("563097"),a=i("88648"),u=i("700061"),d=i("878389");i("981168");var c=i("605536"),v=i("237298");let _=(e,t)=>(c.Z.setLayout({name:e,id:e}),(0,a.memo)(i=>{let{className:n="",style:o={},children:r}=i,u=c.Z.getComponent(e),_=(0,v.i)(),m=u.filter(e=>e.location===c.h.Before).sort((e,t)=>e.index-t.index),h=u.filter(e=>e.location===c.h.After).sort((e,t)=>e.index-t.index),f=(0,a.useRef)(null);return a.useEffect(()=>{let e=f.current;return()=>{try{null==e||e.remove()}catch(e){}}},[]),(0,s.jsxs)("div",{className:n,style:(0,d._)((0,l._)({},o),{zIndex:t}),ref:f,id:e,children:[m.map(e=>(0,s.jsx)(a.Fragment,{children:(0,s.jsx)(e.Component,(0,l._)({},_))},e.id)),r,h.map(e=>(0,s.jsx)(a.Fragment,{children:(0,s.jsx)(e.Component,(0,l._)({},_))},e.id))]})})),m=_(u.t.ContainerBackgroundLayout,u.W.ContainerBackgroundLayout),h=_(u.t.LeftBackgroundLayout,u.W.LeftBackgroundLayout),f=_(u.t.HeaderLayout,u.W.HeaderLayout),g=_(u.t.HeaderLeftLayout,u.W.HeaderLeftLayout),p=_(u.t.HeaderRightLayout,u.W.HeaderRightLayout),y=_(u.t.PlayerLayout,u.W.PlayerLayout),b=_(u.t.BottomLayout,u.W.BottomLayout),P=_(u.t.RightPanelLayout,u.W.RightPanelLayout),I=_(u.t.RightBackgroundLayout,u.W.RightBackgroundLayout);var E={root:"xX64ssyI",enlargeDynamicBackground:"zVq63nJQ",left:"wr2z1_Yc",chatroomPanelContainer:"p2xWIp7e",isClient:"bGsQ7hZ_",fullScreen:"S4P53YuT",container:"kVZKWoWC",containerOpt:"OmJSZtrz",right:"NOn14SxG",fold:"T_WBX51p",header:"C3EJnNR_",playerContainer:"sts39Cmk",isImmersive:"qAoSseHO"},S=i("470245");let L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",i="";for(let n=0;n<e;n++)i+=t.charAt(Math.floor(Math.random()*t.length));return i};var C=i("669556"),w=i("246647");i("675373");var N=i("595902"),k=i("300253"),T=i("338426");let R=(0,k.n)((0,T.ZP)(()=>i.e("10371").then(i.bind(i,827779)),{ssr:!1}),{name:w.l.EnterAndLeave,renderWhen:N._.LivingInit}),x=(0,k.n)((0,T.ZP)(()=>i.e("96605").then(i.bind(i,679862)),{ssr:!1}),{name:w.l.ForceLoginRecorder,renderWhen:N._.FirstFrame});var O=(0,k.n)((0,T.ZP)(()=>i.e("78939").then(i.bind(i,523819)),{ssr:!1}),{name:w.l.StreamCompute,renderWhen:N._.LivingInit}),A=i("818597"),F=i("632766"),M=i("645260"),D=i.n(M),G=i("360977"),j=()=>{let{giftStore:{setGiftTccStatus:e,setHoverGiftWhiteList:t,setDiyPluginIdWhiteList:i,setGiftBuffIdWhiteList:n,setDiyCardNameWhiteList:o,setHoverGiftWhiteListV2:r,setWanxiangGiftSwitch:l,setForceShowBuffList:s,setStarGuardEffectWhiteList:u,setMaxGiftTrayCount:d,setGiftBgEffectMap:c,setGiftTrayConfig:v},audienceStore:{setAudienceTccStatus:_},pkStore:{setPKTccStatus:m},fansClubStore:{setFansClubTccStatus:h},linkmicStore:{setChoosePeopleShowTCC:f},feedStore:{isActive:g},roomStore:{setLongtouchShowTcc:p,setUsePageUrlBannerId:y,setPollingFrequency:b}}=(0,A.o)(),P=(0,G.kF)();(0,a.useEffect)(()=>{try{(async()=>{let a=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"gift_config"}),_=(null==P?void 0:P.XTTENV)?a.ppe_pc_live_backup:a,m=D()(_,"gift_status",!1),h=D()(_,"hover_gift_white_list",[]),f=D()(_,"hover_gift_white_list_v2",[]),g=D()(_,"diy_plugin_id_white_list",[]),p=D()(_,"gift_buff_id_white_list",[]),y=D()(_,"diy_card_name_white_list",[]),b=D()(_,"wanxiang_gift_switch",0),I=D()(_,"force_show_buff_list",[]),E=D()(_,"gift_bg_effect_map",{}),S=D()(_,"gift_tray_config",{}),L=D()(_,"star_guard_effect_white_list",[]),C=D()(_,"gift_tray_max_count",Number.MAX_SAFE_INTEGER);t(h),r(f),i(g),o(y),n(p),l(b),s(I),u(L),d(C),e(m),c(E),v(S)})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"pk_config"}),t=D()(e,"pk_status",!1);m(t)})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"audience_config"}),t=D()(e,"audience_status",!1);_(t)})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"fans_club_config"}),t=D()(e,"fans_status",!1);h(t)})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"choose_peoples_info"}),t=D()(e,"choose_people_show",!1);f(t)})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"banner"});p(D()(e,"long_touch.long_touch_show",!1)),y(D()(e,"long_touch.use_page_url_banner_id",[]))})()}catch(e){}},[g]),(0,a.useEffect)(()=>{try{(async()=>{let e=await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"polling_frequency"});b(e)})()}catch(e){}},[g])},V=i("618618"),U=i("727795"),Z=i("359077"),B=i("846296"),W=i("669417"),H=e=>{let{roomStore:{roomInfo:t},cameraStore:{cameraInfo:i},singletonStore:{message:n},feedStore:{isActive:o}}=(0,A.o)(),{roomId:r=""}=t,{groupId:s,cameraId:u}=i||{},d=(0,a.useRef)({}),c=(0,a.useRef)(e);c.current=e;let v=(0,a.useCallback)(()=>{if(!d.current[r]&&!!o){if(!r){n.stop(),W.kg.info("stop by nil roomId");return}if(c.current){null==n||n.stop();return}n.start((0,l._)({room_id:r},u&&{sub_room_id:u},s&&{group_id:s})),d.current[r]=!0}},[r,s,u,n,o]);return(0,a.useEffect)(()=>{if(o){var e,t;let i=0;(null===(e=navigator)||void 0===e?void 0:e.hardwareConcurrency)<=4&&(null===(t=navigator)||void 0===t?void 0:t.deviceMemory)<=2&&(i=9500);let o=d.current;return setTimeout(()=>{r&&v()},i),()=>{r&&(null==n||n.stop(),o[r]=!1)}}},[r,s,u,v,e,n,o]),(0,a.useEffect)(()=>{if(!!r){if(c.current){null==n||n.stop();return}d.current[r]&&(null==n||n.pause(),d.current[r]=!1)}},[r,s,u,n]),v},K=i("614316"),Y=i("63405"),$=i("544406"),Q=i("655069"),q=i("909543"),J=i("213987"),z=i("53562"),X=i("688092"),ee=i("276932"),et=i("919195");let ei=(0,k.n)(()=>{let{linkmicStore:{dressListAll:e,setDressListAll:t},roomStore:{roomInfo:i}}=(0,A.o)();return(0,a.useEffect)(()=>{let n=[V.ke.MEDIA,V.ke.VS],o=D()(i,"room.live_room_mode","");(e||(null==e?void 0:e.length)===0)&&!n.includes(o)&&(null==i?void 0:i.roomId)&&(0,U.VT)({}).then(e=>{let{data:{status_code:i,data:n}}=e;0===i&&(null==n?void 0:n.dress_list)&&t(null==n?void 0:n.dress_list)})},[i]),null},{name:w.l.GetDressList,renderWhen:N._.FirstFrame,taskPriority:"background"});var en=(0,z.Pi)(()=>{var e;let{roomStore:{roomInfo:t,live_room_mode:i,setIsVerified:n,isAppOnly:o,isMedia:r,LandscapeChat:l,setDisableLiveRecommendOnEnd:u,setIsDanmakuFeatureOn:d},linkmicStore:{setLiveRoomMode:c},userStore:{userInfo:v},rechargeStore:{setRechargeAuthStatus:_},fansClubStore:{setFansClubAuthStatus:m},giftStore:{setGiftAuthStatus:h,setHandleRecharge:f},singletonStore:{playerHandler:g},streamStore:{streamInfoFromLiving:p},playerStore:{isLoadedData:y}}=(0,A.o)(),b=D()(t,"room.status"),{url:P}=p;(0,a.useEffect)(()=>{d(!r&&l!==V.xW.OFF)},[r,l]),j(),(0,B.Z)();let I=H(o),E=(0,a.useCallback)(()=>n(!0),[]);(0,Z.ZP)({apis:Z.w5.IM_API,roomId:null!==(e=t.roomId)&&void 0!==e?e:"",saveVerify:E});let{handleRecharge:S}=(0,Q.Z)({isInit:!0,processAfterFirstFrame:!0}),L=(0,q.a)(),C=(0,a.useMemo)(()=>/iframe/.test(L.pathname),[L]);(0,a.useEffect)(()=>{let e=D()(t,"room.room_auth.Gift");!C&&t.roomId&&h(e)},[t,C]),(0,a.useEffect)(()=>{if(c(i),i===V.ke.MEDIA)return(0,et.DP)(!0),()=>{(0,et.DP)(!1)}},[i,c]),(0,a.useEffect)(()=>{y&&I()},[I,y]),(0,a.useEffect)(()=>{o&&(null==v?void 0:v.isReady)&&(0,K.Qz)({anchor_id:D()(t,"anchor.id_str",""),room_id:(null==t?void 0:t.roomId)||"",user_id:(null==v?void 0:v.id_str)||"",enter_mode:null==t?void 0:t.enter_mode,scene:Number(Object.keys(D()(t,"room.linker_map",{}))),playmode:D()(t,"room.linker_detail.linker_play_modes",[]),ui_layout:D()(t,"room.linker_detail.linker_ui_layout")})},[o,t,v]),(0,a.useEffect)(()=>{try{(async()=>{var e;let t=await Y.invoke("GET_IS_MAS"),i=await (null===(e=$.a.canUseIap)||void 0===e?void 0:e.call($.a)),n=D()(t,"data");!(n&&!i)&&_(!0)})()}catch(e){_(!0)}},[]),(0,a.useEffect)(()=>{if(null==t?void 0:t.roomId){let e=D()(t,"room.live_room_mode",""),i=!0;(e===V.ke.MEDIA||e===V.ke.VS)&&(i=!1),m(i)}},[t]);let[w,N]=(0,a.useState)();(0,a.useEffect)(()=>{(0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"liveShareWhiteList"}).then(e=>{N(e)})},[]);let k=(0,X.k)(),T=(0,a.useMemo)(()=>{let e=null;if(w&&(e=w[null==k?void 0:k.XTTENV]?w[null==k?void 0:k.XTTENV]:w),!e)return!1;let{whiteList:i=[]}=e;return i.some(e=>String(e)===String(D()(t,"anchor.id_str"))||String(e)===String(t.roomId)||String(e)===String(t.web_rid))},[w,t,k]);return(0,a.useEffect)(()=>{u(T)},[T]),(0,a.useEffect)(()=>((null==t?void 0:t.web_rid)&&P&&(null==g||g.setCurrentRoom(t,P),null==g||g.startHeartDetect()),()=>{null==g||g.stopHeartDetect()}),[t,P]),(0,a.useEffect)(()=>{f(S)},[S]),(0,a.useEffect)(()=>{if(!!(null==t?void 0:t.roomId))return(0,ee.ov)(null==t?void 0:t.roomId)},[null==t?void 0:t.roomId]),(0,a.useEffect)(()=>{b===V.LV.END&&((0,J.q)("ISLAND_SYNC_HEADER"),(0,J.q)("ISLAND_LAYOUT_NAVIGATION"))},[b]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(ei,{})})}),eo=i("705189"),er=(0,k.n)((0,T.ZP)(()=>i.e("15403").then(i.bind(i,5661)),{ssr:!1}),{name:w.l.StreamCompute,renderWhen:N._.LivingInit}),el=(0,k.n)((0,T.ZP)(()=>i.e("2091").then(i.bind(i,43029)),{ssr:!1}),{name:w.l.RoomEvent,renderWhen:N._.LivingInit}),es=(0,k.n)((0,T.ZP)(()=>i.e("10371").then(i.bind(i,562380)),{ssr:!1}),{name:w.l.PlayerControl,renderWhen:N._.FirstFrame,taskPriority:"user-blocking"});let ea=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R,{}),(0,s.jsx)(x,{}),(0,s.jsx)(O,{}),(0,s.jsx)(en,{}),(0,s.jsx)(eo.Z,{}),(0,s.jsx)(er,{}),(0,s.jsx)(el,{}),(0,s.jsx)(es,{})]});var eu=(0,C.OV)({Component:ea,layoutName:u.t.PlayerLayout,ComponentName:w.l.RoomLogic,index:0}),ed=i("806787"),ec=i("710199"),ev=i("503866"),e_=i("616003"),em=i("439239"),eh=i("742401");let ef=_(u.t.ServiceCenterLayout,u.W.ServiceCenterLayout),eg=_(u.t.LinkMicBackgroundLayout,u.W.LinkMicBackgroundLayout),ep=_(u.t.LinkMicLayout,u.W.LinkMicLayout),ey=_(u.t.PlayerControlLayout,u.W.PlayerControlLayout),eb=_(u.t.LinkMicAnimationLayout,u.W.LinkMicAnimationLayout),eP=_(u.t.LikeLayout,u.W.LikeLayout),eI=_(u.t.GiftEffectLayout,u.W.GiftEffectLayout),eE=_(u.t.GiftTrayLayout,u.W.GiftTrayLayout),eS=_(u.t.GiftMenuLayout,u.W.GiftMenuLayout),eL=_(u.t.DanmakuLayout,u.W.DanmakuLayout),eC=_(u.t.TipsLayout,u.W.TipsLayout),ew=_(u.t.EcmoCardLayout,u.W.EcmoCardLayout),eN=_(u.t.ShortTouchLayout,u.W.ShortTouchLayout),ek=_(u.t.WaterMarkLayout,u.W.WaterMarkLayout);var eT=i("134761");i("779788"),i("284961"),i("413806"),i("179133"),i("429532");var eR=i("623527"),ex=i("828782"),eO=i("509090"),eA=i("434144"),eF=i("565024"),eM=i("987475"),eD=i("873791"),eG=i("294452"),ej=i("572932"),eV=i("709606"),eU=i("119513"),eZ=i("75978"),eB=i("967747"),eW=i("197911"),eH=i("874005"),eK=i("448721"),eY=i("119320"),e$=i("611243"),eQ=i("358625"),eq=i("668363"),eJ=i("567754"),ez=i("104013"),eX=i("130459"),e0=i("922894"),e1=i("461591"),e6=i("489011");let e7="activity_indicator_jsb",e3=null,e4=null;class e5{getGiftGuestListData(e){try{var t,i,n,o;let{choosePeopleList:e,choosePeopleArr:r,choosePeopleAll:l,linkStatus:s,isGroupLive:a}=this._store.linkmicStore,{roomInfo:u}=this._store.roomStore,d=null===(i=this._store)||void 0===i?void 0:null===(t=i.linkmicStore)||void 0===t?void 0:t.allowSendGiftGuest,c=Object.values(e).filter(e=>{var t,i,n;return!!d||!!a||(null===(i=e.user)||void 0===i?void 0:null===(t=i.user)||void 0===t?void 0:t.id_str)===(null==u?void 0:null===(n=u.anchor)||void 0===n?void 0:n.id_str)}).map(e=>{var t,i,n,o,r,l;let s="0";(null===(i=e.user)||void 0===i?void 0:null===(t=i.content)||void 0===t?void 0:t.linkmic_audience_content)?s=e.user.content.linkmic_audience_content.fan_ticket_fuzzy_str:(null===(o=e.user)||void 0===o?void 0:null===(n=o.content)||void 0===n?void 0:n.linkmic_content)&&(s=null===(l=e.user.content)||void 0===l?void 0:l.linkmic_content.fan_ticket);let a=4;return String(e.user.user.id_str)===String(null==u?void 0:null===(r=u.anchor)||void 0===r?void 0:r.id_str)&&(a=2),{count:s,identifier:a,user:JSON.stringify(e.user.user)}});if(s===eq.cK.NOT_LINK)return{code:eG.P.Success,data:{is_all_mic:!1,enable_all_mic:!1,current_user:null==u?void 0:null===(o=u.anchor)||void 0===o?void 0:o.id_str,current_user_list:(0,ez.toJS)(r),guest_list:JSON.stringify(c),connection_type:""}};let v=Object.values(e),_={is_all_mic:l,enable_all_mic:l,current_user:(null==v?void 0:null===(n=v[0].user)||void 0===n?void 0:n.user.id_str)||"",current_user_list:(0,ez.toJS)(r),guest_list:JSON.stringify(c),connection_type:""};return{code:eG.P.Success,data:_}}catch(e){return{code:eG.P.Failed}}}async _fetchSetting(){return e3?e3:e4?await e4:(e4=(async()=>{var e,t,i,n,o;let r=await (0,e0.Mr)({device_platform:"web",aid:"6383"});if((null==r?void 0:r.status)!==200||(null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.status_code)!==0)return W.ZN.error(eR.Mo.LiveSettingError,{content:{statusCode:null==r?void 0:null===(i=r.data)||void 0===i?void 0:i.status_code,logId:null!==(o=r.logId)&&void 0!==o?o:"",is_client:(0,ex.DT)(),data:null==r?void 0:null===(n=r.data)||void 0===n?void 0:n.data}}),null;{let e=null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.data;return e3=e,e}})(),await e4)}async getClientSetting(e){if(!e.key)return{code:eG.P.Failed};let t=await this._fetchSetting();return t?("fans_club_lynx_url_group"===e.key&&(t[e.key].lynx_web_url=ej.w.StarfansUser),{code:eG.P.Success,data:{[e.key]:t[e.key]}}):{code:eG.P.Failed}}async privilege_wear_notification(e){return window.location.reload(),(null==e?void 0:e.toast_text)&&eO.F.info(null==e?void 0:e.toast_text),{code:eG.P.Success}}async registerMessage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{type_list:t=[]}=e;try{if(!t.every(e=>{var t,i,n,o;return(null===(o=this._store)||void 0===o?void 0:null===(n=o.activityIndicatorStore)||void 0===n?void 0:null===(i=n.messageListenList)||void 0===i?void 0:null===(t=i.indexOf)||void 0===t?void 0:t.call(i,e))>=0})){var i,n,o;null===(o=this._store)||void 0===o||o.activityIndicatorStore.setMessageListenList([...new Set([...t,...null===(n=this._store)||void 0===n?void 0:null===(i=n.activityIndicatorStore)||void 0===i?void 0:i.messageListenList])])}return{code:eG.P.Success}}catch(e){return{code:eG.P.Success}}}async pcGetBalance(){let{data:e,logId:t}=await eH.sb({}),i=D()(e,"status_code");if(0===i){var n,o,r;let t=D()(e,"data.diamond",0);null===(r=this._store)||void 0===r||null===(o=r.giftStore)||void 0===o||null===(n=o.setBalance)||void 0===n||n.call(o,t)}else W.kg.event(`[${eR.Tn.Error}]${eR.Mo.LiveBalanceError}`,(0,l._)({statusCode:i,logId:null!=t?t:"",is_client:(0,ex.DT)()},e)),eO.F.info(D()(e,"data.prompts","获取余额失败，请稍后重试")),W.kg.error("获取余额失败",e,t)}async openRechargeDialog(e){return new Promise(async t=>{let{rechargeStore:{rechargeAuthStatus:i}}=this._store,{showRecharge:n}=(0,e$.y)();if(i){var o;let i=await (null===(o=$.a.getIAPRechargeParams)||void 0===o?void 0:o.call($.a));n({type:"recharge",balance:(null==e?void 0:e.money_diff)||0,amount:0,theme:(0,eA.Dr)(eF.Q.getItem({sKey:eM.CookieKeys.Theme})),requestPublicParams:i,onSuccess(){t({code:1,data:{recharge_code:1}})}})}})}constructor(e){var t=this;(0,eT._)(this,"_store",null),(0,eT._)(this,"_eventBus",void 0),(0,eT._)(this,"__registerEvent",async()=>{let{publishEvent:e,broadcastEvent:t}=await Promise.resolve().then(i.bind(i,370612));this._eventBus.on("*",(i,n)=>{e(i,n),t(i,n)})}),(0,eT._)(this,"showModal",async e=>{let{title:t,cancelText:i,confirmText:n,content:o,showCancel:r=!0}=e,{showModal:l}=(0,eX.t)({});return new Promise(e=>{l({title:t,content:o,confirmBtnText:n,closeBtnText:i,onConfirm:()=>{e({code:eG.P.Success,data:{cancel:!1,confirm:!0}})},onClose:()=>{e({code:eG.P.Success,data:{cancel:!0,confirm:!1}})},showCancel:r})})}),(0,eT._)(this,"fetch",async e=>{let{params:t,data:i,headers:n,url:o="",method:r="GET"}=e;try{var s;let e=(0,eY.Kj)(this._store)||{},a=(0,l._)({},t);Object.keys(a).forEach(e=>{(""===a[e]||void 0===a[e])&&delete a[e]});let u=(0,d._)((0,l._)({},i||{},e,a),{aid:6383}),c=await (0,et.IZ)({url:o.replace(/^https?:\/\/[^/]+/,""),method:r,headers:n,data:i,params:u});return W.kg.event(`[${eR.Tn.Info}]${eR.Mo.LiveJsbFetchRqSuccess}`,{statusCode:eG.P.Success,code:null==c?void 0:null===(s=c.data)||void 0===s?void 0:s.status_code,logId:null==c?void 0:c.logId,is_client:(0,ex.DT)(),url:o.replace(/^https?:\/\/[^/]+/,"")}),{code:eG.P.Success,raw:null==c?void 0:c.data}}catch(e){return W.kg.event(`[${eR.Tn.Error}]${eR.Mo.LiveJsbFetchRqError}`,{statusCode:eG.P.Failed,is_client:(0,ex.DT)(),url:o.replace(/^https?:\/\/[^/]+/,""),data:e}),{code:eG.P.Failed}}}),(0,eT._)(this,"sendLogV3",async e=>{let{eventName:t,params:i}=e;try{return window.collectEvent(t,(0,l._)({},(0,eB.m6)(),(0,eY.Kj)(this._store),i)),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"_transformShortLink",async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{if(0>e.indexOf("sslocal://webcast_redirect"))return e;let t=await fetch("https://lf-webcast-gr-sourcecdn.bytegecko.com/obj/byte-gurd-source-gr/webcast/cdn/api/scheme_config/api.roma.config.json"),i=await t.json(),n=eJ.parse(e.split("?")[1]);return i.redirect_rules[n.entry][0].location}catch(e){return!1}}),(0,eT._)(this,"_converH5ToAnniexweb",async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let t={redirect_rules:{exhibition_gift_list_h5:[{location:(0,e6.SX)(),ruleType:0}]}},i=eJ.parse(e.split("?")[1]);return t.redirect_rules[i.entry][0].location}catch(e){return!1}}),(0,eT._)(this,"openExhibition",async e=>{var t,i,n,o,r,l,s;let{lynx:a,targetUrl:u}=e,{roomInfo:d}=(null===(t=this._store)||void 0===t?void 0:t.roomStore)||{};try{let e=null===(n=this._store)||void 0===n?void 0:null===(i=n.singletonStore.liveContainer)||void 0===i?void 0:i.isSupportLynx(),t=null!==(r=null==d?void 0:null===(o=d.anchor)||void 0===o?void 0:o.id_str)&&void 0!==r?r:"";return a&&e?null===(s=this._store)||void 0===s||null===(l=s.singletonStore.liveContainer)||void 0===l||l.openLandPage({url:(0,e6.oQ)(t,u),reset:!0}):this.openSchema({url:(0,e6.dY)(t),_reset:!0}),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openGroupExhibition",async e=>{var t,i,n,o,r,l,s,a;let{lynx:u,newExhibition:d=!1,exhibitionSchema:c=""}=e,{choosePeopleArr:v}=(null===(t=this._store)||void 0===t?void 0:t.linkmicStore)||{},{roomInfo:_}=(null===(i=this._store)||void 0===i?void 0:i.roomStore)||{};try{let e=null===(o=this._store)||void 0===o?void 0:null===(n=o.singletonStore.liveContainer)||void 0===n?void 0:n.isSupportLynx(),t=(null==v?void 0:v[0])?null==v?void 0:v[0]:null!==(l=null==_?void 0:null===(r=_.anchor)||void 0===r?void 0:r.id_str)&&void 0!==l?l:"";return u&&e?d&&c?this.openScheme({url:c,_reset:!0}):null===(a=this._store)||void 0===a||null===(s=a.singletonStore.liveContainer)||void 0===s||s.openLandPage({url:(0,e6.oQ)(t),reset:!0}):this.openSchema({url:(0,e6.dY)(t),_reset:!0}),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openAnniexWeb",async e=>{var t,i,n,o;let{url:r,reset:l=!1,skipLint:s=!1}=e;if(!(null===(i=this._store)||void 0===i?void 0:null===(t=i.singletonStore.liveContainer)||void 0===t?void 0:t.isSupportLynx())||-1!==r.search("exhibition_gift_list_h5"))return await this.openScheme({url:r,_noReset:l});try{let e=s?r:await this._converH5ToAnniexweb(r);if(!e)return eO.F.info("打开失败，请重试"),"boolean"==typeof e?(0,eQ.PO)({status:"1",statusCode:eG.P.Failed,url:e}):(0,eQ.PO)({status:"2",statusCode:eG.P.Failed,url:e}),{code:eG.P.Failed};(0,eQ.PO)({statusCode:eG.P.Success,status:"0",url:e});let t=(()=>{let e={__isDouyinPC:"true"};try{let t=eJ.parse(r.split("?")[1]);if("string"==typeof t.url_query){let i=eJ.parse(decodeURIComponent(t.url_query));Object.assign(e,i)}}catch(e){}return e})();return null===(o=this._store)||void 0===o||null===(n=o.singletonStore.liveContainer)||void 0===n||n.openLandPage({url:e,extraParams:t,reset:l}),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openScheme",async e=>{var t,i,n,o,r,l,s,a;let{url:u,isLiveModal:d=!1,_reset:c=!1,_noReset:v=!1}=e;if(-1!==u.indexOf("sslocal://webcast_redirect?entry=gold_gift"))try{let e=null===(t=this._store)||void 0===t?void 0:t.roomStore,o=null===(i=this._store)||void 0===i?void 0:i.userStore,r=null===(n=this._store)||void 0===n?void 0:n.activityIndicatorStore,l=D()(e,"roomInfo.roomId"),s=D()(e,"roomInfo.anchor.id_str"),a=D()(e,"roomInfo.anchor.sec_uid"),u=D()(o,"userInfo.id_str"),d=D()(o,"userInfo.sec_uid"),c=null==r?void 0:r._getGoldActLandUrl;return(null==r?void 0:r.setCurrentLandPage)([c({anchorId:s,secAnchorId:a,userId:u,secUserId:d,roomId:l})]),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}try{let e=await this._transformShortLink(u);if(!e)return eO.F.info("打开失败，请重试"),"boolean"==typeof e?(0,eQ.PO)({status:"1",statusCode:eG.P.Failed,url:e}):(0,eQ.PO)({status:"2",statusCode:eG.P.Failed,url:e}),{code:eG.P.Failed};(0,eQ.PO)({statusCode:eG.P.Success,status:"0",url:e});let{url:t}=eJ.parse(e.split("?")[1]),i=()=>{let e={__isDouyinPC:"true"};try{let t=eJ.parse(u.split("?")[1]);if("string"==typeof t.url_query){let i=eJ.parse(decodeURIComponent(t.url_query));Object.assign(e,i)}}catch(e){}return e},n=!1;try{let e=(null==t?void 0:null===(o=t.split("?"))||void 0===o?void 0:o[1])||"",i=eJ.parse(e);"1"==i.pc_web_lynx&&(n=!0)}catch(e){}if(n&&(null===(l=this._store)||void 0===l?void 0:null===(r=l.singletonStore.liveContainer)||void 0===r?void 0:r.isSupportLynx()))return null===(a=this._store)||void 0===a||null===(s=a.singletonStore.liveContainer)||void 0===s||s.openLandPage({url:`sslocal://lynxview?url=${t}`,reset:c,extraParams:i()}),{code:eG.P.Success};let d=(0,eY.fh)(t,this._store,i()),_=this._store.activityIndicatorStore.currentLandPage.indexOf(d);if(_>=0){let e=[...this._store.activityIndicatorStore.currentLandPage];return e.splice(_,1),this._store.activityIndicatorStore.setCurrentLandPage(e,v),{code:eG.P.Success}}return c?this._store.activityIndicatorStore.setCurrentLandPage([d],v):this._store.activityIndicatorStore.setCurrentLandPage([...this._store.activityIndicatorStore.currentLandPage,d],v),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openSchema",async e=>this.openScheme((0,l._)({url:null==e?void 0:e.schema},e))),(0,eT._)(this,"openUrl",async e=>{let{url:t,pcNotClose:i}=e;try{let e=(0,eY.fh)(t,this._store);if(e=`${e}&__isDouyinPC=true`,i){var n;this._store.activityIndicatorStore.setCurrentLandPage([...null===(n=this._store)||void 0===n?void 0:n.activityIndicatorStore.currentLandPage,e],!0)}else this._store.activityIndicatorStore.setCurrentLandPage([e]);return{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openLive",async e=>{var t,i,n,o,r,s,a,u,d,c,v,_,m,h,f,g,p,y,b;if("scheme"===e.type){if(!(null==e?void 0:null===(t=e.args)||void 0===t?void 0:t.url))return{code:eG.P.Failed};let r=null==e?void 0:null===(n=e.args)||void 0===n?void 0:null===(i=n.url)||void 0===i?void 0:i.split("?");if(r[0].indexOf("webcast_room")>=0){let e=eJ.parse(r[1]||"");return e.web_rid&&window.open(`https://live.douyin.com/${e.web_rid}`),{code:eG.P.Success}}return await this.openScheme({url:e.args.url,_noReset:null==e?void 0:null===(o=e.args)||void 0===o?void 0:o._noReset})}if("room"===e.type)return(null==e?void 0:null===(r=e.args)||void 0===r?void 0:r.web_rid)&&window.open(`/${e.args.web_rid}`),{code:eG.P.Success};if("gift_panel"===e.type){let t=null==e?void 0:e.gift_id,i=null==e?void 0:e.is_send_gift,n=null==e?void 0:null===(s=e.gift_log_extra)||void 0===s?void 0:s.gift_source,o=(0,eW.mS)(t,this._store.giftStore.giftList);return t&&i&&(null==o?void 0:o.id)?this.showModal({title:"",content:`送出1个${o.name}(${o.price}钻)`,confirmText:"确定",showCancel:!0,cancelText:"取消"}).then(i=>{var o,r;(null==i?void 0:i.code)===eG.P.Success&&(null==i?void 0:null===(o=i.data)||void 0===o?void 0:o.confirm)&&this.sendGift({gift_id:t,gift_count:1,gift_source:n,to_user_id:null==e?void 0:null===(r=e.args)||void 0===r?void 0:r.user_id})}):(this._store.giftStore.setGiftPanelSwitchStatus(e.page_type?eV.nN.OPEN_BY_PAGE_TYPE:eV.nN.OPEN_GIFT),e.page_type&&(null===(a=this._store)||void 0===a||a.giftStore.setCurrentPageType(e.page_type))),{code:eG.P.Success}}if("login_panel"===e.type)return await this.openLoginPanel(e.args);if("profile"===e.type){let{user_id:t,sec_uid:i,sec_user_id:n,source:o="",mystery_man:r}=e.args||{};return(0,e1.o8)(this._store,(0,l._)({targetUid:t,secTargetUid:n||i,source:o,skipPrivacyCheck:"true"===String((null==e?void 0:null===(u=e.args)||void 0===u?void 0:u.skip_privacy_check)||!1)},void 0!==r?{targetDisplayRole:Number(r)}:{})),{code:eG.P.Success}}if("charge"===e.type)return this.openLiveRecharge(e),{code:eG.P.Success};if("open_pc_package"===e.type)return(null===(c=this._store)||void 0===c?void 0:null===(d=c.giftStore)||void 0===d?void 0:d.giftPanelSwitchStatus)===eV.nN.NO_CONTROL||(null===(_=this._store)||void 0===_?void 0:null===(v=_.giftStore)||void 0===v?void 0:v.giftPanelSwitchStatus)===eV.nN.CLOSE?null===(h=this._store)||void 0===h||null===(m=h.giftStore)||void 0===m||m.setGiftPanelSwitchStatus(eV.nN.OPEN_PROP):null===(g=this._store)||void 0===g||null===(f=g.giftStore)||void 0===f||f.setGiftPanelSwitchStatus(eV.nN.CLOSE),{code:eG.P.Success};if("lynx"===e.type){if(!(null==e?void 0:null===(p=e.args)||void 0===p?void 0:p.url))return{code:eG.P.Failed};try{let t=decodeURIComponent(e.args.url),i=eJ.parse(t.split("?")[1]).url,n=t.split("?")[2]||"",o=eJ.parse(n);return null===(b=this._store)||void 0===b||null===(y=b.singletonStore.liveContainer)||void 0===y||y.openLandPage({url:`sslocal://lynxview?url=${i}`,reset:!0,extraParams:o}),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}return this._pcNotSupport("openLive",e.type),{code:eG.P.Failed}}),(0,eT._)(this,"call",async function(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>{};if((0,eQ.yQ)({name:e,params:""}),t[e]){let o=await t[e](i,n);try{if("on"===e||"x.subscribeEvent"===e)return;null==n||n(o),o.code!==eG.P.Success&&(0,eQ.ZV)({name:e,params:""})}catch(t){(0,eQ.LQ)({name:e,params:""})}return}t._pcNotSupport(e);try{n({code:eG.P.Failed})}catch(t){(0,eQ.LQ)({name:e,params:""})}}),(0,eT._)(this,"x.subscribeEvent",(e,t)=>this.on(e,t)),(0,eT._)(this,"x.publishEvent",e=>this.publishEvent(e)),(0,eT._)(this,"x.open",e=>{if(null==e?void 0:e.schema)return this.openScheme({url:e.schema,_reset:null==e?void 0:e.replace})}),(0,eT._)(this,"on",(e,t)=>"string"==typeof e?(this.subscribeEvent({eventName:e,callback:t}),t):this.subscribeEvent({eventName:e.eventName,callback:t})),(0,eT._)(this,"off",(e,t)=>{this.unSubscribeEvent({eventName:e,listener:t})}),(0,eT._)(this,"webcastBroadcast",async e=>{let{eventName:t,params:i}=e;try{return this._eventBus.emit(t,i),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"subscribeEvent",async e=>{let{eventName:t,callback:i}=e;try{return this._eventBus.on(t,i),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"publishEvent",async e=>{let{eventName:t,params:i}=e;try{return this._eventBus.emit(t,i),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"unSubscribeEvent",async e=>{let{eventName:t,listener:i}=e;try{return this._eventBus.off(t,i),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"setStorage",async e=>{let{key:t,value:i}=e;try{return localStorage.setItem(`${e7}_${t}`,i),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"getStorage",async e=>{let{key:t}=e;try{var i;return{code:eG.P.Success,value:null!==(i=localStorage.getItem(`${e7}_${t}`))&&void 0!==i?i:""}}catch(e){return{code:eG.P.Failed,value:""}}}),(0,eT._)(this,"removeStorage",async e=>{let{key:t}=e;try{return localStorage.removeItem(`${e7}_${t}`),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"toast",async e=>{let{text:t}=e;try{return eO.F.info(t),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openLiveRecharge",async e=>{let{args:t}=e;try{let{rechargeStore:{rechargeAuthStatus:e}}=this._store,{showRecharge:n}=(0,e$.y)();if(e){var i;let e=await (null===(i=$.a.getIAPRechargeParams)||void 0===i?void 0:i.call($.a));n({type:"recharge",balance:(null==t?void 0:t.money_diff)||0,amount:0,theme:(0,eA.Dr)(eF.Q.getItem({sKey:eM.CookieKeys.Theme})),requestPublicParams:e})}return{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"openLoginPanel",async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return(0,eZ.p)().then(t=>{var i,n;t((0,l._)({headerText:"登录后即可参与互动",success:async()=>{!loginCallback()&&window.location.reload()},next:`https://${null===(n=window)||void 0===n?void 0:null===(i=n.location)||void 0===i?void 0:i.host}`,enterMethod:""},e))}),{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"login",async e=>{let{userStore:t}=this._store,{userInfo:i,odin:n}=t;if((null==i?void 0:i.user_id_str)||(null==i?void 0:i.sec_uid)||(null==i?void 0:i.short_id))return{code:eG.P.Success,status:0};{let e=await this.openLoginPanel({});return{code:e.code,status:e.code===eG.P.Success?1:2}}}),(0,eT._)(this,"sendGift",async e=>{let{gift_id:t,gift_count:i,gift_source:n,args:o,gift_buff_level:r=0,to_user_id:s,send_type:a=4}=e;try{var u,c,v,_,m,h,f,g,p,y,b,P,I,E,S,L,C,w,N,k,T,R,x,O,A,F,M,G,j;let e;let{userStore:{userInfo:V},roomStore:{roomInfo:U},rechargeStore:{rechargeAuthStatus:Z}}=this._store;if(!i)return{code:eG.P.Failed};let B=s||D()(U,"anchor.id_str"),H=D()(U,"room.id_str");if(D()(V,"id_str")===B)return eO.F.info("不可为自己送礼"),{code:eG.P.Failed};let K=o?{plugin_id:JSON.stringify(o.plugin_id),plugin_info:JSON.stringify(o.plugin_info),toolbar_card_name:o.toolbar_card_name,extra:o.extra}:{};if(!H)return{code:eG.P.Failed};let Y={gift_id:t,count:i,room_id:H,to_room_id:H,to_user_id:B,to_user_ids:"",send_type:a,send_scene:(null===(c=this._store)||void 0===c?void 0:null===(u=c.linkmicStore)||void 0===u?void 0:u.isGroupLive)?128:1,gift_source:0};W.kg.event("activity_indicator_send_gift",(0,d._)((0,l._)({},Y),{is_client:(0,ex.DT)()}));let $=await (0,eH.hF)((0,l._)((0,d._)((0,l._)({},Y),{buff_level:r,tags_extra:(e=>{try{return JSON.stringify(e)}catch(e){return JSON.stringify({})}})({gift_source:n}),to_episode_id:D()(U,"room.episode_extra.episode_id_str",0)||0}),K));try{let t=(null==$?void 0:null===(m=$.data)||void 0===m?void 0:m.data.diy_item_info)||"{}";e=JSON.parse(t)}catch(e){}let Q=null==$?void 0:null===(v=$.data)||void 0===v?void 0:v.status_code,q=await eH.sb({});if(0===Q){let o=D()(this._store,"giftStore.giftList",[]),r=D()(this._store,"giftStore.effectList",[]),s=(0,eW.mL)(D()($.data,"data"),o,r,V,e,i);null===(g=this._store)||void 0===g||null===(f=g.giftStore)||void 0===f||null===(h=f.setGiftMessages)||void 0===h||h.call(f,s);let{data:a,logId:u}=q,d=D()(a,"status_code");if(0===d){let e=D()(a,"data.diamond",0);null===(L=this._store)||void 0===L||null===(S=L.giftStore)||void 0===S||null===(E=S.setBalance)||void 0===E||E.call(S,e)}else W.kg.event(`[${eR.Tn.Error}]${eR.Mo.LiveBalanceError}`,(0,l._)({statusCode:d,logId:null!=u?u:"",is_client:(0,ex.DT)()},a)),eO.F.info(D()(a,"data.prompts","获取余额失败，请稍后重试")),W.kg.error("获取余额失败",a,u);this.publishEvent({eventName:"H5_sendGiftStatusChange",params:{gift_list:[{gift_id:Number(t),count:i}]}}),null===(b=this._store)||void 0===b||null===(y=b.eventStore)||void 0===y||null===(p=y.giftEvent)||void 0===p||p.liveGiftSendEvent({gift_id:t,combo_cnt:D()($.data,"data.combo_count"),group_cnt:D()($.data,"data.group_count"),gift_source:n,money_per_unit:D()($.data,"data.gift_struct.diamond_count"),gift_cnt:i,money:i*D()($.data,"data.gift_struct.diamond_count"),is_fans_club_gift:"0",to_user_id:D()(U,"anchor.id_str"),full_seats_cnt:1,is_from_container:0}),null===(I=this._store)||void 0===I||null===(P=I.eventStore)||void 0===P||P.giftEvent.liveConsumeEvent({statusCode:Q,amount:i*D()($.data,"data.gift_struct.diamond_count"),is_client:(0,ex.DT)(),type:"gift_send"})}else if(W.kg.event(`[${eR.Tn.Error}]${eR.Mo.LiveGiftSendCodeNotZero}`,(0,l._)({statusCode:Q,logId:null!==(C=null==$?void 0:$.logId)&&void 0!==C?C:"",is_client:(0,ex.DT)()},null==$?void 0:$.data)),20003===Q)await (0,eW.m8)("登录后即可送礼","live_gift");else if(40001===Q){if(!Z)return{code:eG.P.Success,error_code:null==$?void 0:null===(T=$.data)||void 0===T?void 0:T.status_code};let e=null===(w=this._store.giftStore.giftList)||void 0===w?void 0:w.find(e=>Number(e.id)===Number(t)).price;null===(k=this._store.giftStore)||void 0===k||null===(N=k.handleRecharge)||void 0===N||N.call(k,{type:"balance",balance:e-this._store.giftStore.balance,amount:e})}else 42201===Q?eO.F.info("为保障账号和资金安全，请先前往抖音app完成身份验证"):42202===Q?eO.F.info("为保障账号和资金安全，请先前往抖音app完成身份核对"):(eO.F.info((null==$?void 0:null===(x=$.data)||void 0===x?void 0:null===(R=x.data)||void 0===R?void 0:R.prompts)||"送礼失败，请稍后重试"),W.kg.event(`[${eR.Tn.Error}]${eR.Mo.LiveSendGiftError}`,(0,l._)({statusCode:Q,logId:null!==(O=null==$?void 0:$.logId)&&void 0!==O?O:"",is_client:(0,ex.DT)()},null==$?void 0:$.data)));if((null==$?void 0:null===(_=$.data)||void 0===_?void 0:_.status_code)===40001)return eO.F.info("余额不足，请充值后再试"),{code:eG.P.Success,error_code:null==$?void 0:null===(A=$.data)||void 0===A?void 0:A.status_code};return{code:eG.P.Success,error_code:null==$?void 0:null===(F=$.data)||void 0===F?void 0:F.status_code,error_msg:null!==(j=null==$?void 0:null===(G=$.data)||void 0===G?void 0:null===(M=G.data)||void 0===M?void 0:M.prompts)&&void 0!==j?j:""}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"getAppInfo",async e=>{try{var t;let{userStore:{odin:e}}=null!==(t=this._store)&&void 0!==t?t:{userStore:{}};return{code:eG.P.Success,aid:"6383",user_id:null==e?void 0:e.user_id,device_id:null==e?void 0:e.user_unique_id,is_mas:!!(0,ex.xo)(),appID:"6383"}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"getBaseInfo",async e=>{try{let{roomStore:e}=this._store;return{code:eG.P.Success,anchor_info:{nickname:D()(e,"roomInfo.anchor.nickname","")}}}catch(t){let{roomStore:e}=this._store;return{code:eG.P.Failed,anchor_info:{nickname:D()(e,"roomInfo.anchor.nickname","")}}}}),(0,eT._)(this,"userAction",async e=>{let{type:t,args:{user_id:i=""}}=e;try{let e;let n=D()(this._store,"roomStore.roomInfo.roomId",""),o=D()(this._store,"userStore.userInfo.sec_uid",""),r=D()(this._store,"roomStore.roomInfo.anchor.id_str"),l=D()(this._store,"roomStore.setFollowStatus",()=>{});if("follow"===t?e=await (0,eK.ZN)({to_user_id:String(i),current_room_id:n,sec_user_id:o,sec_to_user_id:"",channel_id:0}):"unfollow"===t&&(e=await (0,eK.fv)({to_user_id:String(i),current_room_id:n,sec_user_id:o,sec_to_user_id:""})),String(r)===String(i)&&e){let t=D()(e,"data.data.follow_status",0);l(t)}return{code:eG.P.Success}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"getPaidLiveInfo",async()=>{try{let{paidLiveStore:e}=this._store,t=D()(this._store,"roomStore.roomInfo.anchor.follow_info.follow_status",0),i=D()(this._store,"paidLiveStore.viewType",0),n=t===eU.E.FOLLOWING||t===eU.E.BOTH;return{code:eG.P.Success,paid_live_info:null==e?void 0:e.paidLiveData,follow_status:Number(n),view_type:Number(i)}}catch(e){return{code:eG.P.Failed}}}),(0,eT._)(this,"userInfo",async e=>{try{var t,i,n,o;let{userStore:e}=this._store,{userInfo:r,odin:l}=e;return{code:(null==l?void 0:l.user_is_login)===1?eG.P.Success:eG.P.Failed,userInfo:{userID:null==r?void 0:r.user_id_str,nickName:null==r?void 0:r.nickname,avatarURL:null==r?void 0:null===(i=r.avatar_large)||void 0===i?void 0:null===(t=i.url_list)||void 0===t?void 0:t[0],secUserID:null==r?void 0:r.sec_uid,shortID:null==r?void 0:r.short_id},user_id:null==l?void 0:l.user_id,short_id:null==r?void 0:r.short_id,sec_user_id:null==r?void 0:r.sec_uid,nickname:null==r?void 0:r.nickname,avatar:null==r?void 0:null===(o=r.avatar_large)||void 0===o?void 0:null===(n=o.url_list)||void 0===n?void 0:n[0],is_silent:void 0,douyin_uid:null==r?void 0:r.short_id,is_login:null==l?void 0:l.user_is_login}}catch(e){return{code:eG.P.Failed,userInfo:{userID:""}}}}),(0,eT._)(this,"getUserInfo",async e=>{try{var t,i;let{userStore:e}=this._store,{userInfo:n}=e,o=(null==n?void 0:n.id_str)||(null==n?void 0:n.sec_uid)||(null==n?void 0:n.short_id);return{code:o?eG.P.Success:eG.P.Failed,isLogin:!!o,is_login:!!o,userInfo:{userID:null==n?void 0:n.id_str,nickName:null==n?void 0:n.nickname,avatarURL:null==n?void 0:null===(i=n.avatar_large)||void 0===i?void 0:null===(t=i.url_list)||void 0===t?void 0:t[0],secUserID:null==n?void 0:n.sec_uid,shortID:null==n?void 0:n.short_id}}}catch(e){return{code:eG.P.Failed,userInfo:{userID:""}}}}),(0,eT._)(this,"x.getUserInfo",async e=>this.getUserInfo(e)),(0,eT._)(this,"baseInfo",async()=>{var e,t,i,n,o;let{userStore:{userInfo:r},roomStore:{roomInfo:l}}=this._store,s={avatar:null==r?void 0:null===(t=r.avatar_large)||void 0===t?void 0:null===(e=t.url_list)||void 0===e?void 0:e[0],nickname:null==r?void 0:r.nickname,sec_user_id:null==r?void 0:r.sec_uid,short_id:null==r?void 0:r.short_id,user_id:null==r?void 0:r.user_id_str,user_level:null==r?void 0:r.level,user_type:"",display_id:null==r?void 0:r.display_id},{anchor:a}=l,u={avatar:null==a?void 0:null===(n=a.avatar_thumb)||void 0===n?void 0:null===(i=n.url_list)||void 0===i?void 0:i[0],nickname:null==a?void 0:a.nickname,short_id:null==a?void 0:a.id_str,user_id:null==a?void 0:a.id_str,sec_user_id:null==a?void 0:a.sec_uid,anchor_level:void 0,anchor_type:void 0,display_id:void 0},d={room_id:null==l?void 0:l.roomId,room_layout:1,is_paidlive:!1,live_room_mode:(null==l?void 0:null===(o=l.room)||void 0===o?void 0:o.live_room_mode)||"0",game_points_playing:2,quiz_game_points_playing:2,is_life:!1};return{code:eG.P.Success,user_info:s,room_info:d,anchor_info:u,__data:{user_info:s,room_info:d,anchor_info:u}}}),(0,eT._)(this,"close",async e=>{let{url:t}=e,{activityIndicatorStore:{closeLandPage:i}}=this._store;return i(t),{code:eG.P.Success}}),(0,eT._)(this,"_pcNotSupport",(e,t)=>{(0,eQ.Jn)({name:e,params:t})}),this._store=e,this._eventBus=new eD.N,this.__registerEvent()}}var e2=i("541671"),e8=i("852664"),e9=i("308910"),te=i("160104"),tt=i("590928"),ti=i("990530"),tn=i("367271"),to=i("713097"),tr=i.n(to),tl=i("101363"),ts=i("729532"),ta=i("157703"),tu=i("285385"),td=i("441447"),tc=i("818538"),tv=i("948375");let t_=()=>{setTimeout(()=>{td.emit(td.EVENT.initImSDK)},100),setTimeout(()=>{td.emit(td.EVENT.initNoticeSDK)},500)},tm=e=>{null===ta.sA||void 0===ta.sA||ta.sA.liveUrlLoadEnd(e),td.emit(td.EVENT.afterVideoPlayed),t_()};var th=i("431053"),tf=i("655949"),tg=i("555001"),tp=i("782580"),ty=i("692532"),tb=i("169961");let tP=()=>{let{userStore:{setPlayerUserHandlePause:e},playerStore:{playerInstance:t,setIsPlay:i,isPlay:n,setIsPlayed:o,setIsLoadedData:r,isFullScreen:l,setIsFullScreen:s,setIsTheaterOn:u,isTheaterOn:d,playerLoggerInstance:c},singletonStore:{playerHandler:v},roomStore:{roomInfo:_,roomStatus:m,setFoldChatroom:h,setIsShowRefreshPage:f},streamStore:{streamInfoFromLiving:g,isH265:p,setIsH265Error:y,setVideoInit:b,lowH265:P,setUseBackUp:I,isH265Error:E,useBackUp:S},eventStore:{tabEvent:L,basicEvent:C}}=(0,A.o)(),w=(0,tb.T)(),N=a.useRef(0),k=D()(_,"room.id_str"),{url:T}=g,R=a.useCallback(()=>(null==v||v.setCurrentRoom(_,T),null==v||v.setUrlAutoChange(!1),t&&(null==v||v.setPlayer(t)),m!==V.LV.END&&m!==V.LV.PAUSE&&!0),[_,T,m,t,v]),x=(0,a.useRef)(0),O=(0,a.useRef)(!1),[F,M]=(0,a.useState)(!1),G=a.useCallback(()=>{x.current&&Date.now()-x.current>200&&x.current&&O.current&&W.ZP.event(`[${eR.Tn.Error}]${eR.Mo.LiveBasicPlayerWaiting}`,{room_id:D()(_,"roomId"),url:T,room_status:m,is_client:(0,ex.DT)(),type:"living"})},[_,m,T]),{setLoadStartTime:j,setTtfbTime:U,setStreamReceived:Z}=(0,tf.Z)({from:"living",player:t,isRoomEnd:m===V.LV.END,eventParams:C,isH265:p}),B=(0,tv.Z)(e=>{U(e)}),H=(0,tv.Z)(()=>{j(),ts.z.markOnce("living_player_load_start")}),K=(0,tv.Z)(e=>{tm(e),Z(),"number"!=typeof e&&(e=void 0),ts.z.markOnce("living_player_loaded_data"),(0,tg.j)({roomId:k,type:"first_frame",duration:e}),r(!0),O.current=!1}),Y=(0,tv.Z)(()=>{if(f(!1),N.current=0,R()){let e=D()(_,"roomId");null==v||v.handlePlaying(e),G()}}),$=(0,tv.Z)(()=>{if(R()){let e=D()(_,"roomId");null==v||v.handleWaiting(e),!O.current&&(x.current=Date.now(),O.current=!0)}}),Q=(0,tv.Z)(()=>{if(e(!0),o(!0),b&&b(!0),i(n+1),(0,th.yr)({isLive:1}),F?null==L||L.liveStartEvent({event_page:"live_detail",if_mini_window:(0,ti.OL)()}):M(!0),R()){let e=D()(_,"roomId");null==v||v.handlePlay(e)}}),q=(0,tv.Z)(()=>{if(e(!1),x.current=0,null==L||L.livePauseEvent({event_page:"live_detail",if_mini_window:(0,ti.OL)()}),R()){let e=D()(_,"roomId");null==v||v.handlePause(e)}}),J=(0,tv.Z)(e=>{!e&&tu.oh&&td.emit(td.EVENT.exitClientFullscreen),!l&&u(!1),s(e)}),z=()=>{try{if(location.pathname.indexOf("root/live")>=0)return"root_live";if(location.pathname.indexOf("follow/live")>=0)return"follow_live";if(location.pathname.indexOf("follow")>=0)return"follow";if(location.search.indexOf("recommend=1")>=0)return"recommend";if("www.douyin.com"===location.host)return"main";if("live.douyin.com"===location.host)return"live";return"other"}catch(e){return"error"}},X=e=>{try{return JSON.stringify(e)}catch(e){return"err序列化失败"}},ee=(0,tv.Z)(e=>{if(tm(),R()){var i;let n=(null==e?void 0:null===(i=e.player)||void 0===i?void 0:i.src)||(null==t?void 0:t.src);if(!n)return;let o=D()(_,"roomId");if(p||P&&((null==n?void 0:n.includes("ld5"))||(null==n?void 0:n.includes("sd5")))&&!E){y(!0),null==c||c.updateExt({h265_degrade:1}),setTimeout(()=>{var i,n,o,r,l;null==t||t.retry(),null===W.ZP||void 0===W.ZP||null===(l=W.ZP.event)||void 0===l||l.call(W.ZP,"player_relegate_url",{room_id:D()(_,"roomId"),url:null==t?void 0:null===(o=t.plugins)||void 0===o?void 0:null===(n=o.flvlive)||void 0===n?void 0:null===(i=n.loader)||void 0===i?void 0:i.finnalUrl,is_client:(0,ex.DT)(),host:null===(r=location)||void 0===r?void 0:r.host,pathType:(()=>{try{if(location.pathname.indexOf("root/live")>=0)return"root_live";if(location.pathname.indexOf("follow/live")>=0)return"follow_live";if(location.pathname.indexOf("follow")>=0)return"follow";if(location.search.indexOf("recommend=1")>=0)return"recommend";if("www.douyin.com"===location.host)return"main";if("live.douyin.com"===location.host)return"live";return"other"}catch(e){return"error"}})(),isNewProject:1,code:(null==e?void 0:e.httpCode)||(null==e?void 0:e.code),info:null==e?void 0:e.message,detail:(()=>{try{return JSON.stringify(e)}catch(e){return"err序列化失败"}})()})},1e3);return}S?f(!0):I(!0);null==v||v.handleError(o,e)}}),{errorHandle:et}=(0,ty.o)({playerInstance:t,playerLoggerInstance:c,streamInfo:{isH265:p,isH265Error:E,setIsH265Error:y,playerUrl:T,useBackUp:S,setUseBackUp:I},isRoomError:R,onH265Degrade:e=>{setTimeout(()=>{var i,n,o,r,l;null===W.ZP||void 0===W.ZP||null===(l=W.ZP.event)||void 0===l||l.call(W.ZP,"player_relegate_url",{room_id:D()(_,"roomId"),url:null==t?void 0:null===(o=t.plugins)||void 0===o?void 0:null===(n=o.flvlive)||void 0===n?void 0:null===(i=n.loader)||void 0===i?void 0:i.finnalUrl,is_client:(0,ex.DT)(),host:null===(r=location)||void 0===r?void 0:r.host,pathType:z(),isNewProject:1,code:(null==e?void 0:e.httpCode)||(null==e?void 0:e.code),info:null==e?void 0:e.message,detail:X(e)})},1e3)},onUnablePlay:()=>{f(!0)},onError:e=>{null==tm||tm(),null==v||v.handleError(k,e)},disable:!(0,tp.getInNewProjectPreviewABWithoutStoreCheck)(w)}),ei=(0,tv.Z)(()=>{if(N.current>1){null==f||f(!0);return}if(m===V.LV.LIVING&&(0,tp.getInLiveOOMFixAB)()&&N.current<=1){N.current=N.current+1,null==t||t.retry();return}if(m===V.LV.LIVING){null==t||t.retry();return}if(R()){let e=D()(_,"roomId");null==v||v.handleEnded(e)}}),en=(0,a.useMemo)(()=>({[ec.FP.PLAY]:Q,[ec.FP.PAUSE]:q,[ec.FP.FULLSCREEN_CHANGE]:J,[ec.FP.ERROR]:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,tp.getInNewProjectPreviewABWithoutStoreCheck)(w)?et(...t):ee(...t)},[ec.FP.ENDED]:ei,[ec.FP.WAITING]:$,[ec.FP.PLAYING]:Y,[ec.FP.LOADEDDATA]:K,[ec.FP.LOADSTART]:H,[ec.FP.TTFB]:B}),[Q,q,J,et,ee,ei,Y,$,K,H,B]);(0,a.useEffect)(()=>{if((0,tu.oh)()&&t){let{fullscreenTarget:e}=t.config.baseConfig,i=td.listen(td.EVENT.ControlLiveFullscreenByClient,i=>{let{isFull:n}=i;n?((0,tc.a)(),(0,tu.GP)(()=>{null==t||t.getFullscreen(e)})):null==t||t.exitFullscreen()});return t.on(ec.FP.FULLSCREEN_CHANGE,e=>{td.emit(td.EVENT.ControlLiveFullscreenByClient,{isFull:e})}),()=>{null==i||i()}}},[t]),(0,a.useEffect)(()=>(!l&&!d&&h(!1),l||d?document.body.classList.add("xgplayer-fullscreen-parent"):document.body.classList.remove("xgplayer-fullscreen-parent"),()=>{document.body.classList.remove("xgplayer-fullscreen-parent")}),[l,d]);let eo=a.useRef(!0);return(0,a.useEffect)(()=>{var e,i;R()&&T&&(null==t?void 0:null===(e=t._core)||void 0===e?void 0:e._errorInfo)&&eo.current&&p&&(eo.current=!1,ee(null==t?void 0:null===(i=t._core)||void 0===i?void 0:i._errorInfo))},[R,T,t,p]),en};var tI=i("624207"),tE=i("403300");let tS=(0,a.forwardRef)((e,t)=>(0,s.jsx)("svg",(0,d._)((0,l._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h13a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2h-13zm10 11h-1.501v2H20.5a1 1 0 0 0 1-1v-2.5h-2V19zm-7 0v-1.5h-2V20a1 1 0 0 0 1 1h2.499v-2H12.5zm0-6h1.499v-2H11.5a1 1 0 0 0-1 1v2.5h2V13zm7 0h-1.501v-2H20.5a1 1 0 0 1 1 1v2.5h-2V13z",fill:"#fff"})})));var tL=i("466576"),tC=i("811796"),tw=i("559947"),tN=i("589944"),tk=i("328155"),tT=i("400582");let tR=()=>{var e,t;let i=(0,q.a)(),n=(0,tk.Nr)(i.pathname),o=null===tT.Z||void 0===tT.Z?void 0:null===(e=tT.Z.getPlayerInstance)||void 0===e?void 0:e.call(tT.Z),r=null===tT.Z||void 0===tT.Z?void 0:null===(t=tT.Z.getLoggerInstance)||void 0===t?void 0:t.call(tT.Z);return{reusePlayer:!!(n&&o&&r),playerInstance:o,loggerInstance:r}};var tx=i("505575"),tO=i("797973");let tA=()=>{let{player:e}=(0,tx.n)(),{playerStore:{isTheaterOn:t,isFullScreen:i}}=(0,A.o)(),n=(0,a.useRef)(!1),o=(0,tO.Z)(t=>{var i,n,o,r;let{isLock:l}=t,s=null===(r=document)||void 0===r?void 0:null===(o=r.activeElement)||void 0===o?void 0:null===(n=o.classList)||void 0===n?void 0:null===(i=n.contains)||void 0===i?void 0:i.call(n,e_.nk);if(!!l||!s)null==e||e.focus({isLock:l})});return(0,a.useEffect)(()=>{let t=()=>{n.current=!0,o({isLock:!0})};null==e||e.on(ec.FP.PAUSE,t);let i=()=>{n.current=!1,o({isLock:!1})};return null==e||e.on(ec.FP.PLAY,i),()=>{null==e||e.off(ec.FP.PLAY,t),null==e||e.off("play",i)}},[e]),(0,a.useEffect)(()=>{if(e){var t;let i=null==e?void 0:null===(t=e.root)||void 0===t?void 0:t.querySelector(".douyin-player-controls");if(i){let e=()=>{if(!n.current)o({isLock:!0})},t=()=>{if(!n.current)o({isLock:!1})};return i.addEventListener("mouseenter",e),i.addEventListener("mouseleave",t),()=>{i.removeEventListener("mouseenter",e),i.removeEventListener("mouseleave",t)}}}},[e]),(0,a.useEffect)(()=>{if((0,e8.G6)()&&(i||t)){let e=document.querySelector("#douyin-right-container");if(e)return e.style.paddingTop="0px",()=>{e.style.paddingTop="var(--header-height)"}}},[i,t]),(0,a.useEffect)(()=>{o({isLock:!1}),setTimeout(()=>{try{var t;null===(t=e.root)||void 0===t||t.classList.add("douyin-player-controls-autohide")}catch(e){}},100)},[i,i,e]),null};var tF=i("473233"),tM=i("976167"),tD=i("487330"),tG=i("414678"),tj=i("443024"),tV=i("885762"),tU=(0,z.Pi)(e=>{var t,i,n,o;let{detailPage:r}=e,u=(0,A.o)(),{userStore:{userInfo:c,odin:v,headerUserInfo:_},playerStore:{setPlayerInstance:m,setPlayerLoggerInstance:h,setIsFullScreen:f,isFullScreen:g,setLoggerOptions:p,loggerOptions:y,playerInstance:b,setFullScreenTarget:P,playerLoggerInstance:I,setIsTheaterOn:E},activityIndicatorStore:{setJSBInstance:L},singletonStore:{message:C,setPlayer:w,setLiveContainer:k},rightPanelStore:{playerMargin:T},roomStore:{isDoubleScreen:R,setIsFocus:x,isAppOnly:O,roomInfo:F,playerCoverText:M,coverUrl:G},streamStore:{streamInfoFromLiving:{secret_key:j,bitrate:V},streamData:U},paidLiveStore:{isPaidLive:Z},linkmicStore:{linkRoomType:B,functionType2:W},vipStore:{setIsShowVipPanel:H,vipInfoLoaded:K},vrStore:{isImmersive:Y}}=u;(0,tV.$s)(e=>{let{setFullscreen:t}=e;return{setFullscreen:t}});let{cityName:$}=(0,tD.Iq)(e=>{let{cityName:t}=e;return{cityName:t}}),{url:Q,backupUrl:z,H264Url:X,lowUrl:ee,common:et,startQuality:ei}=(0,tt.H)(),en=(0,a.useMemo)(()=>{},[c.id_str,null==v?void 0:v.user_unique_id]),eo=eh.s?void 0:document.body,er=(0,q.a)(),el=(0,a.useMemo)(()=>{(0,tk.Nr)(er.pathname);let e={url:Q,_freezeUrl:R||Z||(()=>{try{if("undefined"!=typeof window&&window.__cdn_degrade__)return window.__cdn_degrade__=!1,!0}catch(e){return!1}})()?Q:"",autoplay:!0,volume:(0,ev.T1)(),muted:(0,ev.rC)(),fullscreenTarget:eo,worker:{recylable:!1},disconnectTime:5};return j&&(e.decryption={entry:"https://unpkg.byted-static.com/byted/webplayer-extensions/0.0.3/dist/live-decrytion.js",keyStr:j}),en&&(e.volumeWaterMark=en),e},[Q,eo,j,en,R,Z]),es=tP(),ea=(0,a.useMemo)(()=>({controls:{autoHide:!0},CompatibilityFullscreenPlugin:{keyboardCode:"KeyH",position:"top-right",IconExitFullscreen:tE.Z,IconFullscreen:tS}}),[]),eu=(0,tC.d)(),eT=(0,a.useMemo)(()=>{var e,t,i,n,o,l;let{nickname:s,avatar_thumb:a,id_str:u}=(null==F?void 0:F.anchor)||{},d=(null==F?void 0:null===(t=F.room)||void 0===t?void 0:null===(e=t.linker_detail)||void 0===e?void 0:e.linker_ui_layout)||0,c=null==F?void 0:null===(i=F.web_stream_url)||void 0===i?void 0:i.pull_datas,v=null==eu?void 0:null===(o=eu.request)||void 0===o?void 0:null===(n=o.header)||void 0===n?void 0:n["user-agent"];return{inlinePlayer:r&&Q&&!(v?/Safari/.test(v)&&!/Chrome/.test(v):(0,e8.G6)()),isDoubleScreen:R,meta:(()=>{if(c&&Object.keys(c).length>0){var e,t,i,n,o;let r=c[Object.keys(c)[0]];if((null==r?void 0:null===(e=r.extension)||void 0===e?void 0:e.camera_clip)&&(null==r?void 0:null===(t=r.extension)||void 0===t?void 0:t.game_clip)&&(null==r?void 0:null===(i=r.extension)||void 0===i?void 0:i.camera_hidden)===0){let e=(null==r?void 0:null===(n=r.extension)||void 0===n?void 0:n.game_clip)||{},t=(null==r?void 0:null===(o=r.extension)||void 0===o?void 0:o.camera_clip)||{};return{mainPointers:[e.x,e.y,e.w,e.h],miniPointers:[t.x,t.y,t.w,t.h],displayMode:0}}}})(),anchorInfo:{nickname:s,avatar:null==a?void 0:null===(l=a.url_list)||void 0===l?void 0:l[0],id_str:u},roomInfo:{roomId:null==F?void 0:F.roomId,linkerUiLayout:d},inlineEnterOptInfo:{backupUrl:z,H264Url:X,lowUrl:ee}}},[R,F,r,Q,z,X,ee]),eR=!!(M&&!(M===e_.kx.ANCHOR_BAN&&B)),ex=(0,a.useMemo)(()=>{var e,t,i,n,o,r,s;return(0,d._)((0,l._)({user_id:c.id_str,device_id:null!==(s=null==v?void 0:v.user_unique_id)&&void 0!==s?s:"",scene:em.C.liveDetail,live_type:D()(F,"room.live_room_mode",""),definition:ei,is_game:D()(F,"room.game_data.game_tag_info.is_game",2),is_live_end:eR?1:0,is_shopping:!!(null===(t=D()(F,"room.toolbar_data"))||void 0===t?void 0:null===(e=t.entrance_list)||void 0===e?void 0:e.find(e=>e.component_type===tF.Ls.Cart))},(null===(i=D()(U,"H265_streamData",void 0))||void 0===i?void 0:i.stream)?{}:{h265_miss:1}),{url:el.url,title:null==F?void 0:null===(n=F.room)||void 0===n?void 0:n.title,baseConfigUrl:(null==b?void 0:null===(r=b.config)||void 0===r?void 0:null===(o=r.baseConfig)||void 0===o?void 0:o.url)||"",originUrl:Q||""})},[c.id_str,null==v?void 0:v.user_unique_id,null==F?void 0:null===(t=F.room)||void 0===t?void 0:t.live_room_mode,ei,M,B,eR,U,el.url,null==F?void 0:null===(i=F.room)||void 0===i?void 0:i.title,null==b?void 0:null===(o=b.config)||void 0===o?void 0:null===(n=o.baseConfig)||void 0===n?void 0:n.url,Q]);(0,a.useEffect)(()=>{p(ex)},[ex]);let eO=(0,S.bU)(),{reusePlayer:eA,playerInstance:eF,loggerInstance:eM}=tR();(0,a.useEffect)(()=>{let e=new e5(u);Object.freeze(e),L(e),e._fetchSetting(),window.__JSB__=e,window.__landPage_jsb__=e,window.__MESSAGE_INSTANCE__=C,window.__INDICATOR_UTIL__=eY.Qg},[u]),(0,a.useEffect)(()=>{tL.T.reset(),k(new tL.T(u))},[u]),(0,a.useEffect)(()=>{P(eo)},[eo]),(0,a.useEffect)(()=>{var e;(0,tN.X)()&&K&&(null==_?void 0:_.isLogin)&&(null==F?void 0:null===(e=F.room)||void 0===e?void 0:e.id_str)&&(0,tM.Z)("live")},[K,null==_?void 0:_.isLogin,F]),(0,a.useEffect)(()=>{O&&((0,J.q)("ISLAND_SYNC_HEADER"),(0,J.q)("ISLAND_LAYOUT_NAVIGATION"),E(!1))},[O]);let eD=(0,tp.useInLivePlayerDegradeAB)(),eG=(0,tj.X3)();return O?(0,s.jsx)(tI.Z,{avatar:D()(F.anchor,"avatar_thumb.url_list[0]",""),qrcode:F.qrcode_url,className:e2.Z.appOnly}):(0,s.jsxs)("div",{className:tr()(e2.Z.livingPlayer,"__livingPlayer__",{[e2.Z.hideLoadingAndControl]:!Q,[e2.Z.isImmersive]:Y},eG),style:{marginRight:T},id:tl.f+((null==b?void 0:b.playerId)||""),children:[(0,s.jsx)(e9.TY,{className:e2.Z.basicPlayerPip,pipAnchorId:ti.MA.BasicPlayer,placeholder:(0,s.jsx)(te.InPicturePlaceholder,{}),children:(0,s.jsxs)(ed.N,{disableLogger:eR,onReady:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];ts.z.markOnce("living_player_ready"),null===ta.sA||void 0===ta.sA||ta.sA.livePlayerInitEnd(...t)},onBeforePlayerInit:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];ts.z.markOnce("living_player_before_player_init"),null===ta.sA||void 0===ta.sA||ta.sA.livePlayerInitStart(...t)},baseConfig:el,pluginsConfig:ea,sessionId:null==et?void 0:et.session_id,secretKey:j,bitrate:V,isPaidLive:Z,logOptions:ex,poster:eD?G:void 0,onFocus:()=>{x(!0)},onBlur:()=>{x(!1)},onLoadedData:e=>{es.loadeddata(e),null==eO||eO.emit(N._.FirstFrame)},onError:es[ec.FP.ERROR],onTTFB:es[ec.FP.TTFB],onLoadStart:es[ec.FP.LOADSTART],onWaiting:es[ec.FP.WAITING],onPlaying:es[ec.FP.PLAYING],onPlay:es[ec.FP.PLAY],onPause:es[ec.FP.PAUSE],onEnd:es[ec.FP.ENDED],onFullScreenChange:es[ec.FP.FULLSCREEN_CHANGE],ref:e=>{if(!!(null==e?void 0:e.player))(null==e?void 0:e.player)&&(null==e?void 0:e.player)!==b&&(m(null==e?void 0:e.player),w(null==e?void 0:e.player)),(null==e?void 0:e.logger)&&(null==e?void 0:e.logger)!==I&&h(null==e?void 0:e.logger)},playerAction:eT,disableDynamicBg:"audio"===B&&"audio_audience"!==W,reusePlayer:eA,playerInstance:eF,loggerInstance:eM,role:"consumer",scene:"LivingPlayer",children:[(0,s.jsx)(ef,{className:e2.Z.layoutCommon}),(0,s.jsx)(eg,{className:e2.Z.layoutCommon}),(0,s.jsx)(ep,{className:e2.Z.layoutCommon}),(0,s.jsx)(ey,{className:e2.Z.layoutCommon}),(0,s.jsx)(eb,{className:e2.Z.layoutCommon}),(0,s.jsx)(eP,{className:tr()(e2.Z.layoutCommon,e2.Z.layoutLike)}),(0,s.jsx)(eI,{className:e2.Z.layoutCommon}),(0,s.jsx)(eE,{className:e2.Z.layoutCommon}),(0,s.jsx)(eS,{className:e2.Z.layoutCommon}),(0,s.jsx)(eL,{className:e2.Z.layoutCommon}),(0,s.jsx)(eC,{className:tr()(e2.Z.layoutCommon)}),(0,s.jsx)(ew,{className:e2.Z.layoutCommon}),(0,s.jsx)(eN,{className:e2.Z.layoutCommon}),(0,s.jsx)(tw.xr,{ref:e=>{e&&b&&e!==(null==b?void 0:b._pipRef)&&(b._pipRef=e)}}),(0,s.jsx)(ek,{className:e2.Z.layoutCommon}),(0,s.jsx)(tA,{}),(0,s.jsx)("div",{id:`gift_effect_bg_${null==F?void 0:F.roomId}`,style:{position:"absolute",left:0,bottom:"-4px",width:"100%",height:"auto",background:"transparent",pointerEvents:"none",zIndex:-1,opacity:"0.5"}}),(0,s.jsx)(tG.h,{source:"LivingPlayer"})]})}),(0,s.jsx)(tn.GZ,{isDoubleScreen:R})]})}),tZ=i("889585");n=0;let tB=(0,k.n)(tU,{name:w.l.LIVING_PLAYER,renderWhen:N._.LivingInit});var tW=(0,C.OV)({Component:tB,layoutName:u.t.PlayerLayout,ComponentName:w.l.LIVING_PLAYER,index:1}),tH=i("36964"),tK=i("736579");let tY=(0,k.n)((0,T.ZP)(()=>i.e("92053").then(i.bind(i,655201)),{ssr:!1}),{name:w.l.RightPanelContainer,renderWhen:tK.d.afterComponent(w.l.ChatRoom)});var t$=(0,C.OV)({Component:tY,layoutName:u.t.RightPanelLayout,ComponentName:w.l.RightPanelContainer,index:1}),tQ=i("446042"),tq=i("770732");let tJ=(0,k.n)((0,T.ZP)(()=>Promise.all([i.e("70505"),i.e("23426")]).then(i.bind(i,211507)),{ssr:!1}),{name:w.l.RoomInfoBar,renderWhen:N._.FirstFrame});(0,tQ.GI)({name:w.l.RoomInfoBar,condition:e=>{let{store:t}=e,{layoutStore:{immersive:i},vrStore:{isImmersive:n}}=t;return!i&&!n},Component:tJ,index:0});var tz=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.RoomInfoBar}),layoutName:u.t.HeaderLayout,ComponentName:w.l.RoomInfoBar,index:0});let tX=(0,k.n)((0,T.ZP)(()=>i.e("63199").then(i.bind(i,56052)),{ssr:!1}),{name:w.l.LandPageContainer,renderWhen:N._.FirstFrame,taskPriority:"background"});(0,tQ.GI)({name:w.l.LandPageContainer,condition:e=>{let{store:t}=e,{roomStore:{roomStatus:i,hideBanner:n},vipStore:{showVipLiveBoundary:o}}=t;return(i!==V.LV.END||o)&&(!n||o)},Component:tX,index:0});var t0=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.LandPageContainer}),layoutName:u.t.RightPanelLayout,ComponentName:w.l.LandPageContainer,index:0}),t1=i("424784");let t6=(0,k.n)(t1.Z,{name:w.l.LiveShare,renderWhen:tK.d.afterComponent(w.l.ChatRoom),taskPriority:"background"});(0,tQ.GI)({name:w.l.LiveShare,condition:e=>{let{store:t}=e,{roomStore:{roomStatus:i},feedStore:{isActive:n}}=t;return n&&i!==V.LV.END},Component:t6,index:0});var t7=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.LiveShare}),layoutName:u.t.LeftBackgroundLayout,ComponentName:w.l.LiveShare,index:0}),t3=i("106798");let t4=(0,k.n)((0,T.ZP)(()=>i.e("41306").then(i.bind(i,821855)),{ssr:!1}),{name:w.l.ProgrammeWrapper,renderWhen:tK.d.afterComponent(w.l.ChatRoom)});(0,tQ.GI)({name:w.l.ProgrammeWrapper,condition:()=>!0,Component:t4,index:0});var t5=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.ProgrammeWrapper}),layoutName:u.t.ContainerBackgroundLayout,ComponentName:w.l.ProgrammeWrapper,index:0});i("602157");var t2=i("768492"),t8=i("429719");function t9(e){let{title:t="抖音直播",description:i,keywords:n}=e,o=(0,q.a)(),[r,l]=a.useState(!1);a.useEffect(()=>{(0,e8.GP)()&&l(!0)},[]);let u=a.useMemo(()=>(0,eA.Dr)(eF.Q.getItem({sKey:eM.CookieKeys.Theme})),[]);return(0,s.jsxs)(t8.Head,{children:[(0,s.jsx)("title",{children:t}),(0,s.jsx)("meta",{name:"description",content:i}),(0,s.jsx)("meta",{name:"keywords",content:n}),(0,s.jsx)("link",{rel:"canonical",href:`${(0,t2.Pe)()}${"/live"===o.pathname?"":o.pathname}`}),(0,s.jsx)("meta",{name:"theme-color",content:`${"light"===u?"#ffffff":"#161823"}`}),!r&&(0,s.jsx)("link",{rel:"manifest",href:"https://lf9-static.bytednsdoc.com/obj/eden-cn/nupthpqups/manifest.json"})]})}var ie=(0,z.Pi)(e=>{let{roomStore:{roomInfo:t}}=(0,A.o)(),i=(0,a.useMemo)(()=>D()(t,"anchor.nickname",""),[t]);return(0,s.jsx)(t9,{title:`${i}的抖音直播间 - 抖音直播`,description:`欢迎来到${i}的抖音直播间，${i}与大家一起记录美好生活 - 抖音直播`,keywords:`${i},${i}}直播,${i}抖音,${i}直播间,${i}抖音直播,${i}抖音直播间,抖音直播,抖音`})});let it=(0,k.n)(ie,{name:w.l.LiveTDK,renderWhen:N._.LivingInit});(0,tQ.GI)({name:w.l.LiveTDK,condition:()=>!0,Component:it,index:0});var ii=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.LiveTDK}),layoutName:u.t.ContainerBackgroundLayout,ComponentName:w.l.LiveTDK,index:0});let io=(0,k.n)((0,T.ZP)(()=>i.e("34162").then(i.bind(i,209839)),{ssr:!1}),{name:w.l.AutoRunModal,renderWhen:tK.d.afterComponent(w.l.ChatRoom),taskPriority:"background"});(0,tQ.GI)({name:w.l.AutoRunModal,condition:()=>!0,Component:io,index:0});var ir=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.AutoRunModal}),layoutName:u.t.ContainerBackgroundLayout,ComponentName:w.l.AutoRunModal,index:0});let il=(0,k.n)((0,T.ZP)(()=>i.e("17282").then(i.bind(i,616337)),{ssr:!1}),{name:w.l.AudioCheatTips,renderWhen:N._.FirstFrame,taskPriority:"background"});(0,tQ.GI)({name:w.l.AudioCheatTips,condition:()=>!0,Component:il,index:0});var is=(0,C.OV)({Component:()=>(0,s.jsx)(tq.Z,{name:w.l.AudioCheatTips}),layoutName:u.t.PlayerControlLayout,ComponentName:w.l.AudioCheatTips,index:0}),ia=i("187406"),iu=(0,z.Pi)(e=>{let{context:t,children:i}=e;return(0,s.jsx)(ia.T,{context:t,children:i})}),id=i("879214"),ic=i("829021"),iv=i("836313");i("209955");var i_=i("336347");let im=e=>{let{type:t=i_.NI.emptyList}=e;return a.useEffect(()=>{td.emit(td.EVENT.livePlayerEndCoverShow,{filter_detail:t})},[]),(0,s.jsx)(i_.jj,(0,l._)({type:t,className:`live-room-error ${t}`,secondaryButtonTitle:i_.NI.serverError===t?"刷新":void 0},e))};var ih=i("397473"),ig={iframePlayer:"MVRx33oq",isMobile:"At4hKOru",hideFullScreen:"UCBLAG1c",liveTitlePlugin:"K_nS_sZi",liveTitlePluginContainer:"GVk0rG7_",liveCommentPlugin:"ZWA1w9nr",iframePlayerDefault:"MPESKh3I"},ip=i("713111"),iy=i("443646"),ib=i("867204"),iP=i("382708"),iI=i("340619"),iE=i("843722"),iS=i("335771"),iL=i("243321"),iC=i("142589"),iw=i("767859"),iN=i("457958"),ik=i("805652"),iT=i("309931"),iR=(0,z.Pi)(e=>{let{userCount:t="",title:i="",showUserCount:n=!1,className:o}=e,{player:r}=(0,tx.n)(),l=a.useMemo(()=>{var e;return null==r?void 0:null===(e=r.root)||void 0===e?void 0:e.querySelector(".douyin-player-top-bar")},[r]);return l?(0,iT.createPortal)((0,s.jsxs)("div",{className:tr()(ik.Z.liveTitle,o),children:[(0,s.jsx)("span",{className:ik.Z.text,children:i}),n&&(0,s.jsx)(iN.A,{className:ik.Z.userCount,count:t})]}),l):null}),ix=i("960109"),iO=i("772750"),iA=i("149620"),iF=i("325354"),iM=i("698387"),iD=i("128487"),iG=i("235230"),ij=i("632168");let iV=(0,T.ZP)(()=>Promise.resolve().then(i.bind(i,101156)),{ssr:!1});var iU=(0,tw.rW)(function(e){let{webRid:t,roomTeaLogParams:i,onClick:n,scene:o,program:r,className:l,isPaidLive:u,viewType:d,isLogin:c,full:v}=e,[_,m]=(0,a.useState)({}),h=(0,a.useMemo)(()=>{var e,i;return _&&_[t]&&o&&(null===(i=_[t])||void 0===i?void 0:null===(e=i.scopes)||void 0===e?void 0:e.indexOf(o))>-1?_[t]:null},[t,o,_]),f=a.useMemo(()=>!(u&&(d===iD.PAID_LIVE_VIEW_TYPE.TRT_WATCH_FINISH||!c)),[u,d,c]);if((0,a.useEffect)(()=>{(async()=>{m(await (0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"entrance"}))})()},[o,t]),f){var g;return(0,s.jsx)(iG.G,{href:(null==h?void 0:h.url)||(0,iM.X)(`/${t}`),target:(null==h?void 0:h.html_target)||"_blank",passParams:i,onClick:n,className:v?ij.Z.full:"","data-e2e":"live-enter-room",children:(0,s.jsxs)("div",{className:tr()([ij.Z.enterRoom,l,ij.Z.loaded]),children:[(0,s.jsx)(iV,{className:ij.Z.enterRoomIcon}),(0,s.jsx)("span",{children:(null==r?void 0:null===(g=r.mod)||void 0===g?void 0:g.episode_stage)===ib.jL.FIRST_LIVE?"点击进入首播":(null==h?void 0:h.enter_text)||"点击进入直播间"})]})})}return null}),iZ=i("394063"),iB=i("861481"),iW=i("501535"),iH=i("928406"),iK=i("361602"),iY=i("778531");let i$=(0,T.ZP)(()=>Promise.all([i.e("23145"),i.e("21248"),i.e("11073"),i.e("76746"),i.e("95395"),i.e("95542")]).then(i.bind(i,295850)),{ssr:!1}),iQ=(0,T.ZP)(()=>Promise.all([i.e("74792"),i.e("28251"),i.e("76746"),i.e("26848"),i.e("14473"),i.e("95395"),i.e("45366"),i.e("51385"),i.e("7406"),i.e("81387")]).then(i.bind(i,676128)),{ssr:!1}),iq=(0,T.ZP)(()=>Promise.all([i.e("28251"),i.e("76746"),i.e("26848"),i.e("14473"),i.e("95395"),i.e("45366"),i.e("51385"),i.e("7406"),i.e("64551")]).then(i.bind(i,42909)),{ssr:!1});var iJ=(0,z.Pi)(e=>{var t,i,n,o,r,u,d,c,v,_,m;let{onPlay:h,onSend:f,isPause:g,refreshPlayer:p,anchorSecUserId:y}=e,b=a.useRef(!0),{userStore:{userInfo:P,odin:I,setPlayerUserHandlePause:E},roomStore:{roomInfo:S,playerCoverText:L,isVerified:C},linkmicStore:{linkRoomType:N,linkRoomTypeHooks:k,linkStatus:T},eventStore:{playerEvent:R,basicEvent:x},detailExtra:{iframeConf:O,setIframeConf:M},playerStore:{playerInstance:G,playerLoggerInstance:j,setPlayerInstance:U,setPlayerLoggerInstance:Z},singletonStore:{setPlayer:B}}=(0,A.o)(),W=(0,iF.Z)(),H=D()(S,"room.status"),K=(0,a.useRef)(),[Y,$]=(0,a.useState)(!1),Q=a.useMemo(()=>{if(O){let e=Date.now(),{start:t,end:i}=O;if(t&&i&&e>=t&&e<=i)return!0}return!1},[O]),q=a.useMemo(()=>D()(S,"room.stream_url.live_core_sdk_data.pull_data.options.qualities",[]).map(e=>e.sdk_key),[S]),J=a.useMemo(()=>JSON.parse(D()(S,"room.stream_url.live_core_sdk_data.pull_data.stream_data","null")),[S]),z=a.useMemo(()=>(null==O?void 0:O.resolution)||D()(S,"room.stream_url.live_core_sdk_data.pull_data.options.default_quality.sdk_key",""),[O,S]),X=(0,a.useMemo)(()=>{if(J&&z){var e;let t=(null==J?void 0:null===(e=J.data[z])||void 0===e?void 0:e.main)||{};return(0,ex.tq)()?(0,iy.uC)(t.hls||""):(0,iy.uC)(t.flv||"")}return""},[J,z]);(0,a.useEffect)(()=>{if(!b.current&&(null==P?void 0:P.isReady)){var e,t;null==R||R.livePlayEvent({anchor_id:D()(S,"anchor.id_str",""),room_id:S.roomId||"",muted:K.current.getPlayer().muted,stream_type:W,enter_method_temai:null===(t=window)||void 0===t?void 0:null===(e=t.__INVISIBLE_QUERY__)||void 0===e?void 0:e.enter_method_temai}),b.current=!0}},[S,P,W,b]),(0,a.useEffect)(()=>(window.__IFRAME_PLAYER__=K.current,document.body.style.overflowX="hidden",()=>{document.body.style.overflowX="auto"}),[]);let ee=(0,a.useMemo)(()=>({enter_from_merge:"web_iframe"}),[]),et=a.useRef(!eh.s&&(0,ev.rC)());a.useEffect(()=>{var e,t,i,n,o,r,l,s,a;let u=null===(e=K.current)||void 0===e?void 0:e.getPlayer();if(!!u)T===eq.cK.LINKED?(et.current=u.muted,u.muted=!0,null===(i=u.plugins)||void 0===i||null===(t=i.play)||void 0===t||t.hide(),null===(o=u.plugins)||void 0===o||null===(n=o.volume)||void 0===n||n.hide()):T===eq.cK.NOT_LINK&&(u.muted=et.current,null===(l=u.plugins)||void 0===l||null===(r=l.play)||void 0===r||r.show(),null===(a=u.plugins)||void 0===a||null===(s=a.volume)||void 0===s||s.show())},[T]);let ei=(0,iW.Z)(),{url:en}=(0,tt.H)(),eo=(0,a.useMemo)(()=>({url:X||en,autoplay:!0,volume:(0,ev.T1)(),muted:!1,decryption:null,coreType:(0,ex.tq)()?ec.GI:(0,ec.Eo)()?"mediastream":ec.ry}),[en,X]),er=(0,a.useMemo)(()=>{if("undefined"!=typeof window){let e=eJ.parse(window.location.search);return(null==e?void 0:e.disableFullscreen)==="true"}return!1},[]);return(0,a.useEffect)(()=>{S.web_rid&&(0,F.ZP)({service_name:"webcast.douyin.live_pc",key:"iframe_conf"}).then(e=>{M(e[String(S.web_rid)])})},[S]),(0,a.useEffect)(()=>{var e,t,i,n;let o=null===(t=K.current)||void 0===t?void 0:null===(e=t.getPlayer)||void 0===e?void 0:e.call(t);o&&(0,ex.tq)()&&(null==o||null===(i=o.setAttribute)||void 0===i||i.call(o,"playsinline",!0),null==o||null===(n=o.setAttribute)||void 0===n||n.call(o,"webkit-playsinline",!0))},[null===(i=K.current)||void 0===i?void 0:null===(t=i.getPlayer)||void 0===t?void 0:t.call(i)]),(0,a.useEffect)(()=>{var e,t,i,n,o,r,l,s;let a=null===(t=K.current)||void 0===t?void 0:null===(e=t.getPlayer)||void 0===e?void 0:e.call(t);(0,ex.tq)()&&(null==a?void 0:a.root)&&(null==a||null===(o=a.root)||void 0===o||null===(n=o.classList)||void 0===n||null===(i=n.add)||void 0===i||i.call(n,ig.isMobile)),er&&(null==a?void 0:a.root)&&(null==a||null===(s=a.root)||void 0===s||null===(l=s.classList)||void 0===l||null===(r=l.add)||void 0===r||r.call(l,ig.hideFullScreen))},[(0,ex.tq)(),er]),(0,s.jsxs)("div",{onClick:()=>{var e,t;null===(t=K.current)||void 0===t||null===(e=t.getPlayer())||void 0===e||e.focus({})},children:[(0,s.jsx)(ea,{}),Q?(0,s.jsxs)(ed.N,{className:tr()(ig.iframePlayer,"iframe-player",{[ig.hideFullScreen]:er,[ig.isMobile]:(0,ex.tq)()}),volume:(0,ev.T1)(),disabledLogger:!!(L&&!(L===e_.kx.ANCHOR_BAN&&N)),url:X,closeVideoClick:!0,ref:e=>{if(K.current={getPlayer:()=>e.player},(null==e?void 0:e.player)&&(null==e?void 0:e.player)!==G){var t;U(null==e?void 0:e.player),B(null==e?void 0:e.player),null==e||null===(t=e.player)||void 0===t||t.on("error",e=>{})}(null==e?void 0:e.logger)&&(null==e?void 0:e.logger)!==j&&Z(null==e?void 0:e.logger)},onFullScreen:e=>{$(e)},icons:{loadingIcon:(0,iA.renderToString)((0,s.jsx)(ip.gb,{className:"live-player-loading",text:"视频加载中"}))},onUserAction:e=>{"switch_play_pause"===e.action&&E(!e.paused)},loggerOptions:{user_id:null==P?void 0:P.id_str,device_id:I.user_unique_id,scene:em.C.iframe},baseConfig:eo,scene:"IframePlayer",children:["audio"===N&&H!==V.LV.END&&(0,s.jsx)(iL.k,{componentName:w.l.AUDIO_ROOM_PLUGIN,children:(0,s.jsx)(iQ,{isVerifyed:C})}),"video"===N&&H!==V.LV.END&&(0,s.jsx)(iL.k,{componentName:w.l.VIDEO_ROOM_PLUGIN,children:(0,s.jsx)(iq,{})}),("audio"===k||"video"===k)&&(0,s.jsx)(iZ.LinkMicLayoutPlugin,{isVerifyed:C}),L&&(0,s.jsx)(iI.PlayerEndCover,{cover:D()(S.anchor,"avatar_thumb.url_list[0]",""),anchorSecUserId:y,children:L}),(0,s.jsx)(iE.PlayerLoggerPlugin,{ext:(0,l._)({_is_new_version:null!==(m=null===(n=window)||void 0===n?void 0:n.isNewVersionFirstOpen)&&void 0!==m?m:"",enter_from_merge:null==x?void 0:null===(o=x.getEnterEventParams())||void 0===o?void 0:o.enter_from_merge,enter_method:null==x?void 0:null===(r=x.getEnterEventParams())||void 0===r?void 0:r.enter_method,is_preview:1},ei)}),(0,s.jsx)(iC.Z,{}),(0,s.jsx)(iH.VolumeMemoryPlugin,{}),(0,s.jsx)(ix.default,{}),(0,s.jsx)(iB.LinkMicPlayModeLimitPlugin,{isVerifyed:C}),(0,s.jsx)(iO.RefreshPluginWrap,{position:0,index:1,props:{}}),(0,s.jsx)(iL.k,{componentName:w.l.TITLE_PLUGIN,children:(0,s.jsx)(iR,{containerClassName:ig.liveTitlePlugin,className:ig.liveTitlePluginContainer,position:"rootTop",title:null===(u=S.room)||void 0===u?void 0:u.title,userCount:(0,iP.jQ)(S.room)})}),(0,s.jsx)(iS.AdaptedBySEIPlugin,{}),(null==O?void 0:null===(d=O.plugins)||void 0===d?void 0:d.includes("danmaku"))&&(0,s.jsx)(iL.k,{componentName:w.l.DANMAKU_PLUGIN,children:(0,s.jsx)(i$,{on:!0,feature:!0})}),(null==O?void 0:null===(c=O.plugins)||void 0===c?void 0:c.includes("enter"))&&(0,s.jsx)(iU,{props:{webRid:S.web_rid,roomTeaLogParams:ee},webRid:S.web_rid,roomTeaLogParams:ee}),(null==O?void 0:null===(v=O.plugins)||void 0===v?void 0:v.includes("comment"))&&(0,s.jsx)(iL.k,{componentName:w.l.COMMENT_PLUGIN,children:(0,s.jsx)(iw.FoldChatRoomCommentPlugin,{position:0,props:{containerClassName:ig.liveCommentPlugin,isLogin:null==P?void 0:P.id_str,onSend:f,isIframe:!0},containerClassName:ig.liveCommentPlugin,isLogin:null==P?void 0:P.id_str,onSend:f,isIframe:!0})}),(0,s.jsx)(iY.default,{}),(null==O?void 0:null===(_=O.plugins)||void 0===_?void 0:_.includes("bitrate"))&&J&&z&&(0,s.jsx)(iL.k,{componentName:w.l.QUALITY_SWITCH_PLUGIN,children:(0,s.jsx)(iK.default,{props:{defaultQuality:z,streamData:J,qualityList:q,screenMode:Y?ib.wq.FULL_SCREEN:ib.wq.NORMAL},defaultQuality:z,streamData:J,index:8,qualityList:q,screenMode:Y?ib.wq.FULL_SCREEN:ib.wq.NORMAL,url:X,position:1})}),(0,s.jsx)(tG.h,{source:"IframePlayer"})]}):(0,s.jsx)("div",{className:ig.iframePlayerDefault,children:"「前往抖音电脑版，查看更多精彩直播」"})]})}),iz=i("681815");let iX=(0,T.ZP)(()=>i.e("82199").then(i.bind(i,814669)),{ssr:!1});o=0;let i0=(0,z.Pi)(e=>{var t;let i=(0,a.useMemo)(()=>L(),[]),n=(0,tb.T)(),o=(0,A.o)(),{roomStore:{foldChatroom:r,roomInfo:l,roomStatus:u,isPlayer:d},playerStore:{isFullScreen:c,isTheaterOn:_,setIsTheaterOn:C},pkStore:{pkStatus:w},linkmicStore:{linkRoomType:N,linkMicLayout:k},detailExtra:{inRoomError:T,status_code:R},vrStore:{isImmersive:x}}=o,O=(0,tn.ds)(),F=(0,a.useMemo)(()=>({abTestData:n,store:o,pipContext:O}),[n,o,O]);(0,tM.R)();let M=(0,a.useMemo)(()=>(null==l?!void 0:!l.room)||u===V.LV.END||(null==l?!void 0:!l.web_stream_url)||!l.web_rid||!!c||1===D()(l,"room.stream_url.stream_orientation")&&!w&&"audio"!==N&&"video"!==N,[l,N,w,c,_,u]),{enlargeDynamicBg:G,enlargePadding:j}=(0,iv.K)(),U="4003073"===R,Z="4003222"===R,B="4003233"===R,[W,H]=a.useState(!1);(0,a.useEffect)(()=>{if(!Z&&!B||!W&&B)return;(0,tk.Nr)(location.pathname)&&(history.back(),eO.F.info("主播已设置直播间人数上限，暂不可进入"));let e=setTimeout(()=>{window.history.length>1&&document.referrer&&document.referrer.includes("douyin.com")||(0,tk.Nr)(location.pathname)?history.back():document.referrer.includes("live.douyin.com")?window.open("https://live.douyin.com/","_self"):document.referrer.includes("www.douyin.com")?window.open("https://www.douyin.com/?recommend=1","_self"):window.open("https://live.douyin.com/","_self")},3e3);return()=>{clearTimeout(e)}},[Z,W,B]);let K=T&&"4003099"!==R||!d||U||Z||B;(0,a.useEffect)(()=>{K&&((0,J.q)("ISLAND_SYNC_HEADER"),(0,J.q)("ISLAND_LAYOUT_NAVIGATION"),C(!1))},[K]);let Y=(0,iz.y)(K);return K?(0,s.jsxs)(s.Fragment,{children:[Y,B&&(0,s.jsx)(iX,{setMaxMemberError:H,webRid:null==l?void 0:l.web_rid}),(0,s.jsx)(im,{type:"serverError",title:Z?"主播已设置直播间人数上限，暂不可进入":U?"当前直播间在本区域未开放":"服务器开小差了，点击刷新重试",primaryButtonTitle:U||Z?"":"刷新",primaryButtonAction:()=>{var e,t;null===(t=window)||void 0===t||null===(e=t.location)||void 0===e||e.reload()}})]}):l?(0,s.jsx)(iu,{context:F,children:(0,s.jsx)(S.Gw,{uuid:i,children:(0,s.jsx)(v.P,{value:{detailPage:e.detailPage},children:(0,s.jsxs)(tj.tA,{children:[(0,s.jsx)(tg.EA,{roomId:null!==(t=l.roomId)&&void 0!==t?t:""}),(0,s.jsx)("div",{className:tr()(E.root,{__playerIsFull:!0,[E.fullScreen]:c||_,[E.fold]:r,__roomInfoBarInner:M,__roomInfoBarOuter:!M&&!x,__isAudioRoom:"audio"===N&&k!==ic.yP.MATE_CUSTOM,__isVideoRoom:"video"===N,__hasOptionBar:!0,[E.enlargeDynamicBackground]:G,[E.enlargePadding]:j,[E.isClient]:(0,ex.DT)(),[E.isImmersive]:x}),"data-e2e":"living-container",children:(0,s.jsxs)(m,{className:tr()(E.container,E.containerOpt),children:[(0,s.jsxs)(h,{className:E.left,children:[(0,s.jsxs)(f,{className:E.header,children:[(0,s.jsx)(g,{}),(0,s.jsx)(p,{})]}),(0,s.jsx)(ih.zS,{children:(0,s.jsx)(y,{className:E.playerContainer})}),(0,s.jsx)(b,{className:E.bottom}),(0,s.jsx)(P,{})]}),(0,s.jsx)(I,{className:E.right})]})})]})})})}):null});function i1(e){let t=(0,q.a)(),i=(0,a.useMemo)(()=>/iframe/.test(t.pathname),[t]);return(0,s.jsx)(id.vD,{children:i?(0,s.jsx)(iJ,{}):(0,s.jsx)(i0,(0,l._)({},e))})}},246647:function(e,t,i){i.d(t,{l:function(){return n}});var n={TRIPLE_SCREEN_PLUGIN:"triple_screen_plugin",ROTATE_PLUGIN:"rotate_plugin",GLOBAL_APP:"global_app",GIFT_BAR:"gift_bar",GIFT_BAR_MINI:"gift_bar_mini",HEADER:"header",NAVIGATION:"navigation",SIDEBAR:"siderbar",CATEGORY_TAB:"category_tab",TAB:"tab",TITLE_PLUGIN:"title_plugin",FOLLOW_PLUGIN:"follow_plugin",COMMENT_PLUGIN:"comment_plugin",GIFT_SWITCH_PLUGIN:"gift_switch_plugin",GIFT_BAR_PLUGIN:"gift_bar_plugin",EFFECT_SWITCH_PLUGIN:"effect_switch_plugin",GIFT_TRAY_PLUGIN:"gift_tray_plugin",GIFT_EFFECT_PLUGIN:"gift_effect_plugin",FANS_CLUB_PLUGIN:"fans_club_plugin",EXHIBITION_VIEW_PLUGIN:"exhibition_view_plugin",VIP_VIEW_PLUGIN:"vip_view_plugin",EFFECT_PLUGIN:"effect_plugin",HOUR_RANK_LIST_VIEW_PLUGIN:"hour_rank_list_view_plugin",TOOL_BAR_PLUGIN:"tool_bar_plugin",QUALITY_SWITCH_PLUGIN:"quality_switch_plugin",DANMAKU_PLUGIN:"danmaku_plugin",AUDIO_ROOM_PLUGIN:"audio_room_plugin",VIDEO_ROOM_PLUGIN:"video_room_plugin",NEW_VIDEO_ROOM_PLUGIN:"new_video_room_plugin",RTC_LAYER_PLUGIN:"rtc_layer_plugin",NEW_RTC_LAYER_PLUGIN:"new_rtc_layer_plugin",PK_VIEW_PLUGIN:"pk_view_plugin",PIP_PLUGIN:"pip_plugin",INPICTURE_PLUGIN:"inpicture_plugin",ADMIN_PRIVILEGE_PLUGIN:"admin_privilege_plugin",LIVING_PLAYER:"living_plyaer",IFRAME_PLAYER:"iframe_player",GIFT_ITEM:"gift_item",GIFT_PANEL:"gift_panel",LIVE_CATEGORY:"live_category",LIVE_CARD:"live_card",RANK_LIST:"rank_list",ORDER_SING_LIST:"order_sing_list",ORDER_SING_RULE:"order_sing_rule",PROMOTION_POP:"promotion_pop",PROMOTION_LIST_WRAPPER:"promotion_list_wrapper",FANS_CLUB_POPUP:"fans_club_popup",USER_POPUP:"user_popup",CHAT_ROOM_PANEL:"chat_room_panel",AUDIENCE_PANEL:"audience_panel",FIXED_CHAT:"fixed_chat",LIVE_CAROUSEL:"live_carousel",LIVE_COVER:"live_cover",LIVE_FULLPLAYER_QULIATY:"live_fullplayer_quality",Live_Like:"live_like",Live_Flutter_Like:"live_flutter_like",DANMAKU_SETTINGS:"danmaku_settings",VIP_LIVE_BOUNDARY:"vip_live_boundary",FOLD_CHAT_ROOM_COMMENT_PLUGIN:"fold_chat_room_comment_plugin",LIVING_PIP_WINDOW:"living-pip-window",SHORT_CUT:"short_cut",SERVICE_CENTER_PLUGIN:"service_center_plugin",QUALITY_SWITCH:"quality_switch",LivePreviewEnterRoom:"LivePreviewEnterRoom",LiveUserProfile:"live_user_profile",LOTTERY_COMPONENT:"lottery_componet",LOTTERY_COMPONENT_PLUGIN:"lottery_componet_plugin",LINK_MIC_DYNAMIC_CONFIG:"link_mic_dynamic_config",LIVE_RESERVE_CARD:"live_reserve_card",StreamCompute:"StreamCompute",RoomLogic:"RoomLogic",EnterAndLeave:"EnterAndLeave",ForceLoginRecorder:"ForceLoginRecorder",ChatRoom:"ChatRoom",Tracking:"Tracking",RoomInit:"RoomInit",RoomMessageConsume:"RoomMessageConsume",StatusHandler:"StatusHandler",RoomEvent:"RoomEvent",RightPanelContainer:"RightPanelContainer",RoomInfoBar:"RoomInfoBar",LandPageContainer:"LandPageContainer",LiveShare:"LiveShare",OperatingBar:"OperatingBar",TheaterPlugin:"TheaterPlugin",KeyBindPlugin:"KeyBindPlugin",VolumeMemoryPlugin:"VolumeMemoryPlugin",RefreshPlugin:"RefreshPlugin",HintContainerPlugin:"HintContainerPlugin",CancelMutePlugin:"CancelMutePlugin",GlobalControlPlugin:"GlobalControlPlugin",PlayerLoggerPlugin:"PlayerLoggerPlugin",PlayerTeaLogPlugin:"PlayerTeaLogPlugin",PlayerEndCover:"PlayerEndCover",VolumeWheelPlugin:"VolumeWheelPlugin",AdaptedBySEIPlugin:"AdaptedBySEIPlugin",PKSEIPlugin:"PKSEIPlugin",NewPlayerErrorCover:"NewPlayerErrorCover",PaidLivePlugin:"PaidLivePlugin",LeadingLoginPlugin:"LeadingLoginPlugin",LinkMicLayoutPlugin:"LinkMicLayoutPlugin",NewLinkMicLogicPlugin:"NewLinkMicLogicPlugin",LinkMicPlayModeLimitPlugin:"LinkMicPlayModeLimitPlugin",UpdateFunctionTypePlugin:"UpdateFunctionTypePlugin",TopEffectPlugin:"TopEffectPlugin",OrderSingPlugin:"OrderSingPlugin",GroupFightPlugin:"GroupFightPlugin",GuestBattlePlugin:"GuestBattlePlugin",LiveReserveCard:"LiveReserveCard",PlayerControl:"PlayerControl",UgcAvatar:"UgcAvatar",PlayerEventConsume:"PlayerEventConsume",GroupLive:"GroupLive",ChangeDynamicBg:"ChangeDynamicBg",LinkMicApplyPlugin:"LinkMicApplyPlugin",ORDER_SING_SELECT_GUEST:"order_sing_select_guest",PausePop:"PausePop",DetailContextMenuPlugin:"DetailContextMenuPlugin",DoubleScreenPlugin:"DoubleScreenPlugin",ProgrammeWrapper:"ProgrammeWrapper",LiveTDK:"LiveTDK",AutoRunModal:"AutoRunModal",AudioCheatTips:"AudioCheatTips",GetDressList:"GetDressList",GROUP_LIVE_PLUGIN:"group_live_plugin",LiveFromAppTips:"LiveFromAppTips",COMMENT_EDITOR:"comment_editor",WaterMark:"WaterMark",LIVE_CARD_IN_MIX_PLAYER:"live_card_in_mix_player",VrPlugin:"VrPlugin",NewLinkInitPlugin:"NewLinkInitPlugin",Gift_MENU_PLUGIN:"GiftMenu",LIVE_CHANNEL_BANNER_ROOMS:"LIVE_CHANNEL_BANNER_ROOMS",LIVE_CHANNEL_BANNER:"LIVE_CHANNEL_BANNER"}},595902:function(e,t,i){i.d(t,{_:function(){return n}});var n={LivingInit:"LivingInit",FirstFrame:"FirstFrame",DoubleScreenLoaded:"DoubleScreenLoaded"}},101363:function(e,t,i){i.d(t,{f:function(){return n}});let n="living_player_container"},572932:function(e,t,i){i.d(t,{w:function(){return n}});var n={StarfansUser:"sslocal://lynxview?url=https%3A%2F%2Flf-webcast-gr-sourcecdn.bytegecko.com%2Fobj%2Fbyte-gurd-source-gr%2Fwebcast%2Fmono%2Flynx_pc%2Fstarfans_lynx_pc%2Fpages%2Fstarfans_user.js&type=popup_pia_=1&gravity=bottom&height_percent=73&rate_height=600&horizontal_width=375&use_pia=1&enable_preload=main",Exhibition:"https://lf-webcast-gr-sourcecdn.bytegecko.com/obj/byte-gurd-source-gr/webcast/mono/lynx/revenue_gift_exhibition_hall_lynx3_douyin_rspeedy/pages/gift_list_rspeedy.json?_pia_=1&web_bg_color=ff060a19&sponsor_status=normal_sponsor&showPcClose=true"}},439239:function(e,t,i){i.d(t,{C:function(){return n}});var n={iframe:"iframe",liveCard:"live_card",liveSmallCard:"live_small_card",liveCarousel:"live_carousel",liveDetail:"live_detail",mediaDetail:"live_media_detail",smallWindow:"live_small_window",liveCollege:"live_college",liveSearch:"live_search",liveSlider:"live_slider",liveFeedFull:"live_feed_full",liveModal:"live_modal"}},770732:function(e,t,i){var n=i(563097),o=i(88648),r=i(187406),l=i(53562),s=i(344226);t.Z=(0,o.memo)((0,l.Pi)(e=>{let{children:t,name:i}=e,l=(0,o.useContext)(r.h),a=s.Z.getIocItem(l,i);return a?(0,n.jsx)(a.Component,{children:t}):null}))},187406:function(e,t,i){i.d(t,{T:function(){return r},h:function(){return o}});var n=i(563097);let o=i(88648).createContext([]),r=e=>{let{children:t,context:i}=e;return(0,n.jsx)(o.Provider,{value:i,children:t})}},446042:function(e,t,i){i.d(t,{GI:function(){return o}});var n=i(344226);let o=n.Z.defineIoc.bind(n.Z)},669556:function(e,t,i){i.d(t,{OV:function(){return o},hx:function(){return r}});var n=i(605536);let o=n.Z.defineLayoutItem.bind(n.Z),r=n.Z},300253:function(e,t,i){i.d(t,{n:function(){return f}});var n=i("520739"),o=i("563097"),r=i("88648"),l=i("243321");i("874386");var s=i("470245"),a=i("595902"),u=i("223526"),d=i("277429"),c=i("19670");let v=e=>{let t=(0,s.bU)(),{renderWhen:i,timeout:n,componentName:o,taskPriority:l}=e,v=r.useMemo(()=>i.indexOf(a._.LivingInit)>=0,[i]),[_,m]=r.useState(v),h=r.useRef();return(0,r.useEffect)(()=>{if(t&&!v){let e=t.onImmediately(i,()=>{let e=()=>{m(!0),clearTimeout(h.current)},t=(0,d.iD)(),r=(0,d.Ee)(o)||l||"immediate";(0,c.qu)(`
          [useRenderWhen]:, 
          useScheduler: ${t},
          componentName: ${o},
          taskPriority: ${r}, 
          timeout: ${n}, 
          renderWhen: ${i}
        `),t&&("user-blocking"===r||"user-visible"===r||"background"===r)?u.p.postTask({task:e,priority:r}):e()});return h.current=window.setTimeout(()=>{m(!0),null==e||e()},n),()=>{null==e||e(),clearTimeout(h.current)}}},[t,i,n,v]),(0,r.useEffect)(()=>{if(t&&!v){let e=t.onForceMountComponent(o,()=>{m(!0),clearTimeout(h.current)}),i=t.onForceUnmountComponent(o,()=>{m(!1),clearTimeout(h.current)});return()=>{null==e||e(),null==i||i()}}},[t,o,v]),_};var _=i("914104"),m=i("742401"),h=i("53562");function f(e,t){let{ErrorBoundary:i=l.k,name:a,fallback:u=(0,o.jsx)(o.Fragment,{}),renderWhen:c,timeout:f}=t;function g(t){let i=(0,s.bU)();return(0,r.useEffect)(()=>{null==i||i.emitComponentAfter(a,{})},[i]),(0,o.jsx)(e,(0,n._)({},t))}return(0,h.Pi)(function(e){let t=v({renderWhen:(0,d.VZ)(a)||c,timeout:f||(0,d.UX)()||3e3,componentName:a}),l=(0,s.bU)();(0,r.useMemo)(()=>{t&&(null==l||l.emitComponentBefore(a,{}))},[t,l]);let h=(0,r.useMemo)(()=>{if(!m.s)return(0,_.OK)()},[]);return t?(0,o.jsx)(i,{componentName:a,_slardarInstance:h,children:(0,o.jsx)(g,(0,n._)({},e))}):u},{forwardRef:!1})}},736579:function(e,t,i){i.d(t,{d:function(){return r}});var n=i(134761);i(874386);var o=i(970106);class r{static after(e){return"__after__"+e}static before(e){return"__before__"+e}static unmountComponent(e){return"__unmountComponent__"+e}static beforeFn(e){return"__beforeFn__"+e}static afterFn(e){return"__afterFn__"+e}static beforeComponent(e){return"__beforeComponent__"+e}static afterComponent(e){return"__afterComponent__"+e}static forceUnmountComponent(e){return"__forceUnmountComponent__"+e}static forceMountComponent(e){return"__forceMountComponent__"+e}on(e,t){return this.eventBus.on(e,t),()=>this.eventBus.off(e,t)}onImmediately(e,t){return this.emitedEvents.has(e)?(t(),()=>{}):(this.on(e,t),()=>this.eventBus.off(e,t))}off(e,t){this.eventBus.off(e,t)}emit(e,t){this.eventBus.emit(e,t)}onComponentBefore(e,t){return this.eventBus.on(r.beforeComponent(e),t),()=>this.eventBus.off(r.beforeComponent(e),t)}onComponentAfter(e,t){return this.eventBus.on(r.afterComponent(e),t),()=>this.eventBus.off(r.afterComponent(e),t)}onFnBefore(e,t){return this.eventBus.on(r.beforeFn(e),t),()=>this.eventBus.off(r.beforeFn(e),t)}onFnAfter(e,t){return this.eventBus.on(r.afterFn(e),t),()=>this.eventBus.off(r.afterFn(e),t)}emitComponentBefore(e,t){this.eventBus.emit(r.beforeComponent(e),t)}emitComponentAfter(e,t){this.eventBus.emit(r.afterComponent(e),t)}emitFnBefore(e,t){this.eventBus.emit(r.beforeFn(e),t)}emitFnAfter(e,t){this.eventBus.emit(r.afterFn(e),t)}emitUnmountComponent(e,t){this.eventBus.emit(r.unmountComponent(e),t)}onUnmountComponent(e,t){return this.eventBus.on(r.unmountComponent(e),t),()=>this.eventBus.off(r.unmountComponent(e),t)}onForceUnmountComponent(e,t){return this.eventBus.on(r.forceUnmountComponent(e),t),()=>this.eventBus.off(r.forceUnmountComponent(e),t)}onForceMountComponent(e,t){return this.eventBus.on(r.forceMountComponent(e),t),()=>this.eventBus.off(r.forceMountComponent(e),t)}dispatchForceUnmountComponent(e){this.eventBus.emit(r.forceUnmountComponent(e),{})}dispatchForceMountComponent(e){this.eventBus.emit(r.forceMountComponent(e),{})}get id(){return this._id}destroy(){try{this.eventBus.all.clear()}catch(e){}}constructor(e){var t=this;(0,n._)(this,"eventBus",(0,o.Z)()),(0,n._)(this,"_id",void 0),(0,n._)(this,"emitedEvents",new Set),this._id=e;let i=this.eventBus.emit.bind(this.eventBus);this.eventBus.emit=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];t.emitedEvents.add(n[0]),i(...n)}}}},611651:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i(134761);i(954372),i(826893);var o=i(94659),r=i(104013),l=i(742401);class s extends o.Z{makeObservable(){(0,r.makeObservable)(this,{isSpider:r.computed,setHomeNeedIntial:r.action,setIsOpenLongTask:r.action,setLinkMicHeartConfig:r.action,XTTENV:r.observable,setXTTENV:r.action})}setIsOpenLongTask(e){this.isOpenLongTask=e}get isSpider(){return!l.s&&/(bot|spider|slurp|Google-InspectionTool|GoogleOther|perplexity-user|Google-Extended|Deepseek|ChatGPT-User)/i.test(navigator.userAgent)}setHomeNeedIntial(e){this.needInital=e}setLinkMicHeartConfig(e){this.linkMicHeartConfig=e}constructor(){super(),(0,n._)(this,"needInital",!1),(0,n._)(this,"linkMicHeartConfig",{}),(0,n._)(this,"isOpenLongTask",!0),(0,n._)(this,"XTTENV",""),(0,n._)(this,"setXTTENV",e=>{this.XTTENV=e});this.makeObservable()}}},105200:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{makeObservable(){(0,r.makeObservable)(this,{errorPrompts:r.observable,logId:r.observable,status_code:r.observable,error:r.observable,errorPageMessage:r.observable,iframeConf:r.observable,messageFrom:r.observable,isSpider:r.observable,defaultMoreLeague:r.observable,defaultMatchStatsDetail:r.observable,defaultTagMatchInfo:r.observable,setDetailExtra:r.action,reset:r.action,inRoomError:r.observable,setInRoomError:r.action,setIframeConf:r.action})}constructor(){super(),(0,n._)(this,"errorPrompts",""),(0,n._)(this,"logId",""),(0,n._)(this,"status_code",""),(0,n._)(this,"error",void 0),(0,n._)(this,"errorPageMessage",!1),(0,n._)(this,"iframeConf",{}),(0,n._)(this,"messageFrom",""),(0,n._)(this,"isSpider",!1),(0,n._)(this,"defaultMoreLeague",[]),(0,n._)(this,"defaultMatchStatsDetail",{}),(0,n._)(this,"defaultTagMatchInfo",""),(0,n._)(this,"inRoomError",void 0),(0,n._)(this,"setIframeConf",e=>{this.iframeConf=e}),(0,n._)(this,"setInRoomError",e=>{this.inRoomError=e}),(0,n._)(this,"setDetailExtra",e=>{Object.keys(e).forEach(t=>{this[t]=e[t]})}),(0,n._)(this,"reset",()=>{this.errorPrompts="",this.logId="",this.status_code="",this.error=void 0,this.errorPageMessage=!1,this.iframeConf={},this.messageFrom="",this.isSpider=!1,this.defaultMoreLeague=[],this.defaultMatchStatsDetail={},this.defaultTagMatchInfo=""});this.makeObservable()}}},413435:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{selectedRoom:r.observable,setSelectedRoom:r.action,recommendCategoryData:r.observable,setRecommendCategoryData:r.action,isShowCategoryGameMenu:r.observable,setIsShowCategoryGameMenu:r.action,isSaveCategoryGameMenu:r.observable,setIsSaveCategoryGameMenu:r.action,isReadyHide:r.observable,setIsReadyHide:r.action})}),(0,n._)(this,"selectedRoom",null),(0,n._)(this,"recommendCategoryData",[]),(0,n._)(this,"isShowCategoryGameMenu",!1),(0,n._)(this,"isSaveCategoryGameMenu",!1),(0,n._)(this,"isReadyHide",!1),(0,n._)(this,"setSelectedRoom",e=>this.selectedRoom=e),(0,n._)(this,"setRecommendCategoryData",e=>this.recommendCategoryData=e),(0,n._)(this,"setIsShowCategoryGameMenu",e=>{this.isShowCategoryGameMenu=e}),(0,n._)(this,"setIsSaveCategoryGameMenu",e=>{this.isSaveCategoryGameMenu=e}),(0,n._)(this,"setIsReadyHide",e=>{this.isReadyHide=e});this.makeObservable()}}},665600:function(e,t,i){i.d(t,{Z:function(){return v},p:function(){return c}});var n=i(134761),o=i(32754),r=i(94659),l=i(470955),s=i.n(l),a=i(527459),u=i(945388),d=i(104013),c={AUTO:0,0:"AUTO",ENABLE:1,1:"ENABLE",DISABLE:-1,"-1":"DISABLE"};class v extends r.Z{get isSpringSkin(){return!!this.resource}get isLiveDetail(){return!!(0,a.m)(o.m.LIVING,this.pathname)||!!(0,a.m)(o.m.DOUYIN_LIVING,this.pathname)}get isXiguaDomain(){return -1!==[u.LIVE_XIGUA_DOMAIN,u.XIGUA_DOMAIN].indexOf(this.domain)}get navigationCurrent(){return this.isLiveDetail?"":this.navigationSelected}get showNavigation(){let e=this.shouldShowModule(this.hardNavigation);return void 0!==e?e:(!this.domain||!this.isXiguaDomain)&&(!!(0,a.m)(o.m.HOT_LIVE,this.pathname)||!(this.isClient&&(0,a.m)(o.m.LIVING,this.pathname)||this.isClient&&(0,a.m)(o.m.DOUYIN_LIVING,this.pathname))&&[o.m.CATEGORY_NEW,o.m.CATEGORY,o.m.HOT_LIVE,o.m.HOME,o.m.LIVING,o.m.DOUYIN_LIVING].some(e=>!!(0,a.m)(e,this.pathname)))}get hideNavigation(){return!this.showNavigation}get showCategoryTab(){let e=this.shouldShowModule(this.hardCategoryTab);return void 0!==e?e:(!this.domain||!this.isXiguaDomain)&&![o.m.LIVING_COMMENT].some(e=>!!(0,a.m)(e,this.pathname))}get hideCategoryTab(){return!this.showCategoryTab}get showHeader(){let e=this.shouldShowModule(this.hardHeader);return void 0!==e?e:(!this.domain||!this.isXiguaDomain)&&![o.m.IFRAME,o.m.VIDEO_DOMAIN_IFRAME,o.m.LIVING_COMMENT].some(e=>!!(0,a.m)(e,this.pathname))||this.hidehead}get hideHeader(){return!this.showHeader}get showFooter(){let e=this.shouldShowModule(this.hardFooter);return void 0!==e?e:![o.m.LIVING_COMMENT,o.m.LIVING,o.m.DOUYIN_LIVING,o.m.DOUYIN_RECOMMEND_LIVING,o.m.DOUYIN_FOLLOW_LIVING,o.m.IFRAME].some(e=>!!(0,a.m)(e,this.pathname))}get hideFooter(){return!this.showFooter}get xiguaHeader(){return this.domain&&-1!==[u.LIVE_XIGUA_DOMAIN].indexOf(this.domain)}get showSideBar(){let e=this.shouldShowModule(this.hardSideBar);return void 0!==e?e:![o.m.IFRAME,o.m.VIDEO_DOMAIN_IFRAME,o.m.LIVING_COMMENT].some(e=>!!(0,a.m)(e,this.pathname))}get hideSideBar(){return!this.showSideBar}get showErrorStyle(){let e=this.shouldShowModule(this.hardSideBar);return void 0!==e?e:![o.m.ERROR].some(e=>!!(0,a.m)(e,this.pathname))}get hideErrorStyle(){return!this.showErrorStyle}shouldShowModule(e){return 1===e||-1!==e&&void 0}setHeaderOpacity(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.transparentHeader=e}setHardCategoryTab(e){this.hardCategoryTab=e}setHardHeader(e){this.hardHeader=e}setHardNavigation(e){this.hardNavigation=e}setHardSideBar(e){this.hardSideBar=e}constructor(){var e;super(),e=this,(0,n._)(this,"disableUnLoginFilter",!1),(0,n._)(this,"rawThemeConfig",{}),(0,n._)(this,"domain","live.douyin.com"),(0,n._)(this,"pathname",""),(0,n._)(this,"isClient",!1),(0,n._)(this,"navigationSelected","live"),(0,n._)(this,"hidehead",!1),(0,n._)(this,"forceTheme",void 0),(0,n._)(this,"hardNavigation",0),(0,n._)(this,"hardCategoryTab",0),(0,n._)(this,"hardHeader",0),(0,n._)(this,"hardFooter",0),(0,n._)(this,"hardSideBar",0),(0,n._)(this,"hardErrorStyle",0),(0,n._)(this,"transparentHeader",!1),(0,n._)(this,"specialBanner",!1),(0,n._)(this,"hasRelevantRoom",!0),(0,n._)(this,"immersive",!1),(0,n._)(this,"programmeFill",void 0),(0,n._)(this,"resource",void 0),(0,n._)(this,"playerMargin",0),(0,n._)(this,"reset",()=>{this.disableUnLoginFilter=!1,this.rawThemeConfig={},this.domain="live.douyin.com",this.pathname="",this.isClient=!1,this.navigationSelected="live",this.hidehead=!1,this.forceTheme=void 0,this.hardNavigation=0,this.hardCategoryTab=0,this.hardHeader=0,this.hardFooter=0,this.hardSideBar=0,this.hardErrorStyle=0,this.transparentHeader=!1,this.specialBanner=!1,this.hasRelevantRoom=!0,this.immersive=!1,this.programmeFill=void 0,this.resource=void 0,this.playerMargin=0}),(0,n._)(this,"makeObservable",()=>{(0,d.makeObservable)(this,{disableUnLoginFilter:d.observable,rawThemeConfig:d.observable,domain:d.observable,pathname:d.observable,isClient:d.observable,navigationSelected:d.observable,hidehead:d.observable,forceTheme:d.observable,hardNavigation:d.observable,hardCategoryTab:d.observable,hardHeader:d.observable,hardFooter:d.observable,hardSideBar:d.observable,hardErrorStyle:d.observable,transparentHeader:d.observable,specialBanner:d.observable,hasRelevantRoom:d.observable,programmeFill:d.observable,immersive:d.observable,resource:d.observable,playerMargin:d.observable,setHint:d.action,setModule:d.action,navigationCurrent:d.computed,showNavigation:d.computed,showCategoryTab:d.computed,showHeader:d.computed,showFooter:d.computed,showSideBar:d.computed,showErrorStyle:d.computed,hideNavigation:d.computed,hideCategoryTab:d.computed,hideHeader:d.computed,hideFooter:d.computed,hideSideBar:d.computed,hideErrorStyle:d.computed,xiguaHeader:d.computed,isLiveDetail:d.computed,setHardCategoryTab:d.action,isSpringSkin:d.computed})}),(0,n._)(this,"setModule",function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e[`hard${s()(t)}`]=i}),(0,n._)(this,"setHint",function(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;e.domain=t,e.pathname=i,e.isClient=n,e.hidehead=!!o}),(0,n._)(this,"setImmersive",e=>{this.immersive=e}),(0,n._)(this,"setSpecialBanner",e=>{this.specialBanner=e}),(0,n._)(this,"setResource",e=>{this.resource=e}),(0,n._)(this,"setForceTheme",e=>{this.forceTheme=e});this.makeObservable()}}},207123:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i("134761"),o=i("94659"),r=i("104013"),l=i("877033"),s=i("742401"),a=i("520739"),u=i("878389");i("413806"),i("826893"),i("927234");var d=i("828782"),c=i("669417"),v=i("443646"),_=i("62302"),m=i("907831"),h=i.n(m),f=i("623527");class g{initBrowser(){this.browser.SPIDER_DETECT=(0,d._Q)(),this.browser.BROWSER_NOT_SUPPORTED=!(0,_.VU)()}initRoom(e,t,i){this.room[e]={roomId:e,currentStreamUrl:t,roomFromServer:h()(i)}}init(e,t,i){!this.initBrowserInstance&&(this.initBrowser(),this.initBrowserInstance=!0),!this.room[e]&&this.initRoom(e,t,i)}resetReason(e){e.NETWORK_LOW=!1,e.NETWORK_SERVICE=!1,e.NOT_CATCH_ERROR=!1,e.PLAY_RUNTIME_ERROR=!1,e.USER_PAUSED=!1}resetWaiting(e){e.waitingStartTime=-1,e.waitingFirstStartTime=0,e.waitingTime=0,e.waitingNumber=0,e.waiting=!1}resetRetryCount(e){e.retryCount=0,e.retryTime=0,e.retryRuntimeErrorCount=0}resetRoomObj(e){e.pauseTime=0,e.switchTime=0,e.switchUrlCount=0,this.resetWaiting(e),this.resetReason(e),this.resetRetryCount(e),this.errorReport=!1}resetPlayer(){this.player=null}setCurrentRoom(e,t){var i,n;let o=null==e?void 0:null===(i=e.room)||void 0===i?void 0:i.id_str;if(this.currentRoomId!==o&&""!==this.currentRoomId){let e=this.room[this.currentRoomId];e.waitingTime=0,e.waitingNumber=0,e.waitingStartTime=-1}this.currentRoomId=o,this.init(null==e?void 0:null===(n=e.room)||void 0===n?void 0:n.id_str,t,e)}urlIsSame(e,t){let i=null==e?void 0:e.split("?")[0];return i===(null==t?void 0:t.split("?")[0])}setBusinessChangeUrl(e){this.businessChangeUrl=e}setPlayer(e){!this.player&&e&&(this.player=e)}handleWaiting(e){let t=this.room[e];if(t){var i;t.waitingNumber=(null!==(i=t.waitingNumber)&&void 0!==i?i:0)+1,t.waitingStartTime=Date.now(),t.waiting=!0,1===t.waitingNumber&&(t.waitingFirstStartTime=Date.now())}}handlePlaying(e){let t=this.room[e];if(null==t?void 0:t.waiting){var i,n;t.waiting=!1,t.waitingTime=(null!==(i=t.waitingTime)&&void 0!==i?i:0)+Date.now()-(null!==(n=t.waitingStartTime)&&void 0!==n?n:Date.now())}}handleEnded(e){var t,i,n,o,r,l;let s=this.room[e];(null===(o=this.player)||void 0===o?void 0:null===(n=o.plugins)||void 0===n?void 0:null===(i=n.flvlive)||void 0===i?void 0:null===(t=i.endedStatus)||void 0===t?void 0:t.status)==="nobuffer"?(null===(l=navigator)||void 0===l?void 0:l.onLine)?s.NETWORK_LOW=!0:this.browser.NETWORK_OFFLINE=!0:!(null===(r=navigator)||void 0===r?void 0:r.onLine)&&(this.browser.NETWORK_OFFLINE=!0)}handleError(e,t){var i;let n=this.room[e];(null==t?void 0:null===(i=t.code)||void 0===i?void 0:i.toString().indexOf("5"))!==-1||21===t.code||4===t.code||3===t.errorCode||4===t.errorCode||999===t.code?n.NETWORK_SERVICE=!0:404===t.code||403===t.code||401===t.code||407===t.code||31===t.code?n.PLAY_RUNTIME_ERROR=!0:999===t.code||1===t.errorCode||2===t.errorCode?n.NETWORK_LOW=!0:n.NOT_CATCH_ERROR=!0,n.pauseTime=Date.now(),n.err=t}handlePause(e){let t=this.room[e];t&&(t.pauseTime=Date.now())}handlePlay(e){let t=this.room[e];this.globalUserPause=!1,t&&this.resetRoomObj(t)}getQualityUrl(e){var t,i,n,o,r;let l=null!==(r=e.roomFromServer)&&void 0!==r?r:{},s=(null==l?void 0:null===(i=l.room)||void 0===i?void 0:null===(t=i.stream_url)||void 0===t?void 0:t.flv_pull_url)||{},a=(null==l?void 0:null===(o=l.room)||void 0===o?void 0:null===(n=o.stream_url)||void 0===n?void 0:n.hls_pull_url_map)||{},u=(0,d.tq)()?a:s,c="";return u.SD1?c=u.SD1:u.SD2?c=u.SD2:u.HD1?c=u.HD1:u.FULL_HD1&&(c=u.FULL_HD1),(0,v.uC)(c)}changeUrl(e){if(this.currentRoomId!==e.roomId)return;let t=this.getQualityUrl(e);if(this.player&&(0,_.sw)(t)&&!this.urlIsSame(t,this.player.config.url))this.autoChangeUrl?this.player.src=t:this.businessChangeUrl&&this.businessChangeUrl();else if(this.autoChangeUrl){var i;null===(i=this.player)||void 0===i||i.retry()}}startHeartDetect(){if(!this.timer)this.timer=setInterval(()=>{var e,t,i,n,o,r,l,s,v,_,m;let{player:h}=this,g=null!==(t=this.room[this.currentRoomId])&&void 0!==t?t:{};if(!h||!(null==h?void 0:h.hasStart))return;let p=this.browser;if(!p.BROWSER_NOT_SUPPORTED&&!p.SPIDER_DETECT&&!!(null===(e=navigator)||void 0===e?void 0:e.onLine)&&!g.ANCHOR_END&&!g.ANCHOR_LEAVE&&!g.USER_PAUSED&&!this.globalUserPause){if(!h.paused){let e=null!==(i=null==g?void 0:g.waitingNumber)&&void 0!==i?i:0,t=null!==(n=null==g?void 0:g.waitingTime)&&void 0!==n?n:0,l=null!==(o=null==g?void 0:g.waitingStartTime)&&void 0!==o?o:-1,s=null!==(r=null==g?void 0:g.waitingFirstStartTime)&&void 0!==r?r:-1;Date.now()-s>=5e3&&(null==g?void 0:g.waiting)&&((Date.now()-l+t>=3e3||e>=3)&&this.changeUrl(g),(null==g?void 0:g.waiting)?(g.waitingStartTime=Date.now(),g.waitingFirstStartTime=Date.now(),g.waitingNumber=1,g.waitingTime=0):this.resetWaiting(g));return}if(null==g?void 0:g.PLAY_RUNTIME_ERROR){let e=null!==(l=null==g?void 0:g.retryCount)&&void 0!==l?l:0,t=null!==(s=null==g?void 0:g.retryTime)&&void 0!==s?s:Date.now();e<0&&Date.now()-t>=3e4?(null==h||h.retry(),g.retryCount=e+1,g.retryTime=Date.now()):e>=0&&!this.errorReport&&(c.kg.event(`[${c.Tn.Error}]${f.Mo.LiveBasicPlayerError}`,(0,u._)((0,a._)({},null==g?void 0:g.err),{is_client:(0,d.DT)(),type:"living"})),this.errorReport=!0);return}if(g.NETWORK_SERVICE||g.NOT_CATCH_ERROR){let e=null!==(v=null==g?void 0:g.retryRuntimeErrorCount)&&void 0!==v?v:0;e<1?(null==h||h.retry(),g.retryRuntimeErrorCount=e+1):e>=3&&!this.errorReport&&(c.kg.event(`[${c.Tn.Error}]${f.Mo.LiveBasicPlayerError}`,(0,u._)((0,a._)({},null==g?void 0:g.err),{is_client:(0,d.DT)(),type:"living"})),this.errorReport=!0);return}if(g.NETWORK_LOW){let e=null!==(_=null==g?void 0:g.switchUrlCount)&&void 0!==_?_:0,t=null!==(m=null==g?void 0:g.switchTime)&&void 0!==m?m:Date.now();if(e<3&&Date.now()-t>=3e4){g.switchUrlCount=e+1,g.switchTime=0,this.changeUrl(g);return}}if(this.browser.NETWORK_OFFLINE){h.retry(),this.browser.NETWORK_OFFLINE=!1;return}}},1e3)}stopHeartDetect(){this.timer&&clearInterval(this.timer),this.timer=null}setRoomStopReason(e,t,i){let n=this.room[e];n&&(n[t]=i)}getRoomInfo(e){return this.room[e]}setGlobalUserPause(e){this.globalUserPause=e}setUrlAutoChange(e){this.autoChangeUrl=e}constructor(){(0,n._)(this,"browser",void 0),(0,n._)(this,"room",{}),(0,n._)(this,"initBrowserInstance",!1),(0,n._)(this,"currentRoomId",""),(0,n._)(this,"player",void 0),(0,n._)(this,"timer",void 0),(0,n._)(this,"globalUserPause",!1),(0,n._)(this,"autoChangeUrl",!0),(0,n._)(this,"businessChangeUrl",void 0),(0,n._)(this,"errorReport",!1),(0,n._)(this,"reset",()=>{this.browser={SPIDER_DETECT:!1,BROWSER_NOT_SUPPORTED:!1,NETWORK_OFFLINE:!1},this.room={},this.initBrowserInstance=!1,this.currentRoomId="",this.player=null,clearInterval(this.timer),this.timer=null,this.globalUserPause=!1,this.autoChangeUrl=!0,this.businessChangeUrl=""}),this.browser={SPIDER_DETECT:!1,BROWSER_NOT_SUPPORTED:!1,NETWORK_OFFLINE:!1},this.room={},this.startHeartDetect=this.startHeartDetect.bind(this),this.stopHeartDetect=this.stopHeartDetect.bind(this)}}class p extends o.Z{makeObservable(){(0,r.makeObservable)(this,{message:r.observable,setMessage:r.action,container:r.observable,setContainer:r.action,liveContainer:r.observable,setLiveContainer:r.action,playerHandler:r.observable,setPlayerHandler:r.action,audioPower:r.observable,setAudioPower:r.action,player:r.observable,setPlayer:r.action,paidLiveQRCodeVisible:r.observable,setPaidLiveQRCodeVisible:r.action,aiolinkHub:r.observable,setAiolinkHub:r.action,wrdsData:r.observable,setWrdsData:r.action})}constructor(){super(),(0,n._)(this,"message",s.s?null:new l.v0C),(0,n._)(this,"container",null),(0,n._)(this,"liveContainer",null),(0,n._)(this,"playerHandler",s.s?null:new g),(0,n._)(this,"audioPower",null),(0,n._)(this,"player",null),(0,n._)(this,"paidLiveQRCodeVisible",!1),(0,n._)(this,"aiolinkHub",null),(0,n._)(this,"wrdsData",{}),(0,n._)(this,"setLiveContainer",e=>{this.liveContainer=e}),(0,n._)(this,"setContainer",e=>{this.container=e}),(0,n._)(this,"setMessage",e=>{this.message=e}),(0,n._)(this,"setPlayerHandler",e=>{this.playerHandler=e}),(0,n._)(this,"setPlayer",e=>{this.player=e}),(0,n._)(this,"setAudioPower",e=>{this.audioPower=e}),(0,n._)(this,"setWrdsData",(e,t)=>{this.wrdsData[e]=t}),(0,n._)(this,"reset",()=>{this.playerHandler=null,this.container=null,this.audioPower=null,this.message=null,this.player=null,this.liveContainer=null,this.aiolinkHub=null,this.wrdsData={}}),(0,n._)(this,"setPaidLiveQRCodeVisible",e=>{this.paidLiveQRCodeVisible=e}),(0,n._)(this,"setAiolinkHub",e=>{this.aiolinkHub=e});this.makeObservable()}}},234532:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i(134761),o=i(520739),r=i(878389);i(874386);var l=i(94659),s=i(104013);let a=["wish_list","revenue_gift_exhibition","fansclub"];class u extends l.Z{constructor(){var e;super(),e=this,(0,n._)(this,"JSBInstance",null),(0,n._)(this,"bannerList",[]),(0,n._)(this,"currentLandPage",[]),(0,n._)(this,"messageListenList",[]),(0,n._)(this,"bannerKeys",{}),(0,n._)(this,"tccRedirect",[]),(0,n._)(this,"makeObservable",()=>{(0,s.makeObservable)(this,{JSBInstance:s.observable,bannerList:s.observable,currentLandPage:s.observable,setJSBInstance:s.action,setBannerList:s.action,setCurrentLandPage:s.action,setMessageListenList:s.action,messageListenList:s.observable,bannerKeys:s.observable,setBannerKeys:s.action,tccRedirect:s.observable,setTccRedirect:s.action})}),(0,n._)(this,"setJSBInstance",e=>{this.JSBInstance=e}),(0,n._)(this,"setBannerList",e=>{this.bannerList=e}),(0,n._)(this,"setCurrentLandPage",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(!(t.length>0)||i||n)e.currentLandPage=t;else{let i=t[t.length-1],n=a.find(e=>i.indexOf(e)>=0);if(n){let i=t.filter(e=>e.indexOf(n)>=0);e.currentLandPage=i}else{let i=t.filter(e=>a.every(t=>0>e.indexOf(t)));e.currentLandPage=i}}}),(0,n._)(this,"closeLandPage",e=>{let t=this.currentLandPage.findIndex(t=>t.indexOf(e)>=0);if(t>=0){let e=[...this.currentLandPage];e.splice(t,1),this.currentLandPage=e}}),(0,n._)(this,"_getGoldActLandUrl",e=>{let{giftId:t,anchorId:i,secAnchorId:n,userId:l,secUserId:s,roomId:a}=e,u=(0,r._)((0,o._)({request_page:"gift_banner"},t?{gift_id:t}:{}),{anchor_id:i,sec_anchor_id:n,user_id:l,sec_user_id:s,room_id:a,__isDouyinPC:"true"}),d=Object.keys(u).map(e=>`${e}=${u[e]}`).join("&");return"https://lf-webcast-gr-sourcecdn.bytegecko.com/obj/byte-gurd-source-gr/webcast/mono/h5/classic_gifts_position_douyin/pages/main/index.html?"+d}),(0,n._)(this,"setMessageListenList",e=>{this.messageListenList=e}),(0,n._)(this,"setBannerKeys",(e,t)=>{this.bannerKeys[e]=t}),(0,n._)(this,"setTccRedirect",e=>{this.tccRedirect=e});this.makeObservable()}}},651688:function(e,t,i){i.d(t,{Z:function(){return a}});var n=i(134761);i(874386),i(268917);var o=i(94659),r=i(104013),l=i(548309),s=i(873791);class a extends o.Z{get isPanelShow(){return this.renderItemList.length>0}get isFramePanelShow(){return this.frameRenderItemList.length>0}get playerMargin(){return this.renderItemList.length>0&&this.frameRenderItemList.length<=0?this.width+8:this.renderItemList.length<=0&&this.frameRenderItemList.length>0?this.frameWidth+8:this.renderItemList.length>0&&this.frameRenderItemList.length>0?Math.max(this.width,this.frameWidth)+8:0}get infoBarMargin(){return this.frameRenderItemList.length>0?this.frameWidth+10:10}constructor(e){super(),(0,n._)(this,"itemList",[]),(0,n._)(this,"renderItemList",[]),(0,n._)(this,"rootEl",null),(0,n._)(this,"frameRootEl",null),(0,n._)(this,"width",375),(0,n._)(this,"frameWidth",0),(0,n._)(this,"frameItemList",[]),(0,n._)(this,"frameRenderItemList",[]),(0,n._)(this,"eventBus",void 0),(0,n._)(this,"itemClassName",void 0),(0,n._)(this,"frameItemClassName",void 0),(0,n._)(this,"operatingBarPluginIsShow",void 0),(0,n._)(this,"actStore",void 0),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{frameItemClassName:r.observable,itemClassName:r.observable,itemList:r.observable,renderItemList:r.observable,rootEl:r.observable,frameRootEl:r.observable,width:r.observable,frameItemList:r.observable,frameRenderItemList:r.observable,closePanel:r.action,closeFramePanel:r.action,isPanelShow:r.computed,isFramePanelShow:r.computed,closeItem:r.action,closeFrameItem:r.action,registerItem:r.action,registerFrameItem:r.action,unRegisterItem:r.action,unRegisterFrameItem:r.action,playerMargin:r.computed,isItemShow:r.action,isFrameItemShow:r.action,setRootEl:r.action,setFrameRootEl:r.action,setItemClassName:r.action,setFrameItemClassName:r.action,frameWidth:r.observable,setFrameWidth:r.action,infoBarMargin:r.computed,operatingBarPluginIsShow:r.observable,setOperatingBarPluginIsShow:r.action})}),(0,n._)(this,"setOperatingBarPluginIsShow",e=>{this.operatingBarPluginIsShow=e}),(0,n._)(this,"setFrameWidth",e=>{this.frameWidth=e}),(0,n._)(this,"itemIndex",e=>this.renderItemList.findIndex(t=>t.itemKey===e)),(0,n._)(this,"frameItemIndex",e=>this.frameRenderItemList.findIndex(t=>t.itemKey===e)),(0,n._)(this,"setItemClassName",e=>{this.itemClassName=e}),(0,n._)(this,"setFrameItemClassName",e=>{this.frameItemClassName=e}),(0,n._)(this,"setRootEl",e=>{this.rootEl=e}),(0,n._)(this,"setFrameRootEl",e=>{this.frameRootEl=e}),(0,n._)(this,"closePanel",()=>{this.renderItemList.forEach(e=>e.onClose&&e.onClose()),this.renderItemList=[]}),(0,n._)(this,"closeFramePanel",()=>{this.frameRenderItemList.forEach(e=>e.onClose&&e.onClose()),this.frameRenderItemList=[]}),(0,n._)(this,"isItemShow",e=>this.renderItemList.findIndex(t=>t.itemKey===e)>=0),(0,n._)(this,"isFrameItemShow",e=>this.frameRenderItemList.findIndex(t=>t.itemKey===e)>=0),(0,n._)(this,"closeItem",e=>{if(!this.renderItemList)return;let t=this.renderItemList.findIndex(t=>t.itemKey===e);t>=0&&(this.renderItemList.splice(t,1),this.renderItemList=[...this.renderItemList])}),(0,n._)(this,"closeFrameItem",e=>{let t=this.frameRenderItemList.findIndex(t=>t.itemKey===e);t>=0&&(this.frameRenderItemList.splice(t,1),this.frameRenderItemList=[...this.frameRenderItemList])}),(0,n._)(this,"registerItem",e=>{e.group=e.group||e.itemKey;let t=this.itemList.findIndex(t=>t.itemKey===e.itemKey);t<0?this.itemList.push(e):this.itemList[t]=e,this.itemList=[...this.itemList]}),(0,n._)(this,"registerFrameItem",e=>{e.group=e.group||e.itemKey;let t=this.frameItemList.findIndex(t=>t.itemKey===e.itemKey);t<0?this.frameItemList.push(e):this.frameItemList[t]=e,this.frameItemList=[...this.frameItemList]}),(0,n._)(this,"unRegisterItem",e=>{let t=this.itemList.findIndex(t=>t.itemKey===e);t>=0&&(this.itemList.splice(t,1),this.itemList=[...this.itemList]),this.closeItem(e)}),(0,n._)(this,"unRegisterFrameItem",e=>{let t=this.frameItemList.findIndex(t=>t.itemKey===e);t>=0&&(this.frameItemList.splice(t,1),this.frameItemList=[...this.frameItemList]),this.closeFrameItem(e)}),(0,n._)(this,"openItem",e=>{let t=this.itemList.find(t=>t.itemKey===e);if(t&&t.group!==l.k.ACTIndicatorGroup){var i;null===(i=this.actStore)||void 0===i||i.setCurrentLandPage([])}if(!t)return;if(0===this.renderItemList.length){this.renderItemList=[t];return}if(this.renderItemList[0].group!==t.group){let e=this.renderItemList;this.renderItemList=[t],null==e||e.forEach(e=>e.onClose&&e.onClose());return}let n=this.renderItemList.findIndex(e=>e.itemKey===t.itemKey);if(n<0){this.renderItemList=[...this.renderItemList,t];return}if(n===this.renderItemList.length-1){let e=this.renderItemList[n];this.renderItemList.splice(n,1),this.renderItemList=[...this.renderItemList],e.onClose&&e.onClose();return}this.renderItemList.splice(n,1),this.renderItemList=[...this.renderItemList,t]}),(0,n._)(this,"openFrameItem",e=>{let t=this.frameItemList.find(t=>t.itemKey===e);if(!t)return;if(0===this.frameRenderItemList.length){this.frameRenderItemList=[t];return}if(this.frameRenderItemList[0].group!==t.group){let e=this.frameRenderItemList;this.frameRenderItemList=[t],null==e||e.forEach(e=>e.onClose&&e.onClose());return}let i=this.frameRenderItemList.findIndex(e=>e.itemKey===t.itemKey);if(i<0){this.frameRenderItemList=[...this.frameRenderItemList,t];return}if(0===i){let e=this.frameRenderItemList[i];this.frameRenderItemList.splice(i,1),this.frameRenderItemList=[...this.frameRenderItemList],e.onClose&&e.onClose();return}this.frameRenderItemList.splice(i,1),this.frameRenderItemList=[...this.frameRenderItemList,t]}),this.eventBus=new s.N,this.actStore=e;this.makeObservable()}}},408019:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"cartVisible",!1),(0,n._)(this,"showAgreement",!1),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{showAgreement:r.observable,cartVisible:r.observable,setCartVisible:r.action,setShowAgreement:r.action})}),(0,n._)(this,"setCartVisible",e=>this.cartVisible=e),(0,n._)(this,"setShowAgreement",e=>this.showAgreement=e);this.makeObservable()}}},134888:function(e,t,i){i.d(t,{Z:function(){return A}});var n=i("134761");i("874386"),i("954372"),i("826893");var o=i("94659"),r=i("104013"),l=i("200055"),s=i("183407"),a=i("646423"),u=i("4765"),d=i("486904"),c=i("192160"),v=i("718141"),_=i("2296"),m=i("56430"),h=i("823921"),f=i("473679"),g=i("222661"),p=i("32762"),y=i("357913"),b=i("195366"),P=i("520739");class I{constructor(e){(0,n._)(this,"store",null),(0,n._)(this,"livesdkSubTabShow",e=>{let{eventStore:{basicEvent:t}}=this.store;window.collectEvent("livesdk_sub_tab_show",(0,P._)({},e,t.getCommonEventParams(),t.getPlayerCommonEventParams(),t.getEnterEventParams(),t.getRecommendParams()))}),(0,n._)(this,"livesdkSearchBarClick",e=>{let{eventStore:{basicEvent:t}}=this.store;window.collectEvent("livesdk_search_bar_click",(0,P._)({},e,t.getCommonEventParams(),t.getPlayerCommonEventParams(),t.getEnterEventParams(),t.getRecommendParams()))}),(0,n._)(this,"livesdkSearchResultWordsClick",e=>{let{eventStore:{basicEvent:t}}=this.store;window.collectEvent("livesdk_search_result_words_click",(0,P._)({},e,t.getCommonEventParams(),t.getPlayerCommonEventParams(),t.getEnterEventParams(),t.getRecommendParams()))}),(0,n._)(this,"livesdkSearchResultDeleteClick",e=>{let{eventStore:{basicEvent:t}}=this.store;window.collectEvent("livesdk_search_result_delete",(0,P._)({},e,t.getCommonEventParams(),t.getPlayerCommonEventParams(),t.getEnterEventParams(),t.getRecommendParams()))}),this.store=e}}var E=i("82384"),S=i("293871"),L=i("40086"),C=i("208417"),w=i("804660"),N=i("198934"),k=i("571709"),T=i("511974"),R=i("701953"),x=i("40582");class O{constructor(e){var t=this;(0,n._)(this,"store",null),(0,n._)(this,"liveOperationBannerShowEvent",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{eventStore:{basicEvent:i}}=t.store;window.collectEvent("livesdk_pc_first_page_banner_show",(0,P._)({},i.getCommonEventParams(),i.getEnterEventParams(),e))}),(0,n._)(this,"liveOperationBannerClickEvent",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{eventStore:{basicEvent:i}}=t.store;window.collectEvent("livesdk_pc_first_page_banner_click",(0,P._)({},i.getCommonEventParams(),i.getEnterEventParams(),e))}),(0,n._)(this,"liveChannelGuessCategoryClickEvent",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{eventStore:{basicEvent:i}}=t.store;window.collectEvent("livesdk_pc_guessyoulike_click",(0,P._)({},i.getCommonEventParams(),i.getEnterEventParams(),e))}),this.store=e}}class A extends o.Z{initEvents(){this.chatEvent=new l.s(this.store),this.basicEvent=new s.L(this.store),this.ecomEvent=new a.B(this.store),this.fansclubEvent=new u.h(this.store),this.giftBaseEvent=new d.f(this.store),this.giftEvent=new c.c(this.store),this.redPacketEvent=new v.q(this.store),this.linkmicBaseEvent=new _.U(this.store),this.linkmicEvent=new m.O(this.store),this.loginEvent=new h.p(this.store),this.pkEvent=new f.C(this.store),this.playerEvent=new g.r(this.store),this.ranklistEvent=new p.F(this.store),this.reportEvent=new y.P(this.store),this.rtcEvent=new b.z(this.store),this.gameTabEvent=new I(this.store),this.userEvent=new E.L(this.store),this.vsEvent=new S.y(this.store),this.slardarEvent=new L.Uh(this.store),this.vipEvent=new C.Z(this.store),this.giftGuideEvent=new w.v(this.store),this.wishListEvent=new N.D(this.store),this.giftExhibitionEvent=new k.B(this.store),this.lotteryEvent=new T.T(this.store),this.reserveEvent=new R.r(this.store),this.vrEvent=new x.Z(this.store),this.liveChannelEvent=new O(this.store)}constructor(e){super(),(0,n._)(this,"store",void 0),(0,n._)(this,"chatEvent",void 0),(0,n._)(this,"basicEvent",void 0),(0,n._)(this,"ecomEvent",void 0),(0,n._)(this,"fansclubEvent",void 0),(0,n._)(this,"giftBaseEvent",void 0),(0,n._)(this,"giftEvent",void 0),(0,n._)(this,"redPacketEvent",void 0),(0,n._)(this,"linkmicBaseEvent",void 0),(0,n._)(this,"linkmicEvent",void 0),(0,n._)(this,"loginEvent",void 0),(0,n._)(this,"pkEvent",void 0),(0,n._)(this,"playerEvent",void 0),(0,n._)(this,"ranklistEvent",void 0),(0,n._)(this,"reportEvent",void 0),(0,n._)(this,"rtcEvent",void 0),(0,n._)(this,"tabEvent",void 0),(0,n._)(this,"gameTabEvent",void 0),(0,n._)(this,"userEvent",void 0),(0,n._)(this,"vsEvent",void 0),(0,n._)(this,"slardarEvent",void 0),(0,n._)(this,"vipEvent",void 0),(0,n._)(this,"giftGuideEvent",void 0),(0,n._)(this,"wishListEvent",void 0),(0,n._)(this,"giftExhibitionEvent",void 0),(0,n._)(this,"lotteryEvent",void 0),(0,n._)(this,"reserveEvent",void 0),(0,n._)(this,"vrEvent",void 0),(0,n._)(this,"LiveChannelEvent",void 0),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{chatEvent:r.observable,basicEvent:r.observable,ecomEvent:r.observable,fansclubEvent:r.observable,giftBaseEvent:r.observable,giftEvent:r.observable,linkmicBaseEvent:r.observable,linkmicEvent:r.observable,loginEvent:r.observable,pkEvent:r.observable,playerEvent:r.observable,ranklistEvent:r.observable,reportEvent:r.observable,rtcEvent:r.observable,tabEvent:r.observable,gameTabEvent:r.observable,userEvent:r.observable,vsEvent:r.observable,redPacketEvent:r.observable,vipEvent:r.observable,giftGuideEvent:r.observable,wishListEvent:r.observable,giftExhibitionEvent:r.observable,lotteryEvent:r.observable,reserveEvent:r.observable,vrEvent:r.observable,LiveChannelEvent:r.observable})}),(0,n._)(this,"reset",()=>{Object.entries(this).filter(e=>{let[t]=e;return/Event$/.test(t)}).forEach(e=>{let[t]=e;return this[t]=null}),this.store=null});this.store=e,this.makeObservable(),this.initEvents()}}},679272:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{setIsActive(e){this.isActive=e}constructor(){super(),(0,n._)(this,"isActive",!0),(0,n._)(this,"hasPre",!1),(0,n._)(this,"hasNext",!1),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{isActive:r.observable,hasPre:r.observable,hasNext:r.observable,setIsActive:r.action})});this.makeObservable()}}},187308:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761);i(874386);var o=i(94659),r=i(104013);class l extends o.Z{setContainerList(e){this.containerList=e}setLongtouchList(e){this.longtouchList=e}setCommonList(e){this.commonList=e}constructor(){super(),(0,n._)(this,"containerList",new Map),(0,n._)(this,"longtouchList",new Map),(0,n._)(this,"commonList",new Map),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{containerList:r.observable,setContainerList:r.action,longtouchList:r.observable,setLongtouchList:r.action,commonList:r.observable,setCommonList:r.action})}),(0,n._)(this,"reset",()=>{this.containerList=new Map,this.longtouchList=new Map,this.store=null});this.makeObservable()}}},789113:function(e,t,i){i.d(t,{Z:function(){return u}});var n=i(134761),o=i(104013),r=i(94659),l=i(645260),s=i.n(l),a=i(456354);class u extends r.Z{get pkStatus(){let e=!!this.pkAppData.ver;return!!this.pkTccStatus&&e}get pkTeamCount(){let e="";if(!this.pkStatus||this.pkStatus&&!this.isInPK&&!this.isInPunish)return e;let t=s()(this.pkListData,"battle_stats.multi_pk_team",[]),i=1===s()(this.pkListData,"battle_stats.battle_settings.battle_config_setting.team_mode",0);if(this.pkAppData.ver===a.TG.DOUBLE)e="1v1";else if(i&&t[1]&&t[2])e=`${t[1].multi_anchor_list.length}v${t[2].multi_anchor_list.length}`;else if(this.pkStatus){var n,o;e=`${null===(o=this.pkAppData)||void 0===o?void 0:null===(n=o.grids)||void 0===n?void 0:n.length}vs`}return e}constructor(){var e;super(),e=this,(0,n._)(this,"pkAppData",{}),(0,n._)(this,"pkTccStatus",!1),(0,n._)(this,"pkEggData",null),(0,n._)(this,"isInPK",!1),(0,n._)(this,"isInPunish",!1),(0,n._)(this,"transformToPK",!1),(0,n._)(this,"pkPlayMode",""),(0,n._)(this,"pkListData",{}),(0,n._)(this,"pkStatusData",{}),(0,n._)(this,"pkCountDown",0),(0,n._)(this,"usePkEgg",!1),(0,n._)(this,"isDoubleView",!1),(0,n._)(this,"showPKScoreBar",!1),(0,n._)(this,"showPKContributorsTop",!1),(0,n._)(this,"pkId",""),(0,n._)(this,"isVote",!1),(0,n._)(this,"pkUserIdList",[]),(0,n._)(this,"makeObservable",()=>{(0,o.makeObservable)(this,{pkAppData:o.observable,pkTccStatus:o.observable,pkStatus:o.computed,setPKAppData:o.action,setPKTccStatus:o.action,setPkEggData:o.action,pkEggData:o.observable,pkCountDown:o.observable,pkListData:o.observable,pkStatusData:o.observable,setPkListData:o.action,setPkStatusData:o.action,setPkCountDown:o.action,setUsePkEgg:o.action,usePkEgg:o.observable,isDoubleView:o.observable,setIsDoubleView:o.action,setShowPKScoreBar:o.action,showPKScoreBar:o.observable,showPKContributorsTop:o.observable,setShowPKContributorsTop:o.action,pkId:o.observable,setPkId:o.action,isVote:o.observable,setIsVote:o.action,isInPK:o.observable,isInPunish:o.observable,transformToPK:o.observable,pkPlayMode:o.observable,pkTeamCount:o.computed,setTransformToPK:o.action,setIsInPK:o.action,setIsInPunish:o.action,pkUserIdList:o.observable,setPkUserIdList:o.action,setPkPlayMode:o.action})}),(0,n._)(this,"setPKAppData",e=>this.pkAppData=e),(0,n._)(this,"setPKTccStatus",e=>this.pkTccStatus=e),(0,n._)(this,"setPkEggData",e=>{this.pkEggData=e}),(0,n._)(this,"setPkCountDown",e=>this.pkCountDown=e),(0,n._)(this,"setUsePkEgg",e=>this.usePkEgg=e),(0,n._)(this,"setIsDoubleView",e=>this.isDoubleView=e),(0,n._)(this,"setShowPKScoreBar",e=>this.showPKScoreBar=e),(0,n._)(this,"setShowPKContributorsTop",e=>this.showPKContributorsTop=e),(0,n._)(this,"setPkId",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.pkId=t}),(0,n._)(this,"setIsVote",e=>this.isVote=e),(0,n._)(this,"setIsInPK",e=>this.isInPK=e),(0,n._)(this,"setPkUserIdList",e=>this.pkUserIdList=e),(0,n._)(this,"setIsInPunish",e=>{this.isInPK=e}),(0,n._)(this,"setTransformToPK",e=>this.transformToPK=e),(0,n._)(this,"setPkPlayMode",e=>this.pkPlayMode=a.gL[e]),(0,n._)(this,"setPkListData",e=>this.pkListData=e),(0,n._)(this,"setPkStatusData",e=>this.pkStatusData=e);this.makeObservable()}}},367846:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{makeObservable(){(0,r.makeObservable)(this,{fansClubTccStatus:r.observable,fansClubAuthStatus:r.observable,fansClubShowStatus:r.observable,fansClubJoinStatus:r.observable,fansClubAutoLightStatus:r.observable,fansClubButtonShowStatus:r.observable,fansClubData:r.observable,hasFetchDataStatus:r.observable,fansClubEntranceBounceStatus:r.observable,fansclubGuardianStatus:r.observable,guardianExpireTime:r.observable,fansClubStatus:r.computed,setFansClubAuthStatus:r.action,setFansClubTccStatus:r.action,setFansClubShowStatus:r.action,setFansClubJoinStatus:r.action,setFansClubAutoLightStatus:r.action,setFansClubData:r.action,setHasFetchDataStatus:r.action,setFansClubEntranceBounceStatus:r.action,setFansClubGuardianStatus:r.action,setFansClubButtonShowStatus:r.action,setGuardianExpireTime:r.action})}get fansClubStatus(){return this.fansClubTccStatus&&this.fansClubAuthStatus}constructor(){super(),(0,n._)(this,"fansClubAuthStatus",!1),(0,n._)(this,"fansClubTccStatus",!1),(0,n._)(this,"fansClubButtonShowStatus",!1),(0,n._)(this,"fansClubShowStatus",{isShow:!1,source:""}),(0,n._)(this,"fansClubJoinStatus",!1),(0,n._)(this,"fansClubAutoLightStatus",!1),(0,n._)(this,"fansClubData",{}),(0,n._)(this,"hasFetchDataStatus",!1),(0,n._)(this,"fansClubEntranceBounceStatus",!1),(0,n._)(this,"fansclubGuardianStatus",0),(0,n._)(this,"guardianExpireTime",0),(0,n._)(this,"setFansClubAuthStatus",e=>this.fansClubAuthStatus=e),(0,n._)(this,"setFansClubTccStatus",e=>this.fansClubTccStatus=e),(0,n._)(this,"setFansClubShowStatus",e=>this.fansClubShowStatus=e),(0,n._)(this,"setFansClubButtonShowStatus",e=>this.fansClubButtonShowStatus=e),(0,n._)(this,"setFansClubJoinStatus",e=>this.fansClubJoinStatus=e),(0,n._)(this,"setFansClubAutoLightStatus",e=>this.fansClubAutoLightStatus=e),(0,n._)(this,"setFansClubData",e=>this.fansClubData=e),(0,n._)(this,"setHasFetchDataStatus",e=>this.hasFetchDataStatus=e),(0,n._)(this,"setFansClubEntranceBounceStatus",e=>this.fansClubEntranceBounceStatus=e),(0,n._)(this,"setFansClubGuardianStatus",e=>this.fansclubGuardianStatus=e),(0,n._)(this,"setGuardianExpireTime",e=>this.guardianExpireTime=e);this.makeObservable()}}},31543:function(e,t,i){i.d(t,{Z:function(){return v}});var n=i(134761),o=i(520739),r=i(878389);i(250440),i(429532),i(779788);var l=i(94659),s=i(104013),a=i(709606),u=i(688432),d=i(984468);let c=[a.kQ.GIFT,a.kQ.FANS,a.kQ.LEVEL,a.kQ.ACTION_1,a.kQ.ACTION_2,a.kQ.ACTIVITY_1,a.kQ.ACTIVITY_2,a.kQ.PROP,a.kQ.CURATED,a.kQ.OLD_CARATED,,];class v extends l.Z{get supportedGiftPages(){return this.giftPages.filter(e=>e.display&&c.includes(e.pageType)).map(e=>(0,r._)((0,o._)({},e),{giftList:(0,u.fc)(e.giftList)}))}get giftList(){return(0,u.pL)(this.giftPages,[],a.dq.NORMAL,1,!1)}get giftStatus(){return this.giftSwitchStatus&&this.giftAuthStatus&&this.giftTccStatus}get openWanxiang(){return 1===this.wanxiangGiftSwitch}constructor(){super(),(0,n._)(this,"giftMessages",[]),(0,n._)(this,"giftPages",[]),(0,n._)(this,"effectList",[]),(0,n._)(this,"balance",0),(0,n._)(this,"targetGiftPrice",0),(0,n._)(this,"targetGiftId",0),(0,n._)(this,"effectSwitchStatus",!0),(0,n._)(this,"giftSwitchStatus",!0),(0,n._)(this,"giftAuthStatus",!1),(0,n._)(this,"giftTccStatus",!1),(0,n._)(this,"isGiftPanelVisible",!1),(0,n._)(this,"isGiftPanelVisibleNew",!1),(0,n._)(this,"giftPanelSwitchStatus",a.nN.NO_CONTROL),(0,n._)(this,"giftPanelShowFrom",""),(0,n._)(this,"giftExtraInfo",{}),(0,n._)(this,"hoverGiftWhiteList",[]),(0,n._)(this,"hoverGiftWhiteListV2",[]),(0,n._)(this,"diyPluginIdWhiteList",[]),(0,n._)(this,"giftBuffIdWhiteList",[]),(0,n._)(this,"diyCardNameWhiteList",[]),(0,n._)(this,"handleRecharge",void 0),(0,n._)(this,"showBuffCard",!0),(0,n._)(this,"wanxiangGiftSwitch",0),(0,n._)(this,"forceShowBuffList",[]),(0,n._)(this,"starGuardEffectWhiteList",[]),(0,n._)(this,"currentPageType",a.Tj.GIFT),(0,n._)(this,"paygrade",void 0),(0,n._)(this,"currentHoverGift",void 0),(0,n._)(this,"maxGiftTrayCount",Number.MAX_SAFE_INTEGER),(0,n._)(this,"giftBgEffectMap",{}),(0,n._)(this,"giftTrayConfig",{}),(0,n._)(this,"giftComboHint",null),(0,n._)(this,"giftSkinCache",void 0),(0,n._)(this,"giftShortcutKey",!1),(0,n._)(this,"isFirstGiftShortcutKey",!1),(0,n._)(this,"giftLayer",0),(0,n._)(this,"hasGiftConfirm",!1),(0,n._)(this,"makeObservable",()=>{(0,s.makeObservable)(this,{diyPluginIdWhiteList:s.observable,diyCardNameWhiteList:s.observable,hoverGiftWhiteList:s.observable,hoverGiftWhiteListV2:s.observable,giftBuffIdWhiteList:s.observable,giftMessages:s.observable,giftPages:s.observable,effectList:s.observable,balance:s.observable,targetGiftPrice:s.observable,targetGiftId:s.observable,effectSwitchStatus:s.observable,giftSwitchStatus:s.observable,giftAuthStatus:s.observable,giftTccStatus:s.observable,isGiftPanelVisible:s.observable,giftPanelSwitchStatus:s.observable,giftPanelShowFrom:s.observable,giftExtraInfo:s.observable,giftBgEffectMap:s.observable,handleRecharge:s.observable,showBuffCard:s.observable,wanxiangGiftSwitch:s.observable,starGuardEffectWhiteList:s.observable,maxGiftTrayCount:s.observable,giftTrayConfig:s.observable,supportedGiftPages:s.computed,giftList:s.computed,giftStatus:s.computed,setGiftMessages:s.action,setGiftPages:s.action,setEffectList:s.action,setBalance:s.action,setGiftTrayConfig:s.action,setTargetGiftPrice:s.action,setTargetGiftId:s.action,setEffectSwitchStatus:s.action,setGiftSwitchStatus:s.action,setGiftAuthStatus:s.action,setGiftTccStatus:s.action,setIsGiftPanelVisible:s.action,setIsGiftPanelVisibleNew:s.action,setGiftPanelSwitchStatus:s.action,setGiftPanelShowFrom:s.action,setGiftExtra:s.action,setHoverGiftWhiteList:s.action,setDiyPluginIdWhiteList:s.action,setGiftBuffIdWhiteList:s.action,setDiyCardNameWhiteList:s.action,setHandleRecharge:s.action,setShowBuffCard:s.action,setHoverGiftWhiteListV2:s.action,setGiftBgEffectMap:s.action,setWanxiangGiftSwitch:s.action,openWanxiang:s.computed,setStarGuardEffectWhiteList:s.action,currentPageType:s.observable,setCurrentPageType:s.action,paygrade:s.observable,setPaygrade:s.action,currentHoverGift:s.observable,setCurrentHoverGift:s.action,setMaxGiftTrayCount:s.action,giftShortcutKey:s.observable,setGiftShortcutKey:s.action,isFirstGiftShortcutKey:s.observable,setIsFirstGiftShortcutKey:s.action,setGiftComboHint:s.action,giftSkinCache:s.observable,setGiftSkinCache:s.action,giftLayer:s.observable,setGiftLayer:s.action,hasGiftConfirm:s.observable,setHasGiftConfirm:s.action})}),(0,n._)(this,"setGiftExtra",(e,t)=>this.giftExtraInfo=Object.assign({},this.giftExtraInfo,{[e]:t})),(0,n._)(this,"setGiftMessages",e=>this.giftMessages=e),(0,n._)(this,"setGiftPages",e=>this.giftPages=e),(0,n._)(this,"setEffectList",e=>this.effectList=e),(0,n._)(this,"setBalance",e=>this.balance=e),(0,n._)(this,"setTargetGiftPrice",e=>this.targetGiftPrice=e),(0,n._)(this,"setTargetGiftId",e=>this.targetGiftId=e),(0,n._)(this,"setEffectSwitchStatus",e=>this.effectSwitchStatus=e),(0,n._)(this,"setGiftSwitchStatus",e=>this.giftSwitchStatus=e),(0,n._)(this,"setGiftAuthStatus",e=>{this.giftAuthStatus=e}),(0,n._)(this,"setGiftBgEffectMap",e=>{this.giftBgEffectMap=e}),(0,n._)(this,"setGiftTccStatus",e=>this.giftTccStatus=e),(0,n._)(this,"setGiftPanelSwitchStatus",e=>this.giftPanelSwitchStatus=e),(0,n._)(this,"setGiftPanelShowFrom",e=>this.giftPanelShowFrom=e),(0,n._)(this,"setHoverGiftWhiteList",e=>this.hoverGiftWhiteList=e),(0,n._)(this,"setHoverGiftWhiteListV2",e=>this.hoverGiftWhiteListV2=e),(0,n._)(this,"setDiyPluginIdWhiteList",e=>this.diyPluginIdWhiteList=e),(0,n._)(this,"setGiftBuffIdWhiteList",e=>this.giftBuffIdWhiteList=e),(0,n._)(this,"setDiyCardNameWhiteList",e=>this.diyCardNameWhiteList=e),(0,n._)(this,"setHandleRecharge",e=>this.handleRecharge=e),(0,n._)(this,"setShowBuffCard",e=>this.showBuffCard=e),(0,n._)(this,"setWanxiangGiftSwitch",e=>this.wanxiangGiftSwitch=e),(0,n._)(this,"setIsGiftPanelVisible",e=>this.isGiftPanelVisible=e),(0,n._)(this,"setIsGiftPanelVisibleNew",e=>this.isGiftPanelVisibleNew=e),(0,n._)(this,"setForceShowBuffList",e=>this.forceShowBuffList=e),(0,n._)(this,"setStarGuardEffectWhiteList",e=>this.starGuardEffectWhiteList=e),(0,n._)(this,"setCurrentPageType",e=>this.currentPageType=e),(0,n._)(this,"setPaygrade",async e=>{var t,i,n,o,r,l,s,a;let u=null===(n=this.store)||void 0===n?void 0:null===(i=n.roomStore)||void 0===i?void 0:null===(t=i.roomInfo)||void 0===t?void 0:t.roomId,c=null===(s=this.store)||void 0===s?void 0:null===(l=s.roomStore)||void 0===l?void 0:null===(r=l.roomInfo)||void 0===r?void 0:null===(o=r.anchor)||void 0===o?void 0:o.id_str;if(!u||!c)return;let v=await (0,d.HF)({room_id:u,anchor_id:c,request_from:e});v.data&&200===v.status&&(this.paygrade=null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.data)}),(0,n._)(this,"setCurrentHoverGift",e=>{this.currentHoverGift=e}),(0,n._)(this,"setMaxGiftTrayCount",e=>this.maxGiftTrayCount=e),(0,n._)(this,"scrollGiftList",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new CustomEvent("scrollGiftList",{detail:e});document.dispatchEvent(t)}),(0,n._)(this,"setGiftComboHint",e=>{this.giftComboHint=e}),(0,n._)(this,"setGiftSkinCache",e=>{this.giftSkinCache=e}),(0,n._)(this,"setGiftShortcutKey",e=>{try{localStorage.setItem(a.vp,JSON.stringify(e))}catch(e){}this.giftShortcutKey=e}),(0,n._)(this,"setIsFirstGiftShortcutKey",e=>{try{localStorage.setItem(a.iR,JSON.stringify(e))}catch(e){}this.isFirstGiftShortcutKey=e}),(0,n._)(this,"setGiftLayer",e=>{this.giftLayer=e}),(0,n._)(this,"setGiftTrayConfig",e=>{this.giftTrayConfig=e}),(0,n._)(this,"setHasGiftConfirm",e=>{this.hasGiftConfirm=e});this.makeObservable()}}},436886:function(e,t,i){i.d(t,{Z:function(){return a}});var n=i("134761"),o=i("94659"),r=i("104013"),l=i("433964");l.a4.SUPPORT,l.a4.LIGHT_GIFT;var s={FANS_CLUB:"FANS_CLUB",GIFT_EXHIBITION:"GIFT_EXHIBITION",WISH_LIST:"WISH_LIST"};class a extends o.Z{makeObservable(){(0,r.makeObservable)(this,{giftExhibitionGuideStatus:r.observable,wishListGuideStatus:r.observable,leftGiftGuideShowType:r.computed,rightGiftGuideShowType:r.computed,setGiftExhibitionGuideStatus:r.action,setWishListGuideStatus:r.action})}get leftGiftGuideShowType(){return s.FANS_CLUB}get rightGiftGuideShowType(){return this.giftExhibitionGuideStatus?s.GIFT_EXHIBITION:s.WISH_LIST}constructor(){super(),(0,n._)(this,"giftExhibitionGuideStatus",!1),(0,n._)(this,"wishListGuideStatus",!1),(0,n._)(this,"setGiftExhibitionGuideStatus",e=>this.giftExhibitionGuideStatus=e),(0,n._)(this,"setWishListGuideStatus",e=>this.wishListGuideStatus=e);this.makeObservable()}}},647245:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"isShowHourRankList",!1),(0,n._)(this,"openType",0),(0,n._)(this,"isFirstLoad",!0),(0,n._)(this,"chatRoomOpenType",12),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{isShowHourRankList:r.observable,openType:r.observable,setIsShowHourRankList:r.action,chatRoomOpenType:r.observable,setOpenType:r.action,setChatRoomOpenType:r.action})}),(0,n._)(this,"setOpenType",e=>this.openType=e),(0,n._)(this,"setIsShowHourRankList",e=>this.isShowHourRankList=e),(0,n._)(this,"setIsFirstLoad",e=>this.isFirstLoad=e),(0,n._)(this,"setChatRoomOpenType",e=>this.chatRoomOpenType=e);this.makeObservable()}}},738299:function(e,t,i){i.d(t,{Z:function(){return s}});var n=i(134761);i(250440);var o=i(94659),r=i(104013),l=i(986371);class s extends o.Z{get supportedPropList(){return this.propList.filter(e=>l.cf.includes(Number(e.type)))}constructor(){super(),(0,n._)(this,"propList",[]),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{propList:r.observable,supportedPropList:r.computed,setPropList:r.action})}),(0,n._)(this,"setPropList",e=>this.propList=e);this.makeObservable()}}},7396:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(104013),r=i(94659);class l extends r.Z{setVipEmojiConfig(e){this.vipEmojiConfig=e}constructor(){super(),(0,n._)(this,"isVip",!1),(0,n._)(this,"isShowVipPanel",!1),(0,n._)(this,"vipEmojiConfig",null),(0,n._)(this,"emojiPanelRef",null),(0,n._)(this,"vipLiveStatus",""),(0,n._)(this,"vipInfoLoaded",!1),(0,n._)(this,"vipSource","icon"),(0,n._)(this,"showVipLiveBoundary",!1),(0,n._)(this,"makeObservable",()=>{(0,o.makeObservable)(this,{isShowVipPanel:o.observable,vipEmojiConfig:o.observable,setIsShowVipPanel:o.action,setVipEmojiConfig:o.action,emojiPanelRef:o.observable,isVip:o.observable,setIsVip:o.action,vipLiveStatus:o.observable,setVipLiveStatus:o.action,vipInfoLoaded:o.observable,setVipInfoLoaded:o.action,vipSource:o.observable,showVipLiveBoundary:o.observable,setShowVipLiveBoundary:o.action})}),(0,n._)(this,"setShowVipLiveBoundary",e=>{this.showVipLiveBoundary=e}),(0,n._)(this,"setIsShowVipPanel",e=>{let{isShow:t,source:i}=e;this.isShowVipPanel=t,i&&t&&(this.vipSource=i)}),(0,n._)(this,"setIsVip",e=>this.isVip=e),(0,n._)(this,"setEmojiPanelRef",e=>{this.emojiPanelRef=e}),(0,n._)(this,"setVipLiveStatus",e=>this.vipLiveStatus=e),(0,n._)(this,"setVipInfoLoaded",e=>this.vipInfoLoaded=e);this.makeObservable()}}},356700:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"showChat",!1),(0,n._)(this,"isDanmakuFeatureOn",!0),(0,n._)(this,"onSend",{current:()=>{}}),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{showChat:r.observable,setShowChat:r.action,isDanmakuFeatureOn:r.observable,setIsDanmakuFeatureOn:r.action})}),(0,n._)(this,"setIsDanmakuFeatureOn",e=>{this.isDanmakuFeatureOn=e}),(0,n._)(this,"setShowChat",e=>{this.showChat=e}),(0,n._)(this,"setOnSend",e=>{this.onSend.current=e});this.makeObservable()}}},516136:function(e,t,i){i.d(t,{Z:function(){return m}});var n=i(134761);i(250440),i(927234),i(268917);var o=i(618618),r=i(94659),l=i(645260),s=i.n(l),a=i(613063),u=i.n(a),d=i(104013),c=i(852664),v=i(879176),_=i(616003);class m extends r.Z{get isDanmakuFeatureOn(){return!this.isMedia&&this.LandscapeChat!==o.xW.OFF||this.isDanmakuFeatureOnControl}get isSpringSkin(){var e,t;return!!(null===(t=this.store)||void 0===t?void 0:null===(e=t.layoutStore)||void 0===e?void 0:e.resource)}get hideBanner(){return[_.kx.KICK_OUT,_.kx.LIVE_FINISH].includes(this.playerCoverText)}get isFixedChat(){var e,t,i;return(null===(i=this.roomInfo)||void 0===i?void 0:null===(t=i.room)||void 0===t?void 0:null===(e=t.room_auth)||void 0===e?void 0:e.FixedChat)===1}get roomStatus(){var e,t;return null===(t=this.roomInfo)||void 0===t?void 0:null===(e=t.room)||void 0===e?void 0:e.status}get roomId(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.roomId}get live_room_mode(){var e,t;return null===(t=this.roomInfo)||void 0===t?void 0:null===(e=t.room)||void 0===e?void 0:e.live_room_mode}get isAppOnly(){var e,t,i;return this.roomInfo.enter_mode===o.gE.APP||(null===(t=this.store)||void 0===t?void 0:null===(e=t.linkmicStore)||void 0===e?void 0:e.isPlayModeNotSupport)||this.inRoomOnAppView&&(null===(i=this.roomInfo.room)||void 0===i?void 0:i.status)!==o.LV.END}get LandscapeChat(){var e,t;return null===(t=this.roomInfo.room)||void 0===t?void 0:null===(e=t.room_auth)||void 0===e?void 0:e.LandscapeChat}get coverUrl(){var e,t,i,n;return null===(n=this.roomInfo)||void 0===n?void 0:null===(i=n.room)||void 0===i?void 0:null===(t=i.cover)||void 0===t?void 0:null===(e=t.url_list)||void 0===e?void 0:e[0]}get isMedia(){var e,t;return(null===(t=this.roomInfo)||void 0===t?void 0:null===(e=t.room)||void 0===e?void 0:e.live_room_mode)===o.ke.MEDIA}get isDoubleScreen(){return this.isPullDataExsit&&!(0,c.G6)()||this.isUgcLive}get isPullDataExsit(){var e,t,i,n,o,r,l;return!!(Object.values((null===(t=this.roomInfo)||void 0===t?void 0:null===(e=t.web_stream_url)||void 0===e?void 0:e.pull_datas)||{}).length>0)&&!!(Object.values((null===(o=this.roomInfo)||void 0===o?void 0:null===(n=o.room)||void 0===n?void 0:null===(i=n.stream_url)||void 0===i?void 0:i.pull_datas)||{}).length>0)&&Object.values(null===(l=this.roomInfo)||void 0===l?void 0:null===(r=l.web_stream_url)||void 0===r?void 0:r.pull_datas).every(e=>{var t,i;return(null==e?void 0:null===(t=e.extension)||void 0===t?void 0:t.camera_clip)&&(null==e?void 0:null===(i=e.extension)||void 0===i?void 0:i.game_clip)||(0,v.V)(null==e?void 0:e.extension)})}get hasProgramme(){return this.enableProgramme&&this.abProgramme}get isAnchorBan(){return 2===s()(this.roomInfo,"room.others.mosaic_version",0)&&0!==s()(this.roomInfo,"room.mosaic_status",0)||this.imAnchorBan}get longtouchShow(){var e;let t=s()(this.roomInfo,"room.live_room_mode"),i=Number(null===(e=this.roomInfo.room)||void 0===e?void 0:e.status_str)===o.LV.END;return t===o.ke.MEDIA?2!==s()(this.roomInfo,"room.room_auth.LongTouch",0):this.longtouchShowTcc&&!i}constructor(e){var t,i,r;super(),t=this,(0,n._)(this,"roomInfo",{}),(0,n._)(this,"emojiList",[]),(0,n._)(this,"emojiReflex",{}),(0,n._)(this,"liveStatus",o.zZ.NORMAL),(0,n._)(this,"likeStatus",{}),(0,n._)(this,"followInfo",{}),(0,n._)(this,"isUgcLive",!1),(0,n._)(this,"isGameHiddle",!1),(0,n._)(this,"forceEnableH265",!1),(0,n._)(this,"hasAppointment",!1),(0,n._)(this,"enableProgramme",!1),(0,n._)(this,"abProgramme",!1),(0,n._)(this,"notSupportReason",o.Ly.UNKNOWN),(0,n._)(this,"pausePop",!1),(0,n._)(this,"longtouchList",(null===(r=this.store)||void 0===r||null===(i=r.feedStore)||void 0===i||i.isActive,[])),(0,n._)(this,"longtouchShowTcc",!1),(0,n._)(this,"isAsianGames",!1),(0,n._)(this,"usePageUrlBannerId",[]),(0,n._)(this,"relevantRooms",[]),(0,n._)(this,"danmakuQueue",[]),(0,n._)(this,"danmakuQueueLength",0),(0,n._)(this,"danmakuSwitch",!0),(0,n._)(this,"isFocus",!1),(0,n._)(this,"imAnchorBan",!1),(0,n._)(this,"isOlympicGame",!1),(0,n._)(this,"isEnableOlympic4k",!1),(0,n._)(this,"foldChatroom",!1),(0,n._)(this,"activityEmojiGroup",[]),(0,n._)(this,"foreign_user",void 0),(0,n._)(this,"store",void 0),(0,n._)(this,"inRoomOnAppView",!1),(0,n._)(this,"isVerified",!1),(0,n._)(this,"isPlayer",!0),(0,n._)(this,"playerCoverText",""),(0,n._)(this,"refreshPlayer",!1),(0,n._)(this,"recommendOnEndRoom",[]),(0,n._)(this,"isPip",!1),(0,n._)(this,"isDanmakuFeatureOnControl",!0),(0,n._)(this,"isShowRefreshPage",!1),(0,n._)(this,"disableLiveRecommendOnEnd",!1),(0,n._)(this,"isDoubleLike",!1),(0,n._)(this,"pollingFrequency",{}),(0,n._)(this,"makeObservable",()=>{(0,d.makeObservable)(this,{roomInfo:d.observable,emojiList:d.observable,emojiReflex:d.observable,liveStatus:d.observable,likeStatus:d.observable,followInfo:d.observable,setRoomInfo:d.action,setFollowStatus:d.action,setEmojiList:d.action,setEmojiReflex:d.action,setRoomUserStats:d.action,setRoomStatus:d.action,setLiveStatus:d.action,setFollowInfo:d.action,isUgcLive:d.observable,isGameHiddle:d.observable,pausePop:d.observable,setUgcLive:d.action,setGameHiddle:d.action,setPausePop:d.action,hasAppointment:d.observable,enableProgramme:d.observable,abProgramme:d.observable,hasProgramme:d.computed,isAnchorBan:d.computed,forceEnableH265:d.observable,notSupportReason:d.observable,longtouchShow:d.computed,longtouchList:d.observable,setLongtouchList:d.action,setNotSupportReason:d.action,longtouchShowTcc:d.observable,setLongtouchShowTcc:d.action,usePageUrlBannerId:d.observable,setUsePageUrlBannerId:d.action,isAsianGames:d.observable,setIsAsianGames:d.action,relevantRooms:d.observable,danmakuQueue:d.observable,setDanmakuQueue:d.action,danmakuQueueLength:d.observable,danmakuSwitch:d.observable,setDanmakuSwitch:d.action,foldChatroom:d.observable,setFoldChatroom:d.action,isFocus:d.observable,setIsFocus:d.action,imAnchorBan:d.observable,setImAnchorBan:d.action,isOlympicGame:d.observable,setIsOlympicGame:d.action,isEnableOlympic4k:d.observable,setIsEnableOlympic4k:d.action,activityEmojiGroup:d.observable,setActivityEmojiGroup:d.action,setActivityEmojiGroupForce:d.action,setForeignUser:d.action,foreign_user:d.observable,isPullDataExsit:d.computed,isDoubleScreen:d.computed,isMedia:d.computed,LandscapeChat:d.computed,isAppOnly:d.computed,inRoomOnAppView:d.observable,setInRoomOnAppView:d.action,live_room_mode:d.computed,roomId:d.computed,roomStatus:d.computed,isVerified:d.observable,setIsVerified:d.action,isPlayer:d.observable,setIsPlayer:d.action,isFixedChat:d.computed,playerCoverText:d.observable,setPlayerCoverText:d.action,refreshPlayer:d.observable,setRefreshPlayer:d.action,recommendOnEndRoom:d.observable,setRecommendOnEndRoom:d.action,hideBanner:d.computed,isPip:d.observable,setIsPip:d.action,isDanmakuFeatureOn:d.computed,setIsDanmakuFeatureOn:d.action,isDanmakuFeatureOnControl:d.observable,isShowRefreshPage:d.observable,setIsShowRefreshPage:d.action,disableLiveRecommendOnEnd:d.observable,setDisableLiveRecommendOnEnd:d.action,isDoubleLike:d.observable,setIsDoubleLike:d.action,pollingFrequency:d.observable,setPollingFrequency:d.action})}),(0,n._)(this,"setIsDoubleLike",e=>{this.isDoubleLike=e}),(0,n._)(this,"setDisableLiveRecommendOnEnd",e=>{this.disableLiveRecommendOnEnd=e}),(0,n._)(this,"setIsShowRefreshPage",e=>{this.isShowRefreshPage=e}),(0,n._)(this,"setIsPip",e=>{this.isPip=e}),(0,n._)(this,"setIsDanmakuFeatureOn",e=>{this.isDanmakuFeatureOnControl=e}),(0,n._)(this,"setRecommendOnEndRoom",e=>{this.recommendOnEndRoom=e}),(0,n._)(this,"setRefreshPlayer",e=>{this.refreshPlayer=e}),(0,n._)(this,"setPlayerCoverText",e=>{this.playerCoverText=e}),(0,n._)(this,"setIsPlayer",e=>{this.isPlayer=e}),(0,n._)(this,"setIsVerified",e=>{this.isVerified=e}),(0,n._)(this,"setInRoomOnAppView",e=>{this.inRoomOnAppView=e}),(0,n._)(this,"setUgcLive",e=>{this.isUgcLive=e}),(0,n._)(this,"setGameHiddle",e=>{this.isGameHiddle=e}),(0,n._)(this,"setNotSupportReason",e=>{this.notSupportReason=e}),(0,n._)(this,"setPausePop",e=>{this.pausePop=e}),(0,n._)(this,"setRoomInfo",e=>this.roomInfo=e),(0,n._)(this,"setEmojiList",e=>this.emojiList=e),(0,n._)(this,"setEmojiReflex",e=>this.emojiReflex=e),(0,n._)(this,"setFollowStatus",e=>u()(this.roomInfo,"anchor.follow_info.follow_status",e)),(0,n._)(this,"setRoomUserStats",e=>u()(this.roomInfo,"room.room_view_stats",e)),(0,n._)(this,"setRoomStatus",e=>{u()(this.roomInfo,"room.status",e),u()(this.roomInfo,"room.status_str",e.toString())}),(0,n._)(this,"setLiveStatus",e=>this.liveStatus=e),(0,n._)(this,"setLikeStatus",e=>this.likeStatus=e),(0,n._)(this,"setFollowInfo",(e,t)=>{this.followInfo[e]=t}),(0,n._)(this,"setRoomCommentaryRoomInfo",e=>{u()(this.roomInfo,"room.commentary_room_info",e)}),(0,n._)(this,"setAppointment",function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.hasAppointment=e}),(0,n._)(this,"setLongtouchList",e=>{var t,i;(null===(i=this.store)||void 0===i?void 0:null===(t=i.feedStore)||void 0===t?void 0:t.isActive)&&(this.longtouchList=e)}),(0,n._)(this,"setLongtouchShowTcc",e=>{this.longtouchShowTcc=e}),(0,n._)(this,"setUsePageUrlBannerId",e=>{this.usePageUrlBannerId=e}),(0,n._)(this,"setRelativeRooms",e=>{this.relevantRooms=e}),(0,n._)(this,"setIsAsianGames",e=>{this.isAsianGames=e}),(0,n._)(this,"setDanmakuQueue",(e,t)=>{t?this.danmakuQueue.push(e):this.danmakuQueue=e,this.danmakuQueueLength=this.danmakuQueue.length}),(0,n._)(this,"setDanmakuSwitch",e=>{this.danmakuSwitch=e}),(0,n._)(this,"reset",()=>{var e,t;this.roomInfo={},this.emojiList=[],this.emojiReflex={},this.liveStatus=o.zZ.NORMAL,this.likeStatus={},this.followInfo={},this.isUgcLive=!1,this.isGameHiddle=!1,this.forceEnableH265=!1,this.hasAppointment=!1,this.enableProgramme=!1,this.abProgramme=!1,this.notSupportReason=o.Ly.UNKNOWN,this.pausePop=!1,this.longtouchList=(null===(t=this.store)||void 0===t||null===(e=t.feedStore)||void 0===e||e.isActive,[]),this.longtouchShowTcc=!1,this.isAsianGames=!1,this.usePageUrlBannerId=[],this.relevantRooms=[],this.danmakuQueue=[],this.danmakuQueueLength=0,this.danmakuSwitch=!0,this.imAnchorBan=!1}),(0,n._)(this,"setFoldChatroom",e=>{this.foldChatroom=e}),(0,n._)(this,"setIsFocus",e=>{this.isFocus=e}),(0,n._)(this,"setImAnchorBan",e=>{this.imAnchorBan=e}),(0,n._)(this,"setIsOlympicGame",e=>{this.isOlympicGame=e}),(0,n._)(this,"setIsEnableOlympic4k",e=>{this.isEnableOlympic4k=e}),(0,n._)(this,"setActivityEmojiGroup",e=>{let t=null,i=new Date().getTime()/1e3;if(e.forEach(e=>{Number(e.start_time)<i&&Number(e.end_time)>i&&(t?Number(null==e?void 0:e.start_time)>Number(null==t?void 0:t.start_time)&&(t=e):t=e)}),!t){this.activityEmojiGroup=[];return}this.activityEmojiGroup=[t]}),(0,n._)(this,"setActivityEmojiGroupForce",e=>{this.activityEmojiGroup=e}),(0,n._)(this,"setForeignUser",e=>this.foreign_user=e),(0,n._)(this,"setPollingFrequency",e=>{this.pollingFrequency=e});this.makeObservable(),this.store=e}}},62323:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"leadingData",{}),(0,n._)(this,"streamData",{}),(0,n._)(this,"leadingShow",!1),(0,n._)(this,"localQuality",void 0),(0,n._)(this,"singleControlTime",0),(0,n._)(this,"singleControlMaxShowTime",0),(0,n._)(this,"renderTime",0),(0,n._)(this,"isUseVVC",!1),(0,n._)(this,"isH265",!1),(0,n._)(this,"isH265Error",!1),(0,n._)(this,"videoInit",!1),(0,n._)(this,"disabledH265",!1),(0,n._)(this,"streamInfoFromLiving",{}),(0,n._)(this,"currentQuality",void 0),(0,n._)(this,"watchingFinished",!0),(0,n._)(this,"lowH265",!1),(0,n._)(this,"useBackUp",!1),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{leadingData:r.observable,streamData:r.observable,leadingShow:r.observable,localQuality:r.observable,renderTime:r.observable,setLeadingData:r.action,setStreamData:r.action,setLeadingShow:r.action,setLocalQuality:r.action,setRenderTime:r.action,singleControlTime:r.observable,singleControlMaxShowTime:r.observable,setSingleControlMaxShowTime:r.action,setSingleControlTime:r.action,isUseVVC:r.observable,isH265:r.observable,setIsH265:r.action,isH265Error:r.observable,setIsH265Error:r.action,videoInit:r.observable,setVideoInit:r.action,setIsUseVVC:r.action,disabledH265:r.observable,setDisabledH265:r.action,streamInfoFromLiving:r.observable,setStreamInfoFromLiving:r.action,currentQuality:r.observable,setCurrentQuality:r.action,watchingFinished:r.observable,setWatchingFinished:r.action,setLowH265:r.action,lowH265:r.observable,useBackUp:r.observable,setUseBackUp:r.action})}),(0,n._)(this,"setLowH265",e=>{this.lowH265=e}),(0,n._)(this,"setWatchingFinished",e=>{this.watchingFinished=e}),(0,n._)(this,"setCurrentQuality",e=>{this.currentQuality=e}),(0,n._)(this,"setStreamInfoFromLiving",(e,t)=>{"string"==typeof e?this.streamInfoFromLiving[e]=t:"object"==typeof e&&(this.streamInfoFromLiving=e)}),(0,n._)(this,"setDisabledH265",e=>{this.disabledH265=e}),(0,n._)(this,"reset",()=>{this.leadingData={},this.streamData={},this.leadingShow=!1,this.localQuality=void 0,this.singleControlTime=0,this.singleControlMaxShowTime=0,this.renderTime=0,this.isUseVVC=!1}),(0,n._)(this,"setIsUseVVC",e=>{this.isUseVVC=e}),(0,n._)(this,"setVideoInit",e=>{this.videoInit=e}),(0,n._)(this,"setLeadingData",e=>{this.leadingData=e}),(0,n._)(this,"setStreamData",e=>{this.streamData=e}),(0,n._)(this,"setLeadingShow",e=>{this.leadingShow=e}),(0,n._)(this,"setLocalQuality",e=>{this.localQuality=e}),(0,n._)(this,"setRenderTime",e=>{this.renderTime=e}),(0,n._)(this,"setSingleControlMaxShowTime",e=>{this.singleControlMaxShowTime=e}),(0,n._)(this,"setSingleControlTime",e=>{this.singleControlTime=e}),(0,n._)(this,"setIsH265",e=>{this.isH265=e}),(0,n._)(this,"setIsH265Error",e=>{this.isH265Error=e}),(0,n._)(this,"setUseBackUp",e=>{this.useBackUp=e});this.makeObservable()}}},869718:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{constructor(){super(),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{userInfo:r.observable,setUserInfo:r.action,headerUserInfo:r.observable,setHeaderUserInfo:r.action,odin:r.observable,setOdin:r.action,userHandlerPause:r.observable,setPlayerUserHandlePause:r.action})}),(0,n._)(this,"userInfo",{}),(0,n._)(this,"headerUserInfo",{isLogin:void 0,isSpider:!1,info:{},webcastInfo:{},statusCode:0}),(0,n._)(this,"odin",{}),(0,n._)(this,"userHandlerPause",!1),(0,n._)(this,"setPlayerUserHandlePause",e=>{this.userHandlerPause=e}),(0,n._)(this,"setUserInfo",e=>this.userInfo=e),(0,n._)(this,"setHeaderUserInfo",e=>this.headerUserInfo=e),(0,n._)(this,"setOdin",e=>this.odin=e);this.makeObservable()}}},758801:function(e,t,i){i.d(t,{Z:function(){return l}});var n=i(134761),o=i(94659),r=i(104013);class l extends o.Z{get isUseMutiCamera(){return!!this.isMutiVr&&this.isInVrView}get isMutiVr(){var e,t,i,n,o,r,l,s,a,u;return 0===Number(null===(n=this.store)||void 0===n?void 0:null===(i=n.roomStore)||void 0===i?void 0:null===(t=i.roomInfo)||void 0===t?void 0:null===(e=t.roomExtra)||void 0===e?void 0:e.vr_type)&&(null===(u=this.store)||void 0===u?void 0:null===(a=u.roomStore)||void 0===a?void 0:null===(s=a.roomInfo)||void 0===s?void 0:null===(l=s.room)||void 0===l?void 0:null===(r=l.pico_info)||void 0===r?void 0:null===(o=r.multi_stream_info)||void 0===o?void 0:o.multi_stream_scene)==="multi_camera"}get isVrLive(){var e,t,i,n;let o=Number(null===(n=this.store)||void 0===n?void 0:null===(i=n.roomStore)||void 0===i?void 0:null===(t=i.roomInfo)||void 0===t?void 0:null===(e=t.roomExtra)||void 0===e?void 0:e.vr_type);return 1===o||2===o||this.isMutiVr}get vr_type(){var e,t,i,n;let o=Number(null===(n=this.store)||void 0===n?void 0:null===(i=n.roomStore)||void 0===i?void 0:null===(t=i.roomInfo)||void 0===t?void 0:null===(e=t.roomExtra)||void 0===e?void 0:e.vr_type);return isNaN(o)?0:o}get is_vr_machine(){return this.isVrLive?this.isMutiVr?this.isInVrView?1:0:1:0}get is_host_camera(){return this.isMutiVr?this.isInVrView?0:1:1}get is_multi_camera_mode_on(){return this.isMutiVr?1:0}get is_original_vr(){return this.isMutiVr?0:1}get gyroscope_state(){return this.isStableView?"off":"on"}get anchorClientInfo(){var e,t,i,n,o,r,l;let s=null===(l=this.store)||void 0===l?void 0:null===(r=l.roomStore)||void 0===r?void 0:null===(o=r.roomInfo)||void 0===o?void 0:null===(n=o.room)||void 0===n?void 0:null===(i=n.stream_url)||void 0===i?void 0:null===(t=i.extra)||void 0===t?void 0:null===(e=t.anchor_client_info)||void 0===e?void 0:e.custom_info;try{let e=JSON.parse(s);return{projectionType:(null==e?void 0:e.projection_model)||"ERP",three180:null==e||!e.viewing_angle||180===Number(null==e?void 0:e.viewing_angle)}}catch(e){return{projectionType:"ERP",three180:!0}}}getCommonEventParams(){return{is_original_vr:this.is_original_vr,is_multi_camera_mode_on:this.is_multi_camera_mode_on,is_host_camera:this.is_host_camera,is_vr_machine:this.is_vr_machine,vr_type:this.vr_type}}constructor(e){super(),(0,n._)(this,"isStableView",!1),(0,n._)(this,"isImmersive",!1),(0,n._)(this,"isInVrView",!1),(0,n._)(this,"store",void 0),(0,n._)(this,"vrRotate",0),(0,n._)(this,"resetView",0),(0,n._)(this,"makeObservable",()=>{(0,r.makeObservable)(this,{isVrLive:r.computed,isStableView:r.observable,setIsStableView:r.action,isImmersive:r.observable,setIsImmersive:r.action,isInVrView:r.observable,setIsInVrView:r.action,isMutiVr:r.computed,vr_type:r.computed,is_vr_machine:r.computed,is_host_camera:r.computed,is_multi_camera_mode_on:r.computed,is_original_vr:r.computed,vrRotate:r.observable,resetView:r.observable,setVrRotate:r.action})}),(0,n._)(this,"setResetView",()=>{this.resetView=this.resetView+1}),(0,n._)(this,"setVrRotate",e=>{this.vrRotate=e}),(0,n._)(this,"setIsInVrView",e=>{this.isInVrView=e}),(0,n._)(this,"setIsImmersive",e=>{this.isImmersive=e}),(0,n._)(this,"setIsStableView",e=>{this.isStableView=e});this.makeObservable(),this.store=e}}},615323:function(e,t,i){i.d(t,{iM:function(){return n}});var n={TYPE_NONE:0,0:"TYPE_NONE",TYPE_TURNON:1,1:"TYPE_TURNON",TYPE_PERMIT:2,2:"TYPE_PERMIT",TYPE_KICKOUTED:3,3:"TYPE_KICKOUTED",TYPE_FINISH:4,4:"TYPE_FINISH",TYPE_WAITING_LIST_CHANGED:5,5:"TYPE_WAITING_LIST_CHANGED",TYPE_LINKED_LIST_CHANGED:6,6:"TYPE_LINKED_LIST_CHANGED",TYPE_ALL_LIST_CHANGED:7,7:"TYPE_ALL_LIST_CHANGED",TYPE_FAN_TICKET_CHANGED:8,8:"TYPE_FAN_TICKET_CHANGED",TYPE_RANKING_UPDATE:9,9:"TYPE_RANKING_UPDATE",TYPE_SILENCE:10,10:"TYPE_SILENCE",TYPE_UNSILENCE:11,11:"TYPE_UNSILENCE",TYPE_INVITE:12,12:"TYPE_INVITE",TYPE_REPLY:13,13:"TYPE_REPLY",TYPE_AUTO_JOIN:14,14:"TYPE_AUTO_JOIN",TYPE_AGREE_ADMIN_FIRST_INVITE:15,15:"TYPE_AGREE_ADMIN_FIRST_INVITE",TYPE_SILENCE_PASSIVE:16,16:"TYPE_SILENCE_PASSIVE",TYPE_SWITCH_SCENE:17,17:"TYPE_SWITCH_SCENE",TYPE_JOIN_GAME_BARRAGE_RTC:18,18:"TYPE_JOIN_GAME_BARRAGE_RTC",TYPE_LEAVE_GAME_BARRAGE_RTC:19,19:"TYPE_LEAVE_GAME_BARRAGE_RTC",TYPE_BATTLE_DATA:202,202:"TYPE_BATTLE_DATA"}},409913:function(e,t,i){i.d(t,{Dk:function(){return a},L6:function(){return _},gf:function(){return c},nE:function(){return u},o9:function(){return d}});var n=i(520739),o=i(878389);i(779788),i(874386);var r=i(144020),l=i(441447),s=i(88648);let a=(e,t,i,s)=>{if(i&&s){let r=JSON.parse(window.localStorage.getItem("DanmaSetting_GiftAndPackage")),l=(null==r?void 0:r[`${s}_${i}`])||{};r?window.localStorage.setItem("DanmaSetting_GiftAndPackage",JSON.stringify((0,o._)((0,n._)({},r),{[`${s}_${i}`]:(0,o._)((0,n._)({},l),{expired:Date.now()+864e5,[e]:t})}))):window.localStorage.setItem("DanmaSetting_GiftAndPackage",JSON.stringify({[`${s}_${i}`]:{expired:Date.now()+864e5,giftOn:"giftOn"!==e||t,packageOn:"packageOn"!==e||t}}))}else{let i=JSON.parse(window.localStorage.getItem("danmakuConfig"));i?window.localStorage.setItem("danmakuConfig",JSON.stringify((0,o._)((0,n._)({},i),{[e]:t}))):window.localStorage.setItem("danmakuConfig",JSON.stringify((0,o._)((0,n._)({},r.HI),{[e]:t}))),l.emit("liveDanmakuSettingChange")}},u=(e,t,i,n)=>{if(t&&i){var o;let l=n?`${i}`:`${i}_${t}`,s=null===(o=JSON.parse(window.localStorage.getItem("DanmaSetting_GiftAndPackage")))||void 0===o?void 0:o[l];return s&&(null==s?void 0:s.expired)>Date.now()?(null==s?void 0:s[e])!==void 0?null==s?void 0:s[e]:r.HI[e]:r.HI[e]}{let t=JSON.parse(window.localStorage.getItem("danmakuConfig"));return t?Number(null==t?void 0:t[e]):r.HI[e]}},d=()=>{try{return!window.localStorage.getItem("isDanmaHint")}catch(e){return!0}},c=()=>{try{window.localStorage.setItem("isDanmaHint","1")}catch(e){}},v=()=>{var e,t,i,o,l,s,a,u;let d=r.HI;try{d=JSON.parse(localStorage.getItem("danmakuConfig"))||r.HI}catch(e){}let c=null!==(o=d.area)&&void 0!==o?o:r.HI.area,v=(0,n._)({start:.01,end:null===(e=r.WK[null!=c?c:r.HI.fontSize])||void 0===e?void 0:e.value},1===c||0===c?{lines:c+1}:{}),_=(null!==(l=d.opacity)&&void 0!==l?l:100)/100,m=null===(t=r.NY[null!==(s=d.fontSize)&&void 0!==s?s:r.HI.fontSize])||void 0===t?void 0:t.value,h=null===(i=r.AY[null!==(a=d.speed)&&void 0!==a?a:r.HI.speed])||void 0===i?void 0:i.value,f=null!==(u=v.lines)&&void 0!==u?u:1/0,g=v.end;return v.end,{area:v,opacity:_,fontSize:m,speed:h,maxLineCount:f,maxHeightRate:g}},_=()=>{let[e,t]=(0,s.useState)(()=>v());return(0,s.useEffect)(()=>l.listen("liveDanmakuSettingChange",()=>{t(v())}),[]),e}},879176:function(e,t,i){i.d(t,{V:function(){return o}});var n=i(481154);let o=e=>{if(null==e?void 0:e.multi_view_data){let{displays:t=[]}="string"==typeof e.multi_view_data?JSON.parse(e.multi_view_data):e.multi_view_data;if(t.some(e=>e.display_id===n.m))return!0}return!1}},688092:function(e,t,i){i.d(t,{k:function(){return r}});var n=i(88648);let o=(0,n.createContext)({XTTENV:""}),r=()=>(0,n.useContext)(o)},639272:function(e,t,i){i.d(t,{o:function(){return s}});var n=i(520739),o=i(742740),r=i(983253),l=i(818597);function s(){let e=(0,l.o)(),t=()=>{var t,i,n;let{linkmicStore:l,roomStore:s}=e||{},a=(null==l?void 0:l.linkRoomType)==="audio"?"voice_live":"";return{anchor_id:null==s?void 0:null===(t=s.roomInfo)||void 0===t?void 0:t.roomId,room_id:null==s?void 0:null===(n=s.roomInfo)||void 0===n?void 0:null===(i=n.anchor)||void 0===i?void 0:i.id_str,enter_from_merge:(0,o.yW)(),enter_method:(0,r.Rs)("enter_method"),request_id:(0,r.Rs)("request_id"),action_type:"click",liveType:a}};return(e,i)=>{var o,r;null===(o=(r=window).collectEvent)||void 0===o||o.call(r,e,(0,n._)({},t(),i))}}},934966:function(e,t,i){i.d(t,{V:function(){return l}}),i(209955);var n=i(612774),o=i(88648);let{Currency:r}=n;function l(){let e=(0,o.useContext)(r);if(void 0===e)throw Error("Currency must be used within Provider");return e}},909497:function(e,t,i){i.d(t,{Y:function(){return P},w:function(){return I}});var n=i("520739"),o=i("878389");i("675373"),i("874386"),i("250440");var r=i("88648"),l=i("645260"),s=i.n(l),a=i("565024"),u=i("128487"),d=i("544406"),c=i("435404"),v=i("617463"),_=i("382708"),m=i("201758"),h=i("665600"),f=i("324867"),g=i("567754");async function p(e,t,i){var n,o,r,l,s,a,u,d;let c=await (0,f.ZP)(i,`/webcast/web/conf/skin/?${(0,g.stringify)({room_id:e,anchor_id:t})}`,{method:"GET"}),v=c.headers.get("x-tt-logid");if(200!==c.status)return null==i||null===(n=i.logger)||void 0===n||n.error("[getTheme] not 200",v),null==i||null===(r=i.metrics)||void 0===r||null===(o=r.emitCounter)||void 0===o||o.call(r,"get_theme_error",1,""),{};let{data:_={}}=null!==(l=await c.json())&&void 0!==l?l:{};try{return JSON.parse(null==_?void 0:null===(s=_.skin)||void 0===s?void 0:s.conf)}catch(e){return null==i||null===(a=i.logger)||void 0===a||a.error("[getTheme]",e,v),null==i||null===(d=i.metrics)||void 0===d||null===(u=d.emitCounter)||void 0===u||u.call(d,"parse_theme_error",1,""),{}}}var y=i("818597"),b=i("669417");let P=async function(){let{webRid:e,isPreEnterRoom:t,store:i,query:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{webRid:"",isPreEnterRoom:!1,store:{},query:{}},l=async()=>{var i,n,o,r,l,a,u;let d,c,v,h;null===b.kg||void 0===b.kg||null===(i=b.kg.info)||void 0===i||i.call(b.kg,"开始调用进房接口");let f=[],g=window.liveDetailDataAPI;g instanceof Promise?(delete window.liveDetailDataAPI,f=await g):f=await (0,m.Y)({webRid:e,isPreEnterRoom:t}),null===b.kg||void 0===b.kg||null===(n=b.kg.info)||void 0===n||n.call(b.kg,"进房接口调用完毕");let[y,P,I,E,S=[],L=[]]=f,{roomInfo:C,relevantRooms:w,logId:N}=y,k=null==C?void 0:C.roomId,T=null==C?void 0:null===(o=C.anchor)||void 0===o?void 0:o.id_str,R=(null==C?void 0:null===(a=C.room)||void 0===a?void 0:null===(l=a.others)||void 0===l?void 0:null===(r=l.web_skin)||void 0===r?void 0:r.enable_skin)?await p(k,T):void 0;y.relevantRooms=w.map(e=>(0,_.bj)(e,N));let x=s()(C,"room.episode_extra.season_id_str"),O=null==L?void 0:L.includes(x);return(u=h||(h={}))[u.TRYWATCH_LEAD=3]="TRYWATCH_LEAD",{rawRes:y,iframeConf:P,linkmicHeartConfig:I,qualitySettings:E,clatity_guide:3,themeConfig:R,isSpider:!1,isAsianGames:!1,isOlympicGame:O,defaultMoreLeague:d,defaultMatchStatsDetail:c,defaultTagMatchInfo:v}};try{var d,f,g,y,P,I,E,S,L,C,w,N,k,T,R,x,O,A,F,M,D,G,j,V,U,Z,B,W,H,K,Y,$,Q,q,J,z,X,ee,et,ei,en,eo,er,el,es,ea,eu,ed;let t;let{rawRes:_,iframeConf:m,linkmicHeartConfig:p,qualitySettings:b,clatity_guide:ec,themeConfig:ev,isAsianGames:e_,isOlympicGame:em,defaultMoreLeague:eh,defaultMatchStatsDetail:ef,defaultTagMatchInfo:eg}=await l(),{roomInfo:ep,error:ey,status_code:eb,errorPageMessage:eP,logId:eI,errorPrompts:eE,relevantRooms:eS,isUseVVC:eL}=_,eC={Digg:null==ep?void 0:null===(f=ep.room)||void 0===f?void 0:null===(d=f.room_auth)||void 0===d?void 0:d.Digg,SpecialStyle:null==ep?void 0:null===(y=ep.room)||void 0===y?void 0:null===(g=y.room_auth)||void 0===g?void 0:g.SpecialStyle};if(null==i||null===(I=i.roomStore)||void 0===I||null===(P=I.setIsAsianGames)||void 0===P||P.call(I,e_),null==i||null===(S=i.roomStore)||void 0===S||null===(E=S.setIsOlympicGame)||void 0===E||E.call(S,em),i.roomStore&&s()(ep,"room.others.programme.enable_programme",!1)&&(i.roomStore.enableProgramme=!0),(null==ep?void 0:null===(w=ep.room)||void 0===w?void 0:null===(C=w.others)||void 0===C?void 0:null===(L=C.web_skin)||void 0===L?void 0:L.enable_skin)&&ev){i.layoutStore.rawThemeConfig=ev;let{force_enable_h265:e,hideCategory:t,showNavigation:n,hideFooter:o,forceTheme:r,immersive:l,banner:s,programme:a,appointment:u,transparentHeader:d,resource:c,navigationSelected:v,hideRelevantRoom:_,programmeFill:m,disableUnLoginFilter:f,playerMargin:g}=ev;f&&i.layoutStore&&(i.layoutStore.disableUnLoginFilter=!0),e&&i.roomStore&&(i.roomStore.forceEnableH265=!0),void 0!==v&&i.layoutStore&&(i.layoutStore.navigationSelected=v),a&&i.roomStore&&(i.roomStore.abProgramme=!0),_&&i.layoutStore&&(i.layoutStore.hasRelevantRoom=!1),m&&i.layoutStore&&(i.layoutStore.programmeFill=m),g&&i.layoutStore&&(i.layoutStore.playerMargin=g),u&&(null===(X=i.roomStore)||void 0===X||X.setAppointment(!0)),t&&(null===(ee=i.layoutStore)||void 0===ee||ee.setModule("categoryTab",h.p.DISABLE)),n&&(null===(et=i.layoutStore)||void 0===et||et.setModule("navigation",h.p.ENABLE)),o&&(null===(ei=i.layoutStore)||void 0===ei||ei.setModule("footer",h.p.DISABLE)),r&&(null===(en=i.layoutStore)||void 0===en||en.setForceTheme(r)),d&&(null===(eo=i.layoutStore)||void 0===eo||eo.setHeaderOpacity(d)),l&&(null===(er=i.layoutStore)||void 0===er||er.setImmersive(!0)),s&&(null===(el=i.layoutStore)||void 0===el||el.setSpecialBanner(s)),c&&(null===(es=i.layoutStore)||void 0===es||es.setResource(c))}null===(N=i.appStore)||void 0===N||N.setIsOpenLongTask(!0),null===(k=i.appStore)||void 0===k||k.setLinkMicHeartConfig(p),null===(T=i.roomStore)||void 0===T||T.setRoomInfo(ep),null===(O=i.roomStore)||void 0===O||O.setUgcLive(null==ep?void 0:null===(x=ep.room)||void 0===x?void 0:null===(R=x.scene_type_info)||void 0===R?void 0:R.commentary_type),null===(M=i.roomStore)||void 0===M||M.setGameHiddle(null===(F=(0,v.MP)(ep))||void 0===F?void 0:null===(A=F.extension)||void 0===A?void 0:A.game_hidden),null===(D=i.roomStore)||void 0===D||D.setLikeStatus(eC),null===(j=i.paidLiveStore)||void 0===j||j.setPaidLiveData(null==ep?void 0:null===(G=ep.room)||void 0===G?void 0:G.paid_live_data),null===(V=i.roomStore)||void 0===V||V.setRelativeRooms(eS);let ew=r.message_from||"live",eN=s()(_,"loginLead",{}),{singleControlTime:ek,singleControlMaxShowTime:eT}=b,eR=a.Q.getItem({sKey:u.storage.CookieKeys.WebcastLocalQuality}),ex=a.Q.getItem({sKey:u.storage.CookieKeys.WebcastLeadingLastShowTime}),eO=a.Q.getItem({sKey:u.storage.CookieKeys.WebcastLeadingTotalShowTimes});null===(U=i.streamStore)||void 0===U||U.setLeadingData((0,o._)((0,n._)({},eN),{clatity_guide:ec,last_show_time:ex,total_show_times:eO})),null===(Z=i.streamStore)||void 0===Z||Z.setLocalQuality(eR),null===(B=i.streamStore)||void 0===B||B.setRenderTime(Date.now()),null===(W=i.streamStore)||void 0===W||W.setSingleControlTime(Number(ek)),null===(H=i.streamStore)||void 0===H||H.setSingleControlMaxShowTime(Number(eT));let{mainCameraInfo:eA,cameraInfoList:eF}=(0,v.EE)(ep);null===(K=i.cameraStore)||void 0===K||K.setMainCameraInfo(eA),null===(Y=i.cameraStore)||void 0===Y||Y.setCameraInfoList(eF);let eM=null==r?void 0:r.camera_id,eD=null==eF?void 0:null===($=eF.find)||void 0===$?void 0:$.call(eF,e=>(null==e?void 0:e.cameraId)===eM);if(!eD||(null==eD?void 0:eD.isMainCamera))t=(0,c.h)(ep),null===(ed=i.cameraStore)||void 0===ed||ed.setCameraInfo(eA);else{let e=(0,o._)((0,n._)({},ep),{room:(0,o._)((0,n._)({},ep.room),{stream_url:null==eD?void 0:eD.h264Stream,title:null==eD?void 0:eD.title}),web_stream_url:null==eD?void 0:eD.h265Stream});t=(0,c.h)(e),null===(ea=i.roomStore)||void 0===ea||ea.setRoomInfo(e),null===(eu=i.cameraStore)||void 0===eu||eu.setCameraInfo(eD)}null===(Q=i.streamStore)||void 0===Q||Q.setStreamData(t);let eG=null==t?void 0:null===(z=t.H265_streamData)||void 0===z?void 0:null===(J=z.options)||void 0===J?void 0:null===(q=J.qualities)||void 0===q?void 0:q.some(e=>"bytevc2"===e.v_codec);i.streamStore.isUseVVC=eL&&eG;let ej={errorPrompts:eE,logId:eI,status_code:eb,error:ey,errorPageMessage:eP,iframeConf:m[e],messageFrom:ew,isSpider:!1,defaultMoreLeague:eh,defaultMatchStatsDetail:ef,defaultTagMatchInfo:eg};i.detailExtra.setDetailExtra(ej)}catch(e){}},I=e=>{var t;let{webRid:i,query:n,isPreEnterRoom:o}=e,l=d.a.useClientDetect(),s=(0,y.o)();null==s||null===(t=s.layoutStore)||void 0===t||t.setHint(location.hostname,location.pathname,l,!!n.hidehead),s.layoutStore.setHardCategoryTab(h.p.DISABLE),(0,r.useEffect)(()=>{P({webRid:i,query:n,isPreEnterRoom:o,store:s})},[])}},228733:function(e,t,i){i.d(t,{Z:function(){return c}});var n=i(520739);i(179133),i(826893),i(413806);var o=i(32754),r=i(683849),l=i(669417),s=i(791483),a=i(527459),u=i(909543),d=i(113592);function c(){let e=(0,u.a)(),t=e=>{let{referrer:t}=document;-1>=t.indexOf("douyin.com")?(e.enter_from_merge="link_share",e.enter_method="direct_open"):e.enter_from_merge="page_refresh"};(0,s.C)(()=>{var i;if(!o._.find(t=>(0,a.m)(t,e.pathname)))return;let s={};try{let e=sessionStorage.getItem(r.UY);e?!(null==(s=JSON.parse(null!=e?e:"{}"))?void 0:s.enter_from_merge)&&t(s):t(s)}catch(e){l.kg.error("解析路由数据失败",e)}window.__INVISIBLE_QUERY__=(0,n._)({},null!==(i=window.__INVISIBLE_QUERY__)&&void 0!==i?i:{},s);let{remainQuery:u,remainQueryString:c}=(0,d.It)(e.search.split("?")[1]);window.history.replaceState({},"",e.pathname+c)},[])}},325354:function(e,t,i){var n=i(867204),o=i(742401),r=i(618618),l=i(818597),s=i(88648),a=i(645260),u=i.n(a);t.Z=()=>{let{roomStore:{roomInfo:e}}=(0,l.o)();return(0,s.useMemo)(()=>{var t,i;return o.s?"":(null===(i=window)||void 0===i?void 0:null===(t=i.__INVISIBLE_QUERY__)||void 0===t?void 0:t.enter_from_merge)==="web_share_link"&&e.enter_mode===r.gE.APP?n.R5.QRCODE:n.FO[u()(e,"room.stream_url.stream_orientation")]||""},[e])}},359077:function(e,t,i){i.d(t,{w5:function(){return a}});var n=i(520739),o=i(88648),r=i(818597),l=i(75978),s=i(705896),a={IM_API:"im/fetch",ENTER_API:"web/enter"};t.ZP=e=>{let{apis:t,roomId:i,cameraGroupId:a,cameraId:u,headers:d,saveVerify:c,isSavePlayer:v}=e,_=(0,o.useRef)(!1),{singletonStore:{message:m},feedStore:{isActive:h}}=(0,r.o)();(0,o.useEffect)(()=>{if(!i||!m||!h)return;let e=()=>{(0,l.p)().then(t=>{var i,n;t({success:()=>{_.current=!0,window.location.reload()},next:`https://${null===(n=window)||void 0===n?void 0:null===(i=n.location)||void 0===i?void 0:i.host}`,onClose:()=>{!_.current&&setTimeout(()=>{e()},2e3)}})})},o=()=>{m.start((0,n._)({room_id:i},u&&{sub_room_id:u},a&&{group_id:a})),null==v||v(!0),null==c||c()},r=(e,t)=>(null==e?void 0:e["Whale-Decision"])==="anonymous"||(null==e?void 0:e["whale-decision"])==="anonymous"||(null==t?void 0:t["Whale-Decision"])==="anonymous"||(null==t?void 0:t["whale-decision"])==="anonymous",f=null;return f=setInterval(()=>{var i;let{fetchHeader:n,pushHeader:l}=null!==(i=null==m?void 0:m.getimHeader())&&void 0!==i?i:{};if(n&&n["x-tt-logid"])switch(t){case"web/enter":d?(clearInterval(f),d["x-vc-bdturing-parameters"]?(null==v||v(!1),null==m||m.pause(),(0,s.PW)(d,o)):d["whale-decision"]&&(null==v||v(!1),null==m||m.stop(),e())):clearInterval(f);break;case"im/fetch":n&&n["x-vc-bdturing-parameters"]?(clearInterval(f),m.pause(),(0,s.PW)(n,o)):r(n,l)&&(clearInterval(f),m.pause(),e())}},1e3),()=>{f&&clearInterval(f)}},[i,d,m,h])}},360977:function(e,t,i){i.d(t,{kF:function(){return r}});var n=i(88648);let o=(0,n.createContext)({XTTENV:""}),r=()=>(0,n.useContext)(o)},836313:function(e,t,i){i.d(t,{K:function(){return l}});var n=i(132607),o=i(169961);let r=(e,t)=>{try{var i;let n=(0,o.T)();if(t)return t(null==n?void 0:n[e]);return null!==(i=null==n?void 0:n[e])&&void 0!==i?i:void 0}catch(e){return}},l=()=>r("enlargeDynamicBackground",e=>{let t=!1,i=!1;switch(e){case n.EnlargeDynamicBgVersion.V1:t=!0;break;case n.EnlargeDynamicBgVersion.V2:i=!0;break;case n.EnlargeDynamicBgVersion.V3:t=!0,i=!0}return{enlargeDynamicBg:t,enlargePadding:i}})},659933:function(e,t,i){i.d(t,{C:function(){return l},D:function(){return s}}),i(874386),i(675373);var n=i(914104),o=i(745618),r=i(419631);let l=i.n(r)()(async()=>{try{return o.CpO.instance}catch(t){var e;null===(e=(0,n.OK)())||void 0===e||e.sendEvent({name:"import_static_idl_error",categories:{error:t}})}}),s=async function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let n=await l();return null==n?void 0:n.decode(...t)}},713503:function(e,t,i){i.d(t,{f:function(){return n}}),i(284961),i(826893);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/^http:\/\//i,"https://")}},113592:function(e,t,i){i.d(t,{Bo:function(){return v},It:function(){return m}});var n=i(520739),o=i(878389);i(527785),i(927234),i(954372),i(826893),i(779788);var r=i(683849),l=i(567754),s=i(914104),a=i(328155),u=i(565024),d=i(987475);let c=["enter_from_merge","enter_method","ug_source","material_group_id","resource_space_id",/^_transparent_/,"web_live_page","web_live_tab","web_live_tab_2","web_live_tab_3","more_detail","game_name","title_type","cover_type","is_recommend","stream_type","room_id","evening_type","search_params","action_type","previous_page","request_id","live_type","function_type","seat_fit_status","insert_task_id","live_reason","aspect_ratio","from_landscape_tab","group_id","is_livehead_preview_mini_window_show","enter_method_temai","show_rank","show_cnt","cid","msToken","if_paid_live_card","entrance_form","ticket_entrance","if_qianchuan_ad","ad_type","live_ad_creative_id","live_ad_id","X-Bogus","ad_log_extra","if_browser_limited","open_promotion_list","open_promotion_detail","message_from","video_id","mini_window_show_type","search_tab","live_position","url_source","xigua_webid","push_id","otherParams","enter_method_on_cellphone","enter_from_on_cellphone","is_replaced_live","preview_type","web_card_rank","show_type"],v=()=>{let{group_id:e=""}=window.__INVISIBLE_QUERY__||{};return e},_=()=>{let e=(0,a.Nr)(location.pathname);window.addEventListener("beforeunload",()=>{try{if(e){var t;u.Q.setItem(d.CookieKeys.LiveInvisibleQuery,(0,l.stringify)(null===(t=window)||void 0===t?void 0:t.__INVISIBLE_QUERY__),60)}}catch(e){}})},m=e=>{try{let t=(0,l.parse)(e);try{let e=u.Q.getItem({sKey:d.CookieKeys.LiveInvisibleQuery});e&&(window.__INVISIBLE_QUERY__=(0,l.parse)(e),u.Q.removeItem(d.CookieKeys.LiveInvisibleQuery)),_()}catch(e){}let i=Object.keys(t).reduce((e,i)=>{if(c.some(e=>("[object RegExp]"===Object.prototype.toString.call(e)&&e.test(i)||"[object String]"===Object.prototype.toString.call(e)&&e===i)&&void 0!==t[i])){if("string"==typeof t[i])window.__INVISIBLE_QUERY__[i]=t[i];else if("object"==typeof t[i]){var r;(null===(r=t[i])||void 0===r?void 0:r.length)>0&&(window.__INVISIBLE_QUERY__[i]=t[i][t[i].length-1])}return e}return(0,o._)((0,n._)({},e),{[i]:t[i]})},{});sessionStorage.setItem(r.UY,JSON.stringify(window.__INVISIBLE_QUERY__));let s=Object.keys(i).length?`?${(0,l.stringify)(i)}`:"";return{remainQuery:i,remainQueryString:s}}catch(n){var t,i;return null===(i=(0,s.OK)())||void 0===i||null===(t=i.sendEvent)||void 0===t||t.call(i,{name:"filterAndUpdateInvisibleQuery_error",categories:{error:n,queryString:e},type:"event"}),{remainQuery:{},remainQueryString:""}}}},611703:function(e,t,i){i.d(t,{l:function(){return v}});var n=i("520739"),o=i("878389"),r=i("563097"),l=i("88648"),s=i("972484"),a={icon:"RSiknfLP"},u=i("713097"),d=i.n(u);let c={0:{key:"unknow_value",render:()=>null},1:{key:"string_value",render(e,t){if(e&&"string"!=typeof e){var i,l,a;t=(0,o._)((0,n._)({},t),{color:(0,s.H)(null==e?void 0:null===(i=e.format)||void 0===i?void 0:i.font_color),fontSize:null==e?void 0:null===(l=e.format)||void 0===l?void 0:l.font_size,fontWeight:(null==e?void 0:null===(a=e.format)||void 0===a?void 0:a.font_type)?500:400}),e=null==e?void 0:e.string_value}return e?(0,r.jsx)("span",{style:t,children:e}):null}},11:{key:"user_value",render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,{user:n,left_additional_content:o="",right_additional_content:l="",self_show_real_name:s}=e;if(!n)return null;let a=n.nickname;return(0,r.jsx)("span",{className:"hts-live-text-user",style:t,onClick:null==i?void 0:i.onClick,children:`${o}${a}${l}`})}},12:{key:"gift_value",render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{name_ref:t}=e,i=null==t?void 0:t.default_pattern;return i?(0,r.jsx)("span",{children:i}):null}},13:{key:"heart_value",render(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],null}},14:{key:"pattern_ref_value",render(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],null}},15:{key:"image_value",render(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,{image:s}=t,u=null==s?void 0:null===(e=s.url_list)||void 0===e?void 0:e[0],c=(0,o._)((0,n._)({},i),{height:null==s?void 0:s.height,width:null==s?void 0:s.width});return u?(0,r.jsx)("img",{className:d()(a.icon,"hts-live-text-img"),style:c,src:u,onClick:null==l?void 0:l.onClick}):null}},2:{key:"image_value",render(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,{image:l}=t,s=null==l?void 0:null===(e=l.url_list)||void 0===e?void 0:e[0],u=(0,o._)((0,n._)({},i),{height:null==l?void 0:l.height,width:null==l?void 0:l.width});return s?(0,r.jsx)("img",{className:d()(a.icon,"hts-live-text-img"),style:u,src:s}):null}}};function v(e){let{text:t,customRenderPiece:i,onPieceClick:n}=e,{pieces:o=[]}=t;return(0,r.jsx)(r.Fragment,{children:o.map((e,t)=>{let{type:o,format:a}=e,{color:u,use_remote_clor:d,weight:v,font_size:_,italic:m}=a||{},h=null==i?void 0:i(e);if(h)return h;let f=c[o];if(!f)return null;let{key:g,render:p}=f,y=e[g],b={fontSize:_||14,fontWeight:v,color:d&&u?(0,s.H)(u):void 0,fontStyle:m?"italic":void 0};return(0,r.jsx)(l.Fragment,{children:p(y,b,{onClick:t=>{null==n||n({event:t,piece:e})}})},`${g}-${t}`)})})}},664037:function(e,t,i){i.d(t,{a:function(){return o},w:function(){return n}});let n="INSERT_AT_USER_COMMAND",o="INSERT_EMOJI_COMMAND"},103013:function(e,t,i){i.d(t,{O:function(){return o},s:function(){return n}});let n="live_at_user",o="live_emoji"},355011:function(e,t,i){i.d(t,{tz:function(){return w},_i:function(){return N}}),i("874386");var n=i("563097"),o=i("158041"),r=i("110479"),l=i("88648"),s=i("914858"),a=i("664037"),u=i("379928"),d=i("797973"),c=i("96008"),v=i.n(c),_=i("545137"),m=i("56486"),h=i("161964"),f=i("509090"),g=i("520739"),p=i("368200");i("675373");var y=i("218805"),b=i("713097"),P=i.n(b),I="ZEuP5hVH",E=i("582746"),S=i("123011");let L="non_paste",C=(0,o.kr)({editor:null,insertAtUser:v(),insertEmoji:()=>!1,setEditor:v(),getTextInfo:()=>({plainText:"",rtfElements:[]}),isEmpty:!0,setIsEmpty:v(),markPaste:v(),markPasteEdit:v(),getPasteEditMethod:()=>L,resetPasteEditMethod:v()}),w=(0,l.memo)(e=>{let{children:t}=e,[i,o]=(0,l.useState)(null),[r,c]=(0,l.useState)(!1),v=(0,l.useRef)(L),b=(0,l.useRef)(!1),{roomStore:{foldChatroom:w,setFoldChatroom:N}}=(0,E.Z)(),k=(0,S.o)(),T=(0,u.Z)(async e=>{let{userInfo:t,triggerType:n}=e;if("number"==typeof(null==t?void 0:t.uid)&&(t.uid=String(t.uid)),!i)return;let o=(0,s.X9)(i.getContent()),r=()=>{w&&N(!1)},l=()=>{i.execCommand(a.w,t),k("livesdk_at_reply",{trigger_type:n,to_user_id:null==t?void 0:t.uid})},u=o&&(null==o?void 0:o.uid)===(null==t?void 0:t.uid)&&(null==o?void 0:o.webcastUid)===(null==t?void 0:t.webcastUid);if(o){if(u)r(),i.focus();else{if(!await function(e){let{title:t,className:i}=e,n=(0,p._)(e,["title","className"]);return new Promise(i=>{y.Modal.confirm((0,g._)({className:P()("noSemiGlobal","semi-always-dark",I,e.className),width:400,centered:!0,mask:!1,icon:null,title:t,okText:"确定",cancelText:"取消",onOk:()=>{i(!0)},onCancel:()=>{i(!1)},closeOnEsc:!0,getPopupContainer:()=>document.fullscreenElement||document.body,zIndex:1e5},n))})}({title:"单次只支持艾特一个人，艾特其他人会清空内容，是否继续？",width:600}))return;r(),i.reset(),l()}}else r(),l()},{leading:!0}).run,R=(0,d.Z)(e=>{let{emojiInfo:t,limitCount:n=3,onlyLimitActivity:o=!1}=e;return!!i&&((t.isActivity||!o)&&(0,h.jj)({deltaSet:i.getContent(),onlyActivity:o}).length>=n?(f.F.info(`最多可添加${n}个${o?"活动":""}表情`),!1):(i.execCommand(a.a,t),!0))}),x=(0,d.Z)(()=>{if(!i)return{plainText:"",rtfElements:[]};let{plainText:e,rtfElements:t}=(0,_.$U)(i);return{plainText:e,rtfElements:t}}),O=(0,d.Z)(()=>{v.current=L,b.current=!1}),A=(0,d.Z)(()=>{v.current="pure_paste",b.current=!1}),F=(0,d.Z)(()=>{if("pure_paste"===v.current){if(b.current){v.current="edit_with_paste";return}b.current=!0}}),M=(0,d.Z)(()=>v.current);(0,m.n)(i?T:void 0);let D=(0,l.useMemo)(()=>({editor:i,setEditor:o,insertAtUser:T,getTextInfo:x,insertEmoji:R,isEmpty:r,setIsEmpty:c,markPaste:A,markPasteEdit:F,getPasteEditMethod:M,resetPasteEditMethod:O}),[i,o,T,x,R,r,c,A,F,M,O]);return(0,n.jsx)(C.Provider,{value:D,children:t})}),N=(0,r.Z)(C)},161964:function(e,t,i){i.d(t,{Wi:function(){return r},jj:function(){return s}}),i(268917),i(874386);var n=i(103013);let o=e=>{var t;return null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[n.O]},r=e=>{try{var t;return JSON.parse((null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t[n.O])||"")}catch(e){return null}},l=e=>{var t;return o(e)&&!!(null===(t=r(e))||void 0===t?void 0:t.isActivity)},s=e=>{let{deltaSet:t,onlyActivity:i}=e,n=[];try{return t.forEach(e=>{let t=e.ops.filter(i?l:o);n.push(...t)}),n}catch(e){return n}}},123011:function(e,t,i){i.d(t,{o:function(){return s}});var n=i(520739),o=i(742740),r=i(983253),l=i(582746);function s(){let e=(0,l.Z)(),t=()=>{var t,i,n;let{linkmicStore:l,roomStore:s}=e||{},a=(null==l?void 0:l.linkRoomType)==="audio"?"voice_live":"";return{anchor_id:null==s?void 0:null===(t=s.roomInfo)||void 0===t?void 0:t.roomId,room_id:null==s?void 0:null===(n=s.roomInfo)||void 0===n?void 0:null===(i=n.anchor)||void 0===i?void 0:i.id_str,enter_from_merge:(0,o.yW)(),enter_method:(0,r.Rs)("enter_method"),request_id:(0,r.Rs)("request_id"),action_type:"click",liveType:a}};return(e,i)=>{var o,r;null===(o=(r=window).collectEvent)||void 0===o||o.call(r,e,(0,n._)({},t(),i))}}},24819:function(e,t,i){i.d(t,{Z:function(){return c}});var n=i(520739);i(179133),i(826893),i(413806);var o=i(32754),r=i(683849),l=i(578580),s=i(791483),a=i(527459),u=i(909543),d=i(588730);function c(){let e=(0,u.a)(),t=e=>{let{referrer:t}=document;-1>=t.indexOf("douyin.com")?(e.enter_from_merge="link_share",e.enter_method="direct_open"):e.enter_from_merge="page_refresh"};(0,s.C)(()=>{var i;if(!o._.find(t=>(0,a.m)(t,e.pathname)))return;let s={};try{let e=sessionStorage.getItem(r.UY);e?!(null==(s=JSON.parse(null!=e?e:"{}"))?void 0:s.enter_from_merge)&&t(s):t(s)}catch(e){l.kg.error("解析路由数据失败",e)}let u=(0,n._)({},null!==(i=window.__INVISIBLE_QUERY__)&&void 0!==i?i:{},s);window.__INVISIBLE_QUERY__=u;let{remainQuery:c,remainQueryString:v}=(0,d.It)(e.search.split("?")[1]);window.history.replaceState({},"",e.pathname+v),(u.enter_from_on_cellphone||u.enter_method_on_cellphone)&&(u.enter_from_merge="live_continue",u.enter_method=u.enter_method_on_cellphone,window.__INVISIBLE_QUERY__=u)},[])}},588730:function(e,t,i){i.d(t,{Bo:function(){return c},It:function(){return v}});var n=i(520739),o=i(878389);i(527785),i(927234),i(954372),i(826893),i(779788);var r=i(683849),l=i(567754),s=i(746309),a=i(565024),u=i(987475);let d=["enter_from_merge","enter_method","ug_source","material_group_id","resource_space_id",/^_transparent_/,"web_live_page","web_live_tab","web_live_tab_2","web_live_tab_3","more_detail","game_name","title_type","cover_type","is_recommend","stream_type","room_id","evening_type","search_params","action_type","previous_page","request_id","live_type","function_type","seat_fit_status","insert_task_id","live_reason","aspect_ratio","from_landscape_tab","group_id","is_livehead_preview_mini_window_show","enter_method_temai","show_rank","show_cnt","cid","msToken","if_paid_live_card","entrance_form","ticket_entrance","if_qianchuan_ad","ad_type","live_ad_creative_id","live_ad_id","X-Bogus","ad_log_extra","if_browser_limited","open_promotion_list","open_promotion_detail","message_from","video_id","mini_window_show_type","search_tab","live_position","url_source","xigua_webid","push_id","otherParams","enter_from_on_cellphone","enter_method_on_cellphone","is_replaced_live","preview_type","web_card_rank","show_type"],c=()=>{let{group_id:e=""}=window.__INVISIBLE_QUERY__||{};return e},v=e=>{try{let t=(0,l.parse)(e);try{let e=a.Q.getItem({sKey:u.CookieKeys.LiveInvisibleQuery});e&&(window.__INVISIBLE_QUERY__=(0,l.parse)(e))}catch(e){}let i=Object.keys(t).reduce((e,i)=>{if(d.some(e=>("[object RegExp]"===Object.prototype.toString.call(e)&&e.test(i)||"[object String]"===Object.prototype.toString.call(e)&&e===i)&&void 0!==t[i])){if("string"==typeof t[i])window.__INVISIBLE_QUERY__[i]=t[i];else if("object"==typeof t[i]){var r;(null===(r=t[i])||void 0===r?void 0:r.length)>0&&(window.__INVISIBLE_QUERY__[i]=t[i][t[i].length-1])}return e}return(0,o._)((0,n._)({},e),{[i]:t[i]})},{});sessionStorage.setItem(r.UY,JSON.stringify(window.__INVISIBLE_QUERY__));let s=Object.keys(i).length?`?${(0,l.stringify)(i)}`:"";return{remainQuery:i,remainQueryString:s}}catch(n){var t,i;return null===(i=(0,s.OK)())||void 0===i||null===(t=i.sendEvent)||void 0===t||t.call(i,{name:"filterAndUpdateInvisibleQuery_error",categories:{error:n,queryString:e},type:"event"}),{remainQuery:{},remainQueryString:""}}}},678315:function(e,t,i){i.d(t,{IT:function(){return o},hp:function(){return n},ie:function(){return r},nz:function(){return l}}),i(927234),i(527785),i(675373),i(874386),i(352982),i(309931);async function n(e){var t;let{pipId:i,width:n,height:o}=e,r=await documentPictureInPicture.requestWindow({width:n,height:o});return r.name=i,t=r,Array.from(document.styleSheets).forEach(e=>{try{let i=Array.from(e.cssRules).map(e=>e.cssText).join(""),n=document.createElement("style");n.textContent=i,t.document.head.appendChild(n)}catch(n){let i=document.createElement("link");if(null===e.href)return;i.rel="stylesheet",i.type=e.type,i.media=e.media.toString(),i.href=e.href,t.document.head.appendChild(i)}}),!function(e){let t=new MutationObserver(t=>{try{let i=t.reduce((e,t)=>"childList"!==t.type?e:e.concat(Array.from(t.addedNodes).filter(e=>e instanceof HTMLLinkElement||e instanceof HTMLStyleElement)),[]);if(0===i.length)return;let n=document.createDocumentFragment();i.forEach(e=>n.appendChild(e.cloneNode())),e.document.head.appendChild(n)}catch(e){}});t.observe(document.head,{attributes:!1,characterData:!1,characterDataOldValue:!1,childList:!0,subtree:!1}),e.addEventListener("pagehide",()=>{t.disconnect()})}(r),r}let o=e=>{var t,i;return"undefined"!=typeof window&&(null===(i=window.documentPictureInPicture)||void 0===i?void 0:null===(t=i.window)||void 0===t?void 0:t.name)===e};function r(){if("undefined"==typeof document)return;let e=document.createElement("div");return e.classList.add("pip-anchor"),e}function l(){try{let{innerHeight:e,outerHeight:t}=documentPictureInPicture.window;return t-e>4}catch(e){return!1}}},40335:function(e,t,i){i.d(t,{K:function(){return s}}),i(874386);var n=i(88648),o=i(888163),r=i(594235),l=i(725887);let s=()=>{var e;let[t,i]=(0,n.useState)((null===(e=l.Le.getConfig(l.gI.TccData))||void 0===e?void 0:e[o.TccKey.PcRechargeConfig])||o.TCC_DEFAULT_VALUE_MAP.get(o.TccKey.PcRechargeConfig));return(0,n.useEffect)(()=>{let e=!1;return(async()=>{let t=await r.get({key:o.TccKey.PcRechargeConfig,defaultValue:o.TCC_DEFAULT_VALUE_MAP.get(o.TccKey.PcRechargeConfig)});!e&&i(t)})(),()=>{e=!0}},[]),{rechargeConfig:t}}},134221:function(e,t,i){i.d(t,{K:function(){return y}});var n=i(417194),o=i(737271),r=i(308253),l=i(265656),s=i(441447),a=i(725887),u=i(828782),d=i(987475),c=i(565024),v=i(328555),_=i(818538),m=i(582296);let h={live:"force_login_live",directVideo:"force_login_direct_video",video:"force_login_video"};function f(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.CookieKeys.RecordForceLogin,o={timestamp:Date.now(),force_login_video:0,force_login_live:0,force_login_direct_video:0};o[e]++;try{let r=c.Q.getItem({sKey:i});if(!r)return c.Q.setItem(i,o),o;return(!t&&!(0,n.KC)(r.timestamp)||t&&!(0,n.fu)(r.timestamp))&&(r.force_login_video=0,r.force_login_live=0,r.force_login_direct_video=0,r.timestamp=Date.now()),r[e]++,c.Q.setItem(i,r),r}catch(e){return c.Q.setItem(i,o),o}}function g(e){let{scene:t,forceLoginCallback:i,enterMethod:n,teaEvtParams:a}=e;(0,o.r)()&&(0,r._)(),(0,l.aI)()&&(0,_.a)(),(0,m.default)({headerText:"live"===t?"登录后即可畅享超清直播":"登录后即可观看更多精彩视频",enterMethod:n||("live"===t?"force_login_live":"force_login"),showClose:!1,showFeedback:!0,teaEvtParams:a,success:()=>{window.location.reload()}}),clearTimeout(p),p=setTimeout(()=>{("directVideo"===t||"video"===t)&&s.emit(s.EVENT.videoPause,"recordForceLogin"),i&&(null==i||i())},300)}let p="",y=e=>{var t,i;let{scene:n="video",isLogin:o=!0,location:r,forceLoginCallback:l}=e||{},{isLogin:s=o}=a.Le.getConfig(a.gI.AnnieXUserInfo)||{};!function(e){var t,i;let n=(null===(i=a.Le.getConfig(a.gI.AbtestData))||void 0===i?void 0:null===(t=i.forceLoginSelect)||void 0===t?void 0:t.v3)||0,o="medium"===v.cr.getState().userRiskLevel;if(!n||e||(0,u.tq)()||!o)return;let r=f("force_login_video",!1,d.CookieKeys.RecordForceLoginSelect);(null==r?void 0:r.force_login_video)>=n&&g({scene:"video",enterMethod:"force_login_medium_user",teaEvtParams:{risk_reason:v.cr.getState().userRiskReason}})}(s);let c=(null===(t=a.Le.getConfig(a.gI.AbtestData))||void 0===t?void 0:t.forceLoginHourly)||0,_=(null===(i=a.Le.getConfig(a.gI.AbtestData))||void 0===i?void 0:i.forceLoginDaily)||0||c;if(!_)return;let{cityName:m}=v.cr.getState(),p=(r?null==_?void 0:_[r]:null==_?void 0:_[m])||(null==_?void 0:_.default),y=h[n],b=null==p?void 0:p[y];if(s||!b||(0,u.tq)())return;let P=f(y,!!c);(null==P?void 0:P[y])>=b&&g({scene:n,forceLoginCallback:l})}},431053:function(e,t,i){i.d(t,{$I:function(){return a},Fp:function(){return u},yr:function(){return s}}),i(250440),i(874386);var n=i(88648),o=i(725887),r=i(742740),l=i(586979);let s=e=>{try{if(performance.getEntriesByName("recommend_mounted").length>0){var t,i,n,s;performance.mark("recommend_video_play"),performance.measure("recommendMountedToPlay","recommend_mounted","recommend_video_play");let a=null===(t=performance.getEntriesByName("recommendMountedToPlay")[0])||void 0===t?void 0:t.duration,u=null!==(i=o.Le.getConfig(o.gI.PageEntered))&&void 0!==i?i:[],d=!u.includes(location.pathname);d&&o.Le.setConfig(o.gI.PageEntered,[...u,location.pathname]),!isNaN(a)&&l.i.sendLog("recommendFirstVideoPlay",{cost:Math.floor(a),from_cache:null!==(n=null==e?void 0:e.fromCache)&&void 0!==n?n:0,is_first:d?1:0,path:location.pathname,enter_from:(0,r.yW)(),is_live:null!==(s=null==e?void 0:e.isLive)&&void 0!==s?s:0}),performance.clearMarks("recommend_mounted"),performance.clearMarks("recommend_video_play"),performance.clearMeasures("recommendMountedToPlay")}}catch(e){}},a=e=>{(0,n.useEffect)(()=>(performance.mark("multi_page_mounted"),()=>{performance.getEntriesByName("multi_page_mounted").length>0&&performance.clearMarks("multi_page_mounted")}),[e])},u=()=>{try{if(performance.getEntriesByName("multi_page_mounted").length>0){var e;performance.mark("page_available"),performance.measure("mountedToAvailable","multi_page_mounted","page_available");let t=null===(e=performance.getEntriesByName("mountedToAvailable")[0])||void 0===e?void 0:e.duration;!isNaN(t)&&l.i.sendLog("pageMountedToAvailable",{cost:Math.floor(t),path:location.pathname}),performance.clearMarks("multi_page_mounted"),performance.clearMarks("page_available"),performance.clearMeasures("mountedToAvailable")}}catch(e){}}},839321:function(e,t,i){i.d(t,{m:function(){return a},w:function(){return s}});var n=i(520739);i(675373);var o=i(576660),r=i(66863);let{COMMON_SEARCH_PARAMS:l}=o||{};async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=await (0,r.v_)("/aweme/v1/web/commit/dislike/item/",(0,n._)({aweme_id:e},l),{aweme_id:e}),i=t.status_code;return{statusCode:i,errMsg:0===i||t.status_msg?t.status_msg:"啊哦，服务器打瞌睡了"}}async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=await (0,r.v_)("/aweme/v1/web/dislike/dimension/update/",(0,n._)({aweme_id:e,block_type:2},l),{aweme_id:e}),i=t.status_code;return{statusCode:i,errMsg:0===i||t.status_msg?t.status_msg:"啊哦，服务器打瞌睡了"}}},217110:function(e,t,i){i.d(t,{FF:function(){return p},HN:function(){return y},Lz:function(){return C},MQ:function(){return S},Zl:function(){return L},iv:function(){return P},nQ:function(){return b},vf:function(){return E}});var n=i(520739),o=i(878389);i(779788),i(675373);var r=i(832052),l=i(768492),s=i(742740),a=i(576660),u=i(842602),d=i(66863);let{COMMON_SEARCH_PARAMS:c,CHANNEL_PC_WEB:v}=a||{};function _(e){let{aweme_list:t,has_more:i,item_id_to_episode:n,status_code:o,cursor:r,log_pb:l}=e,s={};try{s=JSON.parse(n)}catch(e){}return{logPb:l&&JSON.stringify(l),itemIdToEpisode:s,statusCode:o||0,hasMore:i,cursor:r,data:(0,u.TN)({awemeList:t||[],logPb:l&&JSON.stringify(l)})||[]}}function m(e){let{aweme_list:t,has_more:i,status_code:n,max_cursor:o,log_pb:r}=e;return{logPb:r&&JSON.stringify(r),statusCode:n||0,hasMore:i,cursor:o,data:(0,u.TN)({awemeList:t||[],logPb:r&&JSON.stringify(r)})||[]}}function h(e){let{mix_infos:t,has_more:i,status_code:n,cursor:o,total:r,log_pb:l}=e;return{statusCode:n,hasMore:i,cursor:o,total:r,logPb:l&&JSON.stringify(l),data:(0,u.NR)(t||[])}}function f(e){let{extra:t,logId:i,log_pb:n,status_code:o,status_msg:r}=e,l="";try{l=JSON.stringify(n)}catch(e){}return{extra:t,logId:i,logPb:l,statusCode:o,statusMsg:r}}function g(e){let{extra:t,logId:i,log_pb:n,status_code:o,status_msg:r}=e,l="";try{l=JSON.stringify(n)}catch(e){}return{extra:t,logId:i,logPb:l,statusCode:o,statusMsg:r}}async function p(e){let{mixId:t,cursor:i,count:r=12,mixScene:l}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=await (0,d.U2)("/aweme/v1/web/mix/aweme/",(0,o._)((0,n._)({},c),{mix_id:t,cursor:Math.max(i,0),count:r,mix_scene:l}),{errorTags:{mixId:t}},void 0,s,{}),v=(0,u.RL)(a,_);return(null==v?void 0:v.data)&&v.data.forEach(e=>{e.logPb=v.logPb}),v}async function y(e){let{uid:t,cursor:i=0,count:r=12,listScene:l}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=await (0,d.U2)("/aweme/v1/web/mix/list/",(0,o._)((0,n._)({},c),{sec_user_id:t,req_from:v,cursor:i,count:r,list_scene:l}),{errorTags:{uid:t}},void 0,s,{});return(0,u.RL)(a,h)}function b(e,t,i){var n,o,a,u;let{currentEpisode:d}=(null==i?void 0:null===(n=i.seriesInfo)||void 0===n?void 0:n.seriesId)?null==i?void 0:i.seriesInfo:(null==i?void 0:i.mixInfo)||{},{data:c,currentEpisode:v}=(null==i?void 0:null===(o=i.seriesInfo)||void 0===o?void 0:o.seriesId)?t:e||{};if(v!==d)return!1;if(null==c?void 0:c.length){for(let e=0;e<c.length;e++)if((null===(a=c[e])||void 0===a?void 0:a.mixInfo.currentEpisode)===v&&(null==c?void 0:null===(u=c[e+1])||void 0===u?void 0:u.awemeId)){let t=null==c?void 0:c[e+1];return{awemeId:null==t?void 0:t.awemeId,url:(null==t?void 0:t.awemeType)===r.e.Note?(0,l.Wr)(null==t?void 0:t.awemeId,`previous_page=${(0,s.yW)()||""}`):(0,l.$N)(null==t?void 0:t.awemeId,`previous_page=${(0,s.yW)()||""}`),img:null==t?void 0:t.video.cover,desc:`第${null==t?void 0:t.mixInfo.currentEpisode}集 | ${null==t?void 0:t.desc}`}}}return!1}async function P(e){let{mixId:t,totalEpisode:i,currentEpisode:n,count:o}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=Math.max(Math.min(n-1,i-o),0),{statusCode:s,data:a,hasMore:u,cursor:d,logPb:c}=await p({mixId:t,cursor:l,count:o},r);return{mixId:t,statusCode:s,data:a,currentEpisode:n,hasMore:u,cursor:0===s?d:l,logPb:c}}function I(e){let{mix_info:t,status_code:i,log_pb:n}=e;return{mixInfo:(0,u.BH)(t),statusCode:i,logPb:n}}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:i}=e,r=await (0,d.U2)("/aweme/v1/web/mix/detail/",(0,o._)((0,n._)({},c),{mix_id:i,req_from:v}),{},void 0,t,{});return(0,u.RL)(r,I)}async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:i,action:r}=e,l=await (0,d.U2)("/aweme/v1/web/mix/collect/",(0,o._)((0,n._)({},c),{mix_id:i,action:r}),{},void 0,t,{});return(0,u.RL)(l,f)}async function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:i,episode:r,awemeId:l,scene:s}=e,a=await (0,d.U2)("/aweme/v1/web/mix/watch/record/",(0,o._)((0,n._)({},c),{mix_id:i,episode:r,item_id:l,scene:s}),{},void 0,t,{});return(0,u.RL)(a,g)}async function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{albumId:i,cursor:r,count:l=12,pullType:s=2}=e,a=await (0,d.U2)("/aweme/v1/web/minor/album/items/",(0,o._)((0,n._)({},c),{album_id:i,count:l,pull_type:s,cursor:r}),{},void 0,t,{});return(0,u.RL)(a,m)}},62706:function(e,t,i){i.d(t,{T:function(){return u},a:function(){return a}});var n=i(520739),o=i(878389);i(675373);var r=i(576660),l=i(66863);let{COMMON_SEARCH_PARAMS:s}=r||{},a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return await (0,l.v_)("/aweme/v1/web/familiar/recommend/submit",(0,o._)((0,n._)({},s),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0,is_friend_recommend:t},{})},u=async e=>await (0,l.v_)("/aweme/v1/web/familiar/recommend/cancel",(0,o._)((0,n._)({},s),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0},{})},970973:function(e,t,i){i.d(t,{A4:function(){return L},DS:function(){return E},Id:function(){return P},NN:function(){return v},Rh:function(){return h},XL:function(){return b},bV:function(){return C},fd:function(){return g},v6:function(){return _}});var n=i(520739),o=i(878389);i(779788),i(675373);var r=i(576660),l=i(3254),s=i(842602),a=i(66863),u=i(87758);let{COMMON_SEARCH_PARAMS:d}=r||{};function c(e){let{aweme_list:t=[],status_code:i,log_pb:n,position:o,is_force_insert:r=!1}=e;return{statusCode:i,position:o,isForceInsert:r,hasMore:!0,awemeList:(0,s.TN)({awemeList:t||[],logPb:n&&JSON.stringify(n)}),logPb:n&&JSON.stringify(n)}}async function v(){let{tagId:e="",count:t=10,refreshIndex:i=1,globalwid:r="",pullType:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,v=await (0,a.U2)("/aweme/v1/web/tab/feed/",(0,o._)((0,n._)({},d),{tag_id:e,count:t,refresh_index:i,video_type_select:1,globalwid:r,pull_type:l}),{errorTags:{tagId:e}},void 0,u,{});return(0,s.RL)(v,c)}async function _(e){let{count:t=10,refreshIndex:i=1,scene:r="recommend"}=e||{},l=await (0,a.v_)("/aweme/v2/web/tab_listen/feed/",(0,o._)((0,n._)({},d),{count:t,pull_type:2,refresh_index:i,web_listen_feed_scene:r}),{},void 0,null);return(0,s.RL)(l,c)}function m(e){let{status_code:t,log_pb:i,ch_info:n}=e;return{statusCode:t,info:(0,s.P$)(n),logPb:i&&JSON.stringify(i)}}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{chId:i,queryType:r=0}=e,l=await (0,a.U2)("/aweme/v1/web/challenge/detail/",(0,o._)((0,n._)({},d),{ch_id:i,query_type:r}),{},void 0,t,{});return(0,s.RL)(l,m)}function f(e){let{aweme_list:t=[],status_code:i,log_pb:n,has_more:o,cursor:r}=e;return{statusCode:i,awemeList:(0,s.TN)({awemeList:t||[],logPb:n&&JSON.stringify(n)}),logPb:n&&JSON.stringify(n),hasMore:o,cursor:r}}async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{chId:i,hashtagName:r,queryType:l=0,sortType:c=u.H.Comprehensive,count:v,cursor:_,isCommerce:m=!1}=e,h=await (0,a.U2)(m?"/aweme/v1/web/commerce/challenge/aweme/":"/aweme/v1/web/challenge/aweme/",(0,o._)((0,n._)({},d),{ch_id:i,hashtag_name:r,query_type:l,sort_type:m?0:c,offset:_,cursor:_,count:v}),{},void 0,t,{});return(0,s.RL)(h,f)}function p(e){let{music_info:t,status_code:i,log_pb:n}=e;return{statusCode:i,musicInfo:(0,s.o0)(t),logPb:n&&JSON.stringify(n)}}function y(e){let{music_info:t,status_code:i,log_pb:n,msg:o,res_list:r,extra:l}=e,s="";try{s=JSON.stringify(n)}catch(e){}return{musicInfo:t,statusCode:i,logPb:s,msg:o,resList:r,extra:l}}async function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{musicId:i,scene:r=1}=e,l=await (0,a.U2)("/aweme/v1/web/music/detail/",(0,o._)((0,n._)({},d),{music_id:i,scene:r}),{},void 0,t,{});return(0,s.RL)(l,p)}async function P(e){let{musicId:t,action:i}=e,o=await (0,a.v_)("/aweme/v1/web/music/collect/",(0,n._)({},d),{music_id:t,type:i,action:i},void 0,null);return(0,s.RL)(o,y)}function I(e){let{aweme_list:t=[],status_code:i,log_pb:n,has_more:o,cursor:r}=e;return{statusCode:i,awemeList:(0,s.TN)({awemeList:t||[],logPb:n&&JSON.stringify(n)}),logPb:n&&JSON.stringify(n),hasMore:o,cursor:r}}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{musicId:i,count:r=10,cursor:l}=e,u=await (0,a.U2)("/aweme/v1/web/music/aweme/",(0,o._)((0,n._)({},d),{count:r,cursor:l,music_id:i}),{},void 0,t,{});return(0,s.RL)(u,I)}function S(e){let{extra:t,cursor:i,status_code:n,has_more:o,challenge_list:r=[],qs:l,is_match:a,keyword_disabled:u}=e;return{statusCode:n,hasMore:o,challengeList:(null==r?void 0:r.map(e=>(0,s.P$)(null==e?void 0:e.challenge_info)))||[],qs:l,isMatch:a,cursor:i,keywordDisabled:u,extra:{now:null==t?void 0:t.now,logid:null==t?void 0:t.logid}}}async function L(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{keyword:i,count:r=10,cursor:l}=e,u=await (0,a.U2)("/aweme/v1/web/challenge/search/",(0,o._)((0,n._)({},d),{count:r,cursor:l,keyword:i}),{},void 0,t,{});return(0,s.RL)(u,S)}async function C(){let{scene:e=l.t.PcOftenWatch,ids:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],0===t.filter(e=>e).length)return;let i=await (0,a.v_)("/aweme/v1/web/write/impression/",(0,n._)({},d),{scene:e,ids:t.join(" ")});return(0,s.RL)(i,c)}},971475:function(e,t,i){var n=i(563097);i(88648);var o=i(61850),r=i(520339),l=i(509090);t.Z=(0,o.Pi)(e=>{let{onClick:t,emojiTea:i}=e,{roomStore:{activityEmojiGroup:o}}=(0,r.oR)();return o&&0!==o.length?(0,n.jsx)("div",{children:o.map(e=>(0,n.jsxs)("div",{className:"emoji-panel__common",children:[(0,n.jsx)("h3",{children:e.emoji_group.name}),(0,n.jsx)("div",{className:"emoji-panel__common_group_list",children:e.emoji_group.emoji_list.map(o=>(0,n.jsx)("div",{className:"img-item-wrap",children:(0,n.jsx)("img",{className:"img-item",src:o.emoji.url_list[0],onClick:()=>{var n,r,s;if(null==i||i.livesdkEmojiClick({tab_title:null==e?void 0:null===(n=e.emoji_group)||void 0===n?void 0:n.name,emoji_type:"tab_activity",emoji_name:`[${e.emoji_group.name}_${o.name}]`}),Number(e.end_time)<new Date().getTime()/1e3){l.F.info("活动已结束，该表情不可用");return}t&&t({display_name:`[${e.emoji_group.name}_${o.name}]`,emojiId:null==o?void 0:o.id_str,isEmojiGroup:!0,url:null==o?void 0:null===(s=o.emoji)||void 0===s?void 0:null===(r=s.url_list)||void 0===r?void 0:r[0]})}})},o.name))})]},e.emoji_group.name))}):null})},921028:function(e,t,i){i.d(t,{E:function(){return P}});var n=i("563097"),o=i("88648");i("706652");var r=i("713097"),l=i.n(r),s=i("520339"),a=i("96166"),u=i("618618"),d=i("386184"),c=i("509090"),v=i("851190"),_=i("520739"),m=i("878389");let h=(0,o.forwardRef)((e,t)=>(0,n.jsx)("svg",(0,m._)((0,_._)({xmlns:"http://www.w3.org/2000/svg",width:7,height:9,fill:"none",ref:t},e),{children:(0,n.jsx)("path",{d:"M1.574 3.585v-.81a2.025 2.025 0 1 1 4.05 0v.81h.405a.81.81 0 0 1 .81.81V8.04a.81.81 0 0 1-.81.81H1.17a.81.81 0 0 1-.81-.81V4.395a.81.81 0 0 1 .81-.81h.405zm3.24-.81a1.215 1.215 0 1 0-2.43 0v.81h2.43v-.81z",fill:"currentColor"})})));var f=i("645260"),g=i.n(f),p=i("877639"),y=i.n(p),b=i("558452");let P=e=>{var t,i,r;let{}=e,{vipStore:{vipEmojiConfig:l,setIsShowVipPanel:_,isVip:m},vipStore:h,roomStore:{roomInfo:f},singletonStore:{message:p}}=(0,s.oR)(),y=(0,o.useRef)(null),P=(0,o.useCallback)(()=>{document.dispatchEvent(new MouseEvent("click"))},[]),E=async e=>{P();let{data:t}=await (0,a.W)({room_id_str:null==f?void 0:f.roomId,episode_id:g()(f,"room.episode_extra.episode_id_str"),stage:g()(f,"room.episode_extra.mod.episode_stage"),type:3,emoji_id:e,content:""});switch(t.status_code){case u.Ze.SUCCESS:null==p||p.queuePush((0,d.Wd)(t.data));break;case u.Ze.MUTE:c.F.info(t.data.prompts||"你已被禁言");break;case u.Ze.WORD_LIMITED:c.F.info(t.data.prompts||"超出字数限制");break;default:c.F.info(t.data.prompts||"服务出现异常")}},S=(0,o.useRef)();return o.useEffect(()=>{if(S.current){let e=e=>{var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e)};return S.current.addEventListener("wheel",e),()=>{var t,i;null===(i=S.current)||void 0===i||null===(t=i.removeEventListener)||void 0===t||t.call(i,"wheel",e)}}},[]),(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"vip-emoji-panel-wrapper",ref:y,children:[m?null:(0,n.jsxs)("div",{className:"vip-emoji-subscribe",children:[(0,n.jsx)("span",{children:"开通会员后可使用以下表情"}),(0,n.jsx)(v.zx,{size:"small",onClick:()=>{P(),(0,b.Z)("subscribe_emoji_panel")},style:{height:"24px",fontSize:"12px",padding:"0 8px",margin:"0",minWidth:"auto"},children:null==h?void 0:null===(i=h.vipEmojiConfig)||void 0===i?void 0:null===(t=i.emoji_tab_info)||void 0===t?void 0:t.btn_text})]}),(0,n.jsx)("div",{className:"vip-emoji-item-list-wrapper",ref:S,children:null==l?void 0:null===(r=l.emoji_list)||void 0===r?void 0:r.map((e,t)=>(0,n.jsx)(o.Fragment,{children:(0,n.jsx)(I,{locked:!m,config:e,containerRef:y,onSendEmoji:E})},t))})]})})},I=e=>{var t,i;let{locked:o,config:r,containerRef:s,onSendEmoji:a}=e,u=(e,t)=>{if(o)return e.stopPropagation(),c.F.info({text:"开通直播间会员后可使用以下表情",className:"emoji-panel__emoji-toast"},s,2e3);null==a||a(t)};return(0,n.jsxs)("div",{className:l()("vip-emoji-item",o?"disabled":""),onClick:y()(e=>u(e,r.id),2e3),children:[o?(0,n.jsx)(h,{className:"vip-emoji-icon-block"}):null,(0,n.jsx)("img",{src:null==r?void 0:null===(i=r.img)||void 0===i?void 0:null===(t=i.url_list)||void 0===t?void 0:t[0],alt:null==r?void 0:r.text})]})}},7981:function(e,t,i){i.d(t,{Z:function(){return s}}),i("874386");var n=i("563097"),o=i("88648"),r=i("713097"),l=i.n(r),s=e=>{let{items:t,defaultActiveKey:i,activeKey:r}=e,[s,a]=(0,o.useState)(i);return(0,o.useEffect)(()=>{a(r)},[r]),(0,n.jsxs)("div",{className:"tabs-wrapper",children:[(0,n.jsx)("div",{className:"tabs-nav-list-wrapper",children:null==t?void 0:t.map(e=>(0,n.jsx)("div",{onClick:t=>{t.stopPropagation(),a(e.key)},className:l()("tabs-nav-list-item",e.key===s?"active":""),children:e.label},e.key))}),(0,n.jsx)("div",{className:"tabs-nav-panel-list-wrapper",children:null==t?void 0:t.map(e=>(0,n.jsx)("div",{className:l()("tabs-nav-panel-item",e.key===s?"active":"inActive"),children:e.children},e.key))})]})}},605430:function(e,t,i){i.d(t,{u:function(){return r}});var n=i(88648);let o=n.createContext({display:!1,input:!1,map:{},list:[],icon:"",showEmoji:!1,setShowEmoji:()=>{}}),r=()=>n.useContext(o);t.Z=o},520339:function(e,t,i){i.d(t,{FD:function(){return j},cT:function(){return Z},DQ:function(){return G},oR:function(){return M},od:function(){return V},t:function(){return U},_i:function(){return D}}),i("874386");var n=i("355011"),o=i("591265"),r=i("582746"),l=i("818597"),s=i("782580"),a=i("774444"),u=i("569541"),d=i("159488"),c=i("123011"),v=i("639272"),_=i("951320"),m=i("520739"),h=i("878389"),f=i("368200");i("675373");var g=i("563097"),p=i("88648"),y=i("338426"),b=i("315985"),P=i("817938"),I=i("155845"),E=i("246647"),S=i("243321"),L=i("713097"),C=i.n(L),w=i("517054"),N=i("740824"),k={commentEditorWrap:"_JaLZP3V",focus:"jMp9QX7x",focusOrNoEmpty:"WpjpX0o_",danmakuSwitch:"mtIBQnaR",commentEditor:"FhIBByiy"};let T=(0,y.ZP)(()=>Promise.all([i.e("22556"),i.e("23145"),i.e("21248"),i.e("11073"),i.e("8734")]).then(i.bind(i,36764)),{ssr:!1});function R(e){let t=(0,p.useRef)(null),[i,n]=(0,p.useState)(!1);(0,b.Z)(()=>n(!1),t);let{maxLength:r,placeholder:l,disabled:s,className:a,onSend:u}=e,d=(0,f._)(e,["maxLength","placeholder","disabled","className","onSend"]),{enablePrivilegeDanmu:c,showPrivilegePanel:v}=(0,w.B3)(e=>({enablePrivilegeDanmu:e.enable,showPrivilegePanel:e.showPanel})),_=(0,o._i)(e=>e.editor),y=(0,o._i)(e=>e.isEmpty),E=(0,P.Z)(null==_?void 0:_.getRootContainer());(0,I.Z)("enter",e=>{E&&(e.preventDefault(),null==u||u())},{exactMatch:!0,useCapture:!0});let S=(0,w.MW)()||l;return(0,g.jsxs)("div",(0,h._)((0,m._)({},d),{className:C()(a,k.commentEditorWrap,E&&k.focus,(i||E||!y||v)&&k.focusOrNoEmpty),onClick:()=>{n(!0),null==_||_.focus()},"data-e2e":"live-chatting",ref:t,children:[c&&(0,g.jsx)(N.K,{className:k.danmakuSwitch}),(0,g.jsx)(T,{editable:!s,placeholder:S,maxLength:v?15:r,className:k.commentEditor})]}))}let x=(0,p.memo)(e=>(0,g.jsx)(S.k,{componentName:E.l.COMMENT_EDITOR,children:(0,g.jsx)(R,(0,m._)({},e))}));var O=i("611703"),A=i("529437");let F=e=>{let{oldFn:t,newFn:i}=e;return function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];let r=t(...n),l=i(...n);return(0,s.useInNewProjectAB)()||(0,s.useInNewProjectPreviewAB)()?l:r}},M=F({oldFn:r.Z,newFn:l.o}),D=F({oldFn:n._i,newFn:o._i}),G=F({oldFn:a.DQ,newFn:()=>({})}),j=F({oldFn:u.FD,newFn:d.FD}),V=F({oldFn:c.o,newFn:v.o}),U=F({oldFn:()=>_.S,newFn:()=>x}),Z=F({oldFn:()=>O.l,newFn:()=>A.l})},39072:function(e,t,i){var n=i(520739),o=i(878389),r=i(563097),l=i(88648);let s=(0,l.forwardRef)((e,t)=>(0,r.jsx)("svg",(0,o._)((0,n._)({width:19,height:18,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,r.jsx)("path",{d:"M9.5 5.124v-.001m0 0a4.098 4.098 0 0 0-3.067-1.41c-2.1 0-3.75 1.634-3.75 3.714 0 2.547 2.307 4.623 5.802 7.77l.027.025.574.513a.618.618 0 0 0 .412.158M9.5 5.123h-.002m.002 0a4.098 4.098 0 0 1 3.066-1.41c2.1 0 3.75 1.634 3.75 3.714 0 2.547-2.306 4.623-5.802 7.77l-.027.025-.574.513a.618.618 0 0 1-.415.158m0 0h.003M7.02 7.431l2.48 3.718 2.478-3.718",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})})));t.Z=s}}]);