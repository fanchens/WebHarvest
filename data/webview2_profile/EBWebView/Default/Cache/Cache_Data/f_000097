"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["77734"],{504625:function(e,t){t.Z={switch:"tMqkS46E",checked:"_Ioc3QzW"}},632168:function(e,t){t.Z={full:"aWUFxyvW",enterRoom:"lPOF_UNl",loaded:"_ISFVfJd",enterRoomIcon:"X8tZCAb3"}},805652:function(e,t){t.Z={liveTitle:"LgHq3PbL",text:"zV4wzltK",userCount:"zBxhJBXm"}},541671:function(e,t){t.Z={livingPlayer:"MR5iyRn7",hideLoadingAndControl:"KnGa6bTq",appOnly:"j54OJYbU",layoutCommon:"O9ENko9T",layoutLike:"HWXkuQI4",basicPlayerPip:"ujvi6Ali",isImmersive:"Lq7W1XKA"}},773768:function(e,t){t.Z={container:"elRUuzsS",toolbar:"PI6ImCXQ",menu:"if7C8ipZ",tags:"L5MQ4Qvg",tips:"yaQJImEq",label:"DS6IBtKl",goDownload:"xyK16f29",text:"IUilDqvc",picked:"h5ykWpRZ",show:"M2TwwxDB",hidden:"N9ADC7YB"}},980981:function(e,t){t.Z={app_only:"JLqHnzHG",content:"fElrJFEA",qrcode:"JwQhs9jY",toast:"HGRdqyVW",guide:"J5f5nA69",scan_icon:"WdeRd8G1"}},279775:function(e,t,n){let i;n.r(t),n.d(t,{default:function(){return e3}}),n("179133"),n("826893"),n("874386"),n("250440");var r=n("563097"),o=n("88648"),l=n("567754"),a=n("909543"),s=n("553542"),u=n("782580"),_=n("400582"),c=n("632766"),d=n("700177"),E=n("582746"),m=n("746309"),h=n("236603"),v=n("737466"),I=n("472434"),f=n("981116"),P=n("57350"),L=n("495123"),T=n("167951"),N=n("504229"),S=n("63405"),p=n("24819"),g=n("861396"),C=n("57718"),y=n("94680"),A=n("719469"),R=n("487330"),O=n("273312"),b=n("780977"),w=n("289228"),k=n("520739"),Y=n("878389"),V=n("459198"),U=n("818597"),x=n("945388"),K=n("528898"),M=n("40699"),Z=n("713097"),D=n.n(Z),j=n("128231"),F=n.n(j),G=n("755262"),H=n("714102"),W=n("441447"),B=n("53562");(0,B.Pi)(function(e){let{domain:t,pathname:n,children:i,isDetail:o}=e,l=(0,U.o)(),{forceTheme:a,hideErrorStyle:s,showFooter:u}=l.layoutStore;return(0,r.jsxs)("div",{className:D()(M.Z.scroll,a,{[M.Z.detailScroll]:o}),id:K.IS,ref:e=>t===x.LIVE_XIGUA_DOMAIN&&W.emit(W.EVENT.globalScrollEl,e),onScroll:F()(e=>{var t,n,i,r;(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.scrollTop)!==void 0&&W.emit(W.EVENT.tabContainerScroll,{tab:"live",scrollTop:null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.scrollTop}),(null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.scrollTop)>200&&(null==l||null===(r=l.appStore)||void 0===r||r.setHomeNeedIntial(!0))},20),children:[(0,r.jsx)("div",{className:D()({[M.Z.xiguaNormal]:t===x.LIVE_XIGUA_DOMAIN&&!(0,G.H)(n,t),[M.Z.xiguaPadding]:(0,G.H)(n,t),[M.Z.error]:s,[M.Z.loadingStyle]:o}),children:i}),u&&(0,r.jsx)(H.$,{})]})});let Q=(0,B.Pi)(function(e){let{children:t}=e,{pathname:n}=(0,a.a)(),i=n.includes("/live/"),o=i?D()(M.Z.scroll,{[M.Z.detailScroll]:!0}):"";return(0,r.jsx)("div",{className:o,id:K.IS,style:i?{}:{display:"contents"},children:t})});var q=n("134761");n("954372");var $=n("742401"),X=n("869718"),z=n("516136"),J=n("611651"),ee=n("413435"),et=n("668363"),en=n("31543"),ei=n("738299"),er=n("789113"),eo=n("94659"),el=n("104013");class ea extends eo.Z{get audiencePanelStatus(){return this.audienceTccStatus}get audienceStatus(){return this.audienceSwitchStatus&&this.audienceAuthStatus}constructor(){super(),(0,q._)(this,"audienceSwitchStatus",!0),(0,q._)(this,"audienceAuthStatus",!1),(0,q._)(this,"audienceTccStatus",!1),(0,q._)(this,"audienceSelectTab",30),(0,q._)(this,"showEntrance",!1),(0,q._)(this,"onlineScore1000Num",0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{audienceSwitchStatus:el.observable,audienceAuthStatus:el.observable,audienceTccStatus:el.observable,audienceSelectTab:el.observable,showEntrance:el.observable,onlineScore1000Num:el.observable,audiencePanelStatus:el.computed,audienceStatus:el.computed,setAudienceSwitchStatus:el.action,setAudienceAuthStatus:el.action,setAudienceTccStatus:el.action,setAudienceSelectTab:el.action,setShowEntrance:el.action,setOnlineScore1000Num:el.action})}),(0,q._)(this,"setAudienceSelectTab",e=>this.audienceSelectTab=e),(0,q._)(this,"setShowEntrance",e=>this.showEntrance=e),(0,q._)(this,"setOnlineScore1000Num",e=>this.onlineScore1000Num=e),(0,q._)(this,"setAudienceSwitchStatus",e=>this.audienceSwitchStatus=e),(0,q._)(this,"setAudienceAuthStatus",e=>this.audienceAuthStatus=e),(0,q._)(this,"setAudienceTccStatus",e=>this.audienceTccStatus=e);this.makeObservable()}}var es=n("367846"),eu=n("665600"),e_=n("62323"),ec=n("647245"),ed=n("679272"),eE=n("207123"),em=n("187308"),eh=n("134888");class ev extends eo.Z{constructor(){super(),(0,q._)(this,"cameraInfo",{}),(0,q._)(this,"mainCameraInfo",{}),(0,q._)(this,"cameraInfoList",[]),(0,q._)(this,"multiCameraLogParams",{}),(0,q._)(this,"switchCameraNumber",0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{cameraInfo:el.observable,mainCameraInfo:el.observable,cameraInfoList:el.observable,setCameraInfo:el.action,setMainCameraInfo:el.action,setCameraInfoList:el.action,setMultiCameraLogParams:el.action,multiCameraLogParams:el.observable,switchCameraNumber:el.observable,setSwitchCameraNumber:el.action})}),(0,q._)(this,"setSwitchCameraNumber",e=>{this.switchCameraNumber=e}),(0,q._)(this,"setMultiCameraLogParams",e=>{this.multiCameraLogParams=e}),(0,q._)(this,"reset",()=>{this.cameraInfo={},this.mainCameraInfo={},this.cameraInfoList=[]}),(0,q._)(this,"setCameraInfo",e=>{"function"==typeof e?this.cameraInfo=e(this.cameraInfo):this.cameraInfo=e}),(0,q._)(this,"setMainCameraInfo",e=>{"function"==typeof e?this.mainCameraInfo=e(this.mainCameraInfo):this.mainCameraInfo=e}),(0,q._)(this,"setCameraInfoList",e=>{"function"==typeof e?this.cameraInfoList=e(this.cameraInfoList):this.cameraInfoList=e});this.makeObservable()}}var eI=n("736145");class ef extends eo.Z{constructor(){super(),(0,q._)(this,"participatedLotterys",[]),(0,q._)(this,"landingPageType","userMain"),(0,q._)(this,"currentLottery",{}),(0,q._)(this,"leftTimeFromShortTouch",0),(0,q._)(this,"candidateState",0),(0,q._)(this,"isFirstLoad",!0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{landingPageType:el.observable,participatedLotterys:el.observable,currentLottery:el.observable,leftTimeFromShortTouch:el.observable,candidateState:el.observable,isFirstLoad:el.observable,setIsFirstLoad:el.action})}),(0,q._)(this,"setParticipatedLotterys",e=>this.participatedLotterys=e),(0,q._)(this,"setLandingPageType",e=>this.landingPageType=e),(0,q._)(this,"setCurrentLottery",e=>this.currentLottery=e),(0,q._)(this,"setLeftTimeFromShortTouch",e=>this.leftTimeFromShortTouch=e),(0,q._)(this,"setCandidateStat",e=>this.candidateState=e),(0,q._)(this,"setIsFirstLoad",e=>this.isFirstLoad=e);this.makeObservable()}}class eP extends eo.Z{constructor(){super(),(0,q._)(this,"rechargeAuthStatus",!1),(0,q._)(this,"showGiftRechargeContainer",!1),(0,q._)(this,"remoteRechargeContainerRendered",!1),(0,q._)(this,"remoteRechargeRootRef",null),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{rechargeAuthStatus:el.observable,setRechargeAuthStatus:el.action,showGiftRechargeContainer:el.observable,setShowGiftRechargeContainer:el.action,remoteRechargeContainerRendered:el.observable,setRemoteRechargeContainerRendered:el.action,remoteRechargeRootRef:el.observable.ref})}),(0,q._)(this,"setRechargeAuthStatus",e=>this.rechargeAuthStatus=e),(0,q._)(this,"setShowGiftRechargeContainer",e=>this.showGiftRechargeContainer=e),(0,q._)(this,"setRemoteRechargeContainerRendered",e=>this.remoteRechargeContainerRendered=e);this.makeObservable()}}var eL=n("234532");class eT extends eo.Z{constructor(){super(),(0,q._)(this,"isFirstLoad",!0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{isFirstLoad:el.observable,setIsFirstLoad:el.action})}),(0,q._)(this,"setIsFirstLoad",e=>this.isFirstLoad=e);this.makeObservable()}}var eN=n("408019");class eS extends eo.Z{setShowShare(e){this.showShare=e}setLeft(e){this.left=e}setTop(e){this.top=e}setHeight(e){this.height=e}setShareFrom(e){this.shareFrom=e}constructor(){super(),(0,q._)(this,"showShare",!1),(0,q._)(this,"left",void 0),(0,q._)(this,"top",void 0),(0,q._)(this,"height",void 0),(0,q._)(this,"shareFrom","lottery"),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{showShare:el.observable,left:el.observable,top:el.observable,height:el.observable,shareFrom:el.observable,setShowShare:el.action,setLeft:el.action,setTop:el.action,setHeight:el.action,setShareFrom:el.action})});this.makeObservable()}}var ep=n("7396"),eg=n("436886"),eC=n("105200"),ey=n("651688"),eA=n("867204"),eR=n("213987");class eO extends eo.Z{get screenMode(){return this.isFullScreen?eA.wq.FULL_SCREEN:this.isTheaterOn?eA.wq.THEATER:eA.wq.NORMAL}constructor(){super(),(0,q._)(this,"isTheaterOn",!1),(0,q._)(this,"isFullScreen",!1),(0,q._)(this,"isPause",!1),(0,q._)(this,"playerInstance",null),(0,q._)(this,"playerLoggerInstance",null),(0,q._)(this,"isPlayed",!1),(0,q._)(this,"loggerOptions",{}),(0,q._)(this,"isPlay",0),(0,q._)(this,"isLoadedData",!1),(0,q._)(this,"fullscreenTarget",null),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{isTheaterOn:el.observable,isFullScreen:el.observable,isPause:el.observable,playerInstance:el.observable,playerLoggerInstance:el.observable,setPlayerInstance:el.action,setPlayerLoggerInstance:el.action,setIsTheaterOn:el.action,setIsFullScreen:el.action,setIsPause:el.action,setIsPlayed:el.action,isPlayed:el.observable,screenMode:el.computed,loggerOptions:el.observable,setLoggerOptions:el.action,isPlay:el.observable,setIsPlay:el.action,isLoadedData:el.observable,setIsLoadedData:el.action,fullscreenTarget:el.observable,setFullScreenTarget:el.action})}),(0,q._)(this,"setFullScreenTarget",e=>{this.fullscreenTarget=e}),(0,q._)(this,"setIsLoadedData",e=>{this.isLoadedData=e}),(0,q._)(this,"setIsPlay",e=>{this.isPlay=e}),(0,q._)(this,"setLoggerOptions",e=>{this.loggerOptions=e}),(0,q._)(this,"setIsPlayed",e=>{this.isPlayed=e}),(0,q._)(this,"setPlayerInstance",e=>{this.playerInstance=e}),(0,q._)(this,"setPlayerLoggerInstance",e=>{this.playerLoggerInstance=e}),(0,q._)(this,"setIsTheaterOn",e=>{this.isTheaterOn=e}),(0,q._)(this,"setIsFullScreen",e=>{this.isFullScreen=e}),(0,q._)(this,"setIsPause",e=>{this.isPause=e});this.makeObservable(),(0,el.reaction)(()=>this.isTheaterOn,(e,t)=>{t&&!e&&((0,eR.q)("ISLAND_SYNC_HEADER"),(0,eR.q)("ISLAND_LAYOUT_NAVIGATION"))})}}var eb=n("356700"),ew=n("758801");(0,B.DT)($.s);let ek=["appStore","userStore","homeStore","roomStore","layoutStore","streamStore","cameraStore","paidLiveStore","detailExtra"];class eY{constructor(){(0,q._)(this,"appStore",new J.Z),(0,q._)(this,"userStore",new X.Z),(0,q._)(this,"homeStore",new ee.Z),(0,q._)(this,"roomStore",new z.Z(this)),(0,q._)(this,"linkmicStore",new et.ZP(this)),(0,q._)(this,"giftStore",new en.Z),(0,q._)(this,"propStore",new ei.Z),(0,q._)(this,"pkStore",new er.Z),(0,q._)(this,"audienceStore",new ea),(0,q._)(this,"fansClubStore",new es.Z),(0,q._)(this,"layoutStore",new eu.Z),(0,q._)(this,"streamStore",new e_.Z),(0,q._)(this,"cameraStore",new ev),(0,q._)(this,"hourRankListStore",new ec.Z),(0,q._)(this,"feedStore",new ed.Z),(0,q._)(this,"singletonStore",new eE.Z),(0,q._)(this,"hybridStore",new em.Z),(0,q._)(this,"eventStore",new eh.Z(this)),(0,q._)(this,"paidLiveStore",new eI.ZP),(0,q._)(this,"lotteryStore",new ef),(0,q._)(this,"rechargeStore",new eP),(0,q._)(this,"ecomStore",new eN.Z),(0,q._)(this,"activityIndicatorStore",new eL.Z),(0,q._)(this,"redpacketStore",new eT),(0,q._)(this,"shareStore",new eS),(0,q._)(this,"vipStore",new ep.Z),(0,q._)(this,"giftGuideStore",new eg.Z),(0,q._)(this,"detailExtra",new eC.Z),(0,q._)(this,"rightPanelStore",new ey.Z(this.activityIndicatorStore)),(0,q._)(this,"playerStore",new eO),(0,q._)(this,"chatStore",new eb.Z),(0,q._)(this,"vrStore",new ew.Z(this)),(0,q._)(this,"hydrate",e=>{ek.forEach(t=>{this[t].hydrate(e[t])})}),(0,q._)(this,"reset",e=>{var t,n;Object.entries(this).filter(e=>{let[t]=e;return/Store$/.test(t)}).filter(t=>{let[n]=t;return!Array.isArray(e)||e.indexOf(n)>=0}).forEach(e=>{let[t,n]=e;(null==n?void 0:n.reset)&&(null==n||n.reset()),(null==n?void 0:n.resetStore)&&(null==n||n.resetStore())}),(null===(t=this.detailExtra)||void 0===t?void 0:t.reset)&&(null===(n=this.detailExtra)||void 0===n||n.reset())})}}var eV=n("612774"),eU=n("171091"),ex=n("914104"),eK=n("228733"),eM=n("236732"),eZ=n("909497"),eD=n("157703"),ej=n("715709"),eF=n("243321"),eG=n("109539"),eH=n("66047");let{user:eW,ABtestContext:eB}=eV,eQ=()=>{let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(0,c.ZP)({service_name:"webcast.douyin.live_pc",key:"message_websocket_params"}).then(e=>{t(e)})},[]),(0,r.jsx)(eU.Z,{websocketKey:e})};function eq(){let e=(0,U.o)(),t=(0,T.Es)();(0,o.useEffect)(()=>{var n;null==e||null===(n=e.userStore)||void 0===n||n.setOdin(t)},[t]);let{userInfo:n}=(0,eG.useUserInfoContext)();return(0,o.useEffect)(()=>{var e;let t=null==n?void 0:null===(e=n.info)||void 0===e?void 0:e.uid;t&&(0,ex.oG)(t)},[n]),(0,r.jsx)(r.Fragment,{})}function e$(){let{webrid:e}=(0,s.U)();(0,eH._)();let t={};return"object"==typeof window&&(t=(0,l.parse)(window.location.search)),(0,eZ.w)({webRid:e,query:t}),(0,eK.Z)(),(0,r.jsx)(eM.Z,{})}let eX=()=>{let e=(0,o.useMemo)(()=>(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){let e=new eY;return!$.s&&(window.__STORE__=e),e}let n=null!=i?i:new eY;return(Object.keys(e).length&&n.hydrate(e),$.s)?n:(window.__STORE__=n,!i&&(i=n),n)})({},!0),[]),t=(0,o.useRef)(e);return(0,o.useEffect)(()=>{let e=t.current;return()=>{setTimeout(()=>{try{var t,n,i;null==e||null===(t=e.singletonStore.message)||void 0===t||t.stop(),null==e||null===(n=e.singletonStore.message)||void 0===n||n.destroy(),null==e||null===(i=e.reset)||void 0===i||i.call(e),Object.keys(e).forEach(t=>{Object.keys(e[t]).forEach(n=>{e[t][n]=null}),e[t]=null})}catch(e){}},1e3)}},[]),(0,o.useEffect)(()=>()=>{(0,eD.pk)(),(0,ej.Ue)()},[]),(0,o.useEffect)(()=>{try{eD.sA.liveAppRenderStart()}catch(e){}},[]),(0,r.jsx)(V.n,{children:(0,r.jsx)(Q,{children:(0,r.jsxs)(U.x.Provider,{value:e,children:[(0,r.jsx)(eq,{}),(0,r.jsx)(eQ,{}),(0,r.jsx)(e$,{})]})})})};var ez=e=>{let t=(0,o.useMemo)(()=>{if(!$.s)return(0,ex.OK)()},[]);return(0,r.jsx)(eF.k,(0,Y._)((0,k._)({},e),{componentName:"SpaLiving",_slardarInstance:t,children:(0,r.jsx)(eX,(0,k._)({},e))}))};function eJ(){let e=(0,E.Z)(),t=(0,T.Es)();(0,o.useEffect)(()=>{var n;null==e||null===(n=e.userStore)||void 0===n||n.setOdin(t)},[t]),(0,o.useEffect)(()=>{if(!!(0,N.sF)())S.asyncCall(S.AsyncCallMethod.XRequestFullScreen)},[]);let{userInfo:n}=(0,eG.useUserInfoContext)();return(0,o.useEffect)(()=>{var e;let t=null==n?void 0:null===(e=n.info)||void 0===e?void 0:e.uid;t&&(0,m.oG)(t)},[n]),(0,r.jsx)(r.Fragment,{})}function e0(){let{webrid:e}=(0,s.U)();(0,eH._)();let t={};return"object"==typeof window&&(t=(0,l.parse)(window.location.search)),(0,A.Z)({webRid:e,query:t}),(0,b.Z)(),(0,p.Z)(),(0,r.jsx)(y.C,{preview:{}})}(0,d.jq)(),(0,I.zA)(),(0,m.XM)();let e1=()=>{let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(0,c.ZP)({service_name:"webcast.douyin.live_pc",key:"message_websocket_params"}).then(e=>{t(e)})},[]),(0,r.jsx)(g.Z,{websocketKey:e})},e2=()=>{let{webrid:e}=(0,s.U)();(0,o.useEffect)(()=>{var e,t;if(null===h.sA||void 0===h.sA||h.sA.liveAppRenderStart(),"live.douyin.com"!==window.location.host&&(null===(t=window)||void 0===t?void 0:null===(e=t.location)||void 0===e?void 0:e.search.includes("r_player=1"))){let e=performance.now()-window.ENTER_ROOM_BY_REUSE_PLAYER;null===h.sA||void 0===h.sA||h.sA.liveUrlLoadEnd(e),window.ENTER_ROOM_BY_REUSE_PLAYER=0,window.PLAYING_START_BY_REUSE_PLAYER=Date.now()}return()=>{(0,h.pk)(),(0,v.Ue)()}},[]);let t=(0,a.a)(),n=(0,o.useMemo)(()=>(0,f.M)({},!0),[]),i=(0,o.useRef)(n),l=(0,eH._)()||{},u=(0,o.useRef)(!1),{followListRoomData:_}=(0,R.Iq)(e=>{let{followListRoomData:t}=e;return{followListRoomData:t}});if((null==l?void 0:l.liveInnerFeed)&&!u.current){var c,d,E;(null==t?void 0:null===(c=t.pathname)||void 0===c?void 0:c.search("/follow/live"))!==-1&&(null==n||null===(E=n.feedStore)||void 0===E||E.addFeedList(null==_?void 0:null===(d=_.filter(e=>null==e?void 0:e.roomId))||void 0===d?void 0:d.map(e=>{var t;let{__fakeAwemeInfo:{authorInfo:n},webRid:i,roomId:r}=e;return{room:null==n?void 0:n.roomData,web_stream_url:null==n?void 0:null===(t=n.roomData)||void 0===t?void 0:t.additional_stream_url,web_rid:i,roomId:r}})),u.current=!0)}return(0,o.useEffect)(()=>{let e=i.current;return()=>{1!==Number(l.liveInnerFeed)&&2!==Number(l.liveInnerFeed)&&setTimeout(()=>{try{var t,n,i;null==e||null===(t=e.singletonStore.message)||void 0===t||t.stop(),null==e||null===(n=e.singletonStore.message)||void 0===n||n.destroy(),null==e||null===(i=e.reset)||void 0===i||i.call(e),Object.keys(e).forEach(t=>{Object.keys(e[t]).forEach(n=>{e[t][n]=null}),e[t]=null})}catch(e){}},1e3)}},[]),(0,r.jsx)(L.n,{children:(0,r.jsx)(P.r,{children:(0,r.jsxs)(C.x.Provider,{value:n,children:[(0,r.jsx)(eJ,{}),(0,r.jsx)(e1,{}),(0,r.jsx)(e0,{})]})})})};var e3=()=>{var e;let t=(0,O.j)();null===_.Z||void 0===_.Z||null===(e=_.Z.recordEnterEndTimeStamp)||void 0===e||e.call(_.Z);let n=(0,a.a)(),i=o.useMemo(()=>null==n?void 0:n.search.includes("use_new_preview=true"),[n]);return(0,r.jsx)(w.k,{componentName:"LivePage",children:(0,u.getInNewProjectPreviewABWithoutStoreCheck)(t)||i?(0,r.jsx)(ez,{}):(0,r.jsx)(e2,{})})}},722107:function(e,t,n){n.d(t,{o:function(){return c}}),n(110006),n(826893);var i=n(563097);n(88648);var r=n(217713),o=n(672129),l=n(876599),a=n(168334),s=n(218805),u=n(509090);let _=(()=>{let e="screen_chat_ignore_send_confirm";return{get:()=>"true"===localStorage.getItem(e),set(t){localStorage.setItem(e,t?"true":"false")}}})(),c=async(e,t)=>{var n;if(!e)return!0;if((null!==(n=t.emojiCount)&&void 0!==n?n:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let t=e.match(/\[.*?\]/g);return t?t.length:0}catch(e){return 0}}(t.text))>3)return u.F.info("最多可添加3个表情"),!1;let{diamond_count:c,style:d}=e;if(_.get()||!d||(0,o.BC)(d)||!c)return!0;let E=function(e){switch(e){case r.Qz.Base:return"基础弹幕";case r.Qz.Advanced:return"高级弹幕";case r.Qz.Supreme:return"至尊弹幕";default:return""}}(d),m=!1,h=await (0,a.S)({title:"确认支付",footerFill:!0,content:(0,i.jsxs)("div",{className:l.Z.content,children:[(0,i.jsxs)("p",{className:l.Z.text,children:["使用",E,"需要支付",c,"钻，确认支付并发送弹幕吗？"]}),(0,i.jsx)(s.Checkbox,{className:l.Z.checkbox,"aria-label":"screen_chat_send_confirm",onChange:e=>{m=!!e.target.checked},children:"下次不再提醒"})]}),width:300});return h&&_.set(m),h}},169094:function(e,t,n){var i=n(520739),r=n(878389);n(874386);var o=n(563097),l=n(948375),a=n(503866),s=n(88648),u=n(710199),_=n(818597),c=n(505575),d=n(70755),E=n(881243),m=n(159344),h=n(53562);let v=e=>{let{playerInstance:t}=e,{eventStore:{playerEvent:n}}=(0,_.o)(),[i,r]=(0,s.useState)(!1),[c,h]=(0,s.useState)(!1),v=(0,s.useRef)(!1);(0,s.useEffect)(()=>()=>{v.current=!0},[]);let I=s.useRef(!0),f=(0,l.Z)(()=>{var e,i;null!==(i=(e=window).__INVISIBLE_QUERY__)&&void 0!==i||(e.__INVISIBLE_QUERY__={}),window.__INVISIBLE_QUERY__.if_browser_limited=1;null==n||n.volumeBrowserLimitedMute(),I.current&&(setTimeout(()=>{if(!!t.paused)t.muted=!0,t.play(),setTimeout(()=>{(0,a.w)(!1),t.once(u.FP.VOLUMECHANGE,()=>{!v.current&&h(!1)})})},0),I.current=!1,h(!0),null==n||n.volumeBrowserLimitedToastShow())});(0,s.useEffect)(()=>{if(!!t)return t.on(u.FP.AUTOPLAY_WAS_PREVENTED,f),()=>{null==t||t.off(u.FP.AUTOPLAY_WAS_PREVENTED,f)}},[t]),(0,s.useEffect)(()=>{if(!t)return;let e=e=>{var n,i;if(!t)return;let r=null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.tagName;if("INPUT"!==r&&"TEXTAREA"!==r&&(null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.contentEditable)!=="true")(null==e?void 0:e.code)==="KeyP"&&!(e.shiftKey||e.metaKey||e.ctrlKey)&&(t.muted=!t.muted)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t]);let P=(0,l.Z)(()=>{null==n||n.volumeBrowserLimitedClickOpen(),t&&(t.muted?t.muted=!1:t.volume=.5,t.emit("volumechange")),h(!1)}),L=(0,s.useCallback)(()=>{null==n||n.volumeBrowserLimitedClickClose(),h(!1)},[]);return(0,o.jsx)(d.l,{showHint:c,priority:2,duration:30,delay:0,onClose:()=>{h(!1)},children:(0,o.jsx)(E.I,{className:m.Z.cancelMute,onClose:L,onModalVisibleChange:r,onOpen:P,preventModalVisible:i})})};t.C=(0,h.Pi)(e=>{let{player:t}=(0,c.n)();return(0,o.jsx)(v,(0,r._)((0,i._)({},e),{playerInstance:t}))})},36964:function(e,t,n){n.d(t,{Z:function(){return L}}),n("675373");var i=n("563097");n("88648");var r=n("700061"),o=n("246647"),l=n("595902"),a=n("669556"),s=n("300253"),u=n("338426"),_=n("446042"),c=n("770732"),d=n("645260"),E=n.n(d),m="GkkH0S6K",h="oaf6Ibtx",v="XS8pzVXh",I=n("713097"),f=n.n(I);let P=(0,s.n)((0,u.ZP)(()=>Promise.all([n.e("70505"),n.e("75404")]).then(n.bind(n,487289)),{ssr:!1}),{name:o.l.ChatRoom,renderWhen:l._.FirstFrame,fallback:(0,i.jsx)("div",{className:f()(m,h),children:(0,i.jsx)("div",{className:v})})});(0,_.GI)({name:o.l.ChatRoom,condition:e=>{let{store:t}=e,{roomStore:{roomInfo:n},vrStore:{isImmersive:i}}=t;return E()(n,"web_rid")&&!i},Component:P,index:0});var L=(0,a.OV)({Component:()=>(0,i.jsx)(c.Z,{name:o.l.ChatRoom}),layoutName:r.t.RightBackgroundLayout,ComponentName:o.l.RoomLogic,index:0})},457958:function(e,t,n){n.d(t,{A:function(){return s}});var i=n(563097),r=n(309244),o=n(713097),l=n.n(o);n(88648);var a=n(414655);let s=e=>{let{count:t,className:n,renderSVG:o}=e;return(0,i.jsxs)("span",{className:l()(a.Z.userCount,n),children:[o?o():(0,i.jsx)(r.Z,{}),(0,i.jsx)("span",{className:a.Z.count,children:t||"0"})]})}},424784:function(e,t,n){n.d(t,{s:function(){return A}});var i=n(520739),r=n(368200);n(675373),n(874386);var o=n(563097),l=n(88648),a=n(338426),s=n(103423),u=n(713097),_=n.n(u),c=n(818597),d=n(505575),E=n(53562),m=n(873791),h=n(828782),v=n(796591),I=n(309931);let f=(0,a.ZP)(()=>Promise.all([n.e("74792"),n.e("5498"),n.e("21189"),n.e("12563"),n.e("96919"),n.e("47457"),n.e("77616"),n.e("69775")]).then(n.bind(n,756574)),{ssr:!1}),P=new m.N,L="__Live_Share_Mouse_Enter",T="__Live_Share_Mouse_Leave",N="__Live_Share_Choose_Friend",S="__Live_Share_Share_To_Friend",p="__Live_Share_Share_Success",g="__Live_Share_Outer_Click",C="__Live_Share_Outer_Failed",y="__Live_Share_Close",A=e=>{var t,n,r,o,l,a,s;let{onMouseEnter:u,onMouseLeave:_,onChooseFriend:c,onShareToFriend:d,onShareSuccess:E,onOuterClick:m,onShareFailed:h,onShareClose:I,store:f,shareFrom:A}=e,R=e=>function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];null==e||e(...n)},O={[g]:R(m),[L]:R(u),[T]:R(_),[N]:R(c),[S]:R(d),[p]:R(E),[C]:R(h),[y]:R(I)};return Object.keys(O).forEach(e=>{P.on(e,O[e])}),null==f||null===(t=f.shareStore)||void 0===t||t.setShowShare(!0),null==f||f.shareStore.setShareFrom(A||"lottery"),"share_icon"===A&&window.collectEvent("livesdk_share_icon_click",(0,i._)({room_id:null==f?void 0:null===(r=f.roomStore)||void 0===r?void 0:null===(n=r.roomInfo)||void 0===n?void 0:n.roomId,anchor_id:null==f?void 0:null===(s=f.roomStore)||void 0===s?void 0:null===(a=s.roomInfo)||void 0===a?void 0:null===(l=a.room)||void 0===l?void 0:null===(o=l.owner)||void 0===o?void 0:o.id_str},(0,v.Nu)())),()=>{var e;null==f||null===(e=f.shareStore)||void 0===e||e.setShowShare(!1),Object.keys(O).forEach(e=>{P.off(e,O[e])})}};t.Z=(0,E.Pi)(e=>{let{className:t=""}=e,n=(0,r._)(e,["className"]),{player:a}=(0,d.n)(),{shareStore:u,roomStore:E}=(0,c.o)(),m=(0,l.useRef)(null),A=e=>function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];P.emit(e,...n)};return(0,l.useEffect)(()=>{let e=e=>{let t=e.target.parentNode;for(;t;){if(t===m.current)return;t=t.parentNode}P.emit(g,e)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}},[]),(0,l.useEffect)(()=>{if(u.showShare&&(null==E?void 0:E.roomInfo)){var e,t,n,r;window.collectEvent("livesdk_share_card_show",(0,i._)({share_from:null==u?void 0:u.shareFrom,room_id:null==E?void 0:null===(e=E.roomInfo)||void 0===e?void 0:e.roomId,anchor_id:null==E?void 0:null===(r=E.roomInfo)||void 0===r?void 0:null===(n=r.room)||void 0===n?void 0:null===(t=n.owner)||void 0===t?void 0:t.id_str},(0,v.Nu)()))}},[u.shareFrom,u.showShare]),I.createPortal((0,o.jsx)("div",{className:_()(s.Z.liveShare,t,{[s.Z.isInClient]:(0,h.DT)()}),ref:m,style:{left:u.left,top:u.top,display:u.showShare?"block":"none"},children:(0,o.jsx)(f,(0,i._)({player:a,shareeListHeight:u.height,onMouseEnter:A(L),onMouseLeave:A(T),handleChooseFriend:A(N),handleShareToFriend:A(S),handleShareSuccess:A(p),handleShareError:A(C),handleShareClose:A(y),shareFrom:null==u?void 0:u.shareFrom,hidden:!u.showShare},n))}),document.body)},{forwardRef:!1})},889585:function(e,t,n){n.r(t),n.d(t,{RotatePlugin:function(){return a.Z},DetailContextMenuPlugin:function(){return eN.Z},GroupFightPlugin:function(){return ed.Z},DanmaSetting:function(){return C.Z},RTCLayerPlugin:function(){return eo.Z},HintContainerPlugin:function(){return k},UgcAvatar:function(){return ev.Z},ServiceCenterPlugin:function(){return ey.Z},VolumeWheelPlugin:function(){return D.Z},NewLinkMicLogicPlugin:function(){return eO.Z},PaidLivePlugin:function(){return X.Z},GroupLivePlugin:function(){return ep.Z},LiveReserveCard:function(){return eh.Z},TripleScreenPlugin:function(){return s.Z},VipLiveBoundaryPlugin:function(){return $},AudioRoomPlugin:function(){return en.Z},GiftMenuPlugin:function(){return eY.Z},PausePop:function(){return eT.Z},LinkMicApplyPlugin:function(){return eL},TopEffectPlugin:function(){return e_},LinkMicLayoutPlugin:function(){return J.Z},LinkMicPlayModeLimitPlugin:function(){return ei.Z},AdaptedBySEIPlugin:function(){return G},InPicturePlugin:function(){return r.Z},GiftEffectPlugin:function(){return f.Z},WaterMark:function(){return eC.Z},OrderSingPlugin:function(){return ec.Z},GiftTrayPlugin:function(){return P.Z},PKViewPlugin:function(){return W.Z},ToolBarPlugin:function(){return x.Z},GuestBattlePlugin:function(){return em},LiveFromAppTips:function(){return eg.Z},RefreshPlugin:function(){return b.Z},UpdateFunctionTypePlugin:function(){return ea.Z},ShortTouchPlugin:function(){return B.Z},VideoRoomPlugin:function(){return ee.Z},NewLinkInitPlugin:function(){return eR.Z},QualitySwitchNewPlugin:function(){return O},EffectPlugin:function(){return g},PlayerTeaLogPlugin:function(){return M.Z},PKSEIPlugin:function(){return j.Z},VrPlugin:function(){return eA.Z},NewVideoRoomPlugin:function(){return et.Z},DoubleScreenPlugin:function(){return eS.Z},VipViewPlugin:function(){return Q.Z},PlayerLoggerPlugin:function(){return K.Z},LiveLike:function(){return A.Z},NewRTCLayerPlugin:function(){return ek},AdminPrivilegePlugin:function(){return er.Z},EffectSwitchPlugin:function(){return I.Z},ChangeDynamicBg:function(){return ef.Z},GroupLive:function(){return eI.Z},VolumeMemoryPlugin:function(){return v},LinkMicDynamicPlugin:function(){return el.Z},LeadingLoginPlugin:function(){return z.Z},CancelMutePlugin:function(){return Y.Z},PicturePlugin:function(){return o.Z},FoldChatRoomCommentPlugin:function(){return l.Z},PlayerEndCover:function(){return Z.Z},NewPlayerErrorCover:function(){return H.Z},TheaterPlugin:function(){return i.Z},GlobalControlPlugin:function(){return U},DanmakuNewPlugin:function(){return y.Z}});var i=n("421632"),r=n("540293"),o=n("550131"),l=n("12488"),a=n("54762"),s=n("180894");n("675373");var u=n("700061"),_=n("246647"),c=n("595902"),d=n("669556"),E=n("300253"),m=n("338426");let h=(0,E.n)((0,m.ZP)(()=>Promise.resolve().then(n.bind(n,928406)),{ssr:!1}),{name:_.l.VolumeMemoryPlugin,renderWhen:c._.LivingInit});var v=(0,d.OV)({Component:h,layoutName:u.t.PlayerControlLayout,ComponentName:_.l.VolumeMemoryPlugin,index:0}),I=n("493153"),f=n("725805"),P=n("51526"),L=n("563097");n("88648");var T=n("446042"),N=n("770732"),S=n("736579");let p=(0,E.n)((0,m.ZP)(()=>Promise.all([n.e("26835"),n.e("48539")]).then(n.bind(n,366622)),{ssr:!1}),{name:_.l.EFFECT_PLUGIN,renderWhen:S.d.afterComponent(_.l.ChatRoom),taskPriority:"user-visible"});(0,T.GI)({name:_.l.EFFECT_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:n}}=t;return n},Component:p,index:0});var g=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.EFFECT_PLUGIN}),layoutName:u.t.GiftEffectLayout,ComponentName:_.l.EFFECT_PLUGIN,index:0}),C=n("910417"),y=n("541403"),A=n("185067");let R=(0,E.n)((0,m.ZP)(()=>n.e("54691").then(n.bind(n,361602)),{ssr:!1}),{name:_.l.QUALITY_SWITCH,renderWhen:c._.LivingInit});(0,T.GI)({name:_.l.QUALITY_SWITCH,condition:()=>!0,Component:R,index:0});var O=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.QUALITY_SWITCH}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.QUALITY_SWITCH,index:0}),b=n("450360");let w=(0,E.n)((0,m.ZP)(()=>n.e("98058").then(n.bind(n,868734)),{ssr:!1}),{name:_.l.HintContainerPlugin,renderWhen:c._.FirstFrame,taskPriority:"user-visible"});(0,T.GI)({name:_.l.HintContainerPlugin,condition:e=>{var t;let{store:n}=e;return null==n?void 0:null===(t=n.feedStore)||void 0===t?void 0:t.isActive},Component:w,index:0});var k=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.HintContainerPlugin}),layoutName:u.t.TipsLayout,ComponentName:_.l.HintContainerPlugin,index:0}),Y=n("591614");let V=(0,E.n)((0,m.ZP)(()=>n.e("22299").then(n.bind(n,985455)),{ssr:!1}),{name:_.l.GlobalControlPlugin,renderWhen:S.d.afterComponent(_.l.ChatRoom),taskPriority:"background"});(0,T.GI)({name:_.l.GlobalControlPlugin,condition:e=>{var t;let{store:n}=e;return null==n?void 0:null===(t=n.feedStore)||void 0===t?void 0:t.isActive},Component:V,index:0});var U=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.GlobalControlPlugin}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.GlobalControlPlugin,index:0}),x=n("279910"),K=n("393840"),M=n("113810"),Z=n("322604"),D=n("475274"),j=n("148541");let F=(0,E.n)((0,m.ZP)(()=>Promise.resolve().then(n.bind(n,335771)),{ssr:!1}),{name:_.l.AdaptedBySEIPlugin,renderWhen:c._.LivingInit});(0,T.GI)({name:_.l.AdaptedBySEIPlugin,condition:e=>{let{pipContext:t}=e;return!0},Component:F,index:0});var G=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.AdaptedBySEIPlugin}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.AdaptedBySEIPlugin,index:0}),H=n("357720"),W=n("425641"),B=n("476068"),Q=n("917460");let q=(0,E.n)((0,m.ZP)(()=>n.e("7680").then(n.bind(n,6858)),{ssr:!1}),{name:_.l.VIP_LIVE_BOUNDARY,renderWhen:S.d.afterComponent(_.l.ChatRoom),taskPriority:"background"});(0,T.GI)({name:_.l.VIP_LIVE_BOUNDARY,condition:()=>!0,Component:q,index:0});var $=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.VIP_LIVE_BOUNDARY}),layoutName:u.t.TipsLayout,ComponentName:_.l.VIP_LIVE_BOUNDARY,index:0}),X=n("354391"),z=n("427950"),J=n("231761"),ee=n("466193"),et=n("271261"),en=n("94667"),ei=n("627179"),er=n("839274"),eo=n("602956"),el=n("925025"),ea=n("312894"),es=n("618618");let eu=(0,E.n)((0,m.ZP)(()=>n.e("71361").then(n.bind(n,437473)),{ssr:!1}),{name:_.l.TopEffectPlugin,renderWhen:S.d.afterComponent(_.l.ChatRoom),taskPriority:"user-visible"});(0,T.GI)({name:_.l.TopEffectPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},roomStore:{roomStatus:i}}=t;return n&&i!==es.LV.END},Component:eu,index:0});var e_=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.TopEffectPlugin}),layoutName:u.t.GiftTrayLayout,ComponentName:_.l.TopEffectPlugin,index:0}),ec=n("413221"),ed=n("154692");let eE=(0,E.n)((0,m.ZP)(()=>n.e("62099").then(n.bind(n,947217)),{ssr:!1}),{name:_.l.GuestBattlePlugin,renderWhen:c._.FirstFrame,taskPriority:"user-visible"});(0,T.GI)({name:_.l.GuestBattlePlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},linkmicStore:{isGuestBattle:i,isNewVideoLinkmicRoom:r}}=t;return n&&i&&!r},Component:eE,index:0});var em=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.GuestBattlePlugin}),layoutName:u.t.LinkMicAnimationLayout,ComponentName:_.l.GuestBattlePlugin,index:0}),eh=n("577630"),ev=n("949235"),eI=n("471121"),ef=n("251015");let eP=(0,E.n)((0,m.ZP)(()=>n.e("46722").then(n.bind(n,85822)),{ssr:!1}),{name:_.l.LinkMicApplyPlugin,renderWhen:c._.FirstFrame,taskPriority:"background"});(0,T.GI)({name:_.l.LinkMicApplyPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},linkmicStore:{linkRoomType:i},roomStore:{roomStatus:r}}=t;return!!(n&&i&&r!==es.LV.END)},Component:eP,index:0});var eL=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.LinkMicApplyPlugin}),layoutName:u.t.LinkMicLayout,ComponentName:_.l.LinkMicApplyPlugin,index:0}),eT=n("642029"),eN=n("174911"),eS=n("135591"),ep=n("287454"),eg=n("92639"),eC=n("726028"),ey=n("741597"),eA=n("584366"),eR=n("384184"),eO=n("105326");n("250440");var eb=n("616003");let ew=(0,E.n)((0,m.ZP)(()=>Promise.all([n.e("3556"),n.e("76746"),n.e("56689"),n.e("33772"),n.e("47735"),n.e("86617"),n.e("95395"),n.e("85820")]).then(n.bind(n,235501)),{ssr:!1}),{name:_.l.NEW_RTC_LAYER_PLUGIN,renderWhen:c._.FirstFrame});(0,T.GI)({name:_.l.NEW_RTC_LAYER_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},linkmicStore:{linkRoomType:i,isNewVideoLinkmicRoom:r},roomStore:{roomStatus:o,playerCoverText:l}}=t;return!!(n&&i&&o!==es.LV.END&&r&&[eb.kx.NONE,eb.kx.ANCHOR_BAN].includes(l))},Component:ew,index:0});var ek=(0,d.OV)({Component:()=>(0,L.jsx)(N.Z,{name:_.l.NEW_RTC_LAYER_PLUGIN}),layoutName:u.t.LinkMicLayout,ComponentName:_.l.NEW_RTC_LAYER_PLUGIN,index:0}),eY=n("368974")},106798:function(e,t,n){n(675373);var i=n(563097);n(88648);var r=n(300253),o=n(246647),l=n(595902),a=n(669556),s=n(700061),u=n(338426),_=n(770732),c=n(446042);let d=(0,r.n)((0,u.ZP)(()=>Promise.all([n.e("76746"),n.e("84425"),n.e("95395"),n.e("91039")]).then(n.bind(n,493504)),{ssr:!1}),{name:o.l.OperatingBar,renderWhen:l._.FirstFrame});(0,c.GI)({name:o.l.OperatingBar,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},roomStore:{inRoomOnAppView:i},vipStore:{showVipLiveBoundary:r},vrStore:{isImmersive:o}}=t;return n&&!i&&!r&&!o},Component:d,index:0}),t.Z=(0,a.OV)({Component:()=>(0,i.jsx)(_.Z,{name:o.l.OperatingBar}),layoutName:s.t.BottomLayout,ComponentName:o.l.OperatingBar,index:1})},361602:function(e,t,n){n.r(t),n.d(t,{QualitySwitchPluginWrapper:function(){return A},default:function(){return R}}),n("874386"),n("250440");var i=n("563097"),r=n("88648"),o=n("713097"),l=n.n(o),a=n("88478"),s=n("892814"),u=n("18043"),_=n("441447"),c="nMP5L4c4",d="E5GerkUB",E=n("559947"),m=n("818597"),h=n("53562"),v=n("700045"),I=n("645260"),f=n.n(I),P=n("505575"),L=n("618618"),T=n("42872"),N=n("358472"),S=n("182794"),p=n("782580"),g=n("19670"),C=n("442761");let y=r.forwardRef((e,t)=>{let{streamData:n,defaultQuality:o,qualityList:E,player:h,sessionId:v,screenMode:I,roomId:f="",isAsianGames:P,isActivity:L,setNoStream:T,showRefreshPage:N}=e,{streamStore:{setCurrentQuality:S,currentQuality:y}}=(0,m.o)(),[A,R]=r.useState(o),[O,b]=r.useState(!1),w=r.useRef(o),k=r.useCallback(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||e!==A)e&&E.includes(e)&&(R(e),requestAnimationFrame(()=>{_.emit(_.EVENT.syncLiveMemoryState,{clarity:e}),_.emit(_.EVENT.syncInteraction)}),(0,g.WH)("QualitySwitchPlugin_handleQuality",{quality:e,passive:t}),!t&&(0,u.QX)(e))},[E,A]);r.useEffect(()=>{let e=_.listen(_.EVENT.syncLiveMemoryState,e=>{(null==e?void 0:e.clarity)&&k(e.clarity,null==e?void 0:e.clarityPassive)});return()=>e()},[k]),r.useImperativeHandle(t,()=>({getCurrentQuality:()=>w.current,setCurrentQuality:(e,t)=>{k(e,t)},getCurrentQualityList:()=>E})),r.useEffect(()=>{var e;w.current=A;let t=new CustomEvent("webcast_qualityEvent",{detail:{roomId:f,isLive:1,quality:A}});null===(e=document)||void 0===e||e.dispatchEvent(t)},[A]),r.useEffect(()=>{_.emit(_.EVENT.syncLiveMemoryState,{clarity:y,clarityPassive:!!(0,p.getAbrQualityAB)()||void 0})},[y]),r.useEffect(()=>{S(o)},[o]);let Y=(0,C.wi)();return(0,a.$)({stream:n,quality:A,onSwitch:b,isUse:!Y,sessionId:v,player:h,screenMode:I,qualityList:E,setNoStream:T,isActivity:L,showRefreshPage:N,roomId:f}),(0,s.v)({stream:n,quality:A,onSwitch:b,isUse:Y,qualityList:E,player:h,screenMode:I}),(0,i.jsx)("div",{"data-wide":!0,className:l()(c,"QualitySwitchNewPlugin",{[d]:P}),children:r.Children.map(e.children,e=>r.isValidElement(e)?r.cloneElement(e,{quality:A,qualityList:E}):null)})});y.displayName="QualitySwitchPlugin";let A=(0,h.Pi)((0,E.rW)(y));var R=(0,h.Pi)(e=>{var t;let{streamStore:{streamInfoFromLiving:n,setCurrentQuality:o,watchingFinished:l,currentQuality:a},playerStore:{screenMode:s},roomStore:{roomInfo:u,isAsianGames:_,roomStatus:c,setIsShowRefreshPage:d},userStore:{userInfo:E},linkmicStore:{linkStatus:h}}=(0,m.o)(),{stream:I,startQuality:p,qualities:g,common:C,url:y,options:R,openIntercepted:O,interceptedQuality:b,openTryWatching:w}=n||{},{player:k}=(0,P.n)(),Y=f()(u,"room.id_str"),V=r.useMemo(()=>({streamData:I,defaultQuality:e.defaultQuality||p,qualityList:g,sessionId:null==C?void 0:C.session_id,screenMode:s,url:e.url||y,roomId:Y,player:k,isAsianGames:_,showRefreshPage:d,containerClassName:"QualitySwitchPluginContainer"}),[I,p,g,C,y,Y,k,_,s]),U=r.useMemo(()=>({setCurrentQuality:o}),[]),x=r.useMemo(()=>({options:R,stream:I}),[R,I]),K=(0,T.j_)([null==R?void 0:null===(t=R.default_quality)||void 0===t?void 0:t.sdk_key,(0,N.Hs)(O?b:void 0)]);return h!==L.cK.LINKED&&c!==L.LV.END&&Object.keys(I||{}).length&&p?(0,i.jsx)(S.T,{maxAbrQuality:K,qualities:g,streamInfo:x,setQuality:o,disableChange:w&&!l,children:(0,i.jsx)(A,{index:9,props:V,children:(0,i.jsx)(v.F,{qualityHandler:U,player:k,openIntercepted:O,interceptedQuality:b,openTryWatching:w&&!l,screenMode:s,watchingFinished:l,streamOptions:R,isLogin:null==E?void 0:E.id_str,streamInfo:x})})}):null})},954909:function(e,t,n){n.d(t,{t:function(){return i}});var i={auto:"auto",origin:"origin",uhd:"uhd",hd:"hd",sd:"sd",ld:"ld"}},861481:function(e,t,n){n.r(t),n.d(t,{LinkMicPlayModeLimitPlugin:function(){return N}}),n(250440);var i=n(879962),r=n(505575),o=n(710199),l=n(618618),a=n(669417),s=n(614316),u=n(623527),_=n(828782),c=n(632766),d=n(645260),E=n.n(d),m=n(96008),h=n.n(m),v=n(88648),I=n(104013),f=n(818597),P=n(432431),L=n(360977),T=n(53562);let N=e=>{let{isVerifyed:t}=e,{roomStore:{roomInfo:n,setNotSupportReason:d},linkmicStore:{setIsPlayModeNotSupport:m,imLinkMicLayout:T,uiLayout:N,setAsrSubtitle:S},singletonStore:{message:p},userStore:{userInfo:g},eventStore:{linkmicEvent:C}}=(0,f.o)(),{player:y}=(0,r.n)(),A=(0,L.kF)(),R=v.useCallback(()=>{a.kg.info("玩法限制",(0,I.toJS)(n)),m(!0),d(l.Ly.MULTI_CONSUMER_LINE)},[m,n]),O=(0,v.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E()(n,"room.linker_detail.linker_ui_layout");(null==g?void 0:g.isReady)&&((0,s.Qz)({anchor_id:E()(n,"anchor.id_str",""),room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:Number(Object.keys(E()(n,"room.linker_map",{}))),playmode:E()(n,"room.linker_detail.linker_play_modes",[]),ui_layout:e}),a.kg.event(`[${u.Tn.Error}]${u.Mo.LiveNotSupportError}`,{room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:Number(Object.keys(E()(n,"room.linker_map",{}))),playmode:E()(n,"room.linker_detail.linker_play_modes",[]),ui_layout:e,is_client:(0,_.DT)()}))},[n,g]);v.useEffect(()=>{let e=E()(n,"room.linker_detail.linker_ui_layout"),t=Number(Object.keys(E()(n,"room.linker_map",{}))),i=E()(n,"room.linker_detail.linker_play_modes",[]);(e||t||(null==i?void 0:i.length)>0)&&a.kg.event("linkmic_user_page_view",{room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:t,playmode:i,ui_layout:e,is_client:(0,_.DT)()})},[n,g]),v.useEffect(()=>{(async()=>{let e=E()(n,"room.linker_detail.linker_ui_layout"),t=await (0,c.ZP)({service_name:"webcast.douyin.live_pc",key:"linkmic_not_support_uilayout"}),{uilayout:i}=t[null==A?void 0:A.XTTENV]?t[null==A?void 0:A.XTTENV]:t,r=e=>{if(i&&(null==i?void 0:i.includes(e)))return O(e),!0};[e,N].some(e=>r(e))&&R()})()},[n,N]);let b=E()(n,"room.live_room_mode"),w=v.useCallback(e=>{if(100===e.code)try{var t,r,o;let a=new TextDecoder().decode(e.content),s=(0,i.KR)(a);if(void 0===T&&s&&s.ktv_sei&&(null==s?void 0:null===(t=s.ktv_sei)||void 0===t?void 0:t.scene)>0&&(null==s?void 0:null===(r=s.ktv_sei)||void 0===r?void 0:r.scene)!==3&&R(),s&&s.app_data)h()();else if(null==s?void 0:null===(o=s.source)||void 0===o?void 0:o.includes("TTLiveSDK")){let e=E()(n,"room.basis.is_customize_audio_room",!1);b===l.ke.AUDIO&&!e&&R()}}catch(e){}},[R,T,b,n]);return v.useEffect(()=>(null==y||y.on(o.FP.SEI,w),()=>{null==y||y.off(o.FP.SEI,w)}),[y,w]),v.useEffect(()=>{let e=E()(n,"room.linker_map",{}),t=E()(n,"room.linker_detail.linker_play_modes",[]),i=!1;(e[P.xs.Scene_AudioChatRoom]||e[P.xs.Scene_VideoChatRoom]||e[P.xs.Scene_VideoEqualRoom])&&t.forEach(e=>{e===P.V0.LinkmicPlayMode_Teamfight&&(O(),i=!0)}),e[P.xs.Scene_AudioChatRoom]&&(t.includes(P.V0.LinkmicPlayMode_Teamfight)||t.includes(P.V0.LinkmicPlayMode_AudioChat_3x3_N_EMPTY))&&(i=!1),t.forEach(e=>{e===P.V0.LinkmicPlayMode_KTVSingingChallenge&&(O(),i=!0)}),(t.includes(P.V0.LinkmicPlayMode_Teamfight)||t.includes(P.V0.LinkmicPlayMode_AudioChat_3x3_N_EMPTY))&&(i=!1),i&&R()},[R,n]),v.useEffect(()=>null==p?void 0:p.on("KtvChallengeConfigMessage",e=>{e.forEach(e=>{let{method:t,payload:n}=e;if(!!t&&!!n)"WebcastKtvChallengeConfigMessage"===t&&(null==n?void 0:n.switch_status)==="1"&&R()})}),[R,p]),null};t.default=(0,T.Pi)(N)},513081:function(e,t,n){n.d(t,{M2:function(){return l},_q:function(){return s},dE:function(){return a}}),n(250440);var i=n(39738),r=n(829021),o=n(782580);let l=(e,t)=>{if([void 0,null,""].includes(e))return;let n=Number(e);if(t){let e=t.find(e=>n===e.id);if(e)return e.value}switch(n){case i.V_.LINKMICUILAYOUT_VIDEOCHAT_DYNAMICLAYOUT1V6:return r.yP.VIDEO_DYNAMIC_FLOAT;case i.V_.LINKMICUILAYOUT_VIDEOCHAT_ENLARGEGUEST1V6:case i.V_.LINKMICUILAYOUT_VIDEOCHATFLOATWINDOWLAYOUT:return r.yP.VIDEO_1V6;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_3X3:return r.yP.VIDEO_GRID;case i.V_.LINKMICUILAYOUT_VIDEOEQUALDYNAMICLAYOUT:return r.yP.VIDEO_DYNAMIC;case i.V_.LINKMICUILAYOUT_CROSSROOMLINKMIC_6V6:return r.yP.VIDEO_6V6;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8:return r.yP.AUDIO_1V8;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_3X3:return r.yP.AUDIO_GRID;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V3:return r.yP.VIDEO_1_V_3;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V6:return r.yP.VIDEO_1_V_6;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V8:return r.yP.VIDEO_1_V_8;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_TOP1V8:return r.yP.VIDEO_T1_V_B8;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_STAGE:return r.yP.AUDIO_1V8_STAGE;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_DYNAMICLAYOUT1V8FIX:return r.yP.VIDEO_1V8;case i.V_.LINKMICUILAYOUT_VIDEO_2V4V4:return r.yP.VIDEO_2V4V4;case i.V_.LINKMICUILAYOUT_LIVE_PARTNER_DYNAMIC:return r.yP.MATE_CUSTOM;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_TOP2V4V4:return r.yP.AUDIO_DOUBLE_C;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_ENLARGE_STAGE:if((0,o.getInLiveAudioLayoutOptAB)())return r.yP.AUDIO_1V8_STAGE;return r.yP.AUDIO_1V8;case i.V_.LinkmicUILayout_VideoLinkmic_Float_1V5:return r.yP.Float_1V5;case i.V_.LinkmicUILayout_VideoLinkmic_Float_1V8:return r.yP.Float_1V8;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_1V1:return r.yP.Dynamic_1V1;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_1V2:return r.yP.Dynamic_1V2;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_2V2:return r.yP.Dynamic_2V2;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_2V3:return r.yP.Dynamic_2V3;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_3V3:return r.yP.Dynamic_3V3;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_3V4:return r.yP.Dynamic_3V4;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_4V4:return r.yP.Dynamic_4V4;case i.V_.LinkmicUILayout_VideoLinkmic_Dynamic_3V3V3:return r.yP.Dynamic_3V3V3;case i.V_.LinkmicUILayout_VideoLinkmic_Equal_3V3:return r.yP.Equal_3V3;case i.V_.LinkmicUILayout_VideoLinkmic_Equal_Left1V8:return r.yP.Equal_Left1V8;case i.V_.LinkmicUILayout_VideoLinkmic_Equal_Top2V4V4:return r.yP.Equal_Top2V4V4;default:return}},a=e=>"new_audience"===e,s=(e,t)=>{if([e,t].some(e=>!e))return{top:0,left:0,right:0,bottom:0};let n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=i.top-n.top,o=i.left-n.left,l=o+t.clientWidth,a=r+t.clientHeight;return{top:r,left:o,right:l,bottom:a}}},846296:function(e,t,n){n(250440);var i=n(513081),r=n(618618),o=n(614316),l=n(818597),a=n(432431),s=n(615323),u=n(632766),_=n(645260),c=n.n(_),d=n(88648),E=n(608261);t.Z=()=>{let{linkmicStore:{setPlayModes:e,setImLinkMicLayout:t,setUiLayout:n,setFunctionType2:_,linkRoomType:m,setIsPlayModeNotSupport:h,layoutConfig:v,setLayoutConfig:I},singletonStore:{message:f},roomStore:{roomInfo:P,setNotSupportReason:L},userStore:{userInfo:T}}=(0,l.o)();(0,d.useEffect)(()=>{let r=c()(P,"room.linker_detail.linker_play_modes",[]),o=c()(P,"room.linker_detail.linker_ui_layout");e(r),n(o),(0,E.D)().includes(Number(o))?t((0,i.M2)(o)):(0,u.ZP)({service_name:"webcast.douyin.live_pc",key:"linkmic_layout_config"}).then(e=>{e&&(I(e),t((0,i.M2)(o,e)))}),_(c()(P,"room.linker_detail.function_type"))},[P,t,_,e]);let N=(0,d.useCallback)((e,t,n)=>{(null==T?void 0:T.isReady)&&(0,o.Qz)({anchor_id:c()(P,"anchor.id_str",""),room_id:null==P?void 0:P.roomId,user_id:null==T?void 0:T.id_str,scene:e,playmode:t,ui_layout:n})},[P,T]);(0,d.useEffect)(()=>{if(!m)return null==f?void 0:f.on("LinkMicMethod",e=>{e.forEach(e=>{let{method:o,payload:l}=e;if(!o||!l)return;let u=Number(l.message_type);if("WebcastLinkMicMethod"===o&&u===s.iM.TYPE_TURNON){let{ui_layout:e}=l;n(e);let r=(0,i.M2)(e,v);r&&t(r)}if(u===s.iM.TYPE_TURNON){let{scene:e,play_modes:t=[],ui_layout:n}=l;if(e){let i=Number(e);(i===a.xs.Scene_KTV||i===a.xs.Scene_VideoKTV)&&(h(!0),N(i,t,n),L(r.Ly.MULTI_KTV))}}})})},[m,v,t,h,L])}},489011:function(e,t,n){n.d(t,{SX:function(){return l},dY:function(){return r},oQ:function(){return o}});var i=n(572932);let r=e=>`sslocal://webcast_webview?url=https%3A%2F%2Flf-webcast-gr-sourcecdn.bytegecko.com%2Fobj%2Fbyte-gurd-source-gr%2Fwebcast%2Fmono%2Fh5%2Frevenue_gift_exhibition_hall_h5_douyin%2Fpages%2Fgift_list%2Findex.html%3Fprofile_user_id%3D${e}%26showPcClose%3Dtrue`,o=(e,t)=>{let n="";return n=t?encodeURIComponent(`${t}?profile_user_id=${e}`):encodeURIComponent(`${i.w.Exhibition}&profile_user_id=${e}`),`sslocal://lynxview?url=${n}&type=popup&gravity=bottom&height_percent=75&web_bg_color=ff060a19&radius=23&radius_bottom_right=0&radius_bottom_left=0&enable_preload=all&add_safe_area_height=0&use_wk_falcon=2`},l=()=>`sslocal://lynxview?url=${encodeURIComponent(i.w.Exhibition)}&type=popup&gravity=bottom&height_percent=75&web_bg_color=ff060a19&radius=23&radius_bottom_right=0&radius_bottom_left=0&enable_preload=all&add_safe_area_height=0&use_wk_falcon=2`},705189:function(e,t,n){n(675373);var i=n(246647),r=n(595902),o=n(300253),l=n(338426);t.Z=(0,o.n)((0,l.ZP)(()=>n.e("86354").then(n.bind(n,963063)),{ssr:!1}),{name:i.l.RoomMessageConsume,renderWhen:r._.LivingInit})},590928:function(e,t,n){n.d(t,{H:function(){return h}});var i=n(520739),r=n(878389);n(563097);var o=n(818597),l=n(88648),a=n(787277),s=n(937382),u=n(443646),_=n(169961),c=n(645260),d=n.n(c),E=n(828782),m=n(314325);let h=()=>{let e=l.useMemo(E.tq,[]),{streamStore:t,roomStore:n}=(0,o.o)(),c=(0,_.T)(),{disabledH265:h,setStreamInfoFromLiving:v,setWatchingFinished:I}=t||{},{isPullDataExsit:f}=n||{},{stream:P,common:L,options:T}=(0,a.kA)({disabledH265:h||e,doubleScreenAB:!0,isPullDataExsit:f}),N=(0,m.dM)(T),{openIntercepted:S,interceptedQuality:p,openTryWatching:g,qualities:C,startQuality:y,bitrate:A}=(0,s.Z)({stream:P,defaultQuality:N}),R=(0,m.AH)(),O=l.useMemo(()=>d()(L,"secret_key",""),[L]),{url:b,lowUrl:w,backupUrl:k,H264Url:Y}=(0,a.le)({stream:P,startQuality:y}),V=(0,l.useMemo)(()=>{let e=[];try{e=Object.keys(P||{}).filter(e=>"ao"!==e).map(e=>{let t;try{t=JSON.parse(P[e].main.sdk_params)}catch(e){t={resolution:"0x0"}}return{quality:e,resolution:t.resolution,url:(0,u.uC)(P[e].main.flv)}})}catch(t){e=[]}let t={resolutions:e,dividing:R,useArea:(null==c?void 0:c.liveUseArea)===1,useScore:R>0,useLongFirstframe:(null==c?void 0:c.liveUseFirstFrame)===1};return(0,r._)((0,i._)({},t),{switchUrl:b,lowUrl:w})},[P,c]);return(0,l.useEffect)(()=>{g&&I(!1)},[g]),(0,l.useEffect)(()=>{v({stream:P,common:L,options:T,openIntercepted:S,interceptedQuality:p,openTryWatching:g,qualities:C,startQuality:y,bitrate:A,secret_key:O,dividing:R,resolutionsel:V,url:b,lowUrl:w})},[P,L,T,S,p,g,C,y,A,O,R,V,b,w]),{stream:P,common:L,options:T,openIntercepted:S,interceptedQuality:p,openTryWatching:g,qualities:C,startQuality:y,bitrate:A,secret_key:O,dividing:R,resolutionsel:V,url:b,lowUrl:w,backupUrl:k,H264Url:Y}}},144020:function(e,t,n){n.d(t,{AY:function(){return a},HI:function(){return s},NY:function(){return l},WK:function(){return o},kc:function(){return i},t0:function(){return r}});var i={WEBCAST_CHAT_MESSAGE:"WebcastChatMessage",WEBCAST_GIFT_MESSAGE:"WebcastGiftMessage"};let r=12e3,o=[{desc:"一行",value:.1,key:1,log:.1},{desc:"两行",value:.2,key:5,log:.2},{desc:"25%",value:.25,key:2,log:.4},{desc:"50%",value:.5,key:3,log:.5},{desc:"80%",value:.8,key:4,log:.8}],l=[{desc:"超小",value:16,width:`${16}px`,key:5,log:-1},{desc:"小号",value:20,width:"20px",key:1,log:0},{desc:"适中",value:24,width:`${22}px`,key:2,log:1},{desc:"大号",value:28,width:`${26}px`,key:3,log:2},{desc:"超大",value:32,width:`${30}px`,key:4,log:3}],a=[{desc:"较慢",value:1.5*r,key:1,log:0},{desc:"适中",value:1.2*r,key:2,log:1},{desc:"较快",value:.9*r,key:3,log:2}],s={opacity:80,area:3,fontSize:1,speed:1,giftOn:!0,packageOn:!0}},344226:function(e,t,n){var i=n(134761);n(268917),n(527785),n(981168);var r=n(104013);t.Z=new class e{defineIoc(e){!this.iocList.find(t=>t.name===e.name&&t.index===e.index)&&this.iocList.push(e)}getIocList(e){return Object.values(this.iocList.filter(t=>t.condition(e)).reduce((e,t)=>((!e[t.name]||e[t.name].index<t.index)&&(e[t.name]=t),e),{}))}getIocItem(e,t){return this.iocList.filter(e=>e.name===t).filter(t=>t.condition(e)).sort((e,t)=>t-e)[0]}constructor(){(0,i._)(this,"iocList",[]),(0,i._)(this,"context",{}),(0,r.makeAutoObservable)(this)}}},237298:function(e,t,n){n.d(t,{P:function(){return l},i:function(){return a}});var i=n(563097),r=n(88648);let o=r.createContext({}),l=e=>(0,i.jsx)(o.Provider,{value:e.value,children:e.children}),a=()=>r.useContext(o)},470245:function(e,t,n){n.d(t,{Gw:function(){return a},bU:function(){return s}});var i=n(563097),r=n(88648),o=n(736579);let l=r.createContext(null),a=e=>{let{children:t,uuid:n}=e,a=(0,r.useMemo)(()=>new o.d(n),[n]),s=(0,r.useRef)(a);return s.current=a,(0,r.useEffect)(()=>()=>{var e;null==s||null===(e=s.current)||void 0===e||e.destroy()},[]),(0,i.jsx)(l.Provider,{value:a,children:t})},s=()=>r.useContext(l)},217713:function(e,t,n){n.d(t,{Qz:function(){return i}});var i={Admin:0,0:"Admin",Base:1,1:"Base",Advanced:2,2:"Advanced",Supreme:3,3:"Supreme"}},271242:function(e,t,n){n.d(t,{W6:function(){return i}});var i={TPYE_LINKER_UNKNOWN:0,0:"TPYE_LINKER_UNKNOWN",TYPE_LINKER_CREATE:1,1:"TYPE_LINKER_CREATE",TYPE_LINKER_CLOSE:2,2:"TYPE_LINKER_CLOSE",TYPE_LINKER_INVITE:3,3:"TYPE_LINKER_INVITE",TYPE_LINKER_APPLY:4,4:"TYPE_LINKER_APPLY",TYPE_LINKER_REPLY:5,5:"TYPE_LINKER_REPLY",TPYE_LINKER_ENTER:6,6:"TPYE_LINKER_ENTER",TPYE_LINKER_LEAVE:7,7:"TPYE_LINKER_LEAVE",TYPE_LINKER_PERMIT:8,8:"TYPE_LINKER_PERMIT",TPYE_LINKER_CANCEL_INVITE:9,9:"TPYE_LINKER_CANCEL_INVITE",TYPE_LINKER_WAITING_LIST_CHANGE:10,10:"TYPE_LINKER_WAITING_LIST_CHANGE",TYPE_LINKER_LINKED_LIST_CHANGE:11,11:"TYPE_LINKER_LINKED_LIST_CHANGE",TYPE_LINKER_UPDATE_USER:12,12:"TYPE_LINKER_UPDATE_USER",TPYE_LINKER_KICK_OUT:13,13:"TPYE_LINKER_KICK_OUT",TPYE_LINKER_CANCEL_APPLY:14,14:"TPYE_LINKER_CANCEL_APPLY",TYPE_LINKER_BAN:15,15:"TYPE_LINKER_BAN",TYPE_LINKER_DISPATCH_ITEM:16,16:"TYPE_LINKER_DISPATCH_ITEM",TYPE_LINKER_VIOLATION_REMINDER:17,17:"TYPE_LINKER_VIOLATION_REMINDER",TYPE_LINKER_UPDATE_LINK_TYPE_APPLY:18,18:"TYPE_LINKER_UPDATE_LINK_TYPE_APPLY",TYPE_LINKER_UPDATE_LINK_TYPE_REPLY:19,19:"TYPE_LINKER_UPDATE_LINK_TYPE_REPLY",TYPE_LINKER_AVATAR_AUDIT:20,20:"TYPE_LINKER_AVATAR_AUDIT",TYPE_APPlY_EXPIRED:22,22:"TYPE_APPlY_EXPIRED",TYPE_APPLY_STRONG_REMINDER:23,23:"TYPE_APPLY_STRONG_REMINDER",TYPE_ANCHOR_STREAM_SWITCH:24,24:"TYPE_ANCHOR_STREAM_SWITCH",TYPE_LINKER_CLICK_SCREEN:25,25:"TYPE_LINKER_CLICK_SCREEN",TYPE_LINKER_LOCK_POSITION:26,26:"TYPE_LINKER_LOCK_POSITION",TYPE_LINKER_FOLLOW_STRONG_GUIDE:27,27:"TYPE_LINKER_FOLLOW_STRONG_GUIDE",TYPE_LINKER_SHARE_VIDEO_IM:28,28:"TYPE_LINKER_SHARE_VIDEO_IM",TYPE_GUEST_INVITE:29,29:"TYPE_GUEST_INVITE",TYPE_GUEST_EXIT_CAST_SCREEN:30,30:"TYPE_GUEST_EXIT_CAST_SCREEN",TYPE_LINKER_SWITCH_SCENE:31,31:"TYPE_LINKER_SWITCH_SCENE",TYPE_LINK_PHASEINFO:32,32:"TYPE_LINK_PHASEINFO",TYPE_LINKER_CHANGE_PLAY_MODE:33,33:"TYPE_LINKER_CHANGE_PLAY_MODE",TYPE_LOW_BALANCE_FOR_PAID_LINKMIC:34,34:"TYPE_LOW_BALANCE_FOR_PAID_LINKMIC",TYPE_DEGRADE_ALERT:35,35:"TYPE_DEGRADE_ALERT",TYPE_ENLARGE_GUEST_INVITE:36,36:"TYPE_ENLARGE_GUEST_INVITE",TYPE_ENLARGE_GUEST_REPLY:37,37:"TYPE_ENLARGE_GUEST_REPLY",TYPE_ENLARGE_GUEST_APPLY:38,38:"TYPE_ENLARGE_GUEST_APPLY",TYPE_LINK_PREPARE_APPLY:39,39:"TYPE_LINK_PREPARE_APPLY",TYPE_LINK_CANCEL_PREPARE_APPLY:40,40:"TYPE_LINK_CANCEL_PREPARE_APPLY",TYPE_LINKER_CROSS_ROOM_UPDATE:41,41:"TYPE_LINKER_CROSS_ROOM_UPDATE",TYPE_LINKER_CHANGE_MULTI_PK_TEAM_INFO:42,42:"TYPE_LINKER_CHANGE_MULTI_PK_TEAM_INFO",TYPE_CROSS_ROOM_LINK_INVITE:43,43:"TYPE_CROSS_ROOM_LINK_INVITE",TYPE_CROSS_ROOM_LINK_REPLY:44,44:"TYPE_CROSS_ROOM_LINK_REPLY",TYPE_CROSS_ROOM_LINK_CANCEL_INVITE:45,45:"TYPE_CROSS_ROOM_LINK_CANCEL_INVITE",TYPE_LINK_RESUME_AUDIENCE:46,46:"TYPE_LINK_RESUME_AUDIENCE",TYPE_LINK_BATTLE_CONNECT:47,47:"TYPE_LINK_BATTLE_CONNECT",TYPE_RESUME_APPLY:48,48:"TYPE_RESUME_APPLY",TYPE_CROSS_ROOM_RTC_INFO:49,49:"TYPE_CROSS_ROOM_RTC_INFO",TYPE_ANCHOR_UPDATE_LINKMIC_CONFIG:50,50:"TYPE_ANCHOR_UPDATE_LINKMIC_CONFIG",TYPE_ANCHOR_UPDATE_LAYOUT:51,51:"TYPE_ANCHOR_UPDATE_LAYOUT",TYPE_APPLY_RANK_CHANGE:52,52:"TYPE_APPLY_RANK_CHANGE",TYPE_CHANGE_MEDIA_INFO:53,53:"TYPE_CHANGE_MEDIA_INFO",TYPE_LINKER_UILAYOUT_CHANGE:54,54:"TYPE_LINKER_UILAYOUT_CHANGE",TYPE_UPDATE_WAITING_USER_OFFSET:55,55:"TYPE_UPDATE_WAITING_USER_OFFSET",TYPE_REMOVE_WAITING_USER:56,56:"TYPE_REMOVE_WAITING_USER",TYPE_LINKER_PREPARE_INVITE:57,57:"TYPE_LINKER_PREPARE_INVITE",TYPE_LINKER_PREPARE_REPLY:58,58:"TYPE_LINKER_PREPARE_REPLY",TYPE_LINKER_CONFIRM_UNSILENCE:59,59:"TYPE_LINKER_CONFIRM_UNSILENCE",TYPE_LINKER_SWITCH_CHANNEL_INVITE:60,60:"TYPE_LINKER_SWITCH_CHANNEL_INVITE",TYPE_LINKER_SWITCH_CHANNEL_REPLY:61,61:"TYPE_LINKER_SWITCH_CHANNEL_REPLY",TYPE_LINKER_SWITCH_CHANNEL_CANCEL:62,62:"TYPE_LINKER_SWITCH_CHANNEL_CANCEL",TYPE_AUDIO_AVATAR_NOTICE:63,63:"TYPE_AUDIO_AVATAR_NOTICE",TYPE_RTC_ACTION:64,64:"TYPE_RTC_ACTION",TYPE_LINKER_CROSS_LINK_INFO_UPDATE:65,65:"TYPE_LINKER_CROSS_LINK_INFO_UPDATE",TYPE_LINKER_CROSS_LINK_FINISH:66,66:"TYPE_LINKER_CROSS_LINK_FINISH",TYPE_INIT_CHAT_ROOM:67,67:"TYPE_INIT_CHAT_ROOM",TYPE_LINKER_AUDIENCE_WAITING_LIST_CHANGE:68,68:"TYPE_LINKER_AUDIENCE_WAITING_LIST_CHANGE",TYPE_LINKER_UPDATE_LINK_TYPE_FORCE_OPEN_CAMERA:69,69:"TYPE_LINKER_UPDATE_LINK_TYPE_FORCE_OPEN_CAMERA",TYPE_LINKER_ENLARGE_UPDATE:70,70:"TYPE_LINKER_ENLARGE_UPDATE",TYPE_LINKER_CLIENT_UI_INFO_CHANGE:71,71:"TYPE_LINKER_CLIENT_UI_INFO_CHANGE",TYPE_LINKER_LIVE_CORE_BIZ_TAG_CHANGE:72,72:"TYPE_LINKER_LIVE_CORE_BIZ_TAG_CHANGE",TPYE_LINKER_SYS_KICK_OUT:101,101:"TPYE_LINKER_SYS_KICK_OUT",TPYE_LINKER_SYNC_WRDS:1e4,1e4:"TPYE_LINKER_SYNC_WRDS",TYPE_LINKER_POS_ATTR:10001,10001:"TYPE_LINKER_POS_ATTR",TYPE_RTS_UPDATE_STATUS:10002,10002:"TYPE_RTS_UPDATE_STATUS"}},809218:function(e,t,n){n.d(t,{K:function(){return _},M:function(){return c}});var i=n(818597),r=n(88648),o=n(717864),l=n(802913),a=n(725887),s=n(544406),u=n(797973);function _(e){return"uhd"===e}function c(){let{triggerDownloadClient:e}=(0,o.o)({channelId:l.g.Lv4k}),{roomStore:{isOlympicGame:t,setIsEnableOlympic4k:n}}=(0,i.o)(),_=(0,u.Z)(async()=>{try{window.collectEvent("add_to_desktop_click",{type:"4k",channel_id:l.g.Lv4k,enter_from:"live_detail",ug_channel_id:a.Le.getConfig(a.gI.WebUgChannelId)||""}),await s.a.openClient()}catch(t){e()}});return(0,r.useEffect)(()=>{n(t)},[t]),{enableOlympic4k:t,rediectDownload:t,openOrDownloadClient:_}}},877033:function(e,t,n){n.d(t,{v0C:function(){return v}});var i=n(134761),r=n(520739),o=n(878389);n(413806),n(826893),n(284961),n(927234),n(874386);var l=n(167951),a=n(742401),s=n(136832),u=n(914104),_=n(655235),c=n(785632),d=n(455239),E=n(214068),m=n(659933),h=n(782580);n(745618);class v extends _.TQ{setImRequestPath(e){this.polling.props.im_path=e}setWebsocketKey(e){this.polling.props.websocket_key=e}setInsertKey(e,t){this.insertData={insert_task_id:e,live_reason:t}}getimReponseHeader(){return this.headers.fetchHeader}getCursor(){var e;return null===this||void 0===this?void 0:null===(e=this.cursor)||void 0===e?void 0:e._first_cursor}getPolling(){return this.polling}getDecoder(){return null===this||void 0===this?void 0:this.decoder}getimPushResponseHeader(){return this.headers.pushHeader}getimHeader(){return this.headers}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.C7.ASYNC;if(n===E.C7.ASYNC){let n=e.split(",").map(e=>this.on(e.replace(c.nl,""),t));return()=>{n.forEach(e=>e())}}let i=e=>t([e]);this.cachedHandler.set(t,i);let r=e.split(",").map(e=>this.syncOn(e.replace(c.nl,""),i));return()=>{this.cachedHandler.delete(t),r.forEach(e=>e())}}unsubscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E.C7.ASYNC;if(n===E.C7.ASYNC){e.split(",").forEach(e=>this.off(e.replace(c.nl,""),t));return}let i=this.cachedHandler.get(t);this.cachedHandler.delete(t),e.split(",").forEach(e=>this.syncOff(e.replace(c.nl,""),i))}start(e){var t,n,i,o,l,s,_,d;arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{this.systemEmitter.on("header",(e,t)=>{if("http"===e&&!this.headers.fetchHeader){this.headers.fetchHeader=t;return}if("socket"===e){this.headers.pushHeader=t;return}});let u="15";if(!a.s){let e=(null===(s=window)||void 0===s?void 0:null===(l=s.__STORE__)||void 0===l?void 0:null===(o=l.roomStore)||void 0===o?void 0:null===(i=o.roomInfo)||void 0===i?void 0:null===(n=i.room)||void 0===n?void 0:null===(t=n.room_auth)||void 0===t?void 0:t.FirstFeedHistChat)||0;2===e&&(u="0")}"string"==typeof e?super.start({room_id:e,identity:c.nN.Audience,need_persist_msg_count:u,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason}):super.start((0,r._)({identity:c.nN.Audience,need_persist_msg_count:u,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason},e))}catch(e){try{(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",categories:{message:null==e?void 0:e.message,stack:null==e?void 0:null===(d=e.stack)||void 0===d?void 0:null===(_=d.toString)||void 0===_?void 0:_.call(d)},level:"warn",type:"log"}})}catch(e){}}}queuePush(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(e=>this.mock(e.method,e))}constructor(){var e;super(m.C,{host:(0,s.iE)().API_DOMAIN,aid:"6383",live_id:1,app_name:"douyin_web",did_rule:3,endpoint:"live_pc",support_wrds:1,user_unique_id:null===(e=(0,l.Es)())||void 0===e?void 0:e.user_unique_id,im_path:"/webcast/im/fetch/",websocket_key:[]},[],{emitter:new d.Q,get backdropWhenHidden(){if("undefined"==typeof window||(0,h.getInLiveMsgFetchOpt)())return[];return["ChatMessage","GiftMessage","LikeMessage"]},wrdsV1:["WebcastPaidLiveTypeModifyMessage"]}),(0,i._)(this,"headers",{}),(0,i._)(this,"insertData",{insert_task_id:"",live_reason:""}),(0,i._)(this,"cachedHandler",new Map);let t=(0,o._)((0,r._)({},this.wrds),{subscribe:(e,t)=>{let n=e.split(",").map(n=>this.wrds.on("RoomDataSyncMessage",e,t,"v1"));return()=>{n.forEach(e=>e())}},unsubscribe:(e,t)=>{e.split(",").forEach(e=>{this.wrds.off("RoomDataSyncMessage",e,t)})}});this.wrds=t,!a.s&&(window.__use_isaac_sdk=!0),this.systemEmitter.on("downgrade",e=>{var t,n,i,r,o,l;this.downgrade(e),(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-downgrade",metrics:{downgrade:1},categories:{type:scope,userId:null===(i=window.INITIAL_STATE)||void 0===i?void 0:null===(n=i.userStore)||void 0===n?void 0:null===(t=n.userInfo)||void 0===t?void 0:t.id_str,roomId:null===(l=window.INITIAL_STATE)||void 0===l?void 0:null===(o=l.roomStore)||void 0===o?void 0:null===(r=o.roomInfo)||void 0===r?void 0:r.roomId},type:"event"}})}),this.systemEmitter.on("error",(e,t)=>{var n,i,r,o,l,a;(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",metrics:{[e]:1},categories:{type:e,userId:null===(r=window.INITIAL_STATE)||void 0===r?void 0:null===(i=r.userStore)||void 0===i?void 0:null===(n=i.userInfo)||void 0===n?void 0:n.id_str,roomId:null===(a=window.INITIAL_STATE)||void 0===a?void 0:null===(l=a.roomStore)||void 0===l?void 0:null===(o=l.roomInfo)||void 0===o?void 0:o.roomId},content:`${t}`,level:"warn",type:"log"}})})}}},324867:function(e,t,n){var i=n(520739),r=n(878389);n(413806),n(826893),n(284961),n(429532),n(338172),n(882732),n(544943),n(874386),n(675373),n(779788);var o=n(567754),l=n(119566),a=n(136832),s=n(742401);let u=e=>e.split("?")[0].replace(/\//g,"_"),_=(e,t)=>{let n=(0,o.parse)(t.split("?")[1]),r=t.split("?")[0],u=(0,i._)({aid:6383,device_platform:"web"},n);!s.s&&Object.assign(u,(0,l.f)());let _=(0,o.stringify)(u);return r.startsWith("http")?`${r}?${_}`:s.s&&!a.r8?`consul:${e}${r}?${_}`:`${(0,a.ZP)().API_DOMAIN+r}?${_}`},c={"Content-type":"application/x-www-form-urlencoded"},d=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"webcast.web.api",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=_(o,t);if(null==e||e.logger.info("request path:",a),!e)return window.fetch(a,(0,r._)((0,i._)({credentials:"same-origin"},n),{headers:(0,i._)({},c,n.headers)}));{var s,d,E,m,h,v;let o=(0,i._)((0,r._)((0,i._)({handleMethod:u(t)},n),{metrics:e.metrics,headers:(0,i._)((0,r._)((0,i._)({},null!==(s=e.app.config.fetch.headers)&&void 0!==s?s:{}),{Cookie:e.headers.cookie,"user-agent":e.headers["user-agent"],"x-use-ppe":null!==(d=e.headers["x-use-ppe"])&&void 0!==d?d:"","x-use-boe":null!==(E=e.headers["x-use-boe"])&&void 0!==E?E:"","x-tt-env":null!==(m=e.headers["x-tt-env"])&&void 0!==m?m:"","X-Real-IP":e.headers["x-real-ip"],"X-Forwarded-For":e.header["x-forwarded-for"]}),c,n.headers)}),null!=l?l:{});e.headers["x-tt-stress"]&&(o.headers["x-tt-stress"]=e.headers["x-tt-stress"]);try{e.measureTime("fetch");let t=await e.fetch(a,o);return e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:t.status,retry:0,error:0}),t}catch(n){null===(v=e.metrics)||void 0===v||null===(h=v.emitCounter)||void 0===h||h.call(v,"isomorphic_request.retry",1,e.app.config.psm,{url:a});let t=await e.fetch(a,o).catch(t=>{throw e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:-1,retry:1,error:1}),t});return e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:t.status,retry:1,error:0}),t}}};t.ZP=d},951320:function(e,t,n){n.d(t,{S:function(){return N}});var i=n(520739),r=n(878389),o=n(368200);n(675373),n(874386);var l=n(563097),a=n(88648),s=n(355011),u=n(338426),_=n(315985),c=n(817938),d=n(155845),E=n(95596),m=n(207480),h=n(713097),v=n.n(h),I=n(35841),f=n(517054),P=n(740824);let L=(0,u.ZP)(()=>Promise.all([n.e("22556"),n.e("23145"),n.e("21248"),n.e("11073"),n.e("8734")]).then(n.bind(n,54291)),{ssr:!1});function T(e){let t=(0,a.useRef)(null),[n,u]=(0,a.useState)(!1);(0,_.Z)(()=>u(!1),t);let{maxLength:E,placeholder:m,disabled:h,className:T,onSend:N}=e,S=(0,o._)(e,["maxLength","placeholder","disabled","className","onSend"]),{enablePrivilegeDanmu:p,showPrivilegePanel:g}=(0,f.B3)(e=>({enablePrivilegeDanmu:e.enable,showPrivilegePanel:e.showPanel})),C=(0,s._i)(e=>e.editor),y=(0,s._i)(e=>e.isEmpty),A=(0,c.Z)(null==C?void 0:C.getRootContainer());(0,d.Z)("enter",e=>{A&&(e.preventDefault(),null==N||N())},{exactMatch:!0,useCapture:!0});let R=(0,f.MW)()||m;return(0,l.jsxs)("div",(0,r._)((0,i._)({},S),{className:v()(T,I.Z.commentEditorWrap,A&&I.Z.focus,(n||A||!y||g)&&I.Z.focusOrNoEmpty),onClick:()=>{u(!0),null==C||C.focus()},"data-e2e":"live-chatting",ref:t,children:[p&&(0,l.jsx)(P.K,{className:I.Z.danmakuSwitch}),(0,l.jsx)(L,{editable:!h,placeholder:R,maxLength:g?15:E,className:I.Z.commentEditor})]}))}let N=(0,a.memo)(e=>(0,l.jsx)(E.k2,{componentName:m.l.COMMENT_EDITOR,children:(0,l.jsx)(T,(0,i._)({},e))}))},130047:function(e,t,n){n(874386);var i=n(563097),r=n(88648);n(414621);var o=n(713097),l=n.n(o),a=n(605430),s=n(842197),u=n(971475),_=n(520339);t.Z=function(e){let{className:t,onEmojiClick:n,style:o,emojiList:c,showEmoji:d,emojiTea:E,setShowEmoji:m}=e,{list:h}=(0,r.useContext)(a.Z),{roomStore:{activityEmojiGroup:v}}=(0,_.oR)(),[I,f]=r.useState([]),P=(null==h?void 0:h.length)>0?h:c,L=(0,r.useRef)(null),[T,N]=r.useState(!1);r.useEffect(()=>{if(d){var e,t;null==E||E.livesdkEmojiShow({tab_title:null==v?void 0:null===(t=v[0])||void 0===t?void 0:null===(e=t.emoji_group)||void 0===e?void 0:e.name}),window.__act_message_source__=""}f((0,s.PA)(P))},[P,d,v]);let S=(0,r.useCallback)(function(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];i&&(null==E||E.livesdkEmojiClick({emoji_name:e.display_name,tab:t})),null==n||n(e)},[n]),p=(0,r.useCallback)(e=>{var t,n;(null==L?void 0:L.current)&&!(null==L?void 0:null===(n=L.current)||void 0===n?void 0:null===(t=n.contains)||void 0===t?void 0:t.call(n,null==e?void 0:e.target))&&T&&(null==m||m(!1))},[T]);(0,r.useEffect)(()=>(document.addEventListener("click",p),!T&&N(!0),()=>{document.removeEventListener("click",p)}),[T,N,p]);let g=(0,r.useRef)(null);return(0,r.useEffect)(()=>{g.current&&g.current.addEventListener("wheel",e=>{e.stopPropagation()})},[]),(0,i.jsx)("div",{className:l()("emoji-panel",t),style:o,onClick:e=>e.stopPropagation(),ref:L,children:(0,i.jsxs)("div",{className:"emoji-panel-list",onWheel:e=>{e.stopPropagation()},ref:g,children:[(null==I?void 0:I.length)>0&&(0,i.jsxs)("div",{className:"emoji-panel__common",children:[(0,i.jsx)("h3",{children:"最常使用"}),(0,i.jsx)("div",{className:"emoji-panel__common-use-list",children:null==I?void 0:I.map(e=>(0,i.jsx)("img",{onClick:()=>n&&S(e,"quick"),src:e.url,className:l()("emoji-panel__common-img")}))})]}),(0,i.jsx)(u.Z,{onClick:e=>n&&S(e,"all",!1),emojiTea:E}),(0,i.jsxs)("div",{className:"emoji-panel__all",children:[(null==I?void 0:I.length)>0&&(0,i.jsx)("h3",{children:"全部表情"}),(0,i.jsx)("div",{className:"emoji-panel__all-list",children:null==P?void 0:P.map(e=>(0,i.jsx)("img",{onClick:()=>n&&S(e,"all"),src:e.url,className:l()("emoji-panel__all-img")}))})]})]})})}},794006:function(e,t,n){n.d(t,{_:function(){return I}});var i=n("520739"),r=n("878389");n("874386");var o=n("563097"),l=n("88648");n("706652");var a=n("713097"),s=n.n(a),u=n("7981"),_=n("39072"),c=n("921028"),d=n("605430"),E=n("842197"),m=n("971475"),h=function(e){let{className:t,style:n,emojiList:i,emojiTea:r,onEmojiClick:a}=e,{list:u}=(0,l.useContext)(d.Z),[_,c]=l.useState([]),h=(null==u?void 0:u.length)>0?u:i,v=(0,l.useRef)(null);l.useEffect(()=>{c((0,E.PA)(h))},[h]);let I=(0,l.useCallback)((e,t)=>{null==r||r.livesdkEmojiClick({emoji_name:e.display_name,tab:t}),null==a||a(e)},[a]),f=(0,l.useRef)();return(0,l.useEffect)(()=>{f.current&&f.current.addEventListener("wheel",e=>{e.stopPropagation()})},[]),(0,o.jsx)("div",{className:s()("emoji-panel-normal-wrapper",t),style:n,ref:v,children:(0,o.jsxs)("div",{className:"emoji-panel-list",onWheel:e=>{e.stopPropagation()},ref:f,children:[(null==_?void 0:_.length)>0&&(0,o.jsxs)("div",{className:"emoji-panel__common",children:[(0,o.jsx)("h3",{children:"最常使用"}),(0,o.jsx)("div",{className:"emoji-panel__common-use-list",children:null==_?void 0:_.map(e=>(0,o.jsx)("img",{onClick:()=>I(e,"quick"),src:e.url,className:s()("emoji-panel__common-img")},e.url))})]}),(0,o.jsx)(m.Z,{onClick:e=>a&&I(e,"all"),emojiTea:r}),(0,o.jsxs)("div",{className:"emoji-panel__all",children:[(null==_?void 0:_.length)>0&&(0,o.jsx)("h3",{children:"全部表情"}),(0,o.jsx)("div",{className:"emoji-panel__all-list",children:null==h?void 0:h.map(e=>(0,o.jsx)("img",{onClick:()=>I(e,"all"),src:e.url,className:s()("emoji-panel__all-img")},e.url))})]})]})})},v=n("520339");let I=l.memo(l.forwardRef((e,t)=>{let{wrapStyle:n,style:a,emojiList:d,onEmojiClick:E,emojiTea:m}=e,[I,f]=(0,l.useState)(!1),[P,L]=(0,l.useState)("emoji"),T=(0,l.useCallback)(()=>{f(!1)},[]);(0,l.useEffect)(()=>(document.addEventListener("click",T),()=>{document.removeEventListener("click",T)}),[]),(0,l.useImperativeHandle)(t,()=>({show:e=>{f(!0),e&&L(e)},hide:()=>{f(!1)},toggle:()=>{f(!I)}}));let{isInPreview:N}=(0,v.DQ)();return(0,o.jsx)("div",{ref:t,className:s()("emoji-panel-wrapper",I?"":"invisible",{isInPreview:N}),onClick:e=>{e.stopPropagation()},style:n,children:(0,o.jsx)("div",{style:(0,r._)((0,i._)({},a),{height:"100%"}),children:(0,o.jsx)(u.Z,{defaultActiveKey:"emoji",activeKey:P,items:[{label:"小表情",key:"emoji",children:(0,o.jsx)(h,{emojiList:d,onEmojiClick:E,emojiTea:m})},{label:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.jsx)(_.Z,{style:{marginRight:"4px"}}),"会员表情"]}),key:"vipEmoji",children:(0,o.jsx)(c.E,{})}]})})})}))},842197:function(e,t,n){n.d(t,{BQ:function(){return d},M9:function(){return l},PA:function(){return _},p3:function(){return a},qA:function(){return u},yO:function(){return c}}),n(927234),n(268917),n(874386),n(413806),n(826893),n(981168),n(779788);var i=n(193533),r=n.n(i);n(645260);var o=n(311474);function l(e){return e?"string"==typeof e?e:"number"==typeof e?`${e}`:r().fromBits(e.low,e.high,e.unsigned).toString():""}n(88648);let a=e=>{var t,n;return l((null==e?void 0:null===(n=e.payload)||void 0===n?void 0:null===(t=n.common)||void 0===t?void 0:t.msg_id)||(0,o.Z)())},s=e=>!isNaN(Number(e)),u=e=>Object.keys(e).filter(e=>!s(e)).map(t=>e[t]),_=e=>{let t={};try{var n;t=JSON.parse(null!==(n=window.localStorage.getItem("commonEmoji"))&&void 0!==n?n:"")}catch(e){t={}}let i=Object.keys(t),r=[];return i.length>0&&i.forEach((t,n)=>{if(n<6){var i;let n=null==e?void 0:null===(i=e.filter(e=>(null==e?void 0:e.display_name)===t))||void 0===i?void 0:i[0];n&&r.push(n)}}),r},c=(e,t)=>{let n=e.split(/(\[.*?])/),i=[];return t?(n.forEach(e=>{var n;null==t||null===(n=t.emoji_group)||void 0===n||n.emoji_list.forEach(n=>{var r;e===`[${null==t?void 0:null===(r=t.emoji_group)||void 0===r?void 0:r.name}_${null==n?void 0:n.name}]`&&i.push(n)})}),i):i},d=(e,t)=>{if(0===c(e,t).length||!t)return"";try{var n;let i=[];return null==t||null===(n=t.emoji_group)||void 0===n||n.emoji_list.forEach(n=>{var r;let o=`[${null==t?void 0:null===(r=t.emoji_group)||void 0===r?void 0:r.name}_${null==n?void 0:n.name}]`,l=0,a=0;for(let t=0;t<e.length;t++){let r=e[t];"["===r&&(l=t),"]"===r&&(a=t,e.slice(l,a+1)===o&&i.push({type:1,value:n.id,start:l,length:o.length}))}}),i.sort((e,t)=>e.start-t.start),JSON.stringify(i)}catch(e){return""}}},403300:function(e,t,n){var i=n(520739),r=n(878389),o=n(563097),l=n(88648);let a=(0,l.forwardRef)((e,t)=>(0,o.jsx)("svg",(0,r._)((0,i._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.5 10a2 2 0 0 1 2-2h13a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-13a2 2 0 0 1-2-2V10zm3 4.5v-2h1.499V11h2v2.5a1 1 0 0 1-1 1H10.5zM20 11h-2v2.498a1 1 0 0 0 1 1h2.5v-2H20V11zm0 8.5h1.5v-2H19a1 1 0 0 0-1 1V21h2v-1.5zM12 21v-1.498h-1.5v-2H13a1 1 0 0 1 1 1V21h-2z",fill:"#fff"})})));t.Z=a}}]);