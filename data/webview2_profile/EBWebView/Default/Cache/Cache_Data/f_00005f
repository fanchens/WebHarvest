"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["51761"],{265482:function(e,t,l){var i=l(563097);l(88648);var n=l(901747),o=l(310528);t.Z=e=>{let{children:t,mobileUrl:l,applicableDevice:a}=e,d=(0,n.Yr)();return(0,i.jsx)(o.$,{mobileUrl:l,nonce:d,applicableDevice:a,children:t})}},730510:function(e,t,l){l.d(t,{z:function(){return g}}),l("874386");var i=l("563097"),n=l("88648"),o=l("713097"),a=l.n(o),d=l("441447"),r=l("343049"),s=l("465769"),u=l("30593"),c=l("140447"),v=l("49279"),m=l("66047"),_=l("575030"),f="jLGIrBFY",p="BEL49lJv",h=l("487330");let g=e=>{let{abtest:t,show:l,awemeInfoList:o,swiper:g,playNextFunc:y,playPrevFunc:w,className:I,defaultCssHidden:x=!0,from:b,isVideoSupportMP4:E=!0}=e,{fullScreenQuestionVars:T}=(0,h.Iq)(e=>{let{fullScreenQuestionVars:t}=e;return{fullScreenQuestionVars:t}}),[C,N]=(0,n.useState)(0),[P,S]=(0,n.useState)(!0),{awemeFeed:L}=(0,v.j)(),A=L.useValue("modalAwemeInfo",e=>e?"inner":"outer"),k=!L.useValue("nextAwemeInfo",Boolean),j=!L.useValue("prevAwemeInfo",Boolean),D=(0,m._)();return((0,n.useEffect)(()=>{if(g){let e=()=>{N(null==g?void 0:g.activeIndex)};try{g.on("slideChange",e),e()}catch(e){}return()=>{try{g.off("slideChange",e)}catch(e){}}}},[g]),(0,n.useEffect)(()=>{let e=d.listen(d.EVENT.changeVideoSideBar,e=>{let{isShowRelatedCard:t}=e;"Boolean"===(0,r.tQ)(t)&&S(t)});return()=>e()},[]),(0,c.Z)("OutsideSwitchButton",{abtest:t,awemeInfoList:o,swiper:g,className:I,innerDisableNext:k,innerDisablePrev:j,stream:A,activeIndex:C,sideBarShow:P}),l)?(0,i.jsx)(u.I,{playNextFunc:()=>{if(!_.f.playNextInterceptor(T))L.getValue("modalAwemeInfo")?L.dispatch("activeIndex",L.getValue("activeIndex")+1):y()},playPrevFunc:()=>{if(!_.f.playPrevInterceptor(T))L.getValue("modalAwemeInfo")?L.dispatch("activeIndex",L.getValue("activeIndex")-1):w()},className:a()(f,{[p]:x&&!P},I),disableNext:E&&"outer"!==A?k:!("recommend"===(0,s.vM)()&&(null==D?void 0:D.enableNextSlide))&&C===o.length-1,disablePrev:E&&"outer"!==A?j:0===C||!o[C-1]}):null}},409349:function(e,t,l){let i,n,o,a;l.d(t,{p:function(){return rU}});var d=l("520739"),r=l("878389"),s=l("368200");l("874386"),l("927234"),l("250440"),l("675373"),l("338172");var u=l("563097"),c=l("909543"),v=l("549519"),m=l("88648");function _(e){let t=e.resolve instanceof Promise?(0,m.use)(e.resolve):e.resolve,l="function"==typeof e.children?e.children(t):e.children;return(0,u.jsx)(u.Fragment,{children:l})}function f(e){return(0,u.jsx)(m.Suspense,{fallback:e.fallback,children:(0,u.jsx)(_,{resolve:e.resolve,children:e.children})})}var p=l("811796"),h=l("713097"),g=l.n(h),y=l("948375"),w=l("465571"),I=l("476261"),x=l("832052"),b=l("399242"),E=l("265656"),T=l("742740"),C=l("455499"),N=l("828782"),P=l("324794"),S=l("564231"),L=l("533155"),A=l("66047"),k=l("798644");let j=()=>{let e=(0,A._)(),t=(0,P.ho)(e=>e.setSmallWindowScene),l=(0,m.useCallback)(e=>{try{var l;let i=k.s.getPlayer(e);if(!i||(null==i?void 0:null===(l=i.config)||void 0===l?void 0:l.awemeType)!==x.e.Normal)return;navigator.mediaSession&&navigator.mediaSession.setActionHandler&&navigator.mediaSession.setActionHandler("enterpictureinpicture",async function(){if((0,E.Dx)()){var e,l,n,o,a,d;t(S.T.AutoPip),L.Z.sendLog("autoSmallWindow",{enter_from:(0,T.yW)(),group_id:(null==i?void 0:null===(e=i.config)||void 0===e?void 0:e.vid)||(null==i?void 0:null===(o=i.config)||void 0===o?void 0:null===(n=o.baseConfig)||void 0===n?void 0:null===(l=n.mediaInfo)||void 0===l?void 0:l.id)}),null===(d=i.plugins)||void 0===d||null===(a=d.pip)||void 0===a||a.requestPIP()}})}catch(e){}},[]);(0,m.useEffect)(()=>{if(!(0,C.Kv)()||(0,N.DT)()||(0,N.tq)()||!(null==e?void 0:e.enableAutoPip))return;let t=k.s.addCb({event:b.Lw.OnRegister,cb:e=>{let{playerId:t}=e;(0,E.Dx)()&&l(t)}});return()=>{t(),navigator.mediaSession.setActionHandler("enterpictureinpicture",null)}},[])};var D=l("336347"),R=l("948431"),M=l("867961"),F=l("791483"),B=l("623582"),O=l("597087"),V=l("737470"),W=l("594235"),U=l("888163"),H=l("132607"),G=l("607412"),z=l("453498"),Z=l("725887"),K=l("983253"),Q=l("781926"),$=l("852664"),Y=l("623527"),q=l("441447"),J=l("371790"),X=l("792639"),ee=l("797460"),et=l("737271"),el=l("259624"),ei=l("286350"),en=l("245861"),eo=l("401156");let ea=e=>{let{awemeInfoList:t,setAwemeInfoList:l}=e,i=(0,m.useRef)(!1);(0,m.useEffect)(()=>{(0,eo.xg)()&&(null==t?void 0:t.length)&&!i.current&&(l(t.filter(e=>!(0,en.p)(e))),i.current=!0)},[t])};var ed=l("254890"),er=l("798256"),es=l("118687"),eu=l("212623"),ec=l("953342"),ev=l("53659"),em=l("833181"),e_=l("580264"),ef=l("338478"),ep=l("226683"),eh=l("320028"),eg=l("985703"),ey=l("119422"),ew=l("774281"),eI=l("637632"),ex=l("504995"),eb=l("756560"),eE=l("376978"),eT=l("613480"),eC=l("876877"),eN=l("652458");l("544943"),l("179133"),l("826893"),l("819117");var eP=l("302461"),eS=l("63405");let eL=()=>{(0,eP.o)(()=>{if((0,N.DT)()){let e;let t=new URLSearchParams(window.location.search);eS.invoke("isMiniWindowLoading").then(t=>{e=null==t?void 0:t.data}).finally(()=>{"1"===t.get("open_mini_window")&&!1!==e&&setTimeout(()=>{q.emit(q.EVENT.changeMinWindows,{event:"check",isMiniWin:!1,clickMethod:"default",source:"small_window_widget"}),t.delete("open_mini_window"),window.history.pushState({},"",`?${t.toString()}`),Z.Le.setConfig(Z.gI.IsMiniWinFromWidget,!0),setTimeout(()=>{eS.invoke("mainViewMoveTopByBounds")},100)},30)})}},[])};var eA=l("998415"),ek=l("62234"),ej=l("91178"),eD=l("957777"),eR=l("601109");let eM=(0,m.forwardRef)((e,t)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({width:88,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,u.jsx)("rect",{width:88,height:32,rx:16,fill:"#000",fillOpacity:".34"}),(0,u.jsx)("rect",{x:".25",y:".25",width:87.5,height:31.5,rx:15.75,stroke:"#fff",strokeOpacity:".2",strokeWidth:".5"}),(0,u.jsx)("path",{d:"M17.218 10.206h3.766v4.256H19.78v2.31h1.358v.896H19.78v2.506c.476-.168.938-.35 1.358-.532v.91c-1.232.546-2.646 1.05-4.27 1.526l-.28-.91c.196-.056.378-.098.56-.154v-5.082h.826v4.844c.322-.098.63-.196.924-.294v-6.02h-1.68v-4.256zm2.87 3.416v-2.576h-1.974v2.576h1.974zm3.598 2.016V9.576h.952v6.356c-.028 2.968-.826 5.138-2.38 6.51l-.756-.658c1.26-1.092 1.974-2.73 2.142-4.928a8.95 8.95 0 0 1-1.918 1.722l-.532-.896a9.345 9.345 0 0 0 2.492-2.044zm4.662-4.326l.854.406c-.462 1.12-1.008 2.1-1.624 2.926l-.756-.532a11.526 11.526 0 0 0 1.526-2.8zm-1.652 4.956v4.55c0 .28.126.42.406.42h.616c.266 0 .448-.098.546-.266.14-.238.224-.91.28-2.002l.882.28c-.084 1.386-.252 2.226-.504 2.52-.224.252-.56.378-1.022.378h-1.092c-.728 0-1.078-.378-1.078-1.12V9.576h.966v5.67a14.193 14.193 0 0 1 2.59 2.184l-.574.868a14.556 14.556 0 0 0-2.016-2.03zm-4.508-4.564c.476.826.924 1.736 1.344 2.73l-.742.364c-.448-1.008-.91-1.904-1.414-2.702l.812-.392zm9.534-1.946c.952.742 1.75 1.484 2.394 2.212l-.728.742c-.574-.714-1.358-1.484-2.366-2.296l.7-.658zm8.512 12.39c-.798 0-1.666-.014-2.604-.028-.952-.014-1.722-.098-2.296-.252-.588-.168-1.106-.518-1.554-1.022-.196-.238-.392-.35-.574-.35-.336 0-.91.644-1.694 1.96l-.756-.672c.756-1.204 1.414-1.932 2.002-2.184v-4.242h-2.016v-.952h2.982v5.25c.112.084.238.182.364.322.364.392.742.686 1.148.882.448.182 1.12.28 1.988.308.77.014 1.736.028 2.884.028.616 0 1.232-.014 1.876-.014.63-.014 1.12-.028 1.456-.056l-.252 1.022h-2.954zm-.42-1.876h-1.988l-.224-.966c.644.042 1.274.07 1.862.07.392 0 .602-.196.602-.574v-5.95h-5.292v-.994h5.292V9.59h1.022v2.268h2.072v.994h-2.072v6.188c0 .812-.434 1.232-1.274 1.232zM36.3 14.098c.896 1.036 1.582 1.946 2.058 2.73l-.812.56c-.504-.84-1.176-1.764-2.03-2.786l.784-.504zm15.064-4.746c.266.504.518 1.064.77 1.694h5.096v.966H46.856v3.136c-.056 3.066-.532 5.516-1.442 7.364l-.826-.742c.784-1.596 1.204-3.794 1.232-6.622v-4.102h5.208c-.224-.546-.49-1.05-.77-1.498l1.106-.196zm18.242 7.882v5.152h-1.022v-.742H61.5v.742h-1.022v-5.152h9.128zM61.5 20.692h7.084V18.2H61.5v2.492zm-.182-8.19a10.19 10.19 0 0 1-1.694 1.792l-.602-.798c1.26-1.008 2.128-2.254 2.576-3.724l1.008.112a9.11 9.11 0 0 1-.686 1.652h2.744V9.548h1.022v1.988h4.578v.966h-4.578v2.268h5.642v.994H58.672v-.994h5.992v-2.268h-3.346z",fill:"#fff",fillOpacity:".9"})]})));var eF=l("115627"),eB=l("289228"),eO=l("443073");let eV=e=>{let{playNextFunc:t,awemeInfo:l}=e;return(0,u.jsx)("div",{className:eR.default.container,children:(0,u.jsx)("div",{className:eR.default.btn,onClick:()=>{t(),B.logInstance.sendLog("brandAdSkip",{group_id:null==l?void 0:l.awemeId})},children:(0,u.jsx)(eF.Z,{src:eM,width:"88",height:"32",viewBox:"0 0 88 32"})})})},eW=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"SlientPlayPlugin",Slardar:t,children:(0,u.jsx)(eV,(0,d._)({},e))})};l("268917");var eU=l("590682"),eH=l("981182"),eG=l("851161"),ez=l("877639"),eZ=l.n(ez),eK=l("116861"),eQ=l("684767"),e$=l("335101");let eY=e=>{let{brandAdComponentItem:t,openUrl:l,isActive:i,awemeInfo:n,position:o="center"}=e,a=(0,e$.n)();(0,m.useEffect)(()=>{var e;let l=q.listen(q.EVENT.quitInnerFeed,()=>{var e;((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle")}),n=q.listen(q.EVENT.InnerFeedReady,()=>{var e;((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.m)("brandMiddle")});return((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")?(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle"):(0,eb.m)("brandMiddle"),!i&&(0,eb.m)("brandMiddle"),()=>{l(),n(),(0,eb.m)("brandMiddle")}},[t,i]),(0,m.useEffect)(()=>{let e=e=>{var a,d,r,s,u,c,v,m,_,f,p;if((0,eK.j)(e.code,e.keyCode)||(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.nodeName)==="INPUT"||(null==e?void 0:null===(d=e.target)||void 0===d?void 0:d.nodeName)==="TEXTAREA"||(null==e?void 0:null===(r=e.target)||void 0===r?void 0:r.contentEditable)==="true"||!i||!t)return;let h=(null==t?void 0:null===(s=t.brand_ad_component_float_tip)||void 0===s?void 0:s.actions)||[],g=null===(u=k.s.getAllPlayer())||void 0===u?void 0:u.length;h.includes("KEYBOARD")&&1===g&&(q.emit(q.EVENT.videoPause,"useBrandOpenEvent"),B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(v=n.webRawData)||void 0===v?void 0:null===(c=v.brandAd)||void 0===c?void 0:c.brand_type],img_url:null==t?void 0:null===(m=t.brand_ad_component_float_tip)||void 0===m?void 0:m.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener")),h.includes("KEYBOARD_SPACE")&&1===g&&(32===e.keyCode||"Space"===e.code)&&(B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(f=n.webRawData)||void 0===f?void 0:null===(_=f.brandAd)||void 0===_?void 0:_.brand_type],img_url:null==t?void 0:null===(p=t.brand_ad_component_float_tip)||void 0===p?void 0:p.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener"))},d=eZ()(()=>{var e,n;if(!!i&&!!t)((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("WHEEL")&&1===(null===(n=k.s.getAllPlayer())||void 0===n?void 0:n.length)&&(q.emit(q.EVENT.videoPause,"useBrandOpenEvent_wheelHandler"),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener"))},5e3,{trailing:!1});return document.addEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.addEventListener("wheel",d,!0),()=>{document.removeEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.removeEventListener("wheel",d,!0)}},[t,l,i,a,n,o])};var eq=l("902676"),eJ=l("901046"),eX=l("769901");let e0=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p}=e||{},[h,y]=(0,m.useState)(!1),[w,I]=(0,m.useState)(!1),x=(0,m.useRef)(!1);(0,eG.e)({timerCb:e=>{if(x.current)return;let{currentTime:t,isEnd:l}=e,i=p.show_time,n=p.show_time+.5;t>=i&&y(!0),t>=n&&I(!0),l&&!x.current&&(y(!0),I(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let b=eZ()(e=>{var t,l;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null==p?void 0:p.img_url,position:"center",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"splash_ad"});return}q.emit(q.EVENT.videoPause,"MiddleFloatTip_onClick")},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(eq.default.adWrapper,v,{[eq.default.show]:h}),style:{width:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.width,height:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.height},children:(0,u.jsxs)(eJ.a,{onClick:e=>b(e),className:eq.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:[(0,u.jsx)("img",{className:eq.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),y(!1),x.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}}),p.has_guide&&w&&(0,u.jsx)("img",{src:eX,className:eq.default.tapIcon})]})})},e1=e=>{var t,l,i,n;let{awemeInfo:o,className:a,isActive:d,onBrandComponentClose:r,onBrandComponentShow:s}=e||{},[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(!1),[p,h]=(0,m.useState)(),y=(0,m.useRef)([]),w=null==o?void 0:null===(t=o.webRawData)||void 0===t?void 0:t.brandAd;return((0,eG.e)({timerCb:e=>{var t,l;let i=!1;for(let n=0;n<(null===(t=w.biz_content.brand_ad_component_config)||void 0===t?void 0:t.middle.length);n++){let t=null===(l=w.biz_content.brand_ad_component_config)||void 0===l?void 0:l.middle[n];if(void 0===t.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&t.brand_ad_component_type===V.Wy.Img){h(t),i=!0;break}}else if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&e.currentTime<=t.brand_ad_component_float_tip.disappear_time&&t.brand_ad_component_type===V.Wy.Img){h(t),i=!0;break}}!i&&h(null)},stopBySeeking:!1,awemeInfo:o,isActive:d,needInit:!0}),eY({brandAdComponentItem:p,openUrl:w.open_url,isActive:d,awemeInfo:o}),(0,m.useEffect)(()=>{var e,t,l,i,n;p&&!y.current.includes(null==p?void 0:null===(e=p.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==o?void 0:null===(l=o.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"center",icon_type:"image"}),y.current.push(null===(n=p.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[p]),_||c||(null==p?void 0:p.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsx)("div",{className:g()(a,eH.default.container),style:{bottom:`${null!==(n=null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:null===(l=i.position)||void 0===l?void 0:l.bottom)&&void 0!==n?n:96}px`},children:(0,u.jsx)(e0,{awemeInfo:o,isActive:d,onBrandComponentClose:()=>{null==r||r(),f(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==w?void 0:w.brand_type]})},onImgError:()=>{v(!0)},brandAdComponentFloatTip:p.brand_ad_component_float_tip})})};function e2(e){var t,l,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(t=v.webRawData)||void 0===t?void 0:t.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.middle)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(l=i.brand_ad_component_float_tip)||void 0===l?void 0:l.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.middle)||void 0===r?void 0:r.length)>0?(0,u.jsx)(e1,(0,d._)({},e)):null}let e4=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"MiddleFeedBrandAd",Slardar:t,children:(0,u.jsx)(e2,(0,d._)({},e))})};var e3=l("495437"),e5=l("30593"),e6=l("135638"),e8=l("644071"),e7=l("675221"),e9=l("508471"),te=l("770268"),tt=l("213794"),tl=l("957504"),ti=l("270547"),tn=l("625617"),to=l("132654"),ta=l("804074"),td=l("415124"),tr=l("23171"),ts=l("954196"),tu=l("462471"),tc=l("765208"),tv=l("872068"),tm=l("578925"),t_=l("183762"),tf=l("567341"),tp=l("259702"),th=l("433012"),tg=l("309063"),ty=l("38790"),tw=l("275740"),tI=l("992074"),tx=l("443291"),tb=l("420863"),tE=l("513709"),tT=l("302759"),tC=l("640829"),tN=l("529961"),tP=l("742758"),tS=l("140786");l("413806");var tL=l("218805"),tA=l("594649"),tk=l("490377"),tj=l("99888"),tD=l("860805");let tR=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{let e=(0,em.Rx)(t);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(i=>{!l[i]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:i,adType:V.Z9.Download,logId:null==t?void 0:t.logPb,creativeId:null==e?void 0:e.creative_id}})})},[l,t])};var tM=l("85154"),tF=l("999981"),tB=l("212271"),tO=l("801636");let tV=e=>{let{awemeInfo:t,isActive:l,adData:i,isHide:n=!1}=e||{},{product_name:o,button_background_color:a,ad_title:d,word_image_url:r,image_url:s,button_text:c}=i,v=(0,m.useRef)(0);(0,m.useEffect)(()=>{if(l){var e,i;let l=(0,em.Rx)(t),n=null==l?void 0:null===(i=l.track_url_list)||void 0===i?void 0:null===(e=i.url_list)||void 0===e?void 0:e[0];n&&(0,tj.R)(n)}},[t,l]);let{displayState:_}=(0,tF.I)({awemeInfo:t,isActive:l,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),f=eZ()((e,l)=>{if(_===tB.cL.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(t);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedDownloadAd",cid:null==i?void 0:i.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1});return(0,m.useEffect)(()=>{v.current=0},[t]),(0,m.useEffect)(()=>{let e;if(!!l)return _===tB.cL.NORMAL_LIGHT&&v.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),v.current+=1},1e3)),()=>{clearTimeout(e)}},[l,_]),tR({awemeInfo:t,adData:i}),(0,u.jsx)("div",{className:g()(tM.default.adWrapper,{[tM.default.hasTransition]:!(_===tB.cL.HIDDEN||n),[tM.default.adWrapperHidden]:_===tB.cL.HIDDEN||n}),id:tM.default.adWrapper,children:(0,u.jsxs)("div",{className:tM.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:tM.default.adSource,onClick:e=>f(e,tB.tU.Source),children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:tM.default.adIcon}),(0,u.jsx)("span",{className:tM.default.adName,children:o})]}),_>tB.cL.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,tB.tU.Title),className:tM.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:r,iconHeight:30,iconWidth:30,className:tM.default.moreIcon}),(0,u.jsx)("div",{className:tM.default.split}),(0,u.jsx)("div",{className:tM.default.adTitle,children:d})]}),(0,u.jsx)("div",{className:tM.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>f(e,tB.tU.Button),style:{background:_<=tB.cL.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:a},children:(0,u.jsx)("span",{children:c||"立即下载"})})})]})})};function tW(e){let{awemeInfo:t}=e||{},l=(0,ey.L)(t),i=(0,tk.rQ)(t);return l&&i?(0,u.jsx)(tV,(0,r._)((0,d._)({},e),{adData:i})):null}let tU=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"FeedDownloadAd",Slardar:t,children:(0,u.jsx)(tW,(0,d._)({},e))})};var tH=l("350173");let tG=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{var e;let i=(0,em.Rx)(t);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!l[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:e,adType:V.Z9.Mp,logId:null==t?void 0:t.logPb,creativeId:null==i?void 0:i.creative_id}})});let n=(0,em.BD)(t);(null==n?void 0:null===(e=n.lynx_raw_data)||void 0===e?void 0:e.web_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"web_url",adType:V.Z9.Mp,logId:null==t?void 0:t.logPb,creativeId:null==i?void 0:i.creative_id}})},[l,t])},tz=e=>{let t=(0,m.useRef)(null),{awemeInfo:l,isActive:i,adData:n,isHide:o=!1}=e||{},{product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v}=n,_=(0,m.useRef)(0),f=eZ()((e,t)=>{if(p===tB.cL.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(l);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedMpAd",cid:null==i?void 0:i.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1}),{displayState:p}=(0,tF.I)({awemeInfo:l,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});return(0,m.useEffect)(()=>{_.current=0},[l]),(0,m.useEffect)(()=>{let e;if(!!i)return p===tB.cL.NORMAL_LIGHT&&_.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),_.current+=1},1e3)),()=>{clearTimeout(e)}},[i,p]),tG({awemeInfo:l,adData:n}),(0,u.jsx)("div",{ref:t,className:g()(tH.default.adWrapper,{[tH.default.hasTransition]:!(p===tB.cL.HIDDEN||o),[tH.default.adWrapperHidden]:p===tB.cL.HIDDEN||o}),id:tH.default.adWrapper,children:(0,u.jsxs)("div",{className:tH.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:tH.default.adSource,onClick:e=>f(e,tB.tU.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:tH.default.adIcon}),(0,u.jsx)("span",{className:tH.default.adName,children:a})]}),p>tB.cL.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,tB.tU.Title),className:tH.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:tH.default.moreIcon}),(0,u.jsx)("div",{className:tH.default.split}),(0,u.jsx)("div",{className:tH.default.adTitle,children:r})]}),(0,u.jsx)("div",{className:tH.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>f(e,tB.tU.Button),style:{background:p<=tB.cL.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{children:v||"立即试玩"})})})]})})};function tZ(e){let{awemeInfo:t}=e||{},l=(0,ew.u)(t),i=(0,tk.rQ)(t);return l&&i?(0,u.jsx)(tz,(0,r._)((0,d._)({},e),{adData:i})):null}let tK=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"FeedMpAd",Slardar:t,children:(0,u.jsx)(tZ,(0,d._)({},e))})};var tQ=l("57196"),t$=l("734415"),tY=l("827053"),tq=l("455344"),tJ=l("579272"),tX=l("372944"),t0=l("444493"),t1=l("135058"),t2=l("238430"),t4=l("128439"),t3=l("99459"),t5=l("67120"),t6=l("535874"),t8=l("200600"),t7=l("708334"),t9=l("63260"),le=l("351087"),lt=l("177592"),ll=l("193463"),li=l("522728"),ln=l("783983"),lo=l("731851"),la=l("866402"),ld=l("846455"),lr=l("505725"),ls=l("357083"),lu=l("492368");l("838368"),l("368529");var lc=l("148091"),lv=l("549909"),lm=l("837997");l("275377");var l_=l("36727"),lf=l("544994"),lp=l("805796"),lh=l("751403"),lg=l("914592"),ly=l("52678"),lw=l("929767"),lI=l("378056"),lx=l("338426"),lb=l("207761"),lE=l("734123");let lT="RECOMMAND_LOGIN_PROMPT_TIMESTAMP",lC=new Date().toDateString(),lN=0,lP=0,lS=0,lL=()=>{var e,t;return(null===(t=window)||void 0===t?void 0:null===(e=t.localStorage)||void 0===e?void 0:e.getItem(lT))===lC||!1},lA=async()=>{try{n=!0}catch(e){}},lk=async(e,t)=>{if(lL())return()=>null;if(void 0===n&&await lA(),lL())return()=>null;clearInterval(i);let l=()=>{e.pause()};if(lP>42e4){var o,a;t(),null===(a=window)||void 0===a||null===(o=a.localStorage)||void 0===o||o.setItem(lT,lC),clearInterval(i)}let d=()=>{lN=Date.now()},r=()=>{lN=0};return e.on(lE.Events.PLAY,d),e.on(lE.Events.PAUSE,r),i=setInterval(()=>{lN>0&&(lP+=1e3)>42e4&&clearInterval(i)},1e3),()=>{e&&(e.off(lE.Events.PLAY,d),e.off(lE.Events.PAUSE,r),e.off(lE.Events.CANPLAY,l)),lN=0,clearInterval(i)}},lj=async(e,t)=>{if(lL())return()=>null;if(void 0===n&&await lA(),lL())return()=>null;let l=()=>{e.pause()};if(++lS>15){var i,o;t(),null===(o=window)||void 0===o||null===(i=o.localStorage)||void 0===i||i.setItem(lT,lC)}return()=>{e&&e.off(lE.Events.CANPLAY,l)}};var lD=l("582296");let lR=(0,lx.ZP)(()=>l.e("30868").then(l.bind(l,950300)),{ssr:!1}),lM=e=>{var t;let{userInfo:l,isActive:i,dispatch:n,abtestData:o}=e,{isLogin:a}=l,d=(0,e$.n)(),[r,s]=(0,m.useState)(),[c,v]=(0,m.useState)(!1);(0,m.useEffect)(()=>{!i&&s(!1)},[i]);let _=(0,m.useCallback)(()=>{s(!1),d&&d.play()},[d]),f=(0,m.useCallback)(e=>{let{enterMethod:t="video_login_guide",isVideoGuide:l="0"}=e;(0,lD.default)({success:()=>{n({type:"updateUserInfo"})},enterMethod:t,teaEvtParams:{is_video_guide:l}})},[n,o]),p=(null===(t=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===t?void 0:t.isInMiniModal)||!1;return(0,m.useEffect)(()=>{if(d&&i&&!1===a&&!p){let e=()=>null,t=()=>null;return(async()=>{e=await lk(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})}),t=await lj(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})})})(),()=>{null==e||e(),null==t||t()}}},[d,i,a]),(0,m.useEffect)(()=>{(async()=>{v(await (0,lb.isHideLoginGuide)(o))})()},[o]),!p&&!1===a&&i&&r&&!c?(0,u.jsx)(lR,{handleHideMask:_,handleLoginAfter:e=>f(e)}):null},lF=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"RecommendLoginGuide",Slardar:t,children:(0,u.jsx)(lM,(0,d._)({},e))})};var lB=l("910443"),lO=l("220922"),lV=l("260224"),lW=l("466428"),lU=l("926116"),lH=l("502449"),lG=l("827914"),lz=l("680319"),lZ=l("79139"),lK=l("119715"),lQ=l("815242"),l$=l("801517"),lY=l("85517"),lq=l("656600"),lJ=l("847191"),lX=l("987475");let l0=e=>{let{isInnerFeed:t,awemeId:l,isActive:i}=e,[n,o]=(0,m.useState)(!1),a=(0,m.useRef)(),d=(0,m.useRef)(!1),r=(0,m.useRef)("");return(0,eP.o)(()=>{if(lq.f.isOfflineClientResizeGuide())return;let e=q.listen(q.EVENT.changeMinWindows,e=>{var n;let{isMiniWin:a,source:s}=e;if((null===(n=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===n?!void 0:!n.isInMiniModal)||!!t)i&&!a&&"resize"===s&&!(0,lJ.$o)(lX.LocalStorageKeys.ResizeGuideTimes)&&(o(!0),d.current=t,r.current=l,(0,lJ.qQ)(lX.LocalStorageKeys.ResizeGuideTimes,1))});return()=>null==e?void 0:e()},[i,t,l]),(0,m.useEffect)(()=>{n&&(!i||r.current!==l||t!==d.current)&&o(!1)},[n,i,l,t]),(0,m.useEffect)(()=>{n&&(a.current=setTimeout(()=>{o(!1)},5e3))},[n]),n};var l1=l("757118"),l2=l("382299");let l4=e=>{let{log:t,isFromLynx:l,onCloseLynx:i,getLynxInfo:n}=(0,l2.H)();t("usePlayByLynx",e);let{isActive:o,player:a}=e||{},[d,r]=(0,m.useState)(l()),s=(0,m.useRef)(!1),u=(0,m.useRef)(!1),c=o&&(d||void 0===d&&l()),v=(0,m.useRef)(0),_=()=>{if(t("usePlayByLynx onSeek",u.current,null==a?void 0:a.currentTime,v.current),!u.current){var e,l,i,o;u.current=!0;let t=n();(null==t?void 0:null===(e=t.progressBarInfo)||void 0===e?void 0:e.timeCurrent)&&(!(null==a?void 0:a.currentTime)||(null==a?void 0:a.currentTime)<=v.current+5)&&(null==a||null===(i=a.seek)||void 0===i||i.call(a,(null==t?void 0:null===(l=t.progressBarInfo)||void 0===l?void 0:l.timeCurrent)/1e3+(((null==a?void 0:a.currentTime)||0)-v.current),(null==t?void 0:t.isPlay)?"play":"pause"),(null==t?void 0:t.isPlay)||null==a||null===(o=a.pause)||void 0===o||o.call(a))}p("onSeek")},f=e=>{var l,i,o;t("usePlayByLynx onVolumeChange",e);let d=n();if((null==d?void 0:d.isMute)===void 0||(null==a?void 0:a.muted)!==(null==d?void 0:d.isMute)||(null==a?void 0:a.volume)!==(null==d?void 0:d.volume)){if(null==d?void 0:null===(l=d.progressBarInfo)||void 0===l?void 0:l.timeCurrent){u.current=!0,t("usePlayByLynx onVolumeChange seek");let e=(null==d?void 0:null===(i=d.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,l=!!(null==d?void 0:d.isPlay);null==a||null===(o=a.seek)||void 0===o||o.call(a,e,l?"play":"pause")}p("onVolumeChange")}},p=e=>{t("usePlayByLynx closeLynxWindow",e),r(!1),i("closeLynxWindow")},h=()=>{t("usePlayByLynx onPlay",s.current),setTimeout(()=>{var e,i,o,d,r;if(l()&&s.current){let l=n();(null==l?void 0:null===(e=l.progressBarInfo)||void 0===e?void 0:e.timeCurrent)&&(u.current=!0,t("usePlayByLynx onPlay seek"),null==a||null===(o=a.seek)||void 0===o||o.call(a,(null==l?void 0:null===(i=l.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,"pause"),null==a||null===(d=a.pause)||void 0===d||d.call(a)),p("onPlay");return}l()&&(t("usePlayByLynx onPlay pause"),null==a||null===(r=a.pause)||void 0===r||r.call(a),v.current=(null==a?void 0:a.currentTime)||0)},100)},g=e=>{var l,i,o;t("usePlayByLynx onShowDouyinWindow",e);let d=n();if(null==d?void 0:null===(l=d.progressBarInfo)||void 0===l?void 0:l.timeCurrent){u.current=!0,t("onShowDouyinWindow seek",e);let l=(null==d?void 0:null===(i=d.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,n=!!(null==d?void 0:d.isPlay);null==a||null===(o=a.seek)||void 0===o||o.call(a,l,n?"play":"pause")}p("onShowDouyinWindow"+e)},y=e=>{t("usePlayByLynx setCanPlay"),(null==e?void 0:e.action)==="switch_play_pause"&&(s.current=!0),(null==e?void 0:e.action)==="dislike"&&g("dislike")};(0,m.useEffect)(()=>{t("usePlayByLynx LynxPlayReady",o,a,c),o&&a&&c&&l()&&(t("usePlayByLynx LynxPlayReady2"),q.emit(q.EVENT.LynxPlayReady,{isReady:!0,player:a}),a.pause(),a.on("user_action",y),a.on("play",h),a.on("seeking",_),a.on("volumechange",f));let e=q.listen(q.EVENT.closeLynxWindow,()=>{r(!1)});return()=>{null==a||a.off("user_action",y),null==a||a.off("play",h),null==a||a.off("seeking",_),null==a||a.off("volumechange",f),null==e||e()}},[o,a,c,l])};var l3=l("656482"),l5=l("316914"),l6=l("645227"),l8=l("565603"),l7=l("766621");let l9=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p,onBrandComponentShow:h}=e||{},[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(!1),b=(0,m.useRef)(!1);(0,eG.e)({timerCb:e=>{if(b.current)return;let{currentTime:t,isEnd:l}=e,i=p.show_time,n=p.show_time+.5;t>=i&&(w(!0),null==h||h()),t>=n&&x(!0),l&&!b.current&&(w(!0),null==h||h(),x(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let E=eZ()(e=>{var t,l;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null==p?void 0:p.img_url,position:"bottom",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}q.emit(q.EVENT.videoPause,"BottomFloatTip_onClick")},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(l7.default.adWrapper,v,{[l7.default.show]:y}),style:{width:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.width,height:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.height},children:(0,u.jsx)(eJ.a,{onClick:e=>E(e),className:l7.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:(0,u.jsx)("img",{className:l7.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),w(!1),b.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}})})})},ie=(0,m.forwardRef)((e,t)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({width:46,height:23,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,u.jsx)("path",{d:"M0 4a4 4 0 0 1 4-4h38a4 4 0 0 1 4 4v15a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4z",fill:"#000",fillOpacity:".3"}),(0,u.jsx)("path",{opacity:".7",d:"M13.487 7.68c.19.36.37.76.55 1.21h3.64v.69h-7.41v2.24c-.04 2.19-.38 3.94-1.03 5.26l-.59-.53c.56-1.14.86-2.71.88-4.73V8.89h3.72c-.16-.39-.35-.75-.55-1.07l.79-.14zm13.532 5.63v3.68h-.73v-.53h-5.06v.53h-.73v-3.68h6.52zm-5.79 2.47h5.06V14h-5.06v1.78zm-.13-5.85c-.34.46-.74.89-1.21 1.28l-.43-.57c.9-.72 1.52-1.61 1.84-2.66l.72.08c-.13.42-.29.81-.49 1.18h1.96V7.82h.73v1.42h3.27v.69h-3.27v1.62h4.03v.71h-9.04v-.71h4.28V9.93h-2.39zM31.455 14.434a.78.78 0 0 0 1.103 1.104l2.434-2.435 2.435 2.434a.78.78 0 0 0 1.103-1.103L36.095 12l2.435-2.434a.78.78 0 0 0-1.103-1.103l-2.435 2.434-2.434-2.434a.78.78 0 1 0-1.103 1.103L33.889 12l-2.434 2.434z",fill:"#fff"})]}))),it=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,className:c,isActive:v,onBrandComponentClose:_,onBrandComponentShow:f}=e||{},[p,h]=(0,m.useState)(!1),[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(),b=(0,m.useRef)([]),E=null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:t.brandAd;return((0,eG.e)({timerCb:e=>{var t,l;let i=!1;for(let n=0;n<(null===(t=E.biz_content.brand_ad_component_config)||void 0===t?void 0:t.bottom.length);n++){let t=null===(l=E.biz_content.brand_ad_component_config)||void 0===l?void 0:l.bottom[n];if(void 0===t.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&t.brand_ad_component_type===V.Wy.Img){x(t),i=!0;break}}else if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&e.currentTime<=t.brand_ad_component_float_tip.disappear_time&&t.brand_ad_component_type===V.Wy.Img){x(t),i=!0;break}}!i&&(x(null),null==_||_())},stopBySeeking:!1,awemeInfo:s,isActive:v,needInit:!0}),eY({brandAdComponentItem:I,openUrl:E.open_url,isActive:v,awemeInfo:s,position:"bottom"}),(0,m.useEffect)(()=>{var e,t,l,i,n;I&&!b.current.includes(null==I?void 0:null===(e=I.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"bottom",icon_type:"image"}),b.current.push(null===(n=I.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[I]),y||p||(null==I?void 0:I.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsxs)("div",{className:"xgplayer-bottom-brand-ad",children:[(0,u.jsx)(eF.Z,{onClick:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},width:"46",height:"23",viewBox:"0 0 46 23",src:ie,className:l8.default.close,style:{bottom:`${null==I?void 0:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:null===(l=i.close_btn_position)||void 0===l?void 0:l.bottom}px`,right:`${null==I?void 0:null===(o=I.brand_ad_component_float_tip)||void 0===o?void 0:null===(n=o.close_btn_position)||void 0===n?void 0:n.right}px`}}),(0,u.jsx)("div",{className:g()(c,l8.default.container),style:{bottom:null!==(r=null===(d=I.brand_ad_component_float_tip)||void 0===d?void 0:null===(a=d.position)||void 0===a?void 0:a.bottom)&&void 0!==r?r:0},children:(0,u.jsx)(l9,{awemeInfo:s,isActive:v,onBrandComponentClose:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},onBrandComponentShow:f,onImgError:()=>{h(!0)},brandAdComponentFloatTip:I.brand_ad_component_float_tip})})]})};function il(e){var t,l,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(t=v.webRawData)||void 0===t?void 0:t.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.bottom)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(l=i.brand_ad_component_float_tip)||void 0===l?void 0:l.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.bottom)||void 0===r?void 0:r.length)>0?(0,u.jsx)(it,(0,d._)({},e)):null}let ii=e=>{let t=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"BottomFeedBrandAd",Slardar:t,children:(0,u.jsx)(il,(0,d._)({},e))})};var io=l("816242"),ia=l("427477"),id=l("954270"),ir=l("930193"),is=l("457309"),iu=l("487330"),ic=l("314331");let iv=(0,m.memo)((0,m.forwardRef)((e,t)=>{var l,i,n,o,a,r,s,c,v,_,f,p,h,y,I,E,T,C,P,S,L,A,j,D,R,F,B;let{isActive:O,isNext:W,isPrev:U,isFirst:H,isLast:z,index:K,awemeInfo:Q,nextAwemeInfo:Y,prevAwemeInfo:q,playNextFunc:J,abtestData:X,deleteCurrentSwiper:ee,toggleComment:et,onAvatarClick:el,fullScreenTarget:ei,logParams:eo,videoToast:ea,followHandler:ed,playPrevFunc:er,userInfo:es,dispatch:eu,isShowCssFullScreenGuide:ec,isAuthorCardShow:eP,isShowRelatedCard:eS,children:eR,videoHashtagClassName:eM,isShowGuide:eF,videoTags:eB,showPlaySwitch:eO=!0,moreBoxShowList:eV={notInterestingIcon:!0,unfollow:!0,report:!0},shortCutFiltered:eU,positionBoxClassName:eH,actionFollow:eG,actionUnFollow:ez,isInnerFeed:eZ,isOuterFeedSplash:eK,onRelatedClick:eQ,onCooperationAuthorClick:e$,isShowCooperation:eY,isAdShortCut:eq=!0,onShopAnchorClick:eJ=()=>{},onActivityCardClick:eX,onDouPlusClick:e0,onSodaClick:e1,onShopAnchorMouseEnter:e2=()=>{},onShopAnchorMouseLeave:tL=()=>{},isShowAdCard:tA=!1,sideBarShow:tk,slardarInstance:tj,defaultIsPageFullScreen:tD,avatarTipText:tR,LiveSliderCard:tM,onDislike:tF,disableShortCut:tB,isDislike:tO,isShowShopSideCard:tV,splashAdStatus:tW,changeSplashAdStatus:tH,onReady:tG,hasPlaceholder:tz=!0,disableFullScreenSearchBar:tZ=!1,isVideoSupportMP4:lx,useNewUserSoundGuide:lb,isMultiInstanceScene:lE=!1,chapterProps:lT,setContainerPlayer:lC,recommendTagProps:lN,canShowListenVideo:lP=!1,listenFeedNextAwemeInfo:lS,listenFeedPrevAwemeInfo:lL,aiNoteProps:lA,isShowAiCard:lk,sideCardContext:lj,isFirstLive:lD}=e,{isiPad:lR,isMobile:lM}=(0,M.X)(),{isMainland:lq,isWebMiniWin:lJ,pipWindow:lX,isListenVideoMiniWin:l8,fullScreenQuestionVars:{isShowingQuestion:l7}={isShowingQuestion:!1}}=(0,iu.Iq)(e=>{let{isMainland:t,isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:n,fullScreenQuestionVars:o}=e;return{isMainland:t,isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:n,fullScreenQuestionVars:o}}),{isFromLynx:l9}=(0,l2.H)(),[ie,it]=(0,m.useState)(!1),{isClientMiniWin:il,isCssFullScreen:iv,isFullScreen:im,setIsSideBarShowFunc:i_,setSlideVideoTab:ip}=(0,m.useContext)(eT.C),ih=(0,m.useRef)(null),{hasChapterBar:ig}=(0,t0.W)(X,Q,null===(l=ih.current)||void 0===l?void 0:l.player),[iy,iw]=(0,m.useState)(!1),iI=(0,N.DT)(),ix=(0,eI.x)(),ib=l0({isInnerFeed:eZ,awemeId:null==Q?void 0:Q.awemeId,isActive:O}),iE=(0,m.useCallback)(()=>iw(!0),[]),iT=(0,m.useCallback)(()=>iw(!1),[]);(0,m.useEffect)(()=>{eZ&&iw(!1)},[eZ]);let iC=(0,m.useMemo)(()=>lJ||il||l8,[lJ,il,l8]),{enablePip:iN}=(0,t5.$)({abtestData:X,awemeInfo:Q});(0,m.useEffect)(()=>{var e,t,l,i;let n=null===(e=ih.current)||void 0===e?void 0:e.player;if(O&&(null==n?void 0:n.isQuickPlayer)){if(iN){let e=null==n?void 0:null===(t=n.root)||void 0===t?void 0:t.querySelector(".xgplayer-pip .xg-tips");e&&(e.innerHTML=`小窗模式${ev.SHORTCUT_KEY.pip.badgeText?`<span class="shortcutKey">${ev.SHORTCUT_KEY.pip.badgeText}</span>`:""}`)}else null==n||null===(i=n.root)||void 0===i||null===(l=i.querySelector(".xgplayer-pip"))||void 0===l||l.setAttribute("style","display: none !important")}},[null===(i=ih.current)||void 0===i?void 0:i.player,iN,O]);let{isShow:iP}=(0,t6.BJ)({useIdleCallback:!(0,$.b_)(),isActive:O,timeout:5e3,delay:(0,$.b_)()&&!l9()?1e3:0,once:!0,immediately:!(0,$.b_)()||(0,t1.GP)(Q)||l9()});(0,t8.j)({player:null==ih?void 0:null===(n=ih.current)||void 0===n?void 0:n.player,isActive:O,abValue:X}),(0,lZ.g)({player:null==ih?void 0:null===(o=ih.current)||void 0===o?void 0:o.player,awemeInfo:Q}),(0,l$.G)({player:null==ih?void 0:null===(a=ih.current)||void 0===a?void 0:a.player,awemeInfo:Q,scene:"pc_web",abtestData:X}),(0,m.useImperativeHandle)(t,()=>{var e;return{getPlayer:()=>ih.current.getPlayer(),player:null===(e=ih.current)||void 0===e?void 0:e.player}}),(0,t7.V)({awemeInfo:Q}),(0,t9.D)({awemeInfo:Q,isActive:O}),(0,m.useEffect)(()=>{O&&!eZ&&Z.Le.setConfig(Z.gI.InnerAutoPlay,null)},[O,eZ,Q]);let iS=(0,m.useMemo)(()=>{let e=(0,lQ.i)({abtestData:X,awemeInfo:Q,isInnerFeed:eZ,isMultiInstanceScene:lE});return e.startTime=(0,ej.v)(Q.awemeId),e.pip&&(e.pip.showIcon=iN),e},[Q,X,iN]);(0,le.O)({player:null===(r=ih.current)||void 0===r?void 0:r.player,isActive:O,awemeInfo:Q,abtestData:X,isWebMiniWin:lJ}),(0,lt.w)({player:null===(s=ih.current)||void 0===s?void 0:s.player,isActive:O,awemeInfo:Q,abtestData:X,isInnerFeed:eZ}),(0,ll.K)({abtestData:X,isActive:O,player:null===(c=ih.current)||void 0===c?void 0:c.player});let iL=(0,ex.D)(Q),{noPaidVideo:iA}=(0,li.B)({awemeInfo:Q});(0,l6.u)({awemeInfo:Q,player:null===(v=ih.current)||void 0===v?void 0:v.player});let{isDanmuIcon:ik,hideList:ij,isChapterIcon:iD,chapterMaxWidth:iR,isAiNoteIcon:iM}=(0,ln.Cy)({isActive:O,abtestData:X,player:null===(_=ih.current)||void 0===_?void 0:_.player,hasChapter:ig,hasAiNote:null==lA?void 0:lA.useable,isMiniWin:iC,showAutoPlay:!iA,showInnerAutoplay:eZ&&!iA,showSubtitles:!!(null==Q?void 0:Q.claInfo),showFakeScreen:(null==Q?void 0:Q.awemeType)!==x.e.Note,showPlayBackRatio:(null==Q?void 0:Q.awemeType)!==x.e.Note,showWatchLater:iL,isClientMiniWin:il}),iF=(0,m.useMemo)(()=>{var e;return[...(null==eV?void 0:eV.notInterestingIcon)?[]:[null===(e=ev.getShortcut().dislike)||void 0===e?void 0:e.badgeText],...eU||[]]},[null==eV?void 0:eV.notInterestingIcon,eU]),iB=(0,m.useMemo)(()=>(0,em.Jt)(Q),[Q]),iO=(0,m.useMemo)(()=>(0,em.gc)(Q),[Q]),iV=(0,m.useMemo)(()=>(0,en.p)(Q),[Q]),iW=tW===V.QB.Normal||!iV;(0,m.useEffect)(()=>{var e,t,l,i,n,o,a,d,r,s;if(!!H&&!!iV)return tW===V.QB.Fullscreen?((0,eb.o)({pauseCustomShortcut:!0,pausePlayControlShortcut:!0},"splashAd"),lm.DJ.pause(["close","help"]),(null===(e=ih.current)||void 0===e?void 0:e.player)&&(null===(n=ih.current)||void 0===n||null===(i=n.player)||void 0===i||null===(l=i.controls)||void 0===l||null===(t=l.hide)||void 0===t||t.call(l))):((null===(o=ih.current)||void 0===o?void 0:o.player)&&(null===(s=ih.current)||void 0===s||null===(r=s.player)||void 0===r||null===(d=r.controls)||void 0===d||null===(a=d.show)||void 0===a||a.call(d)),lm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")),()=>{lm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")}},[tW]),(0,lo._)({awemeInfo:Q,prevAwemeInfo:q,isInnerFeedModel:eZ&&O});let{idlCallBackFlag:iU}=(0,la.o)({isActive:W,once:!0}),{flag:iH}=(0,ld.z)({isNext:W,positionIndex:K,abtestData:X}),iG=(0,m.useRef)(!1),iz=(0,m.useMemo)(()=>{var e;let t=null===(e=k.s.getAllPlayer())||void 0===e?void 0:e.length;return!!iG.current||(eE.H.revertRecommendCreateNextVideo(X)?O||U||W:1===K&&(!!(t>1)||!!iH)||O||U||W&&iU&&1!==K)},[O,U,W,K,iU,iH]);iG.current=iz;let{isShowGuideDownload:iZ}=(0,lr.m)({abtestData:X,awemeInfo:Q,isActive:O,isLogin:null==es?void 0:es.isLogin,player:null===(f=ih.current)||void 0===f?void 0:f.player});(0,m.useEffect)(()=>{2===K&&Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!1})},[K]);(0,ls.Q)({player:null===(p=ih.current)||void 0===p?void 0:p.player,isActive:O,abtestData:X,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:iB&&(0,em.Gu)(Q)&&eq?[]:["showAdDetail"],awemeInfo:Q,showAdMenu:iB&&(0,em.Gu)(Q),disableShortCut:tB||!lx||l7,disableAllNativeShortCut:tB||!lx||l7,isClientMiniWin:il,pipWindow:lX,isLogin:null==es?void 0:es.isLogin}),(0,lv.b)({isActive:O,player:null===(h=ih.current)||void 0===h?void 0:h.player}),(0,w.C)(eC.w3.components.recommend_video),(0,t2.P)({player:null===(y=ih.current)||void 0===y?void 0:y.player}),eL();let{isOnByOuter:iK}=(0,lu.U)({playerReady:ie,config:iS,isActive:O,awemeInfo:Q,player:null===(I=ih.current)||void 0===I?void 0:I.player,setIsSideBarShowFunc:i_,setSlideVideoTab:ip}),iQ={scene:b.lT.Recommend,awemeInfo:Q,abtestData:X,userInfo:es,isMiniWin:iC,isActive:O,isInnerFeed:eZ,player:null==ih?void 0:null===(E=ih.current)||void 0===E?void 0:E.player,fullScreenTarget:ei},{anchorList:i$,hasJingxuanActivity:iY}=(0,ir.e)({abtestData:X,awemeInfo:Q}),iq=(0,io.$)({abTestData:X,awemeInfo:Q})&&!iY;(0,m.useEffect)(()=>{if(O&&!eZ&&ie){var e;return(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"show"),()=>{var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"leave")}}},[O,Q,eZ,ie,X]),l4({player:null==ih?void 0:null===(T=ih.current)||void 0===T?void 0:T.player,isActive:O}),(0,l5.M)({awemeInfo:Q,player:null==ih?void 0:null===(C=ih.current)||void 0===C?void 0:C.player,noPaidVideo:iA,isInnerFeed:eZ});let{listenVideoDisablePrev:iJ,listenVideoDisableNext:iX}=(0,lK.T)({isAuthorCardShow:eP,isFirst:H,isLast:z,isShowRelatedCard:eS,canUseListenFeed:!0,listenFeedPrevAwemeInfo:lL,listenFeedNextAwemeInfo:lS,prevAwemeInfo:q,nextAwemeInfo:Y,isInnerFeed:eZ,isActive:O}),i0=(null==X?void 0:X.reuseVideo)&&!(((null==X?void 0:null===(P=X.recommendQuickStartV1)||void 0===P?void 0:P.val)||(null==X?void 0:X.recommendServerFetch))&&0===K&&!lD||iV||eK),i1=i0?ek.Y:eA.f;return(0,ic.O)({abtestData:X,player:null==ih?void 0:null===(S=ih.current)||void 0===S?void 0:S.player,awemeInfo:Q,isActive:O}),(0,u.jsxs)(u.Fragment,{children:[!tZ&&(iv||im)&&O&&!iC&&(0,u.jsx)(tX.default,(0,d._)({},iQ)),(0,u.jsxs)(i1,{xgplayerConfig:iS,isInitPlayer:iz,style:(0,d._)({height:"100%",width:"100%"},l8?{display:"none"}:{}),className:g()(eN.default.container,"chapterPlayerStyle","MediaNotSupportStyle","lowPopup"),ref:ih,slardarInstance:tj,onReady:e=>{var t,l,i;null==tG||tG(),it(!0),(null===(t=(0,G.bE)("player_ready"))||void 0===t?void 0:t.length)<1&&(0,G.B1)({tag:"player_ready"}),e&&(e.canCheckNotUse=!0),iV&&H&&!eZ&&tW!==V.QB.Normal&&(null==e||null===(i=e.controls)||void 0===i||null===(l=i.hide)||void 0===l||l.call(i))},awemeInfo:Q,scene:b.lT.Recommend,setContainerPlayer:lC,abtestData:X,children:[(0,u.jsx)(lc.V,{awemeInfo:Q,isActive:O,timeout:(0,$.b_)()?4e3:2e3,isFirst:H}),(0,u.jsx)(eD.p,{isActive:O,onRegisterSuccess:()=>{O&&(0,t4.g)(ih.current.player)},scene:b.lT.Recommend}),(0,u.jsx)(ej.t,{awemeInfo:Q,player:null===(L=ih.current)||void 0===L?void 0:L.player,isActive:O}),!iC&&iV&&H&&tW===V.QB.Fullscreen&&(0,u.jsx)(eW,{awemeInfo:Q,playNextFunc:()=>{null==tH||tH(V.QB.Normal),J()}}),!iC&&iV&&H&&!eZ&&(0,u.jsx)(e4,{isActive:O,awemeInfo:Q,onBrandComponentShow:()=>{},onBrandComponentClose:()=>{}}),!iC&&(0,em.Kf)(Q)&&!eZ&&(0,u.jsx)(ii,{isActive:O,awemeInfo:Q,onBrandComponentShow:()=>{iw(!0)},onBrandComponentClose:()=>{iw(!1)}}),!lx&&(0,u.jsx)(lG.X,{awemeId:null==Q?void 0:Q.awemeId}),iW&&(0,u.jsx)("div",{className:g()(eN.default.splashAdComponent,{[eN.default.enterTransition]:iV&&!eZ}),children:(0,u.jsxs)(e3.n,{isActive:O,controlHeight:b.fp.MidHigh,isMiniWin:iC,position:"right",awemeInfo:Q,className:eH,abtestData:X,from:b.lT.Recommend,children:[eO&&!il&&iP||lJ?(0,u.jsx)(e5.I,{playPrevFunc:er,playNextFunc:J,disablePrev:H&&!(eP||eS)||(eP||eS)&&!q,disableNext:z&&!(eP||eS)||(eP||eS)&&!Y,className:g()(eN.default.playSwitchContainer,e6.m4,"filter-bg",{[eN.default.isWebMiniWinSwitch]:lJ})}):null,!il&&iP&&lx&&(0,u.jsx)(e8.InteractionNew,{canShowListenVideo:lP,playPrevFunc:er,playNextFunc:J,listenFeedPrevAwemeInfo:lL,listenFeedNextAwemeInfo:lS,prevAwemeInfo:q,nextAwemeInfo:Y,isAuthorCardShow:eP,isShowRelatedCard:eS,isFirst:H,isLast:z,canUseListenFeed:!0,actionFollow:eG,actionUnFollow:ez,awemeInfo:Q,toggleComment:e=>{if(!eZ){var t;(0,Z.xL)(Q,null==ih?void 0:null===(t=ih.current)||void 0===t?void 0:t.player,"clickComment")}return null==et?void 0:et(e)},loginUserInfo:es,loginDispatch:eu,deleteCurrentSwiper:ee,fullScreenTarget:ei,onAvatarClick:(e,t)=>{if(!eZ){var l;(0,Z.xL)(Q,null==ih?void 0:null===(l=ih.current)||void 0===l?void 0:l.player,"head")}return null==el?void 0:el(e,t)},onFollowBtnClick:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"follow")}},onShareToFriend:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"share")}},onDouPlusClick:e0,abtestData:X,videoToast:ea,isActive:O,followHandler:ed,reportExtraParams:eo,recordPreferVideoSwitch:!eZ,canShowAvatarFollowBtn:!iO,canShowAvatarAdBtn:iO,canShowAvatarTip:!(iB&&(0,em.Gu)(Q)),canShowDislikeTip:!0,moreBoxShowList:(0,d._)({shortcutList:!0},eV),className:e6.m4,avatarTipText:tR,showMusicDetail:!(iB&&(0,em.Gu)(Q)),from:b.lT.Recommend,LiveSliderCard:tM,onRelatedClick:eQ,videoTags:eB,onDislike:tF,isInnerFeed:eZ,scene:"aweme_video_feed_pc",isShowAiCard:lk,recommendTriggered:null==lN?void 0:lN.recommended,showRecommendToFriend:!!lN})]})}),tz&&!iV?(0,u.jsx)(e7._,{awemeInfo:Q,isActive:O,controlHeight:iV?b.fp.SplashControls:b.fp.MidHigh,abtestData:X}):null,(null==Q?void 0:null===(A=Q.chargeInfo)||void 0===A?void 0:A.is_charge_content)&&(0,u.jsx)(e9.V,{awemeInfo:Q,isActive:O,isMiniWin:iC,isShowReplay:!iC}),(null==Q?void 0:null===(j=Q.video)||void 0===j?void 0:j.duration)>18e4&&(0,u.jsx)(te.S,{awemeInfo:Q,isActive:O,isLogin:null==es?void 0:es.isLogin,isMiniWin:iC}),(0,u.jsx)(tt.V,{awemeInfo:Q,isActive:O}),(0,u.jsx)(tl.h,{awemeInfo:Q,isActive:O,isUseOneCheck:eZ,playPrevFunc:er,playNextFunc:J,deleteCurrentSwiper:ee}),eZ||!iP||iA?null:(0,u.jsx)(ti.kL,{isActive:O,awemeInfo:Q,playNextFunc:J,ablePlayNext:!(z&&!(eP||eS)||(eP||eS)&&!Y),shortcutDisabled:lR||lM,scene:b.lT.Recommend}),eZ&&iP?(0,u.jsx)(tn.Ot,{isActive:O,awemeInfo:Q,playPrevFunc:er,playNextFunc:J,ablePlayPrev:!((eP||eS)&&!q),ablePlayNext:!((eP||eS)&&!Y),hide:ij.some(e=>e[0]===ln.p7.InnerAutoPlayer),abtestData:X,isWebMiniWin:lJ}):null,iP&&!iA?(0,u.jsx)(e6.SD,{isOnByOuter:iK,isActive:O,awemeInfo:Q,abtestData:X,isInnerFeed:eZ,isOutFeed:!eZ,hide:ij.some(e=>e[0]===ln.p7.Clear)}):null,iP?(0,u.jsx)(lh.SE,{isActive:O,awemeInfo:Q,abtestData:X}):null,iP&&iL&&!lJ?(0,u.jsx)(to.vq,{isActive:O,awemeInfo:Q,abtest:X,isLogin:null==es?void 0:es.isLogin,loginDispatch:eu,toast:ea,logParams:eo}):null,iN&&(0,u.jsx)(ta._,{isActive:O,awemeInfo:Q,abtestData:X,isReusePlayer:i0}),(0,u.jsx)(td.F,{isActive:O,awemeInfo:Q,isLogin:null==es?void 0:es.isLogin,loginDispatch:eu,abtestData:X,from:b.lT.Recommend,logParams:eo,isMiniWin:iC}),iI&&(0,u.jsx)(tr.zm,{isActive:O,awemeInfo:Q,isInnerFeed:eZ,resizeMiniWindowGuideShow:ib,abtestData:X}),iP&&(0,u.jsx)(ts.k,{isActive:O,onVolumeShortCutChange:()=>{var e;(0,t3.t)(null===(e=ih.current)||void 0===e?void 0:e.player)}}),(0,u.jsx)(tu.g,{isActive:O,abtestData:X,awemeInfo:Q}),(0,u.jsx)(tc.b,{isActive:O}),(0,u.jsx)(tv.h,{isActive:O}),!(0,t1.GP)(Q)&&(0,u.jsx)(tm.Z,{awemeInfo:Q,userInfo:es,isActive:O,isNext:W,isPrev:U,logParams:eo,index:K}),(0,u.jsx)(t_.L,{awemeInfo:Q,isActive:O,abtestData:X,suspendWhenMetaIsUndefined:!0,index:K}),(0,u.jsx)(tf.P,{isActive:O,awemeInfo:Q,abtestData:X,userInfo:es,enablePip:iN}),(0,u.jsx)(tp.E,{isActive:O,awemeInfo:Q,abtestData:X,userInfo:es,deleteCurrentSwiper:ee,config:iS,scene:b.lT.Recommend,isNext:W,currentIndex:K}),(0,u.jsx)(th.q,{index:K,isActive:O,abtestData:X,awemeInfo:Q,isInnerFeed:eZ,scene:b.lT.Recommend}),(0,u.jsx)(tg.o,{isActive:O,awemeInfo:Q}),(null==Q?void 0:Q.awemeType)===x.e.Note?(0,u.jsx)(ty.PictureMode,{isActive:O,awemeInfo:Q,abTestData:X,logParams:eo,playNextFunc:J,playPrevFunc:er,isClientMiniWin:il,ablePlayPrev:!((eP||eS)&&!q),ablePlayNext:!((eP||eS)&&!Y),disableShortCut:tB,isShowSideBar:tk}):null,iP&&!iC?(0,u.jsx)(tw.t,{isActive:O,userInfo:es,dispatch:eu,abtestData:X,awemeInfo:Q,player:null==ih?void 0:null===(D=ih.current)||void 0===D?void 0:D.player,currentIndex:K,isInnerFeed:eZ}):null,eR,(0,u.jsx)(tI.x,{isActive:O,awemeInfo:Q,abTestData:X}),iB&&(0,u.jsx)(tx.K,{awemeInfo:Q,isActive:O}),iB&&iP&&(0,u.jsx)(l_.FeedbackAd,{awemeInfo:Q,deleteCurrentSwiper:ee,toast:ea,abtestData:X}),iP&&(0,u.jsx)(lH.PlayBackSetting,{disable:iB&&(0,em.Gu)(Q),isActive:O,awemeInfo:Q,abtest:X,logParams:eo,loginBlock:!(null==es?void 0:es.isLogin)&&!lJ,loginDispatch:eu,speedType:(0,$.G6)()?e_.$.Safari:e_.$.Normal}),iP&&lx&&(!iC||ix)?(0,u.jsx)(lw.I,{isActive:O,fullScreenTarget:ei,abtestData:X,isLogin:!!(null==es?void 0:es.isLogin),loginDispatch:eu}):null,!iC&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(tb.Danmaku,{isActive:O,awemeInfo:Q,userInfo:es,loginDispatch:eu,abtestData:X,isDanmuIcon:ik,currentIndex:K}),(0,u.jsx)(tE.e,{isActive:O,awemeInfo:Q,abtestData:X,aiNoteProps:lA,isAiNoteIcon:iM}),ig?(0,u.jsx)(tT.WC,{isActive:O,awemeInfo:Q,userInfo:es,loginDispatch:eu,abtestData:X,isChapterIcon:iD,chapterProps:lT,logParams:eo,chapterMaxWidth:iR}):null,iP?(0,u.jsx)(lg.Vw,{awemeInfo:Q,isShowGuide:ec,logParams:eo,isActive:O,defaultIsPageFullScreen:tD,abtestData:X}):null,(0,u.jsxs)(tC.r,{isActive:O,controlHeight:b.fp.MidHigh,position:"bottom",awemeInfo:Q,abtestData:X,children:[iP&&iW&&iq&&!(null==lN?void 0:lN.recommendTagType)&&(0,u.jsx)(io.n,{scene:"player",awemeInfo:Q}),iW&&!(0,id.$m)(Q)&&(null==lN?void 0:lN.recommendTagType)&&!(null==lN?void 0:lN.isShowVideoInfoSideCard)&&(0,u.jsx)(ia.B,(0,d._)({userInfo:es,awemeInfo:Q,player:null==ih?void 0:null===(R=ih.current)||void 0===R?void 0:R.player,abTestData:X},lN)),iP&&!iV&&i$.length>0&&(0,u.jsx)(is.E,{awemeInfo:Q,anchorList:i$,openActivityCard:eX,abtestData:X}),lq&&!iy&&iW&&(0,ef.n)(Q)&&!(0,ep.o4)(Q)&&iP&&(0,u.jsx)(tN.n,{awemeInfo:Q,onClick:eJ,isActive:O,onMouseEnter:e2,onMouseLeave:tL}),(0,eh.A)(Q)&&iP&&(0,u.jsx)(tP.X,{isActive:O,awemeInfo:Q,isHide:tA}),(0,eg.hj)(Q)&&(0,em.Gu)(Q)&&iP&&(0,u.jsx)(lp.FeedLiveAd,{isActive:O,awemeInfo:Q}),(0,ep.o4)(Q)&&(0,em.Gu)(Q)&&iP&&(0,u.jsx)(tS.b,{isHide:tV,isActive:O,awemeInfo:Q}),(0,ep.o4)(Q)&&!(0,em.Gu)(Q)&&iP&&(0,u.jsx)(lY.A,{isActive:O,awemeInfo:Q}),(0,ey.L)(Q)&&iP&&(0,u.jsx)(tU,{isActive:O,awemeInfo:Q,isHide:tA}),(0,ew.u)(Q)&&iP&&(0,u.jsx)(tK,{isActive:O,awemeInfo:Q,isHide:tA}),iW&&(0,u.jsx)("div",{className:g()(eN.default.splashAdComponent,{[eN.default.enterTransition]:iV&&!eZ}),children:(0,u.jsx)(tQ.VideoInfoNew,{isActive:O,awemeInfo:Q,userInfo:es,scene:b.lT.Recommend,isTopicLinkSearchResult:!0,videoHashtagClassName:eM,onSodaClick:e1,videoTags:eB||[],abTestData:X,isShowCreateTime:eZ||tk||!(iB&&(0,em.Gu)(Q)||iV),canMixListen:!eZ,isInnerFeed:eZ,showGuideDownloadClient:iZ,loginUserInfo:es,loginDispatch:eu,fullScreenTarget:ei,reportExtraParams:eo,onCooperationAuthorClick:e$,isShowCooperation:eY,showSideBar:tk,isShowBrandComponent:iy,onBrandComponentHide:iT,onBrandComponentShow:iE,onClickUserName:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"head")}},sideCardContext:lj,showExpandButtonInner:(null==X?void 0:X.aiNoteV2)===2})}),(0,u.jsx)(t$.H,{isActive:O,isAdAweme:iB,awemeInfo:Q,abtestData:X,toast:ea,playNextFunc:J})]}),lb?(0,u.jsx)(lz._q,{isActive:O,awemeId:null==Q?void 0:Q.awemeId,isShowGuide:eF,abtestData:X}):(0,u.jsx)(tY.x,{isActive:O,awemeInfo:Q,abtestData:X,isShowGuide:eF,scene:b.lT.Recommend}),iP&&iW?(0,u.jsx)(ly.h,{awemeInfo:Q,isActive:O,userInfo:es,disableShortCut:tB,abtestData:X}):null,iW&&iP?(0,u.jsx)(lI.MenuList,{isActive:O,abtestData:X,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:(0,em.Gu)(Q)&&iB&&eq?[]:["showAdDetail"],shortCutFiltered:iF,awemeInfo:Q,showEnterDetail:!(iB&&(0,em.Gu)(Q)),showAdMenu:iB&&(0,em.Gu)(Q),disableShortCut:tB,userInfo:es,showRecommendToFriend:!!lN}):null,!tO&&iP?(0,u.jsx)(lF,{isActive:O,userInfo:es,dispatch:eu,abtestData:X,awemeInfo:Q}):null,iP?(0,u.jsx)(tq.B,{awemeInfo:Q,abtestData:X,isActive:O}):null,(null==ij?void 0:ij.length)>0&&iP&&(0,u.jsx)(lf.SettingList,{isActive:O,awemeInfo:Q,hideList:ij,dispatch:eu,abtestData:X,userInfo:es,isAdAweme:iB&&(0,em.Gu)(Q)}),iP?(0,u.jsx)(lB.I,{abtestData:X,isActive:O,awemeInfo:Q,logParams:eo,isChapterScene:!0}):null,iP&&iZ?(0,u.jsx)(lO.PostGuideDownload,{isActive:O,awemeInfo:Q,userInfo:es,abtestData:X,isInnerFeed:eZ,player:null==ih?void 0:null===(F=ih.current)||void 0===F?void 0:F.player}):null,iP&&!iC&&(0,u.jsx)(l1.P,{abtestData:X,isActive:O,controlHeight:b.fp.MidHigh,hidePluginList:(null==ij?void 0:null===(B=ij.map)||void 0===B?void 0:B.call(ij,e=>null==e?void 0:e[0]))||[]})]}),(0,u.jsx)("div",{}),lJ&&(0,u.jsx)(lU.U,{awemeInfo:Q}),(0,u.jsx)("div",{}),il&&(0,u.jsxs)(u.Fragment,{children:[O&&iP&&(0,u.jsx)(lV.MiniWinMask,{isActive:O,awemeInfo:Q,abtestData:X,playPrevFunc:er,playNextFunc:J,disablePrev:H&&!(eP||eS)||(eP||eS)&&!q,disableNext:z&&!(eP||eS)||(eP||eS)&&!Y,ablePlayNext:!(z&&!(eP||eS)||(eP||eS)&&!Y),loginUserInfo:es,loginDispatch:eu,reportExtraParams:eo,recordPreferVideoSwitch:!0}),O&&iP&&!ix&&(0,u.jsx)(lW.N,{awemeInfo:Q})]}),O&&(0,u.jsx)(tJ.s,{}),(0,u.jsx)(l3.p,{isActive:O})]})]})}));var im=l("773238"),i_=l("669206"),ip=l("709950"),ih=l("710199"),ig=l("529596"),iy=l("379788"),iw=l("54730");let iI=e=>{let{awemeInfo:t,abtestData:l,isActive:i,isLogin:n}=e,o=(0,e$.n)(),[a,d]=(0,m.useState)(!1),r=(0,m.useRef)(!1),s=(0,en.p)(t),u=(0,m.useMemo)(()=>{var e;return null===(e=Z.Le.getConfig(Z.gI.WallPaperIds))||void 0===e?void 0:e.includes(null==t?void 0:t.awemeId)},[t]);return(0,m.useEffect)(()=>{let e=async()=>{if(!(!1===n||!i||u||s||(0,N.DT)()||(0,N.tq)())){if(r.current){d(!0);return}try{var e;let[l,i]=await Promise.all([(0,ig.Y)(),(0,iy.lx)({secUid:null===(e=t.authorInfo)||void 0===e?void 0:e.secUid})]);(function(e,t,l){var i,n,o,a;let d=new Date().getTime(),r=null!==(n=(0,lJ.$o)(lX.LocalStorageKeys.PostGuideDownloadClient))&&void 0!==n?n:{lastTimestamp:0,showTimes:0},s=d-r.lastTimestamp>=864e5,u=r.showTimes<10;if(e===iw.Q.Normal&&s&&u&&!1===l&&[1,2].includes(null==t?void 0:null===(i=t.authorInfo)||void 0===i?void 0:i.followStatus)){let e=null!==(a=null===(o=(0,lJ.$o)(lX.LocalStorageKeys.PostGuideDownloadClient))||void 0===o?void 0:o.showTimes)&&void 0!==a?a:0;return(0,lJ.qQ)(lX.LocalStorageKeys.PostGuideDownloadClient,{lastTimestamp:new Date().getTime(),showTimes:e+1}),!0}return!1})(null==i?void 0:i.accountType,t,l)&&(r.current=!0,d(!0))}catch(e){}}};if(o)return o.once(ih.FP.TIMEUPDATE,e),()=>{o.off(ih.FP.TIMEUPDATE,e)}},[l,t,i,n,u,s,o]),{isShowGuideDownload:a}};var ix=l("748900"),ib=l("107058"),iE=l("820855"),iT=l("355077"),iC=l("45585"),iN=l("384579"),iP=l("797734"),iS=l("56348"),iL=l("937841"),iA=l("275555"),ik=l("111341"),ij=l("309931"),iD=l("407544"),iR=l("465769"),iM=l("784415"),iF=l("326494"),iB=l("645361"),iO=l("658228"),iV=l("770068");let iW=0,iU=!1,iH=e=>{var t,l;let{isShowGuide:i,isActive:n,awemeId:o}=e,a=(0,e$.n)(),d=(0,m.useRef)(!1),[r,s]=(0,m.useState)(!1),{attemptOpen:c,executeClose:v}=(0,iD.B)({popName:"浏览器限制-声音提醒",onOpen:()=>{s(!0)},onClose:()=>{s(!1)}});(0,m.useLayoutEffect)(()=>{if(!a||i)return;let e=()=>{if(!d.current)(0,iF.q)({player:a,onSuccess:()=>{!i&&iW<5&&c()}}),d.current=!0};return a.on(ih.FP.AUTOPLAY_WAS_PREVENTED,e),()=>{a.off(ih.FP.AUTOPLAY_WAS_PREVENTED,e)}},[a,i,n]),(0,m.useEffect)(()=>{if(!n||i||!a){v();return}if(!iU&&iW<5&&(a.muted||a.paused)){let e=setTimeout(()=>{a.muted=!1,a.paused&&setTimeout(()=>{a.play()}),d.current=!1,iU=!0},200);return()=>{clearTimeout(e)}}iW<5&&a.muted?c():v()},[i,n,a]);let _=!i&&r;(0,m.useEffect)(()=>{_&&n&&(iW+=1,iM.Z.sendLog("voiceBubbleShow",{enter_from:(0,iR.vM)()}))},[n,_]);let f=()=>{iW=5,v()};if((0,m.useEffect)(()=>{if(a){let e=e=>{((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume")&&f()};return a.on(ih.FP.USER_ACTION,e),()=>{a.off(ih.FP.USER_ACTION,e)}}},[a]),(0,m.useEffect)(()=>{if(a){let e=e=>{("volumeDown"===e.action||"volumeUp"===e.action)&&f()};return a.on(iO.C.CustomShortCut,e),()=>{a.off(iO.C.CustomShortCut,e)}}},[a]),(0,m.useEffect)(()=>{if(!!o)q.emit(q.EVENT.silentStatusChange,{awemeId:o,isAuto:!0,status:_})},[_,o]),!_)return null;let p=null==a?void 0:null===(l=a.getPlugin)||void 0===l?void 0:null===(t=l.call(a,"SoundGuideTooltipPlugin"))||void 0===t?void 0:t.root;return p?(0,ij.createPortal)((0,u.jsx)(iV.V,{onClose:f,onOpen:()=>{iM.Z.sendLog("clickVoiceBubble",{enter_from:(0,iR.vM)()}),a.muted=!1,f()},description:"当前为静音，是否要打开声音？"}),p):null},iG=e=>{let t=(0,iB.N)();return(0,u.jsxs)(eB.k,{componentName:"NewUseSoundGuidePlugin",Slardar:t,children:[(0,u.jsx)(iV.I,(0,d._)({},e)),(0,u.jsx)(iH,(0,d._)({},e))]})};var iz=l("165007"),iZ=l("506435"),iK=l("622273"),iQ=l("646304"),i$=l("280837"),iY=l("872136"),iq=new iY.h({checkVideoUnsafe:{eventName:"check_video_unsafe",params:{aweme_ids:[],counts:0}},checkVideoUnsafeModal:{eventName:"check_video_unsafe_modal",params:{aweme_id:""}}});let iJ={},iX=48e4;{let e=localStorage.getItem("check_safe_time");iX=e?Number(e):iX}let i0=e=>{let{awemeInfo:t,isActive:l,isUseOneCheck:i,playPrevFunc:n,playNextFunc:o,deleteCurrentSwiper:a}=e,d=(0,e$.n)(),[r,s]=(0,m.useState)(!1),[c,v]=(0,m.useState)(5),_=(0,y.Z)(async()=>{if(Date.now()-1e3*Number(t.dyQ)>iX){let e=t.awemeId,l=[{item_id:e,dy_q:t.dyQ,tag:t.isAds?2:0,potential_risk_level:0,authentication_token:""}],i=await (0,iQ.Y)(l);0===i.statusCode&&(iJ[e]=Date.now(),i.result.find(t=>t.item_id===e)&&(d.pause(),s(!0),iq.sendLog("checkVideoUnsafe",{aweme_ids:[t.awemeId],counts:1}),iq.sendLog("checkVideoUnsafeModal",{aweme_id:t.awemeId})));return}}),f=(0,m.useCallback)(async()=>{var e;let l=t.awemeId,i=null!==(e=Z.Le.getConfig(Z.gI.CheckAwemeList))&&void 0!==e?e:[],n=i.findIndex(e=>e.vid===l);if(-1!==n&&Date.now()-i[n].time>iX){let e=i.slice(n,n+6).map(e=>({item_id:e.vid,dy_q:e.dy_q,tag:e.tag,potential_risk_level:0,authentication_token:""})),o=await (0,iQ.Y)(e);if(0===o.statusCode){let e=i.length;for(let t=n;t<Math.min(n+6,e);t++){let e=o.result.find(e=>e.item_id===i[t].vid);i[t].time=Date.now(),i[t].hasCheck=(null==e?void 0:e.safety_code)===0}Z.Le.setConfig(Z.gI.CheckAwemeList,i),o.result.find(e=>e.item_id===l)&&(d.pause(),s(!0),iq.sendLog("checkVideoUnsafeModal",{aweme_id:t.awemeId}));let a=o.result.filter(e=>e.item_id!==l&&1===e.safety_code).map(e=>e.item_id);q.emit(q.EVENT.checkSafeAwemeList,a),iq.sendLog("checkVideoUnsafe",{aweme_ids:o.result.map(e=>e.item_id),counts:o.result.length})}}},[d,t]),p=(0,m.useCallback)(async e=>{i?_():f()},[i,_,f]);return(0,iK.t)(e=>{!e&&l&&d&&_()}),(0,m.useEffect)(()=>{if(r&&c>0){d.pause();let e=setTimeout(()=>{v(c-1)},1e3);return()=>clearTimeout(e)}},[r,c]),(0,m.useEffect)(()=>{if(r&&0===c&&a){if(i){if("reverse"===Z.Le.getConfig(Z.gI.InnerAutoPlay).mode){n();return}o();return}a()}},[r,c,i,a]),(0,m.useEffect)(()=>{i&&(v(5),s(!1))},[i,t]),(0,m.useEffect)(()=>{if(d&&l)return d.on(ih.FP.FIRST_FRAME,p),d.on(ih.FP.REPLAY,p),()=>{d.off(ih.FP.FIRST_FRAME,p),d.off(ih.FP.REPLAY,p)}},[d,l,p]),r&&(0,u.jsxs)("div",{className:i$.default.container,children:[(0,u.jsx)("div",{className:i$.default.damaIcon}),(0,u.jsx)("div",{className:i$.default.damaText,children:"当前视频出现问题，无法播放"}),(0,u.jsxs)("div",{className:i$.default.damaTime,children:[(0,u.jsx)("span",{className:i$.default.nums,children:c}),(0,u.jsx)("span",{children:"秒后自动切换至下一个内容"})]})]})};var i1=l("883675"),i2=l("530419"),i4=l("210571"),i3=l("910427"),i5=l("146586"),i6=l("204378"),i8=l("234594"),i7=l("989827"),i9=l("47047");let ne=e=>{var t,l,i;let{isActive:n}=e||{},{isMobile:o,isiPad:a}=(0,M.X)(),d=(0,e$.n)(),r=(0,i9.O)()||o||a?null==d?void 0:null===(t=d.getPlugin("progress"))||void 0===t?void 0:t.parent:null==d?void 0:null===(l=d.getPlugin("progress"))||void 0===l?void 0:l.outer,s=null==d?void 0:null===(i=d.getPlugin("volume"))||void 0===i?void 0:i.root;return(0,m.useEffect)(()=>{let e=e=>{null==e||e.stopPropagation()};return null==r||r.addEventListener("pointerdown",e),null==r||r.addEventListener("touchstart",e),null==s||s.addEventListener("pointerdown",e),null==s||s.addEventListener("touchstart",e),()=>{null==r||r.removeEventListener("pointerdown",e),null==r||r.removeEventListener("touchstart",e),null==s||s.removeEventListener("pointerdown",e),null==s||s.removeEventListener("touchstart",e)}},[r,s]),(0,m.useEffect)(()=>{if(d&&n){d.addClass("hide-loading");let e=setTimeout(()=>{d.removeClass("hide-loading")},2e3),t=()=>{d.removeClass("hide-loading"),clearTimeout(e)};return d.once("playing",t),()=>{clearTimeout(e),d.off("playing",t)}}},[n,d]),null},nt=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"SwiperFitPlugin",Slardar:t,children:(0,u.jsx)(ne,(0,d._)({},e))})},nl=e=>{let{awemeInfo:t,isActive:l}=e,i=(0,e$.n)(),n=()=>{let e=Z.Le.getConfig(Z.gI.AwemePcRecRawData);return!e&&(e={videoPrefer:{fsn:[],like:[],halfMin:[],min:[]}},Z.Le.setConfig(Z.gI.AwemePcRecRawData,e)),e};return(0,m.useEffect)(()=>{if(i){let e=()=>{i.playTimestamp=new Date().getTime()};return null==i||i.on(ih.FP.PLAY,e),()=>i.off(ih.FP.PLAY,e)}},[i]),(0,m.useEffect)(()=>{if(i&&l){let e=()=>{var e;let{fsn:l}=n().videoPrefer;l.filter((e,t)=>t%2==0).includes(null==t?void 0:t.groupId)||l.push(null==t?void 0:t.groupId,null==t?void 0:null===(e=t.authorInfo)||void 0===e?void 0:e.uid),(0,Z.xL)(t,i,"fsn")};return null==i||i.on(ih.FP.ENDED,e),()=>null==i?void 0:i.off(ih.FP.ENDED,e)}},[i,l,t]),(0,m.useEffect)(()=>{if(i&&l)return()=>{[3e4,6e4].filter(e=>i.cumulateTime>=e).map(e=>3e4===e?"halfMin":"min").map(e=>{var l;return{field:e,groupId:null==t?void 0:t.groupId,authorId:null==t?void 0:null===(l=t.authorInfo)||void 0===l?void 0:l.uid}}).forEach(e=>{let l=n().videoPrefer[e.field];l.filter((e,t)=>t%2==0).includes(null==t?void 0:t.groupId)||l.push(e.groupId,e.authorId),(0,Z.xL)(t,i,e.field)}),i.cumulateTime<2e3&&(0,Z.xL)(t,i,"skip"),i.overallPlayTime?i.overallPlayTime+=i.cumulateTime:i.overallPlayTime=i.cumulateTime}},[i,l,t]),null},ni=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"CumulativeTime",Slardar:t,children:(0,u.jsx)(nl,(0,d._)({},e))})};var nn=l("165674");let no=e=>{let{awemeInfo:t,isActive:l}=e,i=(0,e$.n)(),n=(0,m.useRef)(!1),o=(0,m.useMemo)(()=>(0,em.Rx)(t),[t]);return(0,m.useEffect)(()=>{if(l){let e=Date.now(),l=k.s.getIsPageFullscreen(),i=(0,et.r)()?"browser_full":l?"web_full":"normal";return(0,tA.E)("show",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra,player_form:i}),()=>{var l;(0,tA.E)("show_over",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:Date.now()-e,player_form:i}),(0,tA.E)("break",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:Date.now()-e,video_length:null==t?void 0:null===(l=t.video)||void 0===l?void 0:l.duration})}}},[l,t]),(0,m.useEffect)(()=>{if(i){let e=()=>{(0,tA.E)("auto_play",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra})},t=()=>{(0,tA.E)("show_fail",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra}),(0,tA.E)("play_failed",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra})};return i.once(ih.FP.PLAY,e),i.once(ih.FP.ERROR,t),()=>{i.off(ih.FP.PLAY,e),i.off(ih.FP.ERROR,t)}}},[i,o]),(0,nn.u)(i,ih.FP.PLAY,()=>{(0,tA.E)("play",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,nn.u)(i,ih.FP.REPLAY,()=>{(0,tA.E)("auto_replay",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,nn.u)(i,ih.FP.ENDED,()=>{var e,l;(0,tA.E)("over",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:null==t?void 0:null===(e=t.video)||void 0===e?void 0:e.duration,video_length:null==t?void 0:null===(l=t.video)||void 0===l?void 0:l.duration})}),(0,nn.u)(i,ih.FP.VOLUMECHANGE,()=>{1===(0,lJ.$o)(lX.LocalStorageKeys.PLAYER_IS_MUTE)&&(0,tA.E)("mute",{tag:(0,tD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,nn.u)(i,ih.FP.ERROR,()=>{!n.current&&(n.current=!0)}),null},na=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"AdCommonHandler",Slardar:t,children:(0,u.jsx)(no,(0,d._)({},e))})};var nd=l("944189"),nr=l("459307"),ns=l("512311"),nu=l("829097"),nc=l("264646"),nv=l("509090"),nm=l("979571"),n_=l("109539");let nf=e=>{let{onClose:t}=e;return(0,u.jsx)("div",{className:nc.default.container,onClick:t,children:(0,u.jsxs)("div",{className:nc.default.main,onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("div",{className:nc.default.title,children:"抖音广告"}),(0,u.jsx)("div",{className:nc.default.detail,children:"抖音根据您的个人偏好向您展示广告，以向您提供更好的服务。如果您对于某条广告不感兴趣，您可以通过右键视频，点击“不感兴趣”，选择屏蔽您不感兴趣的广告内容，但这项设置不会改变您在抖音看到的广告数量。"}),(0,u.jsx)("div",{className:nc.default.close,children:(0,u.jsx)(nm.z,{svg:(0,u.jsx)(ns.Z,{}),onClick:t,style:{fontSize:"36px"}})})]})})},np=e=>{let t=document.createElement("div"),l=(0,nd.createRoot)(t),i=document.body;if((0,et.r)()&&(i=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement),Z.Le.getConfig(Z.gI.IsShowAdIntroduction))return;Z.Le.setConfig(Z.gI.IsShowAdIntroduction,!0),i.appendChild(t);let n=e=>{let{fullscreen:t}=e;t&&o()},o=()=>{e.off("switch_fullscreen",n),l.unmount(),t.remove(),Z.Le.setConfig(Z.gI.IsShowAdIntroduction,!1)};e.on("switch_fullscreen",n),l.render((0,u.jsx)(nf,{onClose:o}))},nh=e=>{let{awemeInfo:t,toast:l,abtestData:i}=e,n=(0,e$.n)(),o=(0,n_.useUserInfoContext)(),a=(0,m.useCallback)(async()=>{let e=(0,em.Rx)(t),i=await (0,nu.j$)({creative_id:e.creative_id,log_extra:e.log_extra,is_positive:1});(null==i?void 0:i.code)===0?l?l("操作成功，将持续优化推荐内容"):nv.F.info("操作成功，将持续优化推荐内容"):l?l("操作失败，请稍后重试"):nv.F.info("操作失败，请稍后重试"),(0,tA.E)("otherclick",{tag:(0,tD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"like"})},[t]),r=(0,m.useCallback)(async function(){let{onAddDislikeSuccess:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,em.Rx)(t),n=(0,eg.hj)(t)?{dislike_ad_type:"aweme_webcast"}:{},o=(0,em.Gu)(t)?"广告":"视频",a=await (0,nu.j$)((0,d._)({creative_id:i.creative_id,log_extra:i.log_extra},n));(null==a?void 0:a.code)===0?(l?l(`操作成功，将减少此类${o}出现`):nv.F.info(`操作成功，将减少此类${o}出现`),null==e||e()):l?l("操作失败，请稍后重试"):nv.F.info("操作失败，请稍后重试"),(0,tA.E)("otherclick",{tag:(0,tD.f)(),value:i.creative_id,log_extra:i.log_extra,refer:"feedback_button",right_click:"dislike"})},[t]),s=(0,m.useCallback)(async()=>{var e,l;let n=JSON.parse(null==t?void 0:t.rawAdData);(0,tA.E)("otherclick",{tag:(0,tD.f)(),value:n.creative_id,log_extra:n.log_extra,refer:"feedback_button",right_click:"report"}),q.emit(q.EVENT.videoPause),(0,nr.n)({creative_id:n.creative_id,log_extra:n.log_extra,title:"广告举报",user_id:null==o?void 0:null===(l=o.userInfo)||void 0===l?void 0:null===(e=l.info)||void 0===e?void 0:e.uid,onClose:()=>{(0,eb.m)("adReportModal"),q.emit(q.EVENT.videoRemoveStopPlayNext)},onShow:()=>{q.emit(q.EVENT.videoStopPlayNext),(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"adReportModal")},onLoginSuccess:()=>{q.emit(q.EVENT.videoStopPlayNext)},loginDispatch:null==o?void 0:o.dispatch,abtestData:i})},[t,n,o,i]),u=(0,m.useCallback)(()=>{let e=JSON.parse(null==t?void 0:t.rawAdData);(0,tA.E)("otherclick",{tag:(0,tD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"advertising"}),q.emit(q.EVENT.videoPause)},[t]),c=(0,m.useCallback)(()=>{let e=JSON.parse(null==t?void 0:t.rawAdData);(0,tA.E)("otherclick",{tag:(0,tD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"why"}),np(n)},[n,t]);return(0,nn.u)(n,iO.C.AdLike,a),(0,nn.u)(n,iO.C.AdDislike,r),(0,nn.u)(n,iO.C.AdReport,s),(0,nn.u)(n,iO.C.AdThrow,u),(0,nn.u)(n,iO.C.AdIntroduce,c),null},ng=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"FeedbackAd",Slardar:t,children:(0,u.jsx)(nh,(0,d._)({},e))})};var ny=l("96648"),nw=l("202091"),nI=l("134761"),nx=l("784492"),nb=l("645003"),nE=l("506924");let nT=(0,m.forwardRef)((e,t)=>(0,u.jsx)("svg",(0,r._)((0,d._)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,u.jsx)("path",{d:"M4 1l5 5-5 5",stroke:"#fff",strokeOpacity:".9",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})}))),nC=(0,m.forwardRef)((e,t)=>(0,u.jsx)("svg",(0,r._)((0,d._)({width:31,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.54 8a1.04 1.04 0 1 0 0 2.08h13.92a1.04 1.04 0 1 0 0-2.08H8.54zm3.425 13.89a.448.448 0 0 0 0-.772l-3.47-2.043a.448.448 0 0 0-.675.386v4.086c0 .346.377.561.676.386l3.468-2.043zM7.5 15.242c0-.575.466-1.04 1.04-1.04h13.92a1.04 1.04 0 1 1 0 2.08H8.54a1.04 1.04 0 0 1-1.04-1.04zm7.44 5.16a1.04 1.04 0 0 0 0 2.08h7.52a1.04 1.04 0 1 0 0-2.08h-7.52z",fill:"#fff"})})));var nN=l("757858"),nP=l("282765");function nS(){return(0,u.jsx)("div",{className:nE.default.xgTips,children:(0,u.jsx)("span",{children:"章节要点"})})}let nL=e=>{var t,l,i,n;let{awemeInfo:o,isChapterIcon:a,chapterProps:d,chapterMaxWidth:r,player:s,userInfo:c}=e,v=null!==(n=null==o?void 0:null===(t=o.chapterInfo)||void 0===t?void 0:t.list)&&void 0!==n?n:[],{chapterProgress:_,triggerChapterSliderShow:f}=d,p=(null==o?void 0:null===(l=o.chapterInfo)||void 0===l?void 0:l.isPoint)?1:0,h=o.authorInfo.uid===(null==c?void 0:null===(i=c.info)||void 0===i?void 0:i.uid),g=()=>{var e;return{enter_from:(0,iR.mo)(),enter_from_merge:(0,iR.vM)(),group_id:null==o?void 0:o.awemeId,author_id:null==o?void 0:null===(e=o.authorInfo)||void 0===e?void 0:e.uid,chapter_sequence_num_impr:"number"==typeof _&&-1!==_?_+1:null,is_knowledge_point:p,is_author:h?1:0}},y=(0,nb.Y)(()=>{B.logInstance.sendLog("chapterTagShow",g())}),w=()=>{B.logInstance.sendLog("chapterTagClick",g()),f()};if((0,m.useEffect)(()=>{var e,t;a?null===(e=s.root.querySelector(".chapterContainer"))||void 0===e||e.classList.add(nE.default.displayIcon):null===(t=s.root.querySelector(".chapterContainer"))||void 0===t||t.classList.remove(nE.default.displayIcon)},[a,s]),0===v.length)return null;let I=v[_];return(0,u.jsx)("div",{ref:y,children:a?(0,u.jsxs)("div",{className:nE.default.chapterIcon,children:[(0,u.jsx)(eF.Z,{src:nC,width:31,height:32,viewBox:"0 0 31 32",onClick:w}),(0,u.jsx)(nS,{})]}):(0,u.jsxs)("div",{className:nE.default.chapterBar,onClick:w,style:r?{maxWidth:`${r}px`}:void 0,children:[(0,u.jsx)("div",{className:nE.default.dividerSmall}),(0,u.jsx)("div",{className:nE.default.chapterTitle,children:-1===_?`章节要点：共${v.length}个`:`章节要点${_+1}：${null==I?void 0:I.desc}`}),(0,u.jsx)(eF.Z,{className:nE.default.arrowIcon,src:nT,width:12,height:12,viewBox:"0 0 12 12"})]})})};class nA extends ih.di{renderRoot(){var e;let t=null!==(e=this._config)&&void 0!==e?e:{};this.el&&(0,nN.s)(this,(0,u.jsx)(nL,(0,d._)({},t)))}beforeDestroy(){(0,nN.v)(this)}afterPlayerInit(){this.renderRoot()}configDidUpdate(){this.renderRoot()}render(){return`<div data-state="normal" class="${nE.default.chapterContainer} chapterContainer" data-e2e='chapter-container'></div>`}}(0,nI._)(nA,"pluginName",nP.p7.ChapterPlugin);let nk=(0,eB.h)(e=>{let{isActive:t,awemeInfo:l,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o,userInfo:a}=e,r=(0,e$.n)(),s={position:ih.PZ.CONTROL_LEFT,index:2.9,className:"douyin-player-chapter"};return(0,m.useEffect)(()=>{var e;if(r&&t&&(null==l?void 0:null===(e=l.chapterInfo)||void 0===e?void 0:e.status))return r.registerPlugin(nA,(0,d._)({player:r,awemeInfo:l,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o,userInfo:a},s)),()=>{if(!r.destroyed)r.getPlugin(nP.p7.ChapterPlugin)&&r.unRegisterPlugin(nP.p7.ChapterPlugin)}},[r,t,l,a]),(0,nx.Z)(()=>{r&&r.updatePluginConfig(nP.p7.ChapterPlugin,{isActive:t,awemeInfo:l,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o})},[t,l,n,o,i]),null},"Chapter");var nj=l("654688"),nD=l("667856"),nR=l("88961"),nM=l("243150"),nF=l("907170"),nB=l("986694"),nO=l("421953"),nV=new iY.h({recommendVideoToast:{eventName:"recommend_video_toast",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",label_related_action:"",label_text:"",like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_range:"mutual"}},cancelRecommendVideo:{eventName:"cancel_recommend_video",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",recommend_range:"mutual"}},friendsWatchingShow:{eventName:"friends_watching_show",params:{group_id:"",author_id:"",enter_from:"",is_friend_watching:0,like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_user_relation:"",recommend_user_app_list:""}},fromDiscoverLabel:{eventName:"from_discover_label",params:{group_id:"",author_id:"",action_type:"",enter_from:""}}});let nW=(0,m.forwardRef)((e,t)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({xmlns:"http://www.w3.org/2000/svg",width:12,height:14,fill:"none",ref:t},e),{children:[(0,u.jsx)("g",{filter:"url(#arrowRight_svg__filter0_d_4446_15535)",children:(0,u.jsx)("g",{filter:"url(#arrowRight_svg__filter1_d_4446_15535)",children:(0,u.jsx)("path",{d:"M3.803 9.864a.75.75 0 0 1 0-1.061L6.606 6 3.803 3.197a.75.75 0 0 1 1.06-1.06L8.198 5.47a.75.75 0 0 1 0 1.06L4.864 9.864a.75.75 0 0 1-1.06 0z",fill:"#fff"})})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("filter",{id:"arrowRight_svg__filter0_d_4446_15535",x:-2,y:-1,width:16,height:16,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{dy:1}),(0,u.jsx)("feGaussianBlur",{stdDeviation:1}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_4446_15535"}),(0,u.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_4446_15535",result:"shape"})]}),(0,u.jsxs)("filter",{id:"arrowRight_svg__filter1_d_4446_15535",x:3.083,y:1.417,width:6.833,height:10.167,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{dx:".5",dy:".5"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:".5"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.7 0"}),(0,u.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_4446_15535"}),(0,u.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_4446_15535",result:"shape"})]})]})]})));var nU=l("980141");let nH=e=>{let{awemeInfo:t,recommendTagType:l,onClickGuideTag:i,onClickWhiteTag:n,className:o,userList:a,player:d,shouldShowFollowRecBtn:r,abTestData:s,guideTagTriggerSource:c,recommendTriggerSource:v,userInfo:_}=e,{userRecommendStatus:f,friendRecommendInfo:p,status:{allowSelfRecommendToFriend:h}={},stats:{recommendCount:y=0}={}}=t,{isLogin:w}=_,I=(0,m.useMemo)(()=>{let e=null==s?void 0:s.familiarRecommendEntranceCountLabelCondition;return e?y>e?`共${(0,nF.qe)(y)}人推荐`:"点击推荐":"点击推荐"},[s,y]),x=(0,m.useRef)("mutual"),b=async()=>{var e,i,n,o,a,d,r,s,u,m,_;if(!t||!l||2===f||(null==p?void 0:null===(e=p.label_user_list)||void 0===e?void 0:e.length)>0)return;let{data:h,statusCode:g}=await (0,nB.s$)();if(0===g){let{recommendVisibility:e}=h;x.current=0===e?"mutual":"fans"}nV.sendLog("recommendVideoToast",{group_id:null==t?void 0:t.awemeId,author_id:String(null==t?void 0:t.authorUserId),action_type:"show",relation_tag:null==t?void 0:null===(i=t.authorInfo)||void 0===i?void 0:i.followStatus,enter_from:(0,iR.vM)(),enter_method:"guide"===l?"label":v,label_related_action:c,label_text:"guide"===l?I:void 0,like_cnt:y,follow_cnt:"plus_one"===v?null==t?void 0:null===(a=t.friendRecommendInfo)||void 0===a?void 0:null===(o=a.label_user_list)||void 0===o?void 0:null===(n=o.filter(e=>{var t;return(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.follow_status)===1}))||void 0===n?void 0:n.length:void 0,mutual_cnt:"plus_one"===v?null==t?void 0:null===(s=t.friendRecommendInfo)||void 0===s?void 0:null===(r=s.label_user_list)||void 0===r?void 0:null===(d=r.filter(e=>{var t;return(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.follow_status)===2}))||void 0===d?void 0:d.length:void 0,friend_user_id:null==t?void 0:null===(_=t.friendRecommendInfo)||void 0===_?void 0:null===(m=_.label_user_list)||void 0===m?void 0:null===(u=m.map(e=>{var t;return null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.uid}))||void 0===u?void 0:u.join(","),recommend_range:x.current})},[E,T]=(0,nR.Z)(null,void 0,[t,l]);(0,eP.o)(()=>{T&&b()},[T,t,l]),(0,eP.o)(()=>{var e,l,i,n,o,a,d,r,u,c,v,m,_,g,I;if(!!h&&!!(null==s?void 0:s.pcAllowRecommendToFriends)&&!!w&&!!T){if(2===f||(null==p?void 0:null===(e=p.label_user_list)||void 0===e?void 0:e.length)>0){let e=2!==f||(null==p?void 0:null===(l=p.label_user_list)||void 0===l?void 0:l.length)?3:0;nV.sendLog("friendsWatchingShow",{group_id:null==t?void 0:t.awemeId,author_id:String(null==t?void 0:t.authorUserId),enter_from:(0,iR.vM)(),is_friend_watching:e,like_cnt:e?y:void 0,follow_cnt:e?null==t?void 0:null===(o=t.friendRecommendInfo)||void 0===o?void 0:null===(n=o.label_user_list)||void 0===n?void 0:null===(i=n.filter(e=>{var t;return(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.follow_status)===1}))||void 0===i?void 0:i.length:void 0,mutual_cnt:e?null==t?void 0:null===(r=t.friendRecommendInfo)||void 0===r?void 0:null===(d=r.label_user_list)||void 0===d?void 0:null===(a=d.filter(e=>{var t;return(null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.follow_status)===2}))||void 0===a?void 0:a.length:void 0,friend_user_id:null==t?void 0:null===(v=t.friendRecommendInfo)||void 0===v?void 0:null===(c=v.label_user_list)||void 0===c?void 0:null===(u=c.map(e=>{var t;return null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.uid}))||void 0===u?void 0:u.join(","),recommend_user_relation:null==t?void 0:null===(_=t.friendRecommendInfo)||void 0===_?void 0:null===(m=_.label_user_list)||void 0===m?void 0:m.map(e=>{var t,l;return`${null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.uid}:${null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status}`}).join(","),recommend_user_app_list:null==t?void 0:null===(I=t.friendRecommendInfo)||void 0===I?void 0:null===(g=I.label_user_list)||void 0===g?void 0:g.map(e=>{var t;return`${null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.uid}:${null==e?void 0:e.recommend_app_id}`}).join(",")})}}},[t,T]);let C=()=>{null==i||i()},N=()=>{null==n||n()},P=()=>{null==d||d.emit(lE.Events.USER_ACTION,{action:"recommend",source:"plus_one"})},S=(0,m.useMemo)(()=>{var e,l,i,n,o,d;return(null==a?void 0:a.length)===1?(0,u.jsxs)("div",{className:nO.default.recommendText,children:[(0,u.jsx)("span",{className:g()(nO.default.nickname,nO.default.singleUser),children:null==a?void 0:null===(d=a[0])||void 0===d?void 0:null===(o=d.user)||void 0===o?void 0:o.nickname}),"推荐"]}):(0,u.jsxs)("div",{className:nO.default.recommendText,children:[(0,u.jsx)("span",{className:nO.default.nickname,children:null==t?void 0:null===(n=t.friendRecommendInfo)||void 0===n?void 0:null===(i=n.label_user_list)||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:null===(e=l.user)||void 0===e?void 0:e.nickname})," ","等 ",null==a?void 0:a.length," 人推荐"]})},[a]);return l?(0,u.jsx)("div",{className:g()("xgplayer-recommend-tag",nO.default.wrapper,o),ref:E,children:(()=>{switch(l){case"guide":return(0,u.jsxs)("div",{className:g()(nO.default.guideTagContainer),onClick:C,children:[(0,u.jsx)(nM.Z,{src:nU.Z,width:16,height:16,viewBox:"0 0 16 16"}),(0,u.jsx)("span",{className:nO.default.text,children:I}),(0,u.jsx)(nM.Z,{src:nW,width:12,height:14,viewBox:"0 0 12 14"})]});case"white":return(null==a?void 0:a.length)>0?(0,u.jsxs)("div",{className:nO.default.whiteTagContainer,children:[(0,u.jsxs)("div",{className:nO.default.whiteTag,onClick:N,children:[(0,u.jsx)("div",{className:nO.default.avatarList,children:null==a?void 0:a.slice(0,3).map((e,t)=>{var l,i,n,o;return(0,u.jsx)("img",{src:null==e?void 0:null===(n=e.user)||void 0===n?void 0:null===(i=n.avatar)||void 0===i?void 0:null===(l=i.url_list)||void 0===l?void 0:l[0],className:nO.default.avatar,style:{zIndex:3-t}},(null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.uid)||t)})}),S]}),r&&(0,u.jsx)("div",{className:nO.default.recommendIconWrapper,onClick:P,children:(0,u.jsx)(nM.Z,{src:nU.Z,width:16,height:16,viewBox:"0 0 16 16"})})]}):(0,u.jsx)("div",{});default:return(0,u.jsx)("div",{})}})()}):null};var nG=l("352026"),nz=l("139002"),nZ={Photo:"photo",Name:"name",Blank:"blank",Pull:"pull",Button:"button",Source:"source",Title:"title",SupportArea:"support_area",SupportAreaCard:"support_area_card"},nK={AdProduct:"product",AdBackupProduct:"backup_product"},nQ={HIDDEN:-1,"-1":"HIDDEN",MINI_DARK:0,0:"MINI_DARK",MINI_LIGHT:1,1:"MINI_LIGHT",NORMAL_LIGHT:2,2:"NORMAL_LIGHT"};function n$(e){let{showTimeList:t=[],isActive:l,awemeInfo:i,needInit:n=!0}=e,o=(0,e$.n)(),a=(0,m.useRef)(!0),d=(0,m.useRef)(!1),[r,s]=(0,m.useState)(nQ.HIDDEN),[u=5,c=7,v=9]=t,_=(0,y.Z)(()=>{if(!d.current){var e,t;null==o||null===(e=o.on)||void 0===e||e.call(o,ih.FP.TIMEUPDATE,p),null==o||null===(t=o.on)||void 0===t||t.call(o,ih.FP.SEEKING,h)}d.current=!0}),f=(0,y.Z)(()=>{if(d.current){var e,t;null==o||null===(e=o.off)||void 0===e||e.call(o,ih.FP.TIMEUPDATE,p),null==o||null===(t=o.off)||void 0===t||t.call(o,ih.FP.SEEKING,h)}d.current=!1}),p=(0,y.Z)(e=>{let{currentTime:t}=e||{};t>=u&&t<c?s(e=>n?nQ.MINI_DARK:e<=nQ.MINI_DARK?nQ.MINI_DARK:e):t>=c&&t<v?s(e=>n?nQ.MINI_LIGHT:e<=nQ.MINI_LIGHT?nQ.MINI_LIGHT:e):t>=v&&(a.current=!1,s(e=>n?nQ.NORMAL_LIGHT:e<=nQ.NORMAL_LIGHT?nQ.NORMAL_LIGHT:e),f())}),h=(0,y.Z)(e=>{let{currentTime:t}=e;if(0!==t){s(nQ.NORMAL_LIGHT),f();let e=(0,em.Rx)(i);(0,tA.E)("drag_bar",{tag:(0,tD.f)(),value:e.creative_id,log_extra:e.log_extra})}a.current=!1}),g=(0,m.useCallback)(()=>{a.current=!0,s(nQ.HIDDEN)},[]),w=(0,m.useCallback)(e=>{if(!e.length)return!1;let t=!0;for(let l in e)if("number"!=typeof e[l]){t=!1;break}return t},[]),I=(0,m.useCallback)(()=>{n&&(g(),_())},[n,g,_]);return(0,nn.u)(o,ih.FP.ENDED,I),(0,m.useEffect)(()=>{n?g():r===nQ.HIDDEN&&g()},[l,g]),(0,nx.Z)(()=>{g()},[i]),(0,m.useEffect)(()=>l?!w([u,c,v])||u>=c||c>=v?s(nQ.NORMAL_LIGHT):o&&a.current?(_(),()=>{f()}):void 0:void 0,[o,i,l,_,f]),(0,m.useEffect)(()=>{(null==o?void 0:o.currentTime)&&p({currentTime:o.currentTime})},[o]),{displayState:r}}let nY=e=>{let t=(0,m.useRef)(null),{awemeInfo:l,isActive:i,adData:n,isHide:o=!1}=e||{},{product_title:a,product_name:d,button_background_color:r,ad_title:s,word_image_url:c,image_url:v,button_text:_}=n,f=(0,m.useRef)(0),p=eZ()((e,t)=>{if(h===nQ.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(l);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedAd",cid:null==i?void 0:i.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1}),{displayState:h}=n$({awemeInfo:l,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});(0,m.useEffect)(()=>{f.current=0},[l]);let y=(0,m.useMemo)(()=>{let e="";return h===nQ.MINI_DARK||h===nQ.MINI_LIGHT?e=d:h===nQ.NORMAL_LIGHT&&(e=a||d),e},[h,a,d]);return(0,eP.o)(()=>{let e;if(!!i)return h===nQ.NORMAL_LIGHT&&f.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),f.current+=1},1e3)),()=>{clearTimeout(e)}},[i,h]),(0,m.useEffect)(()=>{["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!n[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:e,adType:V.Z9.DisplayCard13,logId:null==l?void 0:l.logPb}})})},[n,l]),(0,u.jsx)("div",{ref:t,className:g()(nz.default.adWrapper,{[nz.default.hasTransition]:!(h===nQ.HIDDEN||o),[nz.default.adWrapperHidden]:h===nQ.HIDDEN||o}),id:nz.default.adWrapper,children:(0,u.jsxs)("div",{className:nz.default.adContainer,onClick:e=>p(e),children:[(0,u.jsxs)("div",{className:nz.default.adSource,onClick:e=>p(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:v,iconHeight:30,iconWidth:30,className:nz.default.adIcon}),(0,u.jsx)("span",{className:nz.default.adName,children:y})]}),h>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>p(e,nZ.Title),className:nz.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:nz.default.moreIcon}),(0,u.jsx)("div",{className:nz.default.split}),(0,u.jsx)("div",{className:nz.default.adTitle,children:s})]}),(0,u.jsx)("div",{className:nz.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>p(e,nZ.Button),style:{background:h<=nQ.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:r},children:(0,u.jsx)("span",{style:{fontWeight:500},children:_||"查看详情"})})})]})})};function nq(e){let{awemeInfo:t}=e||{},l=(0,eh.A)(t),i=(0,tk.rQ)(t);return l&&i?(0,u.jsx)(nY,(0,r._)((0,d._)({},e),{adData:i})):null}let nJ=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"FeedAd",Slardar:t,children:(0,u.jsx)(nq,(0,d._)({},e))})};var nX=l("774575");let n0=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{let e=(null==l?void 0:l.min_price)?["product_name","product_title","ad_title","word_image_url","image_url","button_text","min_price","product_tags"]:["product_name","ad_title","word_image_url","image_url","button_text"];try{var i,n;let o=(0,em.Rx)(t),a=null==o?void 0:null===(i=o.lynx_components)||void 0===i?void 0:i.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);e.forEach(e=>{!l[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:e,adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:t.logPb}})}),!(null==l?void 0:l.min_price)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"min_price",adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:t.logPb}}),!(null==a?void 0:null===(n=a.lynx_raw_data)||void 0===n?void 0:n.open_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"open_url",adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:t.logPb}})}catch(e){}},[t])};var n1=l("438740"),n2=l("13365");let n4=e=>{var t,l;let{adData:i,logParams:n}=e,o=null==i?void 0:null===(t=i.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(l=o.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info;(0,m.useEffect)(()=>{let e=["product_phrase","product_name","image_url","live_product_infos"];try{let t=[];e.forEach(e=>{!(null==a?void 0:a[e])&&t.push(e)}),["collection_num","return_vistors","favorable_rate","product_tags","sell_num"].every(e=>!(null==a?void 0:a[e]))&&t.push("feedback"),t.length>=e.length&&(0,tA.E)("othershow_fail",{tag:"draw_ad",value:i.creative_id,log_extra:i.log_extra}),Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{key:t,adType:V.Z9.Live,creativeId:null==i?void 0:i.creative_id,logId:null==n?void 0:n.requestId,logParams:n}})}catch(e){}},[i])};var n3=l("262652"),n5=l("116569"),n6=e=>{let{className:t,children:l,style:i,onClick:n}=e;return(0,u.jsx)("span",{style:i,className:g()(n5.default.adTag,t),onClick:n,children:l})};let n8=["不容错过的优品","值得买的好物","优选心仪好物","精选超值好货"],n7=["人气热卖","优选好物"],n9=["优选好物"],oe=e=>{var t,l;let{adData:i,onClickElement:n}=e,o=null==i?void 0:null===(t=i.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(l=o.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info,r=(0,nF.As)(null==i?void 0:i.log_extra),{product_phrase:s,product_name:c,image_url:v,product_tags:_,return_vistors:f,favorable_rate:p,sell_num:h,button_text:g,button_background_color:y,live_product_infos:w}=a||{},I=(0,m.useMemo)(()=>{var e,t,l,i,o;let a;let d=s?(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_short_phrase:s}),children:s})}):null,v=(0,nF.Hy)(h)?(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",sell_num:h}),children:["爆卖",(0,nF.Hy)(h),"件"]})}):null,m=(null==_?void 0:_.length)>0?(0,u.jsx)("div",{className:n3.default.tagLine,children:_.slice(0,2).map((e,t)=>(0,u.jsx)(n6,{className:n3.default.tag,style:0===t?{marginRight:"4px"}:{},onClick:t=>n(t,{refer:"sow",product_tags:e}),children:e},e))}):null;return(null==w?void 0:null===(e=w[0])||void 0===e?void 0:e.product_feedback)?a=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>{var t;return n(e,{refer:"sow",product_feedback:null==w?void 0:null===(t=w[0])||void 0===t?void 0:t.product_feedback})},children:null==w?void 0:null===(i=w[0])||void 0===i?void 0:i.product_feedback})}):f?a=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:f}),children:f})}):p?a=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`商品好评率${Math.round(p)}%`}),children:["商品好评率",Math.round(p),"%"]})}):(null==w?void 0:null===(t=w[0])||void 0===t?void 0:t.collection_num)&&(a=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>{var t;return n(e,{refer:"sow",product_feedback:null==w?void 0:null===(t=w[0])||void 0===t?void 0:t.collection_num})},children:null==w?void 0:null===(o=w[0])||void 0===o?void 0:o.collection_num})})),{productName:c,phrase:d,sellInfo:v,tagsElement:m,tagsText:_,feedbackInfo:a,componentIds:null==r?void 0:r.component_ids,productGallery:null==w?void 0:null===(l=w[0])||void 0===l?void 0:l.product_gallery}},[e]),x=(0,m.useMemo)(()=>{let e=n8[Math.floor(Math.random()*n8.length)];return(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:t=>n(t,{refer:"sow",live_product_info_backup:e}),children:e})})},[n]);return(0,d._)({imageUrl:v||eU.DEFAULT_AD_IMAGE_URL,isBackupImgUrl:!v,buttonText:g,buttonBackgroundColor:y,productPhrase:s,defaultPhraseElement:x},I)};function ot(e){let{timerCb:t,isActive:l,awemeInfo:i,needInit:n=!0,stopBySeeking:o=!0}=e,a=(0,e$.n)(),d=(0,m.useRef)(!0),r=(0,m.useRef)(!1),s=(0,y.Z)(e=>{let{currentTime:l}=e||{};t({currentTime:l,isSeeking:!1})}),u=(0,y.Z)(e=>{let{currentTime:l}=e;if(0!==l){o&&(v(),d.current=!1),t({currentTime:l,isSeeking:!0});let e=(0,em.Rx)(i);(null==e?void 0:e.creative_id)&&(0,tA.E)("drag_bar",{tag:(0,tD.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra})}}),c=(0,y.Z)(()=>{if(!r.current){var e,t;null==a||null===(e=a.on)||void 0===e||e.call(a,ih.FP.TIMEUPDATE,s),null==a||null===(t=a.on)||void 0===t||t.call(a,ih.FP.SEEKING,u)}r.current=!0}),v=(0,y.Z)(()=>{if(r.current){var e,t;null==a||null===(e=a.off)||void 0===e||e.call(a,ih.FP.TIMEUPDATE,s),null==a||null===(t=a.off)||void 0===t||t.call(a,ih.FP.SEEKING,u)}r.current=!1}),_=(0,m.useCallback)(()=>{d.current=!0},[]),f=(0,m.useCallback)(()=>{n&&(_(),c()),t({currentTime:0,isSeeking:!0,isEnd:!0})},[n,_,c,t]);return(0,nn.u)(a,ih.FP.ENDED,f),(0,nx.Z)(()=>{_()},[i]),(0,m.useEffect)(()=>{if(!!l){if(a&&d.current)return c(),()=>{v()}}},[a,i,l,c,v]),(0,m.useEffect)(()=>{(null==a?void 0:a.currentTime)&&s({currentTime:a.currentTime})},[a]),{stopListen:v}}var ol=l("697021"),oi=l("706918"),on=l("801103"),oo=l("276541"),oa=l("647571"),od=l("474379"),or=l("250876");l("459903"),oa.Z.use([od.Z]);var os=e=>{let{slideItems:t,className:l,width:i,height:n=20,isStartPlay:o=!1}=e,[a,d]=(0,m.useState)(),r=(0,m.useRef)(null);return(0,m.useEffect)(()=>{if(a&&o&&(null==t?void 0:t.length)>1){if(!r.current){var e;null==a||null===(e=a.slideNext)||void 0===e||e.call(a),r.current=setInterval(()=>{var e;null==a||null===(e=a.slideNext)||void 0===e||e.call(a)},3e3)}}else r.current&&clearInterval(r.current),r.current=null},[o,t,a]),(0,m.useEffect)(()=>()=>{r.current&&clearInterval(r.current),r.current=null},[]),(0,u.jsx)("div",{className:g()(or.default.adSwiper,l),children:(0,u.jsx)(on.t,{allowTouchMove:!1,direction:"vertical",slidesPerView:1,spaceBetween:0,loop:!0,onInit:d,width:i,height:n,autoplay:!1,children:t.map((e,t)=>(0,u.jsx)(oo.o,{children:(0,u.jsx)("div",{className:or.default.slideContent,children:e})},t))})})},ou=e=>{let{className:t,imageUrl:l,isBackupImgUrl:i=!1,slideItems:n,buttonText:o,onClick:a,isStartPlay:d}=e;return(0,u.jsxs)("div",{className:g()(oi.default.singleLineAdCard,t),onClick:e=>a(e,{refer:nZ.Blank}),children:[(0,u.jsxs)("div",{className:oi.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>a(e,{refer:nZ.Photo,click_type:i?nK.AdBackupProduct:nK.AdProduct}),children:(0,u.jsx)(tO.Q,{src:l,iconHeight:28,iconWidth:28,className:oi.default.adIcon})}),(0,u.jsx)("div",{onClick:e=>a(e,{refer:nZ.Name}),children:(0,u.jsx)(os,{isStartPlay:d,className:oi.default.swiperContainer,width:136,slideItems:n})})]}),(0,u.jsxs)("div",{className:oi.default.btnBox,onClick:e=>a(e,{refer:nZ.Button}),children:[(0,u.jsx)("span",{className:oi.default.text,children:o}),(0,u.jsx)(nm.z,{svg:(0,u.jsx)(ol.Z,{}),className:oi.default.icon})]})]})},oc=l("259351"),ov=e=>{let{className:t,title:l,imageUrl:i,isBackupImgUrl:n=!1,slideItems:o,buttonText:a,buttonBgColor:d=eU.DEFAULT_BUTTON_COLOR,onClick:r,isStartPlay:s}=e;return(0,u.jsxs)("div",{className:g()(oc.default.doubleLineAdCard,t),onClick:e=>r(e,{refer:nZ.Blank}),children:[(0,u.jsxs)("div",{className:oc.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>r(e,{refer:nZ.Photo,click_type:n?nK.AdBackupProduct:nK.AdProduct}),children:(0,u.jsx)(tO.Q,{src:i,iconHeight:40,iconWidth:40,className:oc.default.adIcon})}),(0,u.jsxs)("div",{className:oc.default.detail,children:[(0,u.jsx)("div",{className:oc.default.title,onClick:e=>r(e,{refer:nZ.Name}),children:l}),(0,u.jsx)(os,{isStartPlay:s,className:oc.default.swiperContainer,width:108,slideItems:o})]})]}),(0,u.jsx)("div",{className:oc.default.adButton,onClick:e=>r(e,{refer:nZ.Button}),style:{background:d},children:a})]})},om=l("608845"),o_=e=>{var t;let{className:l,title:i,imageUrl:n,isBackupImgUrl:o=!1,slideItems:a,buttonText:d,buttonBgColor:r=eU.DEFAULT_BUTTON_COLOR,tags:s=[],onClick:c,isStartPlay:v}=e;return(0,u.jsxs)("div",{className:g()(om.default.strongStyleAdCard,l),onClick:e=>c(e,{refer:nZ.Blank}),children:[(0,u.jsxs)("div",{className:om.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>c(e,{refer:nZ.Photo,click_type:o?nK.AdBackupProduct:nK.AdProduct}),children:(0,u.jsx)(tO.Q,{src:n,iconHeight:72,iconWidth:72,className:om.default.adIcon})}),(0,u.jsxs)("div",{className:om.default.detail,children:[(0,u.jsx)("div",{className:om.default.title,onClick:e=>c(e,{refer:nZ.Name}),children:i}),(null==s?void 0:s.length)>0&&(0,u.jsx)("div",{className:om.default.tagLine,children:null==s?void 0:null===(t=s.slice(0,2))||void 0===t?void 0:t.map((e,t)=>(0,u.jsx)(n6,{className:om.default.tag,onClick:t=>c(t,{refer:nZ.Pull,product_tags:e}),children:e},t))}),(0,u.jsx)(os,{isStartPlay:v,className:om.default.swiperContainer,width:156,slideItems:a})]})]}),(0,u.jsx)("div",{className:om.default.adButton,style:{background:r},onClick:e=>c(e,{refer:nZ.Button}),children:d})]})},of=e=>{let{adData:t,awemeInfo:l,isActive:i,logParams:n,isHide:o=!1}=e||{},[a,r]=(0,m.useState)(!1),[s,c]=(0,m.useState)(),[v,_]=(0,m.useState)(!1),f=(0,m.useRef)(!1),p=(0,m.useRef)(new Date().getTime()),h=(0,m.useRef)(new Date().getTime()),y=(0,m.useCallback)(eZ()((e,t)=>{var i,n;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let o=(0,em.Rx)(l);(0,tA.E)("realtime_click",(0,d._)({tag:(0,tD.f)(),value:null==o?void 0:o.creative_id,log_extra:null==o?void 0:o.log_extra,ad_extra_data:(0,d._)({show_time:new Date().getTime()-p.current,click_time:new Date().getTime()-h.current},t)},t)),B.logInstance.sendLog("productEntranceClick",{cid:null==o?void 0:o.creative_id,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(i=l.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,nX.F)(null===(n=l.authorInfo)||void 0===n?void 0:n.followStatus)?"1":"0",commodity_id:"",product_id:"",if_qianchuan_ad:1,ad_type:V.Z9.Live})},1e3,{leading:!0,trailing:!1}),[l]),w=oe({adData:t,onClickElement:y}),{productName:I,phrase:x,sellInfo:b,tagsElement:E,feedbackInfo:C,componentIds:N,buttonText:P,imageUrl:S,isBackupImgUrl:L,tagsText:A,defaultPhraseElement:k}=w,j="#FE2C55",D=I||"视频同款商品",{componentType:R,adSlideItems:M}=(0,m.useMemo)(()=>{let e=null,t=[],l=[];return(null==N?void 0:N.includes(V.nw.SingleLine303))?(e=V.nw.SingleLine303,l=[x,b,E,C].filter(e=>!!e),t=[D]):(null==N?void 0:N.includes(V.nw.MultiLine303))?(e=V.nw.MultiLine303,l=[x,b,E,C].filter(e=>!!e)):(null==N?void 0:N.includes(V.nw.Detail303))&&(e=V.nw.Detail303,l=[x,b,C].filter(e=>!!e)),0===l.length?t.push(k):t=t.concat(l.slice(0,3)),{componentType:e,adSlideItems:t}},[w]),{stopListen:F}=ot({awemeInfo:l,isActive:i,timerCb:e=>{let{currentTime:t,isSeeking:l,isEnd:i}=e;(l||i)&&(r(!0),c(j),_(!0),F()),t>=5&&r(!0),t>=7&&c(j),t>=8&&(_(!0),F())}});return((0,m.useEffect)(()=>{a&&(h.current=new Date().getTime(),(0,tA.E)("othershow",{tag:(0,tD.f)(),value:t.creative_id,log_extra:t.log_extra,refer:(0,em.UV)(R)?nZ.SupportAreaCard:nZ.SupportArea,ad_extra_data:{card_show_duration:h.current-p.current}}))},[a]),n4({adData:t,logParams:n}),(0,m.useEffect)(()=>{if(a&&!f.current&&R){var e,t;f.current=!0;let i=(0,em.Rx)(l);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.Live,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(e=l.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,nX.F)(null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus)?"1":"0",commodity_id:"",product_id:""})}},[a]),(0,m.useEffect)(()=>{f.current=!1},[l]),a)?R===V.nw.SingleLine303?(0,u.jsx)(ou,{className:g()(n2.default.adCard,{[n2.default.hidden]:o}),buttonText:"观看直播",imageUrl:S,isBackupImgUrl:L,slideItems:M,isStartPlay:v,onClick:y}):R===V.nw.MultiLine303?(0,u.jsx)(ov,{className:g()(n2.default.adCard,{[n2.default.hidden]:o}),title:D,imageUrl:S,isBackupImgUrl:L,buttonText:"观看直播",slideItems:M,buttonBgColor:s,isStartPlay:v,onClick:y}):R===V.nw.Detail303?(0,u.jsx)(o_,{className:g()(n2.default.adCard,{[n2.default.hidden]:o}),title:D,imageUrl:S,isBackupImgUrl:L,buttonText:"观看直播",tags:A&&(null==A?void 0:A.length)>0?A:n9,slideItems:M,buttonBgColor:s,isStartPlay:v,onClick:y}):null:null},op=l("101156");let oh=e=>{let{awemeInfo:t,isActive:l,adData:i,isHide:n=!1}=e||{},{product_title:o,product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v,min_price:_=0,product_tags:f=["优选好物"]}=i,p=(0,m.useRef)(!1),h=eZ()((e,l)=>{var i,o;if(y===nQ.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let a=(0,em.Rx)(t);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==a?void 0:a.creative_id,log_extra:null==a?void 0:a.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedLiveAd",cid:null==a?void 0:a.creative_id,ad_refer:l}),B.logInstance.sendLog("productEntranceClick",{cid:null==a?void 0:a.creative_id,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(i=t.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,nX.F)(null===(o=t.authorInfo)||void 0===o?void 0:o.followStatus)?"1":"0",commodity_id:"",product_id:"",if_qianchuan_ad:1,ad_type:V.Z9.Live})},1e3,{leading:!0,trailing:!1}),{displayState:y}=n$({awemeInfo:t,isActive:l,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1});(0,m.useEffect)(()=>{p.current=!1},[t]);let w=(0,m.useMemo)(()=>{let e="";return y===nQ.MINI_DARK||y===nQ.MINI_LIGHT?e=a:y===nQ.NORMAL_LIGHT&&(e=o||a),e},[y,o,a]);return(0,m.useEffect)(()=>{if(y!==nQ.HIDDEN&&!n&&!p.current){var e,l;p.current=!0;let i=(0,em.Rx)(t);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.Live,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(e=t.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,nX.F)(null===(l=t.authorInfo)||void 0===l?void 0:l.followStatus)?"1":"0",commodity_id:"",product_id:""})}},[y,n]),n0({awemeInfo:t,adData:i}),(0,u.jsx)("div",{className:g()(nz.default.adWrapper,n1.default.adWrapper,{[nz.default.hasTransition]:!(y===nQ.HIDDEN||n),[nz.default.adWrapperHidden]:y===nQ.HIDDEN||n}),id:nz.default.adWrapper,children:(0,u.jsxs)("div",{className:nz.default.adContainer,onClick:e=>h(e),children:[!_&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:nz.default.adSource,onClick:e=>h(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:nz.default.adIcon}),(0,u.jsx)("span",{className:nz.default.adName,children:w})]}),y>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>h(e,nZ.Title),className:nz.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:nz.default.moreIcon}),(0,u.jsx)("div",{className:nz.default.split}),(0,u.jsx)("div",{className:nz.default.adTitle,children:r})]})]}),!!_&&(0,u.jsxs)(u.Fragment,{children:[y<nQ.NORMAL_LIGHT&&(0,u.jsxs)("div",{className:nz.default.adSource,onClick:e=>h(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:nz.default.adIcon}),(0,u.jsx)("span",{className:nz.default.adName,children:w})]}),y>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{className:n1.default.adTitleWrapper,children:[(0,u.jsx)("div",{onClick:e=>h(e,nZ.Source),children:(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:n1.default.mainCover,skeletonClass:n1.default.skeleton})}),(0,u.jsxs)("div",{className:n1.default.info,onClick:e=>h(e,nZ.Title),children:[(0,u.jsx)("span",{className:n1.default.adName,children:r}),(0,u.jsx)("div",{children:f.slice(0,2).map(e=>(0,u.jsx)("span",{className:n1.default.tag,children:e},e))}),(0,u.jsxs)("div",{className:n1.default.price,children:[(0,u.jsx)("span",{className:n1.default.unit,children:"\xa5"}),_]})]})]})]}),(0,u.jsx)("div",{className:nz.default.adButton,children:(0,u.jsxs)(tL.Button,{theme:"solid",onClick:e=>h(e,nZ.Button),style:{background:y<=nQ.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:[(0,u.jsx)(op.WaveLineAnimation,{size:15}),(0,u.jsx)("span",{style:{fontWeight:500},children:v||"查看详情"})]})})]})})},og=e=>{var t,l;let{awemeInfo:i}=e||{},n=(0,eg.hj)(i),o=(0,em.Rx)(i),a=(0,nF.As)(null==o?void 0:o.log_extra),s=null==a?void 0:a.component_ids,c=null==o?void 0:null===(t=o.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),v=null==c?void 0:null===(l=c.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info;return n&&v?(null==s?void 0:s.includes(V.nw.SingleLine303))||(null==s?void 0:s.includes(V.nw.MultiLine303))||(null==s?void 0:s.includes(V.nw.Detail303))?(0,u.jsx)(of,(0,r._)((0,d._)({},e),{adData:o})):(0,u.jsx)(oh,(0,r._)((0,d._)({},e),{adData:v})):null},oy=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{let e=(null==l?void 0:l.min_price)?["product_name","product_title","ad_title","word_image_url","image_url","button_text","min_price","product_tags"]:["product_name","ad_title","word_image_url","image_url","button_text"];try{var i,n,o,a;let d=(0,em.Rx)(t),r=null==d?void 0:null===(i=d.lynx_components)||void 0===i?void 0:i.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);r&&e.forEach(e=>{!l[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:e,adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:t.logPb}})});let s=null==d?void 0:null===(n=d.lynx_components)||void 0===n?void 0:n.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);!(null==s?void 0:null===(o=s.lynx_raw_data)||void 0===o?void 0:o.mixed_area_info)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"lynx_components",adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:t.logPb}}),!(null==r?void 0:null===(a=r.lynx_raw_data)||void 0===a?void 0:a.open_url)&&!d.open_url&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"open_url",adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:t.logPb}})}catch(e){}},[t])};var ow=l("551491");let oI=e=>{var t,l;let{adData:i,logParams:n}=e,o=null==i?void 0:null===(t=i.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(l=o.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info;(0,m.useEffect)(()=>{let e=["product_phrase","product_name","image_url","live_product_infos"];try{let t=[];e.forEach(e=>{!(null==a?void 0:a[e])&&t.push(e)});["product_tags","return_vistors","favorable_rate","sell_num","collection_num"].every(e=>!(null==a?void 0:a[e]))&&t.push("feedback"),t.length>=e.length&&(0,tA.E)("othershow_fail",{tag:"draw_ad",value:i.creative_id,log_extra:i.log_extra}),Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{key:t,adType:V.Z9.Live,creativeId:null==i?void 0:i.creative_id,logId:null==n?void 0:n.requestId,logParams:n}})}catch(e){}},[i])},ox=e=>{var t,l;let{adData:i,onClickElement:n}=e,o=null==i?void 0:null===(t=i.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(l=o.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info,r=(0,nF.As)(null==i?void 0:i.log_extra),{product_phrase:s,product_name:c,image_url:v,product_tags:_,return_vistors:f,favorable_rate:p,sell_num:h,collection_num:g,button_text:y,button_background_color:w}=a||{},I=(0,m.useMemo)(()=>{let e;let t=s?(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_short_phrase:s}),children:s})}):null,l=(0,nF.Hy)(h)?(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",sell_num:h}),children:["爆卖",(0,nF.Hy)(h),"件"]})}):null,i=(null==_?void 0:_.length)>0?(0,u.jsx)("div",{className:n3.default.tagLine,children:_.slice(0,2).map((e,t)=>(0,u.jsx)(n6,{className:n3.default.tag,style:0===t?{marginRight:"4px"}:{},onClick:t=>n(t,{refer:"sow",product_tags:e}),children:e},e))}):null;return f?e=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:f}),children:f})}):p&&Number(p)>=80?e=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`商品好评率${Math.round(p)}%`}),children:["商品好评率",Math.round(p),"%"]})}):g&&(e=(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`${(0,nF.WM)(g)}}人收藏`}),children:[(0,nF.WM)(g),"人收藏"]})})),{productName:c,phrase:t,sellInfo:l,tagsElement:i,tagsText:_,feedbackInfo:e,componentIds:null==r?void 0:r.component_ids}},[e]),x=(0,m.useMemo)(()=>{let e=[...n8,...n7],t=e[Math.floor(Math.random()*e.length)];return(0,u.jsx)("div",{className:n3.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",live_product_info_backup:t}),children:t})})},[n]);return(0,d._)({imageUrl:v||eU.DEFAULT_AD_IMAGE_URL,isBackupImgUrl:!v,buttonText:y,buttonBackgroundColor:w,defaultPhraseElement:x},I)};var ob=e=>{let{adData:t,awemeInfo:l,isActive:i,logParams:n,isHide:o=!1}=e||{},a=(0,m.useRef)(!1),r=(0,m.useRef)(0),s=(0,n_.useUserInfoContext)(),[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(),[p,h]=(0,m.useState)(!1),y=(0,m.useRef)(new Date().getTime()),w=(0,m.useRef)(new Date().getTime()),I=(0,ep.ZO)({rawAdData:(0,em.Rx)(l)}),x={promotion_id:null==I?void 0:I.promotion_id,product_id:null==I?void 0:I.product_id},b=(0,m.useCallback)(eZ()((e,t)=>{var i,n;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let o=(0,em.Rx)(l);(0,tA.E)("realtime_click",(0,d._)({tag:(0,tD.f)(),value:null==o?void 0:o.creative_id,log_extra:null==o?void 0:o.log_extra,ad_extra_data:(0,d._)({show_time:new Date().getTime()-y.current,click_time:new Date().getTime()-w.current},t)},t)),B.logInstance.sendLog("productEntranceClick",{cid:null==o?void 0:o.creative_id,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(i=l.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,nX.F)(null===(n=l.authorInfo)||void 0===n?void 0:n.followStatus)?"1":"0",commodity_id:x.promotion_id||"",product_id:x.product_id||"",if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo})},1e3,{leading:!0,trailing:!1}),[l,x]),E=ox({adData:t,onClickElement:b}),{productName:C,phrase:N,sellInfo:P,tagsElement:S,feedbackInfo:L,componentIds:A,buttonText:k,imageUrl:j,isBackupImgUrl:D,tagsText:R,defaultPhraseElement:M}=E,F=C||"视频同款商品",{componentType:O,adSlideItems:W}=(0,m.useMemo)(()=>{let e=null,t=[],l=[];return(null==A?void 0:A.includes(V.nw.SingleLine102))?(e=V.nw.SingleLine102,l=[N,P,S,L].filter(e=>!!e),t=[F]):(null==A?void 0:A.includes(V.nw.MultiLine102))?(e=V.nw.MultiLine102,l=[N,P,S,L].filter(e=>!!e)):(null==A?void 0:A.includes(V.nw.Detail102))&&(e=V.nw.Detail102,l=[N,P,L].filter(e=>!!e)),0===l.length?t.push(M):t=t.concat(l.slice(0,3)),{componentType:e,adSlideItems:t}},[E]),U="#FE2C55",{stopListen:H}=ot({awemeInfo:l,isActive:i,timerCb:e=>{let{currentTime:t,isSeeking:l,isEnd:i}=e;(l||i)&&(v(!0),f(U),h(!0),H()),t>=5&&v(!0),t>=7&&f(U),t>=8&&(h(!0),H())}});return((0,m.useEffect)(()=>{c&&(w.current=new Date().getTime(),(0,tA.E)("othershow",{tag:(0,tD.f)(),value:t.creative_id,log_extra:t.log_extra,refer:(0,em.UV)(O)?nZ.SupportAreaCard:nZ.SupportArea,ad_extra_data:{card_show_duration:w.current-y.current}}))},[c]),oI({adData:t,logParams:n}),(0,m.useEffect)(()=>{if(c&&!o&&!a.current&&O){var e,t;a.current=!0;let i=(0,em.Rx)(l);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(e=l.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,nX.F)(null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus)?"1":"0",commodity_id:x.promotion_id||"",product_id:x.product_id||""})}},[c,o]),(0,m.useEffect)(()=>{r.current=0,a.current=!1},[l]),(0,eP.o)(()=>{var e;let t;if(!!i)return p&&r.current<1&&(null==s?void 0:null===(e=s.userInfo)||void 0===e?void 0:e.isLogin)&&(t=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),r.current+=1},1e3)),()=>{clearTimeout(t)}},[i,p,s]),c)?O===V.nw.SingleLine102?(0,u.jsx)(ou,{className:g()(ow.default.adCard,{[ow.default.hidden]:o}),buttonText:k||"查看详情",imageUrl:j,isBackupImgUrl:D,slideItems:W,isStartPlay:p,onClick:b}):O===V.nw.MultiLine102?(0,u.jsx)(ov,{className:g()(ow.default.adCard,{[ow.default.hidden]:o}),title:F,imageUrl:j,isBackupImgUrl:D,buttonText:k||"查看详情",slideItems:W,buttonBgColor:_,isStartPlay:p,onClick:b}):O===V.nw.Detail102?(0,u.jsx)(o_,{className:g()(ow.default.adCard,{[ow.default.hidden]:o}),title:F,imageUrl:j,isBackupImgUrl:D,buttonText:k||"查看详情",tags:R&&(null==R?void 0:R.length)>0?R:n9,slideItems:W,buttonBgColor:_,isStartPlay:p,onClick:b}):null:null};let oE=e=>{let{awemeInfo:t,isActive:l,adData:i,isHide:n=!1}=e||{},{product_title:o,product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v,min_price:_=0,product_tags:f=["优选好物"]}=i,p=(0,m.useRef)(0),h=(0,m.useRef)(!1),y=(0,n_.useUserInfoContext)(),w=(0,ep.ZO)({rawAdData:(0,em.Rx)(t)}),I={promotion_id:null==w?void 0:w.promotion_id,product_id:null==w?void 0:w.product_id},{displayState:x}=n$({awemeInfo:t,isActive:l,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),b=eZ()((e,l)=>{var i,o;if(x===nQ.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let a=(0,em.Rx)(t);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==a?void 0:a.creative_id,log_extra:null==a?void 0:a.log_extra,refer:l}),B.logInstance.sendLog("productEntranceClick",{cid:null==a?void 0:a.creative_id,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(i=t.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,nX.F)(null===(o=t.authorInfo)||void 0===o?void 0:o.followStatus)?"1":"0",commodity_id:I.promotion_id||"",product_id:I.product_id||"",if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedPreviewLiveAd",cid:null==a?void 0:a.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1});(0,m.useEffect)(()=>{p.current=0,h.current=!1},[t]),(0,eP.o)(()=>{var e;let t;if(!!l)return x===nQ.NORMAL_LIGHT&&p.current<1&&(null==y?void 0:null===(e=y.userInfo)||void 0===e?void 0:e.isLogin)&&(t=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),p.current+=1},1e3)),()=>{clearTimeout(t)}},[l,x,y]);let E=(0,m.useMemo)(()=>{let e="";return x===nQ.MINI_DARK||x===nQ.MINI_LIGHT?e=a:x===nQ.NORMAL_LIGHT&&(e=o||a),e},[x,o,a]);return oy({awemeInfo:t,adData:i}),(0,m.useEffect)(()=>{if(x!==nQ.HIDDEN&&!n&&!h.current){var e,l;h.current=!0;let i=(0,em.Rx)(t);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo,source_page:(0,iR.mo)(),enter_from:(0,iR.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(e=t.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,nX.F)(null===(l=t.authorInfo)||void 0===l?void 0:l.followStatus)?"1":"0",commodity_id:I.promotion_id||"",product_id:I.product_id||""})}},[x,n]),(0,u.jsx)("div",{className:g()(nz.default.adWrapper,n1.default.adWrapper,{[nz.default.hasTransition]:!(x===nQ.HIDDEN||n),[nz.default.adWrapperHidden]:x===nQ.HIDDEN||n}),id:nz.default.adWrapper,children:(0,u.jsxs)("div",{className:nz.default.adContainer,onClick:e=>b(e),children:[!_&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:nz.default.adSource,onClick:e=>b(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:nz.default.adIcon}),(0,u.jsx)("span",{className:nz.default.adName,children:E})]}),x>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>b(e,nZ.Title),className:nz.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:nz.default.moreIcon}),(0,u.jsx)("div",{className:nz.default.split}),(0,u.jsx)("div",{className:nz.default.adTitle,children:r})]})]}),!!_&&(0,u.jsxs)(u.Fragment,{children:[x<nQ.NORMAL_LIGHT&&(0,u.jsxs)("div",{className:nz.default.adSource,onClick:e=>b(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:nz.default.adIcon}),(0,u.jsx)("span",{className:nz.default.adName,children:E})]}),x>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{className:n1.default.adTitleWrapper,children:[(0,u.jsx)("div",{onClick:e=>b(e,nZ.Source),children:(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:n1.default.mainCover,skeletonClass:n1.default.skeleton})}),(0,u.jsxs)("div",{className:n1.default.info,onClick:e=>b(e,nZ.Title),children:[(0,u.jsx)("span",{className:n1.default.adName,children:r}),(0,u.jsx)("div",{children:f.slice(0,2).map(e=>(0,u.jsx)("span",{className:n1.default.tag,children:e},e))}),(0,u.jsxs)("div",{className:n1.default.price,children:[(0,u.jsx)("span",{className:n1.default.unit,children:"\xa5"}),_]})]})]})]}),(0,u.jsx)("div",{className:nz.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>b(e,nZ.Button),style:{background:x<=nQ.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{style:{fontWeight:500},children:v||"查看详情"})})})]})})},oT=e=>{var t,l;let{awemeInfo:i}=e||{},n=(0,m.useMemo)(()=>(0,ep.o4)(i),[i]),o=(0,em.Rx)(i),a=(0,nF.As)(null==o?void 0:o.log_extra),s=null==a?void 0:a.component_ids,c=null==o?void 0:null===(t=o.lynx_components)||void 0===t?void 0:t.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),v=(null==c?void 0:null===(l=c.lynx_raw_data)||void 0===l?void 0:l.mixed_area_info)||{product_title:null==o?void 0:o.web_title,product_name:null==o?void 0:o.web_title,button_background_color:"#E6312E",ad_title:null==o?void 0:o.title,word_image_url:eU.DEFAULT_WORD_IMAGE_URL,image_url:eU.DEFAULT_AD_IMAGE_URL,button_text:null==o?void 0:o.button_text};return n&&v?(null==s?void 0:s.includes(V.nw.SingleLine102))||(null==s?void 0:s.includes(V.nw.MultiLine102))||(null==s?void 0:s.includes(V.nw.Detail102))?(0,u.jsx)(ob,(0,r._)((0,d._)({},e),{adData:o})):(0,u.jsx)(oE,(0,r._)((0,d._)({},e),{adData:v})):null};var oC=l("553746"),oN=l("125530"),oP={SingleLine:0,0:"SingleLine",TowLine:1,1:"TowLine"};let oS=e=>{var t,l,i;let{awemeInfo:n,isActive:o,className:a}=e,{displayState:d}=function(e){let{awemeInfo:t,isActive:l}=e,i=(0,e$.n)(),n=(0,m.useRef)(!0),o=(0,m.useRef)(!1),[a,d]=(0,m.useState)(0),r=(0,m.useCallback)(()=>{if(!o.current){var e,t;null==i||null===(e=i.on)||void 0===e||e.call(i,ih.FP.TIMEUPDATE,c),null==i||null===(t=i.on)||void 0===t||t.call(i,ih.FP.SEEKING,v)}o.current=!0},[i]),s=(0,m.useCallback)(()=>{if(o.current){var e,t;null==i||null===(e=i.off)||void 0===e||e.call(i,ih.FP.TIMEUPDATE,c),null==i||null===(t=i.off)||void 0===t||t.call(i,ih.FP.SEEKING,v)}o.current=!1},[i]),u=(0,m.useCallback)(()=>{n.current=!0},[]),c=(0,m.useCallback)(e=>{let{currentTime:t}=e||{};t>=16&&(n.current=!1,d(1),s())},[i,t,s]),v=(0,m.useCallback)(e=>{let{currentTime:l}=e;l>=16&&(d(1),s());let i=(0,em.Rx)(t);(0,tA.E)("drag_bar",{tag:(0,tD.f)(),value:i.creative_id,log_extra:i.log_extra}),n.current=!1},[s,t]),_=(0,m.useCallback)(()=>{d(1),u(),r()},[r,u]);return(0,nn.u)(i,ih.FP.ENDED,_),(0,m.useEffect)(()=>{u()},[l,u]),(0,m.useEffect)(()=>{d(0),u()},[t.awemeId,u]),(0,m.useEffect)(()=>{if(!!l){if(i&&n.current)return r(),()=>{s()}}},[i,t,l,r,s]),(0,m.useEffect)(()=>{(null==i?void 0:i.currentTime)&&c({currentTime:i.currentTime})},[i]),{displayState:a}}({isActive:o,awemeInfo:n}),r=(null==n?void 0:null===(l=n.anchorInfo)||void 0===l?void 0:null===(t=l.extra)||void 0===t?void 0:t[0])||{},s=(null==r?void 0:r.tags)||[],c=d===oP.TowLine&&s.length>0;return(0,u.jsx)("div",{className:g()("xgplayer-shop-anchor",oN.default.container,oN.default.shopAnchor,{[oN.default.more]:c},a),onClick:()=>{q.emit(q.EVENT.openAdSideCard);let e=(0,em.Rx)(n);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra,refer:"button"})},children:(0,u.jsxs)("div",{className:oN.default.subContainer,children:[(0,u.jsx)(nm.z,{svg:(0,u.jsx)(oC.Z,{}),className:oN.default.icon}),(0,u.jsxs)("div",{className:oN.default.desc,children:[(0,u.jsxs)("div",{className:oN.default.firstLine,children:[null==n?void 0:null===(i=n.anchorInfo)||void 0===i?void 0:i.titleTag,(null==r?void 0:r.elastic_title)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:oN.default.delimiter,children:" | "})," ",null==r?void 0:r.elastic_title]})]}),c&&(0,u.jsx)("div",{className:oN.default.secondLine,children:s.map((e,t)=>(0,u.jsxs)("span",{className:oN.default.towLineItem,children:[e," ",t<s.length-1&&(0,u.jsxs)(u.Fragment,{children:[" ",(0,u.jsx)("span",{className:oN.default.delimiter,children:" | "})]})]},e))})]})]})})},oL=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"AdShopAnchor",Slardar:t,children:(0,u.jsx)(oS,(0,d._)({},e))})},oA=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{let e=(0,em.Rx)(t);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(i=>{!l[i]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:i,adType:V.Z9.Download,logId:null==t?void 0:t.logPb,creativeId:null==e?void 0:e.creative_id}})})},[l,t])};var ok=l("439018");let oj=e=>{let{awemeInfo:t,isActive:l,adData:i,isHide:n=!1}=e||{},{product_name:o,button_background_color:a,ad_title:d,word_image_url:r,image_url:s,button_text:c}=i,v=(0,m.useRef)(0);(0,m.useEffect)(()=>{if(l){var e,i;let l=(0,em.Rx)(t),n=null==l?void 0:null===(i=l.track_url_list)||void 0===i?void 0:null===(e=i.url_list)||void 0===e?void 0:e[0];n&&(0,tj.R)(n)}},[t,l]);let{displayState:_}=n$({awemeInfo:t,isActive:l,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),f=eZ()((e,l)=>{if(_===nQ.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(t);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedDownloadAd",cid:null==i?void 0:i.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1});return(0,m.useEffect)(()=>{v.current=0},[t]),(0,eP.o)(()=>{let e;if(!!l)return _===nQ.NORMAL_LIGHT&&v.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),v.current+=1},1e3)),()=>{clearTimeout(e)}},[l,_]),oA({awemeInfo:t,adData:i}),(0,u.jsx)("div",{className:g()(ok.default.adWrapper,{[ok.default.hasTransition]:!(_===nQ.HIDDEN||n),[ok.default.adWrapperHidden]:_===nQ.HIDDEN||n}),id:ok.default.adWrapper,children:(0,u.jsxs)("div",{className:ok.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:ok.default.adSource,onClick:e=>f(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:ok.default.adIcon}),(0,u.jsx)("span",{className:ok.default.adName,children:o})]}),_>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,nZ.Title),className:ok.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:r,iconHeight:30,iconWidth:30,className:ok.default.moreIcon}),(0,u.jsx)("div",{className:ok.default.split}),(0,u.jsx)("div",{className:ok.default.adTitle,children:d})]}),(0,u.jsx)("div",{className:ok.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>f(e,nZ.Button),style:{background:_<=nQ.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:a},children:(0,u.jsx)("span",{children:c||"立即下载"})})})]})})};function oD(e){let{awemeInfo:t}=e||{},l=(0,ey.L)(t),i=(0,tk.rQ)(t);return l&&i?(0,u.jsx)(oj,(0,r._)((0,d._)({},e),{adData:i})):null}let oR=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"FeedDownloadAd",Slardar:t,children:(0,u.jsx)(oD,(0,d._)({},e))})};var oM=l("846768");let oF=e=>{let{awemeInfo:t,adData:l}=e;(0,m.useEffect)(()=>{var e;let i=(0,em.Rx)(t);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!l[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:e,adType:V.Z9.Mp,logId:null==t?void 0:t.logPb,creativeId:null==i?void 0:i.creative_id}})});let n=(0,em.BD)(t);(null==n?void 0:null===(e=n.lynx_raw_data)||void 0===e?void 0:e.web_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:"web_url",adType:V.Z9.Mp,logId:null==t?void 0:t.logPb,creativeId:null==i?void 0:i.creative_id}})},[l,t])},oB=e=>{let t=(0,m.useRef)(null),{awemeInfo:l,isActive:i,adData:n,isHide:o=!1}=e||{},{product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v}=n,_=(0,m.useRef)(0),f=eZ()((e,t)=>{if(p===nQ.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(l);(0,tA.E)("realtime_click",{tag:(0,tD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedMpAd",cid:null==i?void 0:i.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1}),{displayState:p}=n$({awemeInfo:l,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});return(0,m.useEffect)(()=>{_.current=0},[l]),(0,eP.o)(()=>{let e;if(!!i)return p===nQ.NORMAL_LIGHT&&_.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),_.current+=1},1e3)),()=>{clearTimeout(e)}},[i,p]),oF({awemeInfo:l,adData:n}),(0,u.jsx)("div",{ref:t,className:g()(oM.default.adWrapper,{[oM.default.hasTransition]:!(p===nQ.HIDDEN||o),[oM.default.adWrapperHidden]:p===nQ.HIDDEN||o}),id:oM.default.adWrapper,children:(0,u.jsxs)("div",{className:oM.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:oM.default.adSource,onClick:e=>f(e,nZ.Source),children:[(0,u.jsx)(tO.Q,{src:c,iconHeight:30,iconWidth:30,className:oM.default.adIcon}),(0,u.jsx)("span",{className:oM.default.adName,children:a})]}),p>nQ.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,nZ.Title),className:oM.default.adTitleWrapper,children:[(0,u.jsx)(tO.Q,{src:s,iconHeight:30,iconWidth:30,className:oM.default.moreIcon}),(0,u.jsx)("div",{className:oM.default.split}),(0,u.jsx)("div",{className:oM.default.adTitle,children:r})]}),(0,u.jsx)("div",{className:oM.default.adButton,children:(0,u.jsx)(tL.Button,{theme:"solid",onClick:e=>f(e,nZ.Button),style:{background:p<=nQ.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{children:v||"立即试玩"})})})]})})};function oO(e){let{awemeInfo:t}=e||{},l=(0,ew.u)(t),i=(0,tk.rQ)(t);return l&&i?(0,u.jsx)(oB,(0,r._)((0,d._)({},e),{adData:i})):null}let oV=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"FeedMpAd",Slardar:t,children:(0,u.jsx)(oO,(0,d._)({},e))})};var oW=l("120385"),oU=l("203875");let oH="RECOMMAND_LOGIN_PROMPT_TIMESTAMP",oG=new Date().toDateString(),oz=0,oZ=0,oK=0,oQ=()=>{var e,t;return(null===(t=window)||void 0===t?void 0:null===(e=t.localStorage)||void 0===e?void 0:e.getItem(oH))===oG||!1},o$=async()=>{try{a=!0}catch(e){}},oY=async(e,t)=>{if(oQ())return()=>null;if(void 0===a&&await o$(),oQ())return()=>null;clearInterval(o);let l=()=>{e.pause()};if(oZ>42e4){var i,n;t(),null===(n=window)||void 0===n||null===(i=n.localStorage)||void 0===i||i.setItem(oH,oG),clearInterval(o)}let d=()=>{oz=Date.now()},r=()=>{oz=0};return e.on(ih.FP.PLAY,d),e.on(ih.FP.PAUSE,r),o=setInterval(()=>{oz>0&&(oZ+=1e3)>42e4&&clearInterval(o)},1e3),()=>{e&&(e.off(ih.FP.PLAY,d),e.off(ih.FP.PAUSE,r),e.off(ih.FP.CANPLAY,l)),oz=0,clearInterval(o)}},oq=async(e,t)=>{if(oQ())return()=>null;if(void 0===a&&await o$(),oQ())return()=>null;let l=()=>{e.pause()};if(++oK>15){var i,n;t(),null===(n=window)||void 0===n||null===(i=n.localStorage)||void 0===i||i.setItem(oH,oG)}return()=>{e&&e.off(ih.FP.CANPLAY,l)}},oJ=(0,lx.ZP)(()=>l.e("30868").then(l.bind(l,950300)),{ssr:!1}),oX=(0,eB.h)(e=>{var t;let{userInfo:l,isActive:i,dispatch:n,abtestData:o}=e,{isLogin:a}=l,d=(0,e$.n)(),[r,s]=(0,m.useState)(),[c,v]=(0,m.useState)(!1);(0,m.useEffect)(()=>{!i&&s(!1)},[i]);let _=(0,m.useCallback)(()=>{s(!1),d&&d.play()},[d]),f=(0,m.useCallback)(e=>{let{enterMethod:t="video_login_guide",isVideoGuide:l="0"}=e;(0,lD.default)({success:()=>{"recommend"===(0,T.yW)()&&(null==o?void 0:o.recommendLoginResume)===H.RecommendLoginResume.V2?q.emit(q.EVENT.RecommendLoginResume):n({type:"updateUserInfo"})},enterMethod:t,teaEvtParams:{is_video_guide:l}})},[n,o]),p=(null===(t=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===t?void 0:t.isInMiniModal)||!1;return(0,m.useEffect)(()=>{if(d&&i&&!1===a&&!p){let e=()=>null,t=()=>null;return(async()=>{e=await oY(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})}),t=await oq(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})})})(),()=>{null==e||e(),null==t||t()}}},[d,i,a]),(0,m.useEffect)(()=>{(async()=>{v(await (0,lb.isHideLoginGuide)(o))})()},[o]),!p&&!1===a&&i&&r&&!c?(0,u.jsx)(oJ,{handleHideMask:_,handleLoginAfter:e=>f(e)}):null},"RecommendLoginGuide");var o0=l("790720"),o1=l("532005"),o2=l("802913"),o4=l("656154"),o3=new iY.h({feedDownloadButtonShow:{eventName:"feed_download_button_show",params:{group_id:"",enter_from_merge:"",enter_from:"",follow_status:""}},feedDownloadButtonClick:{eventName:"feed_download_button_click",params:{group_id:"",enter_from_merge:"",enter_from:"",follow_status:"",if_highlight:0}},addToDesktopShow:{eventName:"add_to_desktop_show",params:{enter_from:"",type:"feed_follow_post_button",platform:"client",channel_id:"",ug_channel_id:""}},addToDesktopClick:{eventName:"add_to_desktop_click",params:{enter_from:"",type:"feed_follow_post_button",platform:"client",channel_id:"",ug_channel_id:""}}}),o5=l("717864");let o6=b.fp.MidHigh+20;function o8(e){let{highlightShow:t,followStatus:l,awemeId:i}=e,{downloadHref:n,downloadAttr:o}=(0,o5.o)({channelId:o2.g.Notice}),a=(0,m.useCallback)(()=>{o3.sendLog("feedDownloadButtonClick",{group_id:i,enter_from:(0,T.yW)(),enter_from_merge:(0,iR.vM)(),follow_status:String(l),if_highlight:t?1:0}),o3.sendLog("addToDesktopClick",{enter_from:(0,T.yW)(),channel_id:o2.g.Notice,type:"feed_follow_post_button",ug_channel_id:Z.Le.getConfig(Z.gI.WebUgChannelId)||""});let e=document.createElement("a");e.setAttribute("href",n),e.setAttribute("download",o),e.click()},[n,o,i,l,t]);return(0,u.jsx)("div",{className:g()(o4.default.container),style:{bottom:o6},children:(0,u.jsxs)("div",{className:g()(o4.default.button,{[o4.default.redColor]:t}),onClick:a,children:[(0,u.jsx)("div",{className:g()(o4.default.text),children:"及时接收作品更新提醒"}),(0,u.jsx)("div",{className:g()(o4.default.downloadTips),children:"下载电脑客户端"})]})})}let o7=(0,eB.h)(e=>{var t;let{awemeInfo:l,isActive:i}=e,[n,o]=(0,m.useState)(!1),a=(0,e$.n)();return(0,m.useEffect)(()=>{if(a){let e=()=>{a.currentTime>=5&&o(!0)};return a.on(ih.FP.TIMEUPDATE,e),()=>{a.off(ih.FP.TIMEUPDATE,e)}}},[a]),(0,m.useEffect)(()=>{if(i&&l){var e;o3.sendLog("feedDownloadButtonShow",{group_id:null==l?void 0:l.awemeId,enter_from:(0,T.yW)(),enter_from_merge:(0,iR.vM)(),follow_status:String(null==l?void 0:null===(e=l.authorInfo)||void 0===e?void 0:e.followStatus)}),o3.sendLog("addToDesktopShow",{enter_from:(0,T.yW)(),channel_id:o2.g.Notice,type:"feed_follow_post_button",ug_channel_id:Z.Le.getConfig(Z.gI.WebUgChannelId)||""})}},[i,l]),(0,u.jsx)(o8,{highlightShow:n,followStatus:null==l?void 0:null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus,awemeId:null==l?void 0:l.awemeId})},"PostGuideDownload");var o9=l("944387"),ae=l("606265"),at=l("767585");let al=e=>{let{brandAdComponentItem:t,openUrl:l,isActive:i,awemeInfo:n,position:o="center"}=e,a=(0,e$.n)();(0,m.useEffect)(()=>{var e;let l=q.listen(q.EVENT.quitInnerFeed,()=>{var e;((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle")}),n=q.listen(q.EVENT.InnerFeedReady,()=>{var e;((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.m)("brandMiddle")});return((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")?(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle"):(0,eb.m)("brandMiddle"),!i&&(0,eb.m)("brandMiddle"),()=>{l(),n(),(0,eb.m)("brandMiddle")}},[t,i]),(0,m.useEffect)(()=>{let e=e=>{var a,d,r,s,u,c,v,m,_,f,p;if((0,eK.j)(e.code,e.keyCode)||(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.nodeName)==="INPUT"||(null==e?void 0:null===(d=e.target)||void 0===d?void 0:d.nodeName)==="TEXTAREA"||(null==e?void 0:null===(r=e.target)||void 0===r?void 0:r.contentEditable)==="true"||!i||!t)return;let h=(null==t?void 0:null===(s=t.brand_ad_component_float_tip)||void 0===s?void 0:s.actions)||[],g=null===(u=k.s.getAllPlayer())||void 0===u?void 0:u.length;h.includes("KEYBOARD")&&1===g&&(q.emit(q.EVENT.videoPause),B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(v=n.webRawData)||void 0===v?void 0:null===(c=v.brandAd)||void 0===c?void 0:c.brand_type],img_url:null==t?void 0:null===(m=t.brand_ad_component_float_tip)||void 0===m?void 0:m.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener")),h.includes("KEYBOARD_SPACE")&&1===g&&(32===e.keyCode||"Space"===e.code)&&(B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(f=n.webRawData)||void 0===f?void 0:null===(_=f.brandAd)||void 0===_?void 0:_.brand_type],img_url:null==t?void 0:null===(p=t.brand_ad_component_float_tip)||void 0===p?void 0:p.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener"))},d=eZ()(()=>{var e,n;if(!!i&&!!t)((null==t?void 0:null===(e=t.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("WHEEL")&&1===(null===(n=k.s.getAllPlayer())||void 0===n?void 0:n.length)&&(q.emit(q.EVENT.videoPause),window.open(l,(0,eQ.f)()?"_self":"_blank","noopener"))},5e3,{trailing:!1});return document.addEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.addEventListener("wheel",d,!0),()=>{document.removeEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.removeEventListener("wheel",d,!0)}},[t,l,i,a,n,o])};var ai=l("791032");let an=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p}=e||{},[h,y]=(0,m.useState)(!1),[w,I]=(0,m.useState)(!1),x=(0,m.useRef)(!1);ot({timerCb:e=>{if(x.current)return;let{currentTime:t,isEnd:l}=e,i=p.show_time,n=p.show_time+.5;t>=i&&y(!0),t>=n&&I(!0),l&&!x.current&&(y(!0),I(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let b=eZ()(e=>{var t,l;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null==p?void 0:p.img_url,position:"center",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"splash_ad"});return}q.emit(q.EVENT.videoPause)},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(ai.default.adWrapper,v,{[ai.default.show]:h}),style:{width:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.width,height:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.height},children:(0,u.jsxs)(eJ.a,{onClick:e=>b(e),className:ai.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:[(0,u.jsx)("img",{className:ai.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),y(!1),x.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}}),p.has_guide&&w&&(0,u.jsx)("img",{src:eX,className:ai.default.tapIcon})]})})},ao=e=>{var t,l,i,n;let{awemeInfo:o,className:a,isActive:d,onBrandComponentClose:r,onBrandComponentShow:s}=e||{},[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(!1),[p,h]=(0,m.useState)(),y=(0,m.useRef)([]),w=null==o?void 0:null===(t=o.webRawData)||void 0===t?void 0:t.brandAd;return(ot({timerCb:e=>{var t,l;let i=!1;for(let n=0;n<(null===(t=w.biz_content.brand_ad_component_config)||void 0===t?void 0:t.middle.length);n++){let t=null===(l=w.biz_content.brand_ad_component_config)||void 0===l?void 0:l.middle[n];if(void 0===t.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&t.brand_ad_component_type===V.Wy.Img){h(t),i=!0;break}}else if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&e.currentTime<=t.brand_ad_component_float_tip.disappear_time&&t.brand_ad_component_type===V.Wy.Img){h(t),i=!0;break}}!i&&h(null)},stopBySeeking:!1,awemeInfo:o,isActive:d,needInit:!0}),al({brandAdComponentItem:p,openUrl:w.open_url,isActive:d,awemeInfo:o}),(0,m.useEffect)(()=>{var e,t,l,i,n;p&&!y.current.includes(null==p?void 0:null===(e=p.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==o?void 0:null===(l=o.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"center",icon_type:"image"}),y.current.push(null===(n=p.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[p]),_||c||(null==p?void 0:p.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsx)("div",{className:g()(a,at.default.container),style:{bottom:`${null!==(n=null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:null===(l=i.position)||void 0===l?void 0:l.bottom)&&void 0!==n?n:96}px`},children:(0,u.jsx)(an,{awemeInfo:o,isActive:d,onBrandComponentClose:()=>{null==r||r(),f(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==w?void 0:w.brand_type]})},onImgError:()=>{v(!0)},brandAdComponentFloatTip:p.brand_ad_component_float_tip})})};function aa(e){var t,l,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(t=v.webRawData)||void 0===t?void 0:t.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.middle)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(l=i.brand_ad_component_float_tip)||void 0===l?void 0:l.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.middle)||void 0===r?void 0:r.length)>0?(0,u.jsx)(ao,(0,d._)({},e)):null}let ad=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"MiddleFeedBrandAd",Slardar:t,children:(0,u.jsx)(aa,(0,d._)({},e))})};var ar=l("551784"),as=l("343341"),au=l("190995"),ac=l("936588");let av=e=>{var t,l,i,n;let{awemeInfo:o,isActive:a}=e,[d,r]=(0,m.useState)((null==o?void 0:null===(l=o.chargeInfo)||void 0===l?void 0:null===(t=l.preview_config)||void 0===t?void 0:t.is_preview)?null==o?void 0:null===(n=o.chargeInfo)||void 0===n?void 0:null===(i=n.preview_config)||void 0===i?void 0:i.end_time:0),[s,u]=(0,m.useState)(!1),c=(0,e$.n)(),v=(0,y.Z)(()=>{var e,t,l,i;let n=null==o?void 0:null===(t=o.chargeInfo)||void 0===t?void 0:null===(e=t.preview_config)||void 0===e?void 0:e.end_time,a=(null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(l=i.preview_config)||void 0===l?void 0:l.start_time)||0,d=Math.ceil((null==c?void 0:c.currentTime)*1e3);n>=d&&a<=d?(r(n-d),u(!1)):u(!0)}),_=(0,y.Z)(()=>{var e,t,l,i;let n=null==o?void 0:null===(t=o.chargeInfo)||void 0===t?void 0:null===(e=t.preview_config)||void 0===e?void 0:e.end_time,a=(null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(l=i.preview_config)||void 0===l?void 0:l.start_time)||0,d=Math.ceil((null==c?void 0:c.currentTime)*1e3);n>=d&&a<=d?(r(n-d),u(!1)):u(!0)}),f=(0,y.Z)(()=>{var e,t,l,i;u(!1),r((null==o?void 0:null===(t=o.chargeInfo)||void 0===t?void 0:null===(e=t.preview_config)||void 0===e?void 0:e.is_preview)?null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(l=i.preview_config)||void 0===l?void 0:l.end_time:0)}),p=eZ()(v,200),h=(0,y.Z)(()=>{var e,t,l,i,n;(null==o?void 0:null===(t=o.chargeInfo)||void 0===t?void 0:null===(e=t.preview_config)||void 0===e?void 0:e.is_preview)&&a&&(null==c||null===(l=c.on)||void 0===l||l.call(c,ih.FP.TIMEUPDATE,p),null==c||null===(i=c.on)||void 0===i||i.call(c,ih.FP.SEEKING,_),null==c||null===(n=c.on)||void 0===n||n.call(c,ih.FP.REPLAY,f))}),g=(0,y.Z)(()=>{var e,t,l;null==c||null===(e=c.off)||void 0===e||e.call(c,ih.FP.TIMEUPDATE,p),null==c||null===(t=c.off)||void 0===t||t.call(c,ih.FP.SEEKING,_),null==c||null===(l=c.off)||void 0===l||l.call(c,ih.FP.SEEKING,f)});return(0,m.useEffect)(()=>(h(),()=>{g()}),[null==o?void 0:o.awemeId,a,c]),(0,m.useEffect)(()=>{let e=()=>{if((0,t1.zJ)(o)){var e;null==c||null===(e=c.replay)||void 0===e||e.call(c)}};if(c)return c.on("ended",e),()=>{c.off("ended",e)}},[o,c]),{previewTime:d,isPreivewFinish:s}},am=e=>{var t;let{className:l,awemeInfo:i,isShowReplay:n=!0,isActive:o,isMiniWin:a=!1}=e,d=(0,ac.GP)(i),[r,s]=(0,m.useState)(d||!1),c=(0,e$.n)();(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.ShowPreviewPaidMask,e=>{let{isShow:t,awemeId:l,playerId:n}=e;o&&l===(null==i?void 0:i.awemeId)&&(n===(null==c?void 0:c.playerId)||!n)&&s(t)});return()=>{null==e||e()}},[o,i,c]),(0,m.useEffect)(()=>{d?s(!0):s(!1)},[i]);let{isPreivewFinish:v}=av({awemeInfo:i,isActive:o});return((0,m.useEffect)(()=>{!v&&!a&&s(!1)},[v]),(0,m.useEffect)(()=>{a&&(v?["primary","subscribe"].includes((0,id.$m)(i))&&s(!0):!d&&s(!1))},[v,a]),!r||(null==i?void 0:null===(t=i.chargeInfo)||void 0===t?void 0:t.has_paid))?null:(0,u.jsxs)("div",{className:g()(ar.default.conatienr,l,{[ar.default.filter]:d}),children:[(0,u.jsx)(eF.Z,{src:as.Z,width:28,height:28,viewBox:"0 0 28 28"}),(0,u.jsx)("span",{className:ar.default.title,children:"购买后可看"}),!d&&n&&(0,u.jsxs)("div",{className:ar.default.subTitle,onClick:()=>{var e,t,l,n,o,a;(null==i?void 0:null===(t=i.chargeInfo)||void 0===t?void 0:null===(e=t.preview_config)||void 0===e?void 0:e.start_time)>0?null==c||null===(o=c.seek)||void 0===o||o.call(c,(null==i?void 0:null===(n=i.chargeInfo)||void 0===n?void 0:null===(l=n.preview_config)||void 0===l?void 0:l.start_time)/1e3):null==c||null===(a=c.replay)||void 0===a||a.call(c),s(!1)},children:[(0,u.jsx)(eF.Z,{src:au.Z,width:20,height:20,viewBox:"0 0 20 20"}),"重播"]})]})},a_=e=>{let{isActive:t,startTime:l,awemeInfo:i,isLogin:n=!1,isMiniWin:o=!1}=e,a=(0,e$.n)(),d=(0,m.useRef)(!1);return(0,m.useEffect)(()=>{if(t&&a&&n)return()=>{if((null==a?void 0:a.currentTime)>0){var e,t;let l=1e3>=Math.abs((null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)-(null==a?void 0:a.currentTime)*1e3);(0,iy.J$)({item_id:null==i?void 0:i.awemeId,item_duration:Number(null==i?void 0:null===(t=i.video)||void 0===t?void 0:t.duration),item_progress:l?0:Math.floor((null==a?void 0:a.currentTime)*1e3)})}}},[t,i,a,n]),(0,m.useEffect)(()=>{if(a&&n){let e=()=>{if(t&&(null==a?void 0:a.currentTime)>0){var e,l;let t=1e3>=Math.abs((null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)-(null==a?void 0:a.currentTime)*1e3);(0,iy.J$)({item_id:null==i?void 0:i.awemeId,item_duration:Number(null==i?void 0:null===(l=i.video)||void 0===l?void 0:l.duration),item_progress:t?0:Math.floor((null==a?void 0:a.currentTime)*1e3)})}};return a.on(ih.FP.DESTROY,e),()=>{a.off(ih.FP.DESTROY,e)}}},[a,i,t,n]),(0,m.useEffect)(()=>{if(a&&n){let e=e=>{let{currentTime:t}=e,l=Math.floor(t);if(l>=10&&l%10==0){var n;(0,lJ.qQ)(lX.LocalStorageKeys.CurrentVideoProgress,{awemeType:null==i?void 0:i.awemeType,itemId:null==i?void 0:i.awemeId,preItemDuration:Number(null==i?void 0:null===(n=i.video)||void 0===n?void 0:n.duration),preItemProgress:1e3*l})}};return a.on("timeupdate",e),()=>{a.off("timeupdate",e)}}},[a,i,n]),(0,m.useEffect)(()=>{if(a&&t&&l>=3&&n&&!o&&!d.current){let e=()=>{var e,t;null===(t=a.showPrompt)||void 0===t||t.call(a,{text:`上次播放至：${(0,nF.$y)(1e3*l)}`},{mode:"arrow",autoHide:!0,interval:3e3,preventScreenOverflow:!0,style:{left:`${1e3*l/(null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)*100}%`,bottom:"10px",padding:"8px 12px",borderRadius:"12px",backgroundColor:"#33343F",color:"#ffffff",fontSize:"12px",transition:"none",zIndex:"20"}}),d.current=!0};return a.once("play",e),()=>{a.off("play",e)}}if(a&&t&&l>=3&&n&&o){var e;null===(e=a.hidePrompt)||void 0===e||e.call(a)}},[a,t,l,i,n,o]),null},af=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"RecordContinuePlay",Slardar:t,children:(0,u.jsx)(a_,(0,d._)({},e))})};l("779788");var ap=l("565024"),ah=l("730319");let ag=lX.CookieKeys.StreamPlayerStatusParams,ay=e=>ap.Q.setItem(ag,JSON.stringify(e)),aw=Z.gI.PlayerStatus,aI=e=>Z.Le.setConfig(aw,e),ax=(0,eB.h)(()=>{let e=(0,e$.n)();return(0,m.useEffect)(()=>{if(!e)return()=>{};let t=()=>{let t=function(e){var t,l;let i={},{pluginsConfig:n={}}=null!=e?e:{};return i.is_auto_play=(null===(t=n[nP.p7.AutoPlaySettingPlugin])||void 0===t?void 0:t.nextAutoPlay)||(null===(l=n[nP.p7.SearchAutoPlaySettingPlugin])||void 0===l?void 0:l.nextAutoPlay)?1:0,i.is_full_screen=(0,et.r)()?1:0,i.is_full_webscreen=k.s.getIsPageFullscreen()?1:0,i.is_mute=e.muted?1:0,i.is_speed=e.playbackRate,i.is_visible=(0,ah.d)()?1:0,i}(e);ay(t),aI(t)};t();let l=[iO.C.AutoPlaySwitchChange,ih.FP.FULLSCREEN_CHANGE,ih.FP.VOLUMECHANGE,ih.FP.RATECHANGE],i=["visibilitychange"],n=[q.EVENT.pageFullScreen];l.forEach(l=>e.on(l,t)),i.forEach(e=>document.addEventListener(e,t));let o=n.map(e=>q.listen(e,t));return()=>{l.forEach(l=>e.off(l,t)),i.forEach(e=>document.removeEventListener(e,t)),o.forEach(e=>null==e?void 0:e())}},[e]),null},"RecRawDataCookiePlugin");var ab=l("23902"),aE=l.n(ab),aT=l("18263"),aC=l("953208"),aN=l("223526"),aP=l("133764"),aS=l("161724");let aL=[x.e.Normal],aA=e=>{let{isActive:t,abtestData:l,awemeInfo:i}=e||{},n=(0,e$.n)(),o=(0,m.useMemo)(()=>{if(!aE()(l))return(0,aP.h)()},[l]),a=(0,m.useCallback)(()=>{var e,t,i,n,a;let d=window.newPlayerPreloader,r=Z.Le.getConfig(Z.gI.PreloadList)||[],s=[];null==d||null===(e=d.preloadDataList)||void 0===e||e.forEach(e=>{var t;s.push(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.vid)}),(null==d?void 0:d._wipPreloadTask)&&s.push(null==d?void 0:null===(i=d._wipPreloadTask)||void 0===i?void 0:null===(t=i.data)||void 0===t?void 0:t.vid);let u=null!==(n=null==o?void 0:o.preloadTime)&&void 0!==n?n:5;if((null==r?void 0:r.length)>0){let e=r.filter(e=>{var t;return t=e,aL.includes(t.awemeType)&&!(null==s?void 0:s.includes(e.awemeId))}).map((e,t)=>{var i,n;let o=(0,aS.d)({awemeInfo:e,abtestData:l,enableDash:!0});return{order:t,data:{codecType:null==o?void 0:o.codecType,vid:null==e?void 0:e.awemeId,payload:null==o?void 0:null===(i=o.definition)||void 0===i?void 0:i.list,preloadTime:u,vtype:null==o?void 0:null===(n=o.protocol)||void 0===n?void 0:n.toUpperCase(),bizType:(null==e?void 0:e.isAds)?aC._6.Ad:aC._6.Normal,loadRangeType:"only_size"}}});(null==e?void 0:e.length)>0&&(null===(a=aT.wt.addPreloadList)||void 0===a||a.call(aT.wt,e))}},[i,l,o]);return(0,m.useEffect)(()=>{let e=window.newPlayerPreloader;n&&t&&e&&aN.p.postTask({task:()=>a()})},[n,t,l]),null},ak=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"PreloadNew",Slardar:t,children:(0,u.jsx)(aA,(0,d._)({},e))})};var aj=l("795012"),aD=l("515330"),aR=l("623607"),aM=l("207806");let aF={multiPhotoSlide:{eventName:"multi_photo_slide",params:{aweme_type:x.e.Note,enter_from:"",enter_method:"",author_id:"",group_id:"",pic_cnt:0,is_zoom:!1}},enterGraphicDetail:{eventName:"enter_graphic_detail",params:{enter_from:"",author_id:"",group_id:"",pic_cnt:0}},videoPlayFinish:{eventName:"video_play_finish",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:"",open_from_page:"",multi_window_order:""}},finishTuji:{eventName:"finish_tuji",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:""}}};var aB=new iY.h(aF);function aO(e){var t,l;return(null==e?void 0:null===(l=e.plugins)||void 0===l?void 0:null===(t=l.veStrategyVodLoggerPlugin)||void 0===t?void 0:t.cumulateTime)||0}let aV=e=>{let{timeDuration:t=3e3}=e,l=(0,e$.n)(),[i,n]=(0,m.useState)(!1),o=(0,m.useRef)(),a=(0,m.useCallback)(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{n(!0),o.current=null},t)},[t]);return(0,m.useEffect)(()=>{if(null==l?void 0:l.root){var e,t,i;let d=()=>{o.current&&clearTimeout(o.current),n(!1)},r=()=>{n(!1),a()},s=()=>{n(!1),a()};return null==l||null===(e=l.root)||void 0===e||e.addEventListener("mouseenter",r),null==l||null===(t=l.root)||void 0===t||t.addEventListener("mousemove",s),null==l||null===(i=l.root)||void 0===i||i.addEventListener("mouseleave",d),()=>{var e,t,i;null==l||null===(e=l.root)||void 0===e||e.removeEventListener("mouseenter",r),null==l||null===(t=l.root)||void 0===t||t.removeEventListener("mousemove",s),null==l||null===(i=l.root)||void 0===i||i.removeEventListener("mouseleave",d)}}},[null==l?void 0:l.root,a,n]),(0,m.useEffect)(()=>()=>{o.current&&clearTimeout(o.current),o.current=null},[]),i};var aW=l("559947");function aU(e,t){return(0,m.useMemo)(()=>{let l=[];if(e&&0===e.images.length)return l;let i=-1;for(let n=0;n<e.images.length;n++){let o=e.images[n],a={type:o.video?"video":"image",start:i+1,end:i+(o.video?o.video.duration+.999:t),duration:o.video?o.video.duration:t};i=a.end,l.push(a)}return l},[e,t])}function aH(){let e=(0,e$.n)();(0,m.useEffect)(()=>{if(e)return e.getPlugin("time")&&e.unRegisterPlugin("time"),()=>{!e.destroyed&&e.registerPlugin(aW.ar,{})}},[e])}var aG=l("262648"),az=l("436241"),aZ=l("404887");let{ArrowLeft:aK,ArrowRight:aQ,A:a$,D:aY}=aG.bf,aq=e=>{let t=(0,e$.n)(),{preClick:l,nextClick:i,disableShortCut:n=!1,active:o=!0}=e;return(0,m.useEffect)(()=>{if(!!o){if(t){var e,a;if(n)return(0,aZ.K)(t);let o={[aK.key]:{key:aK.key,action:l,disable:!1,noBodyTarget:!1},[a$.key]:{key:a$.key,action:l,disable:!1,noBodyTarget:!1},[aY.key]:{key:aY.key,action:i,disable:!1,noBodyTarget:!1},[aQ.key]:{key:aQ.key,action:i,disable:!1,noBodyTarget:!1}},r=(null==t?void 0:null===(a=t.plugins)||void 0===a?void 0:null===(e=a.keyboard)||void 0===e?void 0:e.keyCodeMap)||{};return t.updatePluginConfig(nP.p7.Keyboard,{keyCodeMap:(0,d._)({},r,o)}),()=>{if(!t.destroyed){if(t.plugins.keyboard){(0,az.v)({currentCodeMap:t.plugins.keyboard.keyCodeMap,additionalCodeMap:o});let e=t.plugins.keyboard.keyCodeMap;t.updatePluginConfig(nP.p7.Keyboard,{keyCodeMap:(0,d._)({},e||{},o)})}}}}}},[t,l,i,n,o]),null};var aJ=l("666026");function aX(e){let{fragments:t,currentTime:l,onClick:i}=e,n=(0,e$.n)(),o=(0,m.useMemo)(()=>{if(null==n?void 0:n.root){var e,t;return null===(t=n.root)||void 0===t?void 0:null===(e=t.querySelector)||void 0===e?void 0:e.call(t,".douyin-player-controls")}return null},[null==n?void 0:n.root]);if(!o)return null;let a=Array(t.length).fill(0);for(let e=0;e<t.length;e++){let i=t[e];if(l>i.end)a[e]=100;else if(l>=i.start){a[e]=(l-i.start)/i.duration*100;break}}return(0,ij.createPortal)((0,u.jsx)("div",{className:aJ.default["progress-list"],children:a.map((e,t)=>(0,u.jsxs)("div",{onClick:()=>null==i?void 0:i(t),className:`${aJ.default["progress-inner"]}`,children:[(0,u.jsx)("div",{className:g()(aJ.default["progress-played"],{[aJ.default.transition]:![100,0].includes(e)}),style:{width:`${e}%`}}),(0,u.jsx)("div",{className:aJ.default["progress-cache"]})]},t))}),o)}let a0=e=>{var t,l;let{isActive:i,awemeInfo:n,swiper:o,onPlayFinish:a,playNextFunc:r,ablePlayNext:s,playPrevFunc:c,ablePlayPrev:v,logParams:_,arrowButtonSize:f=56,isClientMiniWin:p,disableShortCut:h=!1,isShowSideBar:y=!1,inSearch:w,leftStyle:I,rightStyle:b}=e,E=(0,e$.n)(),[T,C]=(0,m.useState)(!0),[N,P]=(0,m.useState)([!0,!0]),S=(0,m.useRef)(Date.now()),L=(0,m.useRef)(0),A=(0,m.useRef)(_),k=(0,m.useRef)(!0),j=(0,m.useRef)(null),D=e=>{C(e),k.current=e},[R,M]=(0,m.useState)(0),F=aV({});aH();let B=aU(n,3e3);A.current=_;let O=(0,m.useCallback)(e=>{var t,l;aB.sendLog("multiPhotoSlide",(0,d._)({enter_from:null===(t=A.current)||void 0===t?void 0:t.enter_from,enter_method:"click_pic",author_id:null==n?void 0:null===(l=n.authorInfo)||void 0===l?void 0:l.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,et.r)()},A.current)),P([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1]),D(!1),M(B[e].end),null==o||o.slideTo(e,0)},[o,B,n]),V=(0,m.useCallback)(e=>{if(o.activeIndex>0){var t,l;aB.sendLog("multiPhotoSlide",(0,d._)({enter_from:null===(t=A.current)||void 0===t?void 0:t.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==n?void 0:null===(l=n.authorInfo)||void 0===l?void 0:l.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,et.r)()},A.current)),D(!1),M(B[o.activeIndex-1].end),o.slidePrev(),P([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1])}},[o,B,n]),W=(0,m.useCallback)(e=>{if(o.activeIndex<o.slides.length-1){var t;aB.sendLog("multiPhotoSlide",(0,d._)({enter_from:null==_?void 0:_.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==n?void 0:null===(t=n.authorInfo)||void 0===t?void 0:t.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,et.r)()},A.current)),D(!1),M(B[o.activeIndex+1].end),o.slideNext(),P([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1])}},[o,B,n]);return(aq({preClick:V,nextClick:W,disableShortCut:h}),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=e=>{if(e){var t;aB.sendLog("enterGraphicDetail",{enter_from:null==_?void 0:_.enter_from,author_id:null==n?void 0:null===(t=n.authorInfo)||void 0===t?void 0:t.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length})}};return E.on(ih.FP.FULLSCREEN_CHANGE,e),()=>{E.off(ih.FP.FULLSCREEN_CHANGE,e)}}},[n,E]),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=E.getPlugin(nP.p7.AutoPlaySettingPlugin)||E.getPlugin(nP.p7.SearchAutoPlaySettingPlugin);if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[n,E]),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=E.getPlugin(nP.p7.InnerAutoPlayPlugin);if(e)return e._config.innerAutoPlayWeight+=1,()=>{e._config.innerAutoPlayWeight-=1}}},[n,E]),(0,m.useEffect)(()=>{if(o){let e=!1,t=()=>{e=!1,setTimeout(()=>O(o.activeIndex))},l=()=>{D(!1),M(B[o.activeIndex].end),e||o.once("touchEnd",t),e=!0};try{o.on("touchMove",l)}catch(e){}return()=>{try{null==o||o.off("touchMove",l)}catch(e){}}}},[o,B,O]),(0,m.useEffect)(()=>{if(i&&E){if(T){S.current=Date.now()-3e3*L.current*n.images.length;let e=eZ()(()=>{aO(E)>=5e3&&(j.current(),E.off(ih.FP.TIMEUPDATE,e))},500,{leading:!0,trailing:!0}),t=()=>{var t,l,i,a;if((Date.now()-S.current)/(3e3*n.images.length)>=1){E.off(ih.FP.TIMEUPDATE,e),E.on(ih.FP.TIMEUPDATE,e),M(B[0].start),L.current=0,S.current=Date.now();let n=E.getPlugin(nP.p7.AutoPlaySettingPlugin)||E.getPlugin(nP.p7.SearchAutoPlaySettingPlugin),o=E.getPlugin(nP.p7.InnerAutoPlayPlugin);n&&(null==n?void 0:null===(t=n._config)||void 0===t?void 0:t.nextAutoPlay)&&(null==n?void 0:n.playeNextWeightNum)<=1&&s&&(null==n?void 0:n.stopFlag)===0?null==r||r():o&&(null===(l=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===l?void 0:l.modeIndex)===i2.KM.Nomal&&o._config.innerAutoPlayWeight>=0&&s&&(null==o?void 0:o.stopFlag)===0?null==r||r({from:"auto"}):o&&(null===(i=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===i?void 0:i.modeIndex)===i2.KM.Reverse&&o._config.innerAutoPlayWeight>=0&&v&&(null==o?void 0:o.stopFlag)===0&&(null==c||c({from:"auto"}))}else M(Date.now()-S.current);let u=Math.floor((Date.now()-S.current)/3e3);if((null==o?void 0:o.activeIndex)!==u){if(null==o?void 0:o.destroyed)return;aB.sendLog("multiPhotoSlide",(0,d._)({enter_from:null==_?void 0:_.enter_from,enter_method:"auto",author_id:null==n?void 0:null===(a=n.authorInfo)||void 0===a?void 0:a.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,et.r)()},A.current)),null==o||o.slideTo(u,o.activeIndex===n.images.length-1?0:250),P([(null==o?void 0:o.activeIndex)===0,(null==o?void 0:o.activeIndex)===(null==n?void 0:n.images.length)-1])}},l=()=>{S.current=Date.now()-3e3*L.current*n.images.length};return E.on(ih.FP.TIMEUPDATE,t),E.on(ih.FP.PLAY,l),()=>{E.off(ih.FP.TIMEUPDATE,t),E.off(ih.FP.PLAY,l),E.off(ih.FP.TIMEUPDATE,e)}}{let e=()=>{D(!0)};(null==E?void 0:E.paused)&&E.once(ih.FP.PLAY,e);let t=()=>{E.once(ih.FP.PLAY,e)},l=()=>{E.off(ih.FP.PLAY,e)};return E.on(ih.FP.PAUSE,t),E.on(ih.FP.ENDED,l),()=>{E.off(ih.FP.PAUSE,t),E.off(ih.FP.ENDED,l),E.off(ih.FP.PLAY,e)}}}L.current=0},[i,E,T,B,o,r,s]),(0,m.useEffect)(()=>{if(o){let e=()=>{if(o.activeIndex===(null==n?void 0:n.images.length)-1){var t,l,i,r,s,u,c,v;aB.sendLog("videoPlayFinish",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,iR.mo)(),author_id:null==n?void 0:null===(t=n.authorInfo)||void 0===t?void 0:t.uid,group_id:null==n?void 0:n.awemeId,log_pb:null==n?void 0:n.logPb,compilation_id:null==n?void 0:null===(l=n.mixInfo)||void 0===l?void 0:l.mixId,playlet_id:null==n?void 0:null===(i=n.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,aj.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(r=Z.Le.getConfig("isCollapseAuthorCard"))||void 0===r?void 0:r.isCollapseAuthorCard)?0:1,from_follow_list:(null===(s=Z.Le.getConfig("fromFollowList"))||void 0===s?void 0:s.tag)?"1":"0",is_mute:(null==E?void 0:E.muted)?"1":"0",is_force:(null===(u=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===u?void 0:u.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==n?void 0:n.isSlides)?x.e.Slides:null==n?void 0:n.awemeType,pic_cnt:null==n?void 0:null===(c=n.images)||void 0===c?void 0:c.length,is_small_window:"0",column_type:(null==_?void 0:_.column_type)||(null==_?void 0:null===(v=_.search_params)||void 0===v?void 0:v.column_type),is_selected_label:(null==n?void 0:n.weeklyRecommend)?1:0},_,(0,eo.Wc)()));try{o.off("slideChange",e)}catch(e){}null==a||a()}};try{o.slideTo(0,0),P([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1]),o.on("slideChange",e)}catch(e){}return()=>{try{o.off("slideChange",e)}catch(e){}}}},[o,n]),(0,m.useEffect)(()=>{if(o){j.current=()=>{var e,t,l,i,o,a,r;aB.sendLog("finishTuji",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,iR.mo)(),author_id:null==n?void 0:null===(e=n.authorInfo)||void 0===e?void 0:e.uid,group_id:null==n?void 0:n.awemeId,log_pb:null==n?void 0:n.logPb,compilation_id:null==n?void 0:null===(t=n.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==n?void 0:null===(l=n.seriesInfo)||void 0===l?void 0:l.seriesId,tab_name:(0,aj.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(i=Z.Le.getConfig("isCollapseAuthorCard"))||void 0===i?void 0:i.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=Z.Le.getConfig("fromFollowList"))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==E?void 0:E.muted)?"1":"0",is_force:(null===(a=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==n?void 0:n.awemeType,pic_cnt:null==n?void 0:null===(r=n.images)||void 0===r?void 0:r.length,is_small_window:"0"},_)),j.current=()=>{}};let e=()=>{o.activeIndex===(null==n?void 0:n.images.length)-1&&j.current&&!k.current&&j.current()};return o.on("slideChange",e),()=>{o.off("slideChange",e)}}},[o,n]),p||(null==n?void 0:null===(t=n.images)||void 0===t?void 0:t.length)!==1)?!p&&(null==n?void 0:null===(l=n.images)||void 0===l?void 0:l.length)>1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(aX,{fragments:B,currentTime:R,onClick:O}),(0,u.jsx)("div",{className:g()(aM.default.leftArrow,aM.default.arrow,{[aM.default.disabled]:N[0],[aM.default.inSideBar]:y,[aM.default.inSearch]:w,[aM.default.hide]:F,[I]:I}),style:{width:`${f}px`,height:`${f}px`},children:(0,u.jsx)(eF.Z,{src:aD.Z,width:f,height:f,viewBox:"0 0 56 56",onClick:V})}),(0,u.jsx)("div",{className:g()(aM.default.rightArrow,aM.default.arrow,{[aM.default.disabled]:N[1],[aM.default.inSideBar]:y,[aM.default.inSearch]:w,[aM.default.hide]:F,[b]:b}),style:{width:`${f}px`,height:`${f}px`},children:(0,u.jsx)(eF.Z,{src:aR.Z,width:f,height:f,viewBox:"0 0 56 56",onClick:W})})]}):null:(0,u.jsx)(aX,{fragments:B,currentTime:R,onClick:O})};l("635303");var a1=l("451118"),a2=l.p+"media/generalBG.9f4484112e793191.png",a4=l.p+"media/douyinDefault.330eae8fad2b7adc.png",a3=l("452112");let a5=e=>{let{imageInfo:t,className:l,imgPlaceHolderClassName:i,isMini:n,inSearch:o,isOneLive:a,isOneLiveMix:d}=e,[r,s]=(0,m.useState)(!0),[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(null),[p,h]=(0,m.useState)(-1),[y,w]=(0,m.useState)(!1),I=(0,m.useRef)(0),x=(0,$.G6)(),b=(0,$.vU)();I.current=(null==t?void 0:t.width)/(null==t?void 0:t.height);let E=(0,m.useCallback)(()=>{_&&I.current&&(_.offsetWidth/I.current>_.offsetHeight-(n?0:33)?s(!0):s(!1))},[_,n]),T=(0,m.useCallback)(()=>{c||v(!0)},[c]);(0,m.useEffect)(()=>{if(_&&E){let e=a1.Z.bind(_,E);return()=>{e&&e()}}},[_,E]),(0,m.useEffect)(()=>{_&&(n?_.setAttribute("normal",""):_.removeAttribute("normal"))},[_,n]),(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.notevideo,e=>{"onelive_start"===e.type&&!0===e.isMix&&w(!0),"onelive_end"===e.type&&!0===e.isMix&&w(!1)});return()=>e()},[]);let C=(0,m.useMemo)(()=>{if(c)return null;if(-1!==p)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("img",{src:null==t?void 0:t.urlList[p],className:g()({[a3.default.baseWidth]:!r,[a3.default.baseHeight]:r,[a3.default.isSafari]:x,[a3.default.inSearch]:o},a3.default.imgPlaceHolder,i),onError:T}),(0,u.jsxs)("div",{className:g()({[a3.default.backgroundImg]:!x,[a3.default.backgroundImgFirefox]:b,[a3.default.backgroundImgSarari]:x}),children:[(0,u.jsx)("img",{src:x?a2:(null==t?void 0:t.urlList[p])||a2}),!x&&(0,u.jsx)("div",{className:a3.default.backgroundMask})]})]});{let e=new Image;e.src=null==t?void 0:t.urlList[0];let l=setTimeout(()=>{null==t||t.urlList.map((e,t)=>{let l=new Image;l.src=e,l.onload=()=>h(t)})},2e3);return e.onload=()=>{h(0),clearTimeout(l)},(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("img",{src:a4,className:g()({[a3.default.baseWidth]:!r,[a3.default.baseHeight]:r,[a3.default.isSafari]:x,[a3.default.inSearch]:o},a3.default.imgPlaceHolder,i)}),(0,u.jsxs)("div",{className:g()({[a3.default.backgroundImg]:!x,[a3.default.backgroundImgFirefox]:b,[a3.default.backgroundImgSarari]:x}),children:[(0,u.jsx)("img",{src:x?a2:a4}),!x&&(0,u.jsx)("div",{className:a3.default.backgroundMask})]})]})}},[c,p,T,r]);return(0,u.jsx)("div",{className:g()(l,a3.default.imgBackground,a3.default.playerShowInfo,{[a3.default.isFirefox]:b,[a3.default.livePhoto]:5===t.clipType,[a3.default.withoutProgress]:a,[a3.default.isOneLiveMix]:d,[a3.default.isInLive]:y}),ref:f,children:C})};l("455663");var a6=l("827480"),a8=l("435890");let a7=e=>{let{info:t,activeIndex:l,currentIndex:i,albumMusic:n,isInPreview:o,inSearch:a,isOneLive:d}=e,r=(0,m.useRef)(),s=(0,e$.n)(),[c,v]=(0,m.useState)(!1),_=(0,m.useRef)(!1),f=(0,m.useMemo)(()=>{let e=t.video.bitRateList.find(e=>0===e.isH265);return e&&e.playAddr?e.playAddr.map(e=>({src:(0,a6.preProcessUrl)(e.src).url})).concat({src:e.playApi}):[]},[t.video]);return((0,m.useEffect)(()=>{if(s){if(l===i){if(!s.paused){var e;null===(e=r.current)||void 0===e||e.play()}}else r.current&&(r.current.paused||r.current.pause(),r.current.currentTime=0)}},[s,l,i]),(0,m.useEffect)(()=>{if(s&&l===i){let e=()=>{var e;if(!(s.currentTime<=.5)||!_.current)n.beginTime,null===(e=r.current)||void 0===e||e.play()};return s.on("play",e),()=>{s.off("play",e)}}},[s,l,i]),(0,m.useEffect)(()=>{if(s){let e=()=>{var e;if(!(s.currentTime<=.5)&&!(s.duration-s.currentTime<=.5)&&(!(n.beginTime>1e3)||!(s.currentTime-n.beginTime/1e3<=.5)&&!(n.endTime/1e3-s.currentTime<=.5)))null===(e=r.current)||void 0===e||e.pause()};return s.on("pause",e),()=>{s.off("pause",e)}}},[s]),(0,m.useEffect)(()=>{if(s){let e=()=>{_.current=!0};return s.on("ended",e),()=>{s.off("ended",e)}}},[s]),(0,m.useEffect)(()=>{if(s&&l===i){let e=q.listen(q.EVENT.notevideo,e=>{let{type:t,index:i,playerId:n}=e;r.current&&"replay"===t&&n===s.playerId&&i===l&&r.current.play()});return()=>e()}},[s,l,i]),(0,m.useEffect)(()=>{if(s){let e=q.listen(q.EVENT.notevideo,e=>{"onelive_start"===e.type&&v(!0),"onelive_end"===e.type&&v(!1)});return()=>e()}},[s]),(0,m.useEffect)(()=>{l!==i&&v(!1)},[l,i]),(0,m.useEffect)(()=>{if(s&&l===i&&r.current){.01===s.volume?r.current.volume=parseFloat(s.config.volume_raw)||0:r.current.volume=s.volume,r.current.muted=s.muted;let e=e=>{if(!0!==e.isInternalOp).01===s.volume?r.current.volume=parseFloat(s.config.volume_raw)||0:r.current.volume=s.volume,r.current.muted=s.muted};return null==s||s.on(ih.FP.VOLUMECHANGE,e),()=>{null==s||s.off(ih.FP.VOLUMECHANGE,e)}}},[s,l,i]),i-l>1||i-l<-1)?null:(0,u.jsx)("div",{className:g()(a8.default.container,{[a8.default.withoutProgress]:d,[a8.default.inSearch]:a,[a8.default.isInPreview]:o,[a8.default.livePhoto]:5===t.clipType,[a8.default.isInLive]:c}),children:(0,u.jsx)("video",{className:a8.default.video,muted:!0,playsInline:!0,"x5-playsinline":!0,"webkit-playsinline":!0,autoPlay:!1,onPlay:()=>{q.emit(q.EVENT.notevideo,{type:"start",playerId:null==s?void 0:s.playerId,index:i}),!d&&setTimeout(()=>{v(!0)})},onEnded:()=>{q.emit(q.EVENT.notevideo,{type:"end",playerId:null==s?void 0:s.playerId,index:i}),!d&&setTimeout(()=>{v(!1)})},onTimeUpdate:()=>{var e,t;q.emit(q.EVENT.notevideo,{type:"timeupdate",playerId:null==s?void 0:s.playerId,data:(null===(e=r.current)||void 0===e?void 0:e.currentTime)*1e3,index:i}),(0,$.G6)()&&(null==s?void 0:s.paused)&&(null===(t=r.current)||void 0===t||t.pause())},ref:r,children:f.map((e,t)=>(0,u.jsx)("source",{src:e.src},t))})})},a9={singleTime:2e3,speed:250},de=e=>{var t,l,i,n,o,a;let{isActive:s,awemeInfo:c,swiper:v,onPlayFinish:_,playNextFunc:f,ablePlayNext:p,playPrevFunc:h,ablePlayPrev:y,logParams:w,arrowButtonSize:I=56,isClientMiniWin:b,disableShortCut:E=!1,isShowSideBar:T=!1,inSearch:C,leftStyle:N,rightStyle:P}=e,S=(0,e$.n)(),[L,A]=(0,m.useState)(0),[k,j]=(0,m.useState)(!0),[D,R]=(0,m.useState)([!0,!0]),M=(0,m.useRef)(w),F=(0,m.useRef)(!0),B=(0,m.useRef)(null),O=e=>{j(e),F.current=e},V=(0,m.useRef)(null),W=(0,m.useRef)(null),U=(null==c?void 0:null===(t=c.images)||void 0===t?void 0:t.length)===1&&(null==c?void 0:null===(i=c.images)||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:l.clipType)===5,H=U&&(null==c?void 0:null===(o=c.images)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.livePhotoType)===1,G=aV({});aH();let z=aU(c,a9.singleTime);M.current=w;let Q=(0,m.useCallback)(e=>{A(z[e].end)},[S,z]),$=(0,m.useCallback)(e=>{var t,l;aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null===(t=M.current)||void 0===t?void 0:t.enter_from,author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:"click_pic",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),v.slideTo(e,0),O(!1),Q(e),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])},[v,Q,c]),Y=(0,m.useCallback)(e=>{if(v.activeIndex>0){var t,l;aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null===(t=M.current)||void 0===t?void 0:t.enter_from,author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),O(!1),Q(v.activeIndex-1),v.slidePrev(),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])}},[v,Q,c]),J=(0,m.useCallback)(e=>{if(v.activeIndex<v.slides.length-1){var t;aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),O(!1),Q(v.activeIndex+1),v.slideNext(),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])}},[v,Q,c]);aq({preClick:Y,nextClick:J,disableShortCut:E}),(0,m.useEffect)(()=>{if(S&&(null==c?void 0:c.awemeType)===x.e.Note){let e=e=>{if(e){var t;aB.sendLog("enterGraphicDetail",{enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length})}};return S.on(ih.FP.FULLSCREEN_CHANGE,e),()=>{S.off(ih.FP.FULLSCREEN_CHANGE,e)}}},[c,S]),(0,m.useEffect)(()=>{if(S&&(null==c?void 0:c.awemeType)===x.e.Note){let e=S.getPlugin(nP.p7.AutoPlaySettingPlugin)||S.getPlugin(nP.p7.SearchAutoPlaySettingPlugin);if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[c,S]),(0,m.useEffect)(()=>{if(S&&(null==c?void 0:c.awemeType)===x.e.Note){let e=S.getPlugin(nP.p7.InnerAutoPlayPlugin);if(e){let t=e._config.innerAutoPlayWeight;return e._config.innerAutoPlayWeight=t<0?t-1:0,()=>{let l=e._config.innerAutoPlayWeight;e._config.innerAutoPlayWeight=l<-1?t+1:0}}}},[c,S]),(0,m.useEffect)(()=>{if(v){let e=!1,t=()=>{e=!1,setTimeout(()=>$(v.activeIndex))},l=()=>{O(!1),Q(v.activeIndex),e||v.once("touchEnd",t),e=!0};try{v.on("touchMove",l)}catch(e){}return()=>{try{null==v||v.off("touchMove",l)}catch(e){}}}},[v,Q,$]);let X=(0,m.useCallback)(()=>{var e,t,l;let i=S.getPlugin(nP.p7.AutoPlaySettingPlugin)||S.getPlugin(nP.p7.SearchAutoPlaySettingPlugin),n=S.getPlugin(nP.p7.InnerAutoPlayPlugin);i&&(null==i?void 0:null===(e=i._config)||void 0===e?void 0:e.nextAutoPlay)&&(null==i?void 0:i.playeNextWeightNum)<=1&&p&&(null==i?void 0:i.stopFlag)===0?null==f||f():n&&(null===(t=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===t?void 0:t.modeIndex)===i2.KM.Nomal&&n._config.innerAutoPlayWeight>=0&&p&&(null==n?void 0:n.stopFlag)===0?null==f||f({from:"auto"}):n&&(null===(l=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===l?void 0:l.modeIndex)===i2.KM.Reverse&&n._config.innerAutoPlayWeight>=0&&y&&(null==n?void 0:n.stopFlag)===0&&(null==h||h({from:"auto"}))},[S,y,p,h,f]);return(0,m.useEffect)(()=>{if(s&&S&&v&&k&&"video"!==z[v.activeIndex].type){let e=1e3*S.currentTime;e>100&&c.imageAlbumMusicInfo.beginTime>1e3&&(e-=c.imageAlbumMusicInfo.beginTime);let t=()=>{let t=((S.currentTime+S.duration)*1e3-e)%(1e3*S.duration);if(c.imageAlbumMusicInfo.beginTime>1e3){let{beginTime:l,endTime:i}=c.imageAlbumMusicInfo,n=i-l;t=(1e3*S.currentTime-l+n-e)%n}if(t>=a9.singleTime){var l,i,n;if(v.activeIndex===c.images.length-1){X(),A(z[0].start),R([!0,!1]),v.slideTo(0,0);let e=S.getPlugin("pictureProgress");null==e||null===(i=e.innerList)||void 0===i||i.reset(),aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(n=c.authorInfo)||void 0===n?void 0:n.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),aO(S)>=5e3&&B.current();return}A(z[v.activeIndex+1].start),R([!1,v.activeIndex+1===(null==c?void 0:c.images.length)-1]),v.slideTo(v.activeIndex+1,a9.speed),aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType}));return}A(z[v.activeIndex].start+t)};return S.on(ih.FP.TIMEUPDATE,t),()=>{S.off(ih.FP.TIMEUPDATE,t)}}},[null==v?void 0:v.activeIndex,S,s,k,z,X]),(0,m.useEffect)(()=>{if(s&&S&&v){let e=e=>{"switch_play_pause"===e.action&&e.paused&&O(!0)};return S.on(ih.FP.USER_ACTION,e),()=>{S.off(ih.FP.USER_ACTION,e)}}},[s,S,v]),(0,m.useEffect)(()=>{if(S){let e=!1,t=!1,l=()=>{e&&q.emit(q.EVENT.notevideo,{type:"replay",playerId:S.playerId,index:v.activeIndex}),t&&X()},i=()=>{V.current&&(e=!0,clearTimeout(V.current)),W.current&&(t=!0,clearTimeout(W.current))};return S.on("play",l),S.on("pause",i),()=>{S.off("play",l),S.off("pause",i)}}},[S]),(0,m.useEffect)(()=>{if(s&&S&&v){let e=q.listen(q.EVENT.notevideo,e=>{let{type:t,data:l,index:i,playerId:n}=e;if(S.playerId===n){if("start"===t&&U&&setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"onelive_start",playerId:S.playerId,isMix:H})},100),"timeupdate"===t&&v.activeIndex===i&&A(z[v.activeIndex].start+l),"end"===t){if(U&&(q.emit(q.EVENT.notevideo,{type:"onelive_end",playerId:S.playerId,isMix:H}),H?V.current=setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:S.playerId,index:v.activeIndex})},2500):setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:S.playerId,index:v.activeIndex})},300)),k){var o,a,s;if(v.activeIndex===c.images.length-1){H?W.current=setTimeout(()=>{X()},2500):X(),A(z[0].start),R([!0,!1]),v.slideTo(0,0);let e=S.getPlugin("pictureProgress");null==e||null===(a=e.innerList)||void 0===a||a.reset(),aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(s=c.authorInfo)||void 0===s?void 0:s.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),aO(S)>=5e3&&B.current();return}A(z[v.activeIndex+1].start),R([!1,v.activeIndex+1===(null==c?void 0:c.images.length)-1]),v.slideTo(v.activeIndex+1,a9.speed),aB.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(o=c.authorInfo)||void 0===o?void 0:o.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,et.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType}))}else setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:S.playerId,index:v.activeIndex})},100)}}});return()=>{e(),clearTimeout(V.current),clearTimeout(W.current)}}},[s,S,v,k,X]),(0,m.useEffect)(()=>{if(v){let e=()=>{if(v.activeIndex===(null==c?void 0:c.images.length)-1){var t,l,i,n,o,a,r,s;aB.sendLog("videoPlayFinish",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,iR.mo)(),author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,log_pb:null==c?void 0:c.logPb,compilation_id:null==c?void 0:null===(l=c.mixInfo)||void 0===l?void 0:l.mixId,playlet_id:null==c?void 0:null===(i=c.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,aj.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(n=Z.Le.getConfig(Z.gI.IsCollapseAuthorCard))||void 0===n?void 0:n.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=Z.Le.getConfig(Z.gI.FromFollowList))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==S?void 0:S.muted)?"1":"0",is_force:(null===(a=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==c?void 0:c.isSlides)?x.e.Slides:null==c?void 0:c.awemeType,pic_cnt:null==c?void 0:null===(r=c.images)||void 0===r?void 0:r.length,is_small_window:"0",column_type:(null==w?void 0:w.column_type)||(null==w?void 0:null===(s=w.search_params)||void 0===s?void 0:s.column_type),is_selected_label:(null==c?void 0:c.weeklyRecommend)?1:0},w,(0,eo.Wc)()));try{v.off("slideChange",e)}catch(e){}null==_||_()}};try{v.slideTo(0,0),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1]),v.on("slideChange",e)}catch(e){}return()=>{try{v.off("slideChange",e)}catch(e){}}}},[v,c]),(0,m.useEffect)(()=>{if(v){B.current=()=>{var e,t,l,i,n,o,a;aB.sendLog("finishTuji",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,iR.mo)(),author_id:null==c?void 0:null===(e=c.authorInfo)||void 0===e?void 0:e.uid,group_id:null==c?void 0:c.awemeId,log_pb:null==c?void 0:c.logPb,compilation_id:null==c?void 0:null===(t=c.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==c?void 0:null===(l=c.seriesInfo)||void 0===l?void 0:l.seriesId,tab_name:(0,aj.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(i=Z.Le.getConfig(Z.gI.IsCollapseAuthorCard))||void 0===i?void 0:i.isCollapseAuthorCard)?0:1,from_follow_list:(null===(n=Z.Le.getConfig(Z.gI.FromFollowList))||void 0===n?void 0:n.tag)?"1":"0",is_mute:(null==S?void 0:S.muted)?"1":"0",is_force:(null===(o=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===o?void 0:o.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==c?void 0:c.awemeType,pic_cnt:null==c?void 0:null===(a=c.images)||void 0===a?void 0:a.length,is_small_window:"0"},w)),B.current=()=>{}};let e=()=>{v.activeIndex===(null==c?void 0:c.images.length)-1&&B.current&&!F.current&&B.current()};return v.on("slideChange",e),()=>{v.off("slideChange",e)}}},[v,c]),!b&&(null==c?void 0:null===(a=c.images)||void 0===a?void 0:a.length)>1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(aX,{fragments:z,currentTime:L,onClick:$}),(0,u.jsx)("div",{className:g()(aM.default.leftArrow,aM.default.arrow,{[aM.default.disabled]:D[0],[aM.default.inSideBar]:T,[aM.default.inSearch]:C,[aM.default.hide]:G,[N]:N}),style:{width:`${I}px`,height:`${I}px`},children:(0,u.jsx)(eF.Z,{src:aD.Z,width:I,height:I,viewBox:"0 0 56 56",onClick:Y})}),(0,u.jsx)("div",{className:g()(aM.default.rightArrow,aM.default.arrow,{[aM.default.disabled]:D[1],[aM.default.inSideBar]:T,[aM.default.inSearch]:C,[aM.default.hide]:G,[P]:P}),style:{width:`${I}px`,height:`${I}px`},children:(0,u.jsx)(eF.Z,{src:aR.Z,width:I,height:I,viewBox:"0 0 56 56",onClick:J})})]}):null};var dt=l("208275"),dl=l("153296"),di=l("452695");let dn=e=>{var t,l,i,n,o;let{isActive:a,awemeInfo:d,playNextFunc:r,playPrevFunc:s,ablePlayPrev:c,ablePlayNext:v,logParams:_,isMini:f,isClientMiniWin:p,onPlayFinish:h,customProps:y,disableShortCut:w=!1,isShowSideBar:I=!1,inSearch:b}=e,E=(0,e$.n)(),[T,C]=(0,m.useState)(null),[N,P]=(0,m.useState)(d),{arrowButtonSize:S=56,disableInactiveCursor:L=!1,leftStyle:A,rightStyle:k}=y||{},j=(null==d?void 0:null===(t=d.images)||void 0===t?void 0:t.length)===1&&(null==d?void 0:null===(i=d.images)||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:l.clipType)===5,D=j&&(null==d?void 0:null===(o=d.images)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.livePhotoType)===1,R=(0,m.useMemo)(()=>{var e;if((null==d?void 0:d.awemeType)!==x.e.Note)return[];if(a)return null==d?void 0:d.images;return(null==d?void 0:null===(e=d.images)||void 0===e?void 0:e.slice(0,1))||[]},[null==d?void 0:d.images,a,null==d?void 0:d.awemeType]),M=(0,m.useMemo)(()=>{var e,t;return!!(null==d?void 0:null===(t=d.images)||void 0===t?void 0:null===(e=t.find)||void 0===e?void 0:e.call(t,e=>e.video))},[null==d?void 0:d.images]);return((0,m.useEffect)(()=>()=>C(null),[]),(0,m.useEffect)(()=>{let{beginTime:e=0,endTime:t=Number.MAX_SAFE_INTEGER}=(null==d?void 0:d.imageAlbumMusicInfo)||{},l=()=>{(E.currentTime>=t/1e3||E.currentTime<e/1e3)&&(E.currentTime=e/1e3)};return(null==d?void 0:d.awemeType)===x.e.Note&&e>=0&&t>e&&(null==E||E.on(ih.FP.TIMEUPDATE,l)),()=>{null==E||E.off(ih.FP.TIMEUPDATE,l)}},[E,d]),(0,m.useEffect)(()=>{if(a&&T&&E){var e;T.update();let t=a1.Z.bind(null==T?void 0:null===(e=T.$el)||void 0===e?void 0:e[0],()=>{T.update()});return()=>{t&&t()}}},[T,a,E]),(0,m.useEffect)(()=>{P(d)},[d]),(0,eP.o)(()=>{var e,t;if(a&&E&&(null==d?void 0:null===(e=d.imageAlbumMusicInfo)||void 0===e?void 0:e.volume)===0)return E.config.volume_raw=E.volume,E.volume=.01,()=>{E.volume=E.config.volume_raw,(0,lJ.qQ)(lX.LocalStorageKeys.PLAYER_VOLUME,E.config.volume_raw),(0,di.c)({volume:E.config.volume_raw})};!a&&E&&(null==d?void 0:null===(t=d.imageAlbumMusicInfo)||void 0===t?void 0:t.volume)===0&&E.config.volume_raw&&((0,lJ.qQ)(lX.LocalStorageKeys.PLAYER_VOLUME,E.config.volume_raw),(0,di.c)({volume:E.config.volume_raw}))},[a,E]),(null==d?void 0:d.awemeType)!==x.e.Note)?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dt.t,{direction:0,onSwiper:C,className:g()(aM.default.swiperContainer,"focusPanel"),tabIndex:-1,data:R,slideKey:(e,t)=>`${null==e?void 0:e.uri}_${t}`,speed:250,children:(0,u.jsx)(dl.o,{className:aM.default.pictureFeed,children:e=>{let{slideData:t,activeIndex:l,currentIndex:i}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{style:{width:"100%",height:"100%",zIndex:2,background:"transparent"},className:g()(aM.default.mask,{[aM.default.inactive]:l!==i&&L}),type:"button",onKeyDown:e=>null==e?void 0:e.preventDefault()}),(0,u.jsx)(a5,{imageInfo:t,isMini:f,className:aM.default.itemImage,inSearch:b,isOneLive:j,isOneLiveMix:D}),a&&t.video&&(0,u.jsx)(a7,{albumMusic:d.imageAlbumMusicInfo,info:t,isMini:f,activeIndex:l,currentIndex:i,inSearch:b,isOneLive:j})]})}})}),N===d&&a&&!M&&(0,u.jsx)(a0,{isActive:a,awemeInfo:d,swiper:T,onPlayFinish:h,playNextFunc:r,playPrevFunc:s,ablePlayNext:v,ablePlayPrev:c,logParams:_,arrowButtonSize:S,isClientMiniWin:p,disableShortCut:w,isShowSideBar:I,inSearch:b,leftStyle:A,rightStyle:k}),N===d&&a&&M&&(0,u.jsx)(de,{isActive:a,awemeInfo:d,swiper:T,onPlayFinish:h,playNextFunc:r,playPrevFunc:s,ablePlayNext:v,ablePlayPrev:c,logParams:_,arrowButtonSize:S,isClientMiniWin:p,disableShortCut:w,isShowSideBar:I,inSearch:b,leftStyle:A,rightStyle:k})]})},da=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"PictureMode",Slardar:t,children:(0,u.jsx)(dn,(0,d._)({},e))})};var dd=l("969352"),dr=l("904886"),ds=l("730894");let du=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p,onBrandComponentShow:h}=e||{},[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(!1),b=(0,m.useRef)(!1);ot({timerCb:e=>{if(b.current)return;let{currentTime:t,isEnd:l}=e,i=p.show_time,n=p.show_time+.5;t>=i&&(w(!0),null==h||h()),t>=n&&x(!0),l&&!b.current&&(w(!0),null==h||h(),x(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let E=eZ()(e=>{var t,l;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null==p?void 0:p.img_url,position:"bottom",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}q.emit(q.EVENT.videoPause)},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(ds.default.adWrapper,v,{[ds.default.show]:y}),style:{width:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.width,height:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.height},children:(0,u.jsx)(eJ.a,{onClick:e=>E(e),className:ds.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:(0,u.jsx)("img",{className:ds.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),w(!1),b.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}})})})},dc=e=>{var t,l,i,n,o,a,d,r;let{awemeInfo:s,className:c,isActive:v,onBrandComponentClose:_,onBrandComponentShow:f}=e||{},[p,h]=(0,m.useState)(!1),[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(),b=(0,m.useRef)([]),E=null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:t.brandAd;return(ot({timerCb:e=>{var t,l;let i=!1;for(let n=0;n<(null===(t=E.biz_content.brand_ad_component_config)||void 0===t?void 0:t.bottom.length);n++){let t=null===(l=E.biz_content.brand_ad_component_config)||void 0===l?void 0:l.bottom[n];if(void 0===t.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&t.brand_ad_component_type===V.Wy.Img){x(t),i=!0;break}}else if(e.currentTime>=t.brand_ad_component_float_tip.show_time&&e.currentTime<=t.brand_ad_component_float_tip.disappear_time&&t.brand_ad_component_type===V.Wy.Img){x(t),i=!0;break}}!i&&(x(null),null==_||_())},stopBySeeking:!1,awemeInfo:s,isActive:v,needInit:!0}),al({brandAdComponentItem:I,openUrl:E.open_url,isActive:v,awemeInfo:s,position:"bottom"}),(0,m.useEffect)(()=>{var e,t,l,i,n;I&&!b.current.includes(null==I?void 0:null===(e=I.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:null===(t=l.brandAd)||void 0===t?void 0:t.brand_type],img_url:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"bottom",icon_type:"image"}),b.current.push(null===(n=I.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[I]),y||p||(null==I?void 0:I.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsxs)("div",{className:"xgplayer-bottom-brand-ad",children:[(0,u.jsx)(eF.Z,{onClick:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},width:"46",height:"23",viewBox:"0 0 46 23",src:ie,className:dr.default.close,style:{bottom:`${null==I?void 0:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:null===(l=i.close_btn_position)||void 0===l?void 0:l.bottom}px`,right:`${null==I?void 0:null===(o=I.brand_ad_component_float_tip)||void 0===o?void 0:null===(n=o.close_btn_position)||void 0===n?void 0:n.right}px`}}),(0,u.jsx)("div",{className:g()(c,dr.default.container),style:{bottom:null!==(r=null===(d=I.brand_ad_component_float_tip)||void 0===d?void 0:null===(a=d.position)||void 0===a?void 0:a.bottom)&&void 0!==r?r:0},children:(0,u.jsx)(du,{awemeInfo:s,isActive:v,onBrandComponentClose:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},onBrandComponentShow:f,onImgError:()=>{h(!0)},brandAdComponentFloatTip:I.brand_ad_component_float_tip})})]})};function dv(e){var t,l,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(t=v.webRawData)||void 0===t?void 0:t.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.bottom)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(l=i.brand_ad_component_float_tip)||void 0===l?void 0:l.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.bottom)||void 0===r?void 0:r.length)>0?(0,u.jsx)(dc,(0,d._)({},e)):null}let dm=e=>{let t=(0,iB.N)();return(0,u.jsx)(eB.k,{componentName:"BottomFeedBrandAd",Slardar:t,children:(0,u.jsx)(dv,(0,d._)({},e))})},d_=e=>{let{player:t,isActive:l,disableShortCut:i}=e;(0,m.useEffect)(()=>{var e,n,o,a,d,r;if(!!t)i||!l?null==t||null===(o=t.plugins)||void 0===o||null===(n=o.fullscreen)||void 0===n||null===(e=n.updateConfig)||void 0===e||e.call(n,{disabled:!0}):null==t||null===(r=t.plugins)||void 0===r||null===(d=r.fullscreen)||void 0===d||null===(a=d.updateConfig)||void 0===a||a.call(d,{disabled:!1})},[i,t,l])},df=e=>{var t,l;let{isActive:i,isNext:n,isPrev:o,isFirst:a,isLast:r,index:s,awemeInfo:c,nextAwemeInfo:v,prevAwemeInfo:_,playNextFunc:f,abtestData:p,deleteCurrentSwiper:h,toggleComment:y,onAvatarClick:I,fullScreenTarget:E,logParams:T,videoToast:C,followHandler:N,playPrevFunc:P,userInfo:S,dispatch:L,isAuthorCardShow:A,isShowRelatedCard:k,children:j,videoHashtagClassName:D,isShowGuide:R,videoTags:F,showPlaySwitch:B=!0,moreBoxShowList:O={notInterestingIcon:!0,unfollow:!0,report:!0},shortCutFiltered:W,positionBoxClassName:U,actionFollow:H,actionUnFollow:G,isInnerFeed:z,isOuterFeedSplash:K,onRelatedClick:Q,onCooperationAuthorClick:Y,isShowCooperation:q,isAdShortCut:J=!0,onShopAnchorClick:X=()=>{},onActivityCardClick:et,onDouPlusClick:el,onShopAnchorMouseEnter:ei=()=>{},onShopAnchorMouseLeave:eo=()=>{},isShowAdCard:ea=!1,sideBarShow:ed,slardarInstance:er,defaultIsPageFullScreen:es,avatarTipText:eu,LiveSliderCard:ec,onDislike:eI,disableShortCut:eE,isDislike:eN,isShowShopSideCard:eP,splashAdStatus:eS,changeSplashAdStatus:eL,onReady:eA,disableFullScreenSearchBar:ek=!1,useNewUserSoundGuide:ej,chapterProps:eD,recommendTagProps:eR,canShowListenVideo:eM=!1,listenFeedNextAwemeInfo:eF,listenFeedPrevAwemeInfo:eB,aiNoteProps:eO,config:eV,isShowAiCard:eU}=e,{isiPad:eH,isMobile:eG}=(0,M.X)(),ez=(0,e$.n)(),eZ=(0,m.useMemo)(()=>(0,t1.GP)(c),[c]),{isMainland:eK,isWebMiniWin:eQ,pipWindow:eY,isListenVideoMiniWin:eq}=(0,iu.Iq)(e=>{let{isMainland:t,isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:n}=e;return{isMainland:t,isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:n}}),{isClientMiniWin:eJ,isCssFullScreen:eX,isFullScreen:e0,setIsSideBarShowFunc:e1,setSlideVideoTab:e2}=(0,m.useContext)(eT.C),{hasChapterBar:e4}=function(e){let[t,l]=(0,m.useState)(!1),i=(0,e$.n)(),n=(0,m.useMemo)(()=>(0,im.d)(e),[e]);return(0,m.useEffect)(()=>{if(i){var e,t;let o=e=>{if((null==e?void 0:e.eventType)==="firstFrame"||i.currentTime||(0,ee.r)()){var t,a;null===(t=i.off)||void 0===t||t.call(i,ih.FP.FIRST_FRAME,o),null===(a=i.off)||void 0===a||a.call(i,ih.FP.TIMEUPDATE,o),l(n)}};return null===(e=i.on)||void 0===e||e.call(i,ih.FP.FIRST_FRAME,o),null===(t=i.on)||void 0===t||t.call(i,ih.FP.TIMEUPDATE,o),()=>{var e,t;null===(e=i.off)||void 0===e||e.call(i,ih.FP.FIRST_FRAME,o),null===(t=i.off)||void 0===t||t.call(i,ih.FP.TIMEUPDATE,o)}}},[i,n]),(0,m.useEffect)(()=>{},[]),{hasChapterBar:t}}(c),[e3,e5]=(0,m.useState)(!1),e7=(0,m.useCallback)(()=>e5(!0),[]),e9=(0,m.useCallback)(()=>e5(!1),[]);(0,m.useEffect)(()=>{z&&e5(!1)},[z]);let te=(0,m.useMemo)(()=>eQ||eJ||eq,[eQ,eJ,eq]),{enablePip:tt}=(0,t5.$)({abtestData:p,awemeInfo:c});(0,lZ.g)({player:ez,awemeInfo:c}),(0,l$.G)({player:ez,awemeInfo:c,scene:"pc_web",abtestData:p}),(0,t7.V)({awemeInfo:c}),(0,m.useEffect)(()=>{i&&!z&&Z.Le.setConfig(Z.gI.InnerAutoPlay,null)},[i,z,c]);let tl=(0,m.useMemo)(()=>(0,ex.D)(c),[c]),ti=(0,m.useMemo)(()=>(0,t1.zJ)(c),[c]);(0,l6.u)({awemeInfo:c,player:ez});let{isDanmuIcon:tn,hideList:ta,isChapterIcon:td,chapterMaxWidth:tr,isAiNoteIcon:ts}=(0,ln.Cy)({isActive:i,abtestData:p,player:ez,hasChapter:e4,hasAiNote:null==eO?void 0:eO.useable,isMiniWin:te,showAutoPlay:!ti,showInnerAutoplay:z&&!ti,showFakeScreen:(null==c?void 0:c.awemeType)!==x.e.Note,showPlayBackRatio:(null==c?void 0:c.awemeType)!==x.e.Note,showWatchLater:tl,isClientMiniWin:eJ});(0,m.useMemo)(()=>{var e;return[...(null==O?void 0:O.notInterestingIcon)?[]:[null===(e=ev.getShortcut().dislike)||void 0===e?void 0:e.badgeText],...W||[]]},[null==O?void 0:O.notInterestingIcon,W]);let tu=(0,m.useMemo)(()=>(0,em.Jt)(c),[c]),tc=(0,m.useMemo)(()=>(0,em.gc)(c),[c]),tv=(0,m.useMemo)(()=>(0,en.p)(c),[c]),tm=eS===V.QB.Normal||!tv;(0,m.useEffect)(()=>{var e,t,l,i;if(!!a&&!!tv)return eS===V.QB.Fullscreen?((0,eb.o)({pauseCustomShortcut:!0,pausePlayControlShortcut:!0},"splashAd"),lm.DJ.pause(["close","help"]),null==ez||null===(t=ez.controls)||void 0===t||null===(e=t.hide)||void 0===e||e.call(t)):(null==ez||null===(i=ez.controls)||void 0===i||null===(l=i.show)||void 0===l||l.call(i),lm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")),()=>{lm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")}},[eS]),(0,lo._)({awemeInfo:c,prevAwemeInfo:_,isInnerFeedModel:z&&i});let{isShowGuideDownload:t_}=iI({abtestData:p,awemeInfo:c,isActive:i,isLogin:null==S?void 0:S.isLogin});(0,m.useEffect)(()=>{2===s&&Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!1})},[s]),(0,ls.Q)({abtestData:p,player:ez,isActive:i,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:tu&&(0,em.Gu)(c)&&J?[]:["showAdDetail"],awemeInfo:c,showAdMenu:tu&&(0,em.Gu)(c),disableShortCut:eE,disableAllNativeShortCut:eE,isClientMiniWin:eJ,pipWindow:eY,isLogin:null==S?void 0:S.isLogin}),d_({player:ez,isActive:i,disableShortCut:eE}),(0,w.C)(eC.w3.components.recommend_video),(0,t2.P)({player:ez});let{anchorList:tf,hasJingxuanActivity:tp}=(0,ir.e)({abtestData:p,awemeInfo:c}),th=(0,io.$)({abTestData:p,awemeInfo:c})&&!tp;return(0,m.useEffect)(()=>{if(i&&!z&&ez)return(0,Z.xL)(c,ez,"show"),()=>{(0,Z.xL)(c,ez,"leave")}},[i,c,z]),(0,lK.T)({isAuthorCardShow:A,isFirst:a,isLast:r,isShowRelatedCard:k,canUseListenFeed:!0,listenFeedPrevAwemeInfo:eB,listenFeedNextAwemeInfo:eF,prevAwemeInfo:_,nextAwemeInfo:v,isInnerFeed:z,isActive:i}),null==p||p.reuseVideo,(0,u.jsxs)(u.Fragment,{children:[!ek&&(eX||e0)&&i&&!te&&(0,u.jsx)(tX.default,{scene:b.lT.Recommend,awemeInfo:c,abtestData:p,userInfo:S,isMiniWin:te,isActive:i,isInnerFeed:z,player:ez}),(0,u.jsx)(iC.V,{awemeInfo:c,isActive:i,timeout:(0,$.b_)()?4e3:2e3,isFirst:a}),(0,u.jsx)(iN.p,{isActive:i,onRegisterSuccess:()=>{i&&(0,t4.g)(ez)},scene:b.lT.Recommend,disableShortCut:eE}),(0,u.jsx)(iP.E,{isActive:i,awemeInfo:c,abtestData:p,userInfo:S,deleteCurrentSwiper:h,config:eV,scene:b.lT.Recommend,isNext:n,currentIndex:s}),eZ?null:(0,u.jsx)(iS.Z,{awemeInfo:c,userInfo:S,isActive:i,isNext:n,isPrev:o,logParams:T,index:s}),j,(0,u.jsx)(iL.P,{isActive:i,awemeInfo:c,abtestData:p}),tm&&(0,u.jsx)("div",{className:g()(ip.default.splashAdComponent,{[ip.default.enterTransition]:tv&&!z}),children:(0,u.jsxs)(iA.n,{isActive:i,isMiniWin:te,awemeInfo:c,className:U,from:b.lT.Recommend,children:[B&&!eJ||eQ?(0,u.jsx)(ik.I,{playPrevFunc:P,playNextFunc:f,disablePrev:a&&!(A||k)||(A||k)&&!_,disableNext:r&&!(A||k)||(A||k)&&!v,className:g()(ip.default.playSwitchContainer,e6.m4,"filter-bg",{[ip.default.isWebMiniWinSwitch]:eQ})}):null,!eJ&&(0,u.jsx)(e8.InteractionNew,{canShowListenVideo:eM,playPrevFunc:P,playNextFunc:f,listenFeedPrevAwemeInfo:eB,listenFeedNextAwemeInfo:eF,prevAwemeInfo:_,nextAwemeInfo:v,isAuthorCardShow:A,isShowRelatedCard:k,isFirst:a,isLast:r,canUseListenFeed:!0,actionFollow:H,actionUnFollow:G,awemeInfo:c,toggleComment:e=>(!z&&(0,Z.xL)(c,ez,"clickComment"),null==y?void 0:y(e)),loginUserInfo:S,loginDispatch:L,deleteCurrentSwiper:h,fullScreenTarget:E,onAvatarClick:(e,t)=>(!z&&(0,Z.xL)(c,ez,"head"),null==I?void 0:I(e,t)),onFollowBtnClick:()=>{!z&&(0,Z.xL)(c,ez,"follow")},onShareToFriend:()=>{!z&&(0,Z.xL)(c,ez,"share")},onDouPlusClick:el,abtestData:p,videoToast:C,isActive:i,followHandler:N,reportExtraParams:T,recordPreferVideoSwitch:!z,canShowAvatarFollowBtn:!tc,canShowAvatarAdBtn:tc,canShowAvatarTip:!(tu&&(0,em.Gu)(c)),canShowDislikeTip:!0,moreBoxShowList:(0,d._)({shortcutList:!0},O),className:e6.m4,avatarTipText:eu,showMusicDetail:!(tu&&(0,em.Gu)(c)),from:b.lT.Recommend,LiveSliderCard:ec,onRelatedClick:Q,videoTags:F,onDislike:eI,isInnerFeed:z,scene:"aweme_video_feed_pc",isShowAiCard:eU,recommendTriggered:null==eR?void 0:eR.recommended,showRecommendToFriend:!!eR})]})}),ej?(0,u.jsx)(iG,{isActive:i,awemeId:null==c?void 0:c.awemeId,isShowGuide:R}):(0,u.jsx)(iz.x,{isActive:i,awemeInfo:c,abtestData:p,isShowGuide:R,scene:b.lT.Recommend}),(0,u.jsx)(iZ.V,{awemeInfo:c,isActive:i}),(0,u.jsx)(i0,{awemeInfo:c,isActive:i,isUseOneCheck:z,playPrevFunc:P,playNextFunc:f,deleteCurrentSwiper:h}),z||ti?null:(0,u.jsx)(i1.kL,{isActive:i,awemeInfo:c,playNextFunc:f,ablePlayNext:!(r&&!(A||k)||(A||k)&&!v),shortcutDisabled:eH||eG,scene:b.lT.Recommend}),z?(0,u.jsx)(i2.Ot,{isActive:i,awemeInfo:c,playPrevFunc:P,playNextFunc:f,ablePlayPrev:!((A||k)&&!_),ablePlayNext:!((A||k)&&!v),hide:ta.some(e=>e[0]===ln.p7.InnerAutoPlayer)}):null,te?null:(0,u.jsx)(i4.t,{isActive:i,userInfo:S,dispatch:L,abtestData:p,awemeInfo:c,currentIndex:s,isInnerFeed:z}),ti?null:(0,u.jsx)(i3.SD,{isActive:i,awemeInfo:c,abtestData:p,isInnerFeed:z,isOutFeed:!z,hide:ta.some(e=>e[0]===ln.p7.Clear)}),tl?(0,u.jsx)(to.vq,{isActive:i,awemeInfo:c,abtest:p,isLogin:null==S?void 0:S.isLogin,loginDispatch:L,toast:C,logParams:T,canCancelWatchLater:!0}):null,tt&&(0,u.jsx)(i5._,{isActive:i,awemeInfo:c,abtestData:p}),(0,u.jsx)(i6.k,{isActive:i,onVolumeShortCutChange:()=>{(0,ib.t)(ez)}}),(0,u.jsx)(i8.g,{isActive:i,abtestData:p,awemeInfo:c}),(0,u.jsx)(i7.b,{isActive:i}),(0,u.jsx)(nt,{isActive:i}),(0,u.jsx)(ni,{isActive:i,awemeInfo:c}),tu&&(0,u.jsx)(na,{awemeInfo:c,isActive:i}),tu&&(0,u.jsx)(ng,{awemeInfo:c,toast:C,abtestData:p}),"s",(0,u.jsx)(ny.W8,{slot:iE.o.CHILDREN,disable:tu&&(0,em.Gu)(c),isActive:i,awemeInfo:c,abtest:p,logParams:T,loginBlock:!(null==S?void 0:S.isLogin)&&!eQ,loginDispatch:L,speedType:(0,$.G6)()?e_.$.Safari:e_.$.Normal}),!te&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nw.I,{isActive:i,fullScreenTarget:E,abtestData:p,isLogin:!!(null==S?void 0:S.isLogin),loginDispatch:L}),(0,u.jsx)(tb.Danmaku,{isActive:i,awemeInfo:c,userInfo:S,loginDispatch:L,abtestData:p,isDanmuIcon:tn}),(0,u.jsx)(tE.e,{isActive:i,awemeInfo:c,abtestData:p,aiNoteProps:eO,isAiNoteIcon:ts}),e4&&(0,u.jsx)(nk,{isActive:i,userInfo:S,awemeInfo:c,isChapterIcon:td,chapterProps:eD,chapterMaxWidth:tr}),(0,u.jsx)(nj.V,{awemeInfo:c,logParams:T,isActive:i,defaultIsPageFullScreen:es}),(0,u.jsxs)(nD.r,{children:[!!(tm&&th&&!(null==eR?void 0:eR.recommendTagType))&&(0,u.jsx)(io.n,{scene:"player",awemeInfo:c}),!!(tm&&!(0,id.$m)(c)&&(null==eR?void 0:eR.recommendTagType)&&!(null==eR?void 0:eR.isShowVideoInfoSideCard))&&(0,u.jsx)(nH,(0,d._)({userInfo:S,awemeInfo:c,player:ez,abTestData:p},eR)),!tv&&tf.length>0&&(0,u.jsx)(is.E,{awemeInfo:c,anchorList:tf,openActivityCard:et,abtestData:p}),eK&&!e3&&tm&&(0,ef.n)(c)&&!(0,ep.o4)(c)&&(0,u.jsx)(nG.n,{awemeInfo:c,onClick:X,isActive:i,onMouseEnter:ei,onMouseLeave:eo}),(0,eh.A)(c)&&(0,u.jsx)(nJ,{isActive:i,awemeInfo:c,isHide:ea}),(0,eg.hj)(c)&&(0,em.Gu)(c)&&(0,u.jsx)(og,{isActive:i,awemeInfo:c}),(0,ep.o4)(c)&&(0,em.Gu)(c)&&(0,u.jsx)(oT,{isHide:eP,isActive:i,awemeInfo:c}),(0,ep.o4)(c)&&!(0,em.Gu)(c)&&(0,u.jsx)(oL,{isActive:i,awemeInfo:c}),(0,ey.L)(c)&&(0,u.jsx)(oR,{isActive:i,awemeInfo:c,isHide:ea}),(0,ew.u)(c)&&(0,u.jsx)(oV,{isActive:i,awemeInfo:c,isHide:ea}),tm&&(0,u.jsx)("div",{className:g()(ip.default.splashAdComponent,{[ip.default.enterTransition]:tv&&!z}),children:(0,u.jsx)(tQ.VideoInfoNew,{isActive:i,awemeInfo:c,userInfo:S,scene:b.lT.Recommend,isTopicLinkSearchResult:!0,videoHashtagClassName:D,videoTags:F||[],abTestData:p,isShowCreateTime:z||ed||!(tu&&(0,em.Gu)(c)||tv),canMixListen:!z,isInnerFeed:z,showGuideDownloadClient:t_,loginUserInfo:S,loginDispatch:L,fullScreenTarget:E,reportExtraParams:T,onCooperationAuthorClick:Y,isShowCooperation:q,showSideBar:ed,isShowBrandComponent:e3,onBrandComponentHide:e9,onBrandComponentShow:e7,onClickUserName:()=>{!z&&(0,Z.xL)(c,ez,"head")}})}),(0,u.jsx)(t$.H,{isActive:i,isAdAweme:tu,awemeInfo:c,abtestData:p,toast:C,playNextFunc:f})]}),tm?(0,u.jsx)(oW.h,{awemeInfo:c,isActive:i,userInfo:S,disableShortCut:eE,abtestData:p}):null,!eJ&&(0,u.jsx)(oU.q,{isActive:i,abtestData:p,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:(0,em.Gu)(c)&&tu&&J?[]:["showAdDetail"],awemeInfo:c,showEnterDetail:!(tu&&(0,em.Gu)(c)),showAdMenu:tu&&(0,em.Gu)(c),disableShortCut:eE,userInfo:S,directJumpToUser:!1,showRecommendToFriend:!!eR}),eN?null:(0,u.jsx)(oX,{isActive:i,userInfo:S,dispatch:L,abtestData:p}),!te&&(null==ta?void 0:ta.length)>0&&(0,u.jsx)(o0.g,{isActive:i,awemeInfo:c,hideList:ta,dispatch:L,abtestData:p,userInfo:S,isAdAweme:tu}),(0,u.jsx)(o1.I,{isActive:i,awemeInfo:c,logParams:T}),t_?(0,u.jsx)(o7,{isActive:i,awemeInfo:c}):null,(0,u.jsx)(o9.P,{isActive:i,controlHeight:b.fp.MidHigh,isMini:te})]}),(0,u.jsx)(ae.t,{awemeInfo:c,isActive:i}),!!(!te&&tv&&a&&eS===V.QB.Fullscreen)&&(0,u.jsx)(eW,{awemeInfo:c,playNextFunc:()=>{null==eL||eL(V.QB.Normal),f()}}),!te&&tv&&a&&!z&&(0,u.jsx)(ad,{isActive:i,awemeInfo:c,onBrandComponentShow:()=>{},onBrandComponentClose:()=>{}}),!te&&(0,em.Kf)(c)&&!z&&(0,u.jsx)(dm,{isActive:i,awemeInfo:c,onBrandComponentShow:()=>{e5(!0)},onBrandComponentClose:()=>{e5(!1)}}),(null==c?void 0:null===(t=c.chargeInfo)||void 0===t?void 0:t.is_charge_content)&&(0,u.jsx)(am,{awemeInfo:c,isActive:i,isMiniWin:te,isShowReplay:!te}),(null==c?void 0:null===(l=c.video)||void 0===l?void 0:l.duration)>18e4&&(0,u.jsx)(af,{awemeInfo:c,isActive:i,isLogin:null==S?void 0:S.isLogin,isMiniWin:te}),i&&(0,u.jsx)(ax,{}),eQ&&(0,u.jsx)(lU.U,{awemeInfo:c}),(0,u.jsx)(ak,{isActive:i,abtestData:p,awemeInfo:c}),(null==c?void 0:c.awemeType)===x.e.Note?(0,u.jsx)(da,{isActive:i,awemeInfo:c,abTestData:p,logParams:T,playNextFunc:f,playPrevFunc:P,isClientMiniWin:eJ,ablePlayPrev:!((A||k)&&!_),ablePlayNext:!((A||k)&&!v),disableShortCut:eE,isShowSideBar:ed}):null]})},dp=(0,m.memo)((0,m.forwardRef)((e,t)=>{var l;let{awemeInfo:i,abtestData:n,isActive:o,onPlayer:a,hasPlaceholder:s=!0,isPrev:c,isNext:v}=e,{isListenVideoMiniWin:_}=(0,iu.Iq)(e=>{let{isListenVideoMiniWin:t}=e;return{isListenVideoMiniWin:t}}),f=(0,m.useRef)(null),p=(0,m.useMemo)(()=>(0,en.p)(i),[i]),h=(0,m.useMemo)(()=>(0,iT.i)({awemeInfo:i,abtestData:n,enableDash:!0,scene:b.lT.Recommend}),[i,n]),y=(0,m.useMemo)(()=>o||c||v,[o,c,v]);return(0,m.useImperativeHandle)(t,()=>{var e;return{getPlayer:()=>f.current.getPlayer(),player:null===(e=f.current)||void 0===e?void 0:e.player}}),(0,u.jsxs)(ix.N,{config:h,isInitPlayer:y,style:(0,d._)({height:"100%",width:"100%"},_?{display:"none"}:{}),className:g()(ip.default.container,"MediaNotSupportStyle","lowPopup","douyin-recommend-player",{"chapter-player-style":(0,im.d)(i)}),ref:f,scene:b.lT.Recommend,onPlayerCreated:a,abtestData:n,enableProgressPlugin:!(0,i_.gi)(i),children:[(null==n?void 0:null===(l=n.recCoverOptim)||void 0===l?void 0:l.cover)||!s||p?null:(0,u.jsx)(dd._,{awemeInfo:i,isActive:o,controlHeight:p?b.fp.SplashControls:b.fp.MidHigh,abtestData:n,slot:iE.o.START}),(0,u.jsx)(df,(0,r._)((0,d._)({},e),{config:h,slot:iE.o.CHILDREN}))]})}));var dh=l("140447"),dg=l("543763"),dy=l("250103"),dw=l("114746"),dI=l("842602");let dx=e=>{let{log:t,isFromLynx:l,getLynxInfo:i}=(0,l2.H)(),{swiper:n,setAwemeInfoList:o,changeSplashAdStatus:a}=e,d=(0,m.useCallback)(e=>{t("useAwemeInfoListByLynx updateAwemeInfoList"),null==o||o((0,dI.TN)({awemeList:e}))},[o]);(0,F.C)(()=>{let e=q.listen(q.EVENT.changeLynxAwemeList,d);return()=>{null==e||e()}},[d]),(0,m.useEffect)(()=>{l()&&(t("usePlayByLynx changeSplashAdStatus"),null==a||a(V.QB.Normal))},[a,l]);let[r,s]=(0,m.useState)(0),u=(0,m.useCallback)(e=>{t("usePlayByLynx updateSwiperIndex",e),q.emit(q.EVENT.LynxSwiperFinish,-1),s(e)},[]);(0,m.useEffect)(()=>{var e;if(!(0,N.DT)())return()=>{};let l=null===(e=i())||void 0===e?void 0:e.swiperIndex;void 0!==l&&(t("usePlayByLynx updateSwiperIndex2",l),u(l));let n=q.listen(q.EVENT.changeLynxSwiperIndex,u);return()=>{n()}},[]),(0,m.useEffect)(()=>{if(!!(0,N.DT)())(null==n?void 0:n.slideTo)&&(t("usePlayByLynx slideTo",n),n.slideTo(r,0),t("usePlayByLynx LynxSwiperFinish"),q.emit(q.EVENT.LynxSwiperFinish,r))},[n,r])};var db=l("248964"),dE=l("49279"),dT=l("561756"),dC=l("634165"),dN=l("950672"),dP=l("647291"),dS=l("634362"),dL=l("730510");let dA=e=>{var t;let{awemeInfo:l,removeSlideListButton:i,isFromLynx:n}=e,o=(0,p.d)(),a=null!==(t=null==o?void 0:o.nonce)&&void 0!==t?t:"argus-csp-token";return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("script",{nonce:a,dangerouslySetInnerHTML:{__html:`
        try {
          if (window.__QUICK_PLAYER && window.__QUICK_PLAYER.createQuickPlayer) {
            window.__QUICK_PLAYER.createQuickPlayer(${JSON.stringify({awemeInfo:l,removeSlideListButton:i,isFromLynx:n})});
          }
        } catch (e) {
          console.log('createQuickPlayer error', e);
          if (window.__pace_load_deferred_scripts) {
            window.__pace_load_deferred_scripts();
          }
        }
      `}}),(0,u.jsx)("script",{nonce:a,dangerouslySetInnerHTML:{__html:`
        try {
          if (window.__pace_load_deferred_scripts) {
            window.__pace_load_deferred_scripts();
          }
        } catch (e) {}
      `}})]})};var dk=l("945388"),dj=l("85084");l("567754");let dD=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:"",defaultTitle:dk.SITE_DEFAULT_TITLE},{from:t,defaultTitle:l}=e;return t&&dk.SITE_NAME_MAP.get(t)||l};var dR=l("265482");let dM=e=>{let{isSpider:t,redirectFrom:l}=e,i=t?dk.SITE_DEFAULT_TITLE:dD({from:l,defaultTitle:dk.SITE_DEFAULT_TITLE}),n="抖音让每一个人看见并连接更大的世界，鼓励表达、沟通和记录，激发创造，丰富人们的精神世界，让现实生活更美好。",o="抖音,抖音音乐,抖音短视频,抖音官网,amemv,抖音app,抖音app下载";return(0,eP.o)(()=>{(0,dj.J)({title:i,description:n,keywords:o})},[]),(0,u.jsxs)(dR.Z,{children:[(0,u.jsx)("title",{children:i}),(0,u.jsx)("meta",{name:"description",content:n}),(0,u.jsx)("meta",{name:"keywords",content:o}),(0,u.jsx)("link",{rel:"canonical",href:"https://www.douyin.com/"})]})};var dF=l("696745"),dB=l.p+"media/blackBg_big.b7bedc994a938699.png",dO={recommendFakeVideo:"hMkBqQ7u",blackBg:"neudZ7lh",controls:"UgUrZuwu",progress:"wCAmkeP2",leftWrap:"PPANNJWy",playBtn:"CCfCSjWc",time:"xV9Zy4WW",timeSeparator:"xy8j9Drk",loading:"ErU_JjFW"};let dV=(0,m.forwardRef)((e,t)=>{var l;let{awemeInfo:i,isLive:n=!1}=e,o=n?0:(0,en.p)(i)?b.fp.SplashControls:b.fp.MidHigh;return(0,u.jsxs)("div",{ref:t,className:g()(dO.recommendFakeVideo,{[dO.blackBg]:!0}),id:"recommend-fake-video",style:{paddingBottom:`${o}px`,backgroundImage:`url(${dB})`},children:[(0,u.jsx)("img",{id:"recommend-fake-video-img",src:dB,alt:"",width:"0",height:"0",style:{display:"none"}}),(0,u.jsxs)("div",{className:dO.controls,style:{height:`${o}px`},children:[(0,u.jsx)("div",{className:dO.progress}),(0,u.jsx)("div",{style:{height:`${o-2}px`},children:(0,u.jsxs)("div",{className:dO.leftWrap,children:[(0,u.jsx)("div",{className:dO.playBtn}),(0,u.jsxs)("div",{className:dO.time,children:[(0,u.jsx)("span",{children:"00:00"}),(0,u.jsx)("span",{className:dO.timeSeparator,children:"/"}),(0,u.jsx)("span",{children:(0,nF.$y)((null==i?void 0:null===(l=i.video)||void 0===l?void 0:l.duration)||0)})]})]})})]}),(0,u.jsx)(dF.b,{usePerfLoading:!1,className:dO.loading,text:"加载中",slot:es.t6.INSIDE})]})});var dW=l("458343"),dU=l("477667"),dH=l("66627"),dG={widgetMiniWinGuideModalInner:"uguIOeRm",close:"Jw0xzeIQ",content:"u1OtEza9",viewInfo:"IQ03yMaa",settingInfo:"whtL4hj9",infoTitle:"AP9BKf0O",infoDesc:"lPXtDI4e",setButton:"EiSHWGNh",panelContainer:"cMRwBCfY",guideContainer:"YENX1ye1",guideHeader:"sm0ckyJ8",closeButton:"xlIAK1CR",topTip:"rhKt7r4J",subTip:"vKfVPruY",buttonArea:"Uh5pLx6z",button:"b1NosYME"},dz=l("167951");let dZ=()=>{var e,t,l,i;let n=Date.now(),o=null!==(t=null===(e=(0,dz.Es)())||void 0===e?void 0:e.user_unique_id)&&void 0!==t?t:"",{showTimes:a=0,lastShowTime:d=0}=null!==(i=(null!==(l=(0,lJ.$o)(lX.LocalStorageKeys.WidgetMiniWinGuideTimes))&&void 0!==l?l:{})[o])&&void 0!==i?i:{},r=!1;return a<3&&n-d>432e6&&(r=!0),!!r||!1},dK=()=>{var e,t,l,i;let n=Date.now(),o=null!==(t=null===(e=(0,dz.Es)())||void 0===e?void 0:e.user_unique_id)&&void 0!==t?t:"",a=null!==(l=(0,lJ.$o)(lX.LocalStorageKeys.WidgetMiniWinGuideTimes))&&void 0!==l?l:{},{showTimes:s=0}=null!==(i=a[o])&&void 0!==i?i:{};(0,lJ.qQ)(lX.LocalStorageKeys.WidgetMiniWinGuideTimes,(0,r._)((0,d._)({},a),{[o]:{showTimes:s+1,lastShowTime:n}}))};var dQ=l("2165");let d$=e=>{let{abTestData:t}=e,[l,i]=(0,m.useState)(!1),{attemptOpen:n,executeClose:o}=(0,iD.B)({popName:"添加小窗",onOpen:()=>{i(!0)},onClose:()=>{i(!1)}}),a=(0,m.useCallback)(()=>{o(),dQ.Z.sendLog("smallWindowToastClick",{click_result:"close"})},[]),d=(0,m.useCallback)(()=>{eS.invoke("setDesktopMiniWindowWidgetState",{state:!0,from:"web"}),o(),dQ.Z.sendLog("smallWindowToastClick",{click_result:"add"})},[]);return((0,m.useEffect)(()=>{l&&dQ.Z.sendLog("smallWindowToastShow",{})},[l]),(0,m.useEffect)(()=>{let e=(0,N.FJ)().awemePcClient;if((0,i9.dz)()&&e&&(0,dH.y)(e,">=","3.7.0"))return q.listen(q.EVENT.changeMinWindows,async e=>{let{event:t,source:l=""}=e,i=(await eS.invoke("isDesktopMiniWindowWidgetAutoAdd")).data;!(0,i9.O)()&&"close"===t&&!["client","resize"].includes(l)&&!i&&dZ()&&n({afterCallback:()=>{dK()}}),"open"===t&&o()})},[]),(0,eP.o)(()=>{let e="WidgetMiniWinGuideModal";return l&&(0,eb.o)({pausePlayControlShortcut:!0,pauseCustomShortcut:!0,pauseGlobalShortcut:!0},e),()=>{(0,eb.m)(e)}},[l]),(0,dW.w)(()=>{o()},[]),l)?(0,u.jsx)("div",{className:g()(dG.panelContainer,dG.panelContainerAdjust),children:(0,u.jsxs)("div",{className:dG.guideContainer,onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:dG.guideHeader,children:[(0,u.jsx)(eF.Z,{src:dU.Z,className:dG.closeButton,width:28,height:28,onClick:a}),(0,u.jsx)("div",{className:dG.viewInfo,children:(0,u.jsx)("video",{src:"//p-pc-weboff.byteimg.com/tos-cn-i-9r5gewecjs/widget-mini-window.mp4",autoPlay:!0,muted:!0,loop:!0})})]}),(0,u.jsxs)("div",{className:dG.content,children:[(0,u.jsx)("div",{className:dG.topTip,children:"添加「小窗播放」到桌面"}),(0,u.jsx)("div",{className:dG.subTip,children:"添加后，支持快速开启「小窗播放」看抖音"}),(0,u.jsx)("div",{className:dG.buttonArea,children:(0,u.jsx)(tL.Button,{theme:"solid",type:"primary",className:dG.button,onClick:d,children:"立即添加"})})]})]})}):(0,u.jsx)(u.Fragment,{})};var dY={swiperItem:"P2uoik9n",content:"hu8OAx_c",clientMiniWin:"toDpmMrJ",noSelect:"oMGCEkxE",splashTransition:"HPVeSh0l"};let dq=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,m.useEffect)(()=>{!e&&(window.cacheDebugVids=e=>{(0,lb.setCookiesItem)(lX.CookieKeys.DebugVids,JSON.stringify(e)),window.location.reload()},window.clearDebugVids=e=>{(0,lb.removeCookiesItem)(lX.CookieKeys.DebugVids),window.location.reload()})},[])},dJ=e=>{let{awemeInfoList:t,abTestData:l}=e,[i,n]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{let e;let l=null==t?void 0:t[0];return(null==t?void 0:t.length)?!i&&(null==l?void 0:l.awemeType)!==x.e.Normal&&(n(!0),clearTimeout(e)):e=setTimeout(()=>n(!0),5e3),()=>{clearTimeout(e)}},[t,i,null==l?void 0:l.longtaskOpt]),(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.videoPlay,()=>{n(!0)}),t=q.listen(q.EVENT.videoPlayPrevent,()=>{n(!0)});return()=>{e(),t()}},[]),{isFirstScreenFrame:i}};var dX=l("130556");let d0=()=>{(0,m.useEffect)(()=>{(0,G.B1)("page_recommend_render");try{if(Z.Le.getConfig(Z.gI.ReportFirstFeedCoverShow)){Z.Le.setConfig(Z.gI.ReportFirstFeedCoverShow,!1);let e=new PerformanceObserver(t=>{for(let l of t.getEntries())if((null==l?void 0:l.identifier)==="lcp_ele"){e.disconnect(),(0,dX.l)(()=>{var e,t,i,n;let o=(0,G.fX)(),a={first_cover_show:null==l?void 0:l.startTime,new_player:null==o?void 0:null===(e=o.new_player)||void 0===e?void 0:e.startTime,play_init_duration:(0,G.L8)("player_init","new_player","player_ready"),feed_request_start:null==o?void 0:null===(t=o.app_request_start)||void 0===t?void 0:t.startTime,feed_request_duration:(0,G.L8)("request_duration","app_request_start","app_request_end"),app_recommend_page:null==o?void 0:null===(i=o.page_recommend)||void 0===i?void 0:i.startTime,recommend_page_component:null==o?void 0:null===(n=o.page_recommend_render)||void 0===n?void 0:n.startTime};dQ.Z.sendLog("recommendProcessStat",a)});return}});e.observe({type:"element",buffered:!0})}}catch(e){}},[])},d1="RECOMMENTFETCHERROR",d2=()=>{(0,m.useEffect)(()=>{let e=localStorage.getItem(d1);e&&(localStorage.removeItem(d1),Y.oe.event.error({name:Y.Mo.PrefetchFailed,report:{message:e,isSync:!0}}))},[])};var d4=l("583165");let d3="RECOMMEND_USE_CACHE",d5=()=>{(0,m.useEffect)(()=>{let e=Number((0,d4.tN)("recommendFeedCache")),t=Number(localStorage.getItem(d3));t&&(localStorage.removeItem(d3),Y.oe.event.info({name:Y.Mo.RecommendUseCache,report:{recommendFeedCache:e,isExpire:1!==t}}))},[])},d6=e=>{let{list:t,ssrStatusCode:l,csrStatusCode:i,refreshIndex:n}=e,o=(0,m.useRef)(null);(0,m.useEffect)(()=>{t&&t.length>0?clearTimeout(o.current):!o.current&&(o.current=setTimeout(()=>{!(null==t?void 0:t.length)&&(Y.oe.event.error({name:Y.Mo.FirstScreenFailed}),dQ.Z.sendLog("recommendFirstFailed",{ssr_status_code:l,csr_status_code:i,refresh_index:n}))},3e4))},[t])},d8=e=>{let{abTestData:t,swiper:i}=e,n=(0,m.useRef)(250);return(0,m.useEffect)(()=>{let e;(0,Q.N)(async()=>{let{Pylon:t,EBiz:i}=await l.e("74770").then(l.bind(l,198991));e=new t({biz:i.DOUYIN_WEB_RECOMMEND})},!1);let o=()=>{try{let{slideConfig:d,preloadConfig:r}=(null==t?void 0:t.pageSpeed)||{},{nextPlayer:s}=window;if(d&&e){let t=e.strategyInference({scene:"feed_slide",abConfig:{slideStrategy:[6,12]}});0===t?n.current=d.normal:2===t?n.current=d.slow:1===t&&(n.current=d.fast)}if(r){var l,i,o,a;(null==s?void 0:null===(l=s.preLoadData)||void 0===l?void 0:l.byteLength)||(null==s?void 0:null===(a=s.plugins)||void 0===a?void 0:null===(o=a.mp4encryptplayer)||void 0===o?void 0:null===(i=o.preLoadData)||void 0===i?void 0:i.byteLength)?n.current=r.preload:n.current=r.noPreload}}catch(e){}};if(i&&(null==t?void 0:t.pageSpeed))return i.on("slideChange",o),()=>{i.off("slideChange",o)}},[i,null==t?void 0:t.pageSpeed]),{pageSpeed:n.current}};var d7=l("679105"),d9=l("298432"),re=l("399629"),rt=l("333760"),rl=l("257858");l("882732");var ri=l("596161");let rn=()=>"insert"===(0,K.Rs)("feed_operation"),ro=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?["feed_operation","aweme_id"]:["feed_operation","aweme_id","play_progress","from_device_id","record_type"];(0,K.U$)(t);try{let e=new URL(window.location.href);t.forEach(t=>e.searchParams.delete(t)),history.replaceState(null,"",e.toString())}catch(e){}},ra=()=>{let e=(0,K.Rs)("aweme_id");return null!=e?e:null},rd=e=>{if(e){var t;e.continationInfo={playProgress:Number(null!==(t=(0,K.Rs)("play_progress"))&&void 0!==t?t:0),continationVideoAlreadyConsume:!1,fromDeviceId:(0,K.Rs)("from_device_id"),recordType:(0,K.Rs)("record_type"),urlSource:(0,K.Rs)("url_source"),enterFromOnCellphone:(0,K.Rs)("enter_from_on_cellphone"),previousPageOnCellphone:(0,K.Rs)("previous_page_on_cellphone"),isLandscapeStatusOnCellphone:Number((0,K.Rs)("is_landscape_status_on_cellphone")),enterMethodOnCellphone:(0,K.Rs)("enter_method_on_cellphone"),itemDuration:Number((0,K.Rs)("item_duration")),fromUserId:(0,K.Rs)("from_user_id"),fromAppId:Number((0,K.Rs)("from_app_id"))}}return e},rr=e=>{let{urlSource:t,itemDuration:l,enterFromOnCellphone:i,previousPageOnCellphone:n,isLandscapeStatusOnCellphone:o,enterMethodOnCellphone:a,fromDeviceId:d,fromUserId:r,fromAppId:s}=(null==e?void 0:e.continationInfo)||{};"app_continued"===t&&(dQ.Z.sendLog("continuingRemindShow",{scene:"video",enter_from_on_cellphone:i,previous_page_on_cellphone:n,is_landscape_status_on_cellphone:o,enter_method_on_cellphone:a,from_device_id:d,from_user_id:r,item_duration:l,aweme_type:String(null==e?void 0:e.awemeType),item_id:null==e?void 0:e.awemeId,from_app_name:ri.AppID2AppName[(null!=s?s:"").toString()]}),nv.F.info("正在播放手机端的视频"))},rs={PLAY_PROGRESS:30,CONTINUE_ALLOW:600,VIDEO_FILTER:[[60,300,60],[300,600,100],[600,-1,150]]},ru=()=>Math.floor(Date.now()/1e3),rc=e=>{let{setAwemeInfoList:t,swiper:l,userInfo:i}=e,n=(0,rt.U7)();(0,m.useEffect)(()=>{if(l)return q.listen(q.EVENT.recommendInsertVideo,async e=>{rr(e),t(t=>{eS.invoke("mainWindowShowView");let i=t.findIndex(t=>(null==t?void 0:t.awemeId)===(null==e?void 0:e.awemeId));if(setTimeout(()=>{q.emit(q.EVENT.triggerModalPlayerClose),q.emit(q.EVENT.closeImConversation)}),-1===i)return t.splice(l.activeIndex,-1,e),[...t];{var n,o,a;let r=t[i];return(r.continationInfo=(0,d._)({},null!==(n=null==e?void 0:e.continationInfo)&&void 0!==n?n:{}),i<l.activeIndex)?(t.splice(i,1),t.splice(l.activeIndex-1,-1,r),l.slideTo(l.activeIndex-1,0),[...t]):i>l.activeIndex?(t.splice(i,1),t.splice(l.activeIndex,-1,r),[...t]):((null===(o=window.player)||void 0===o?void 0:o.seek)&&"number"==typeof(null==e?void 0:null===(a=e.continationInfo)||void 0===a?void 0:a.playProgress)&&window.player.seek(e.continationInfo.playProgress),t)}})})},[l]);let o=e=>{var t;let{awemeInfo:l}=e;l.continationInfo={playProgress:e.playProgress,urlSource:"pc_continued"},q.emit(q.EVENT.webFeedPushMessage,{userId:null===(t=l.authorInfo)||void 0===t?void 0:t.uid,itemId:l.awemeId,itemType:l.awemeType,playTime:e.playProgress,cover:l.video.cover,fromDeviceId:"",fromDeviceType:e.toClient,recordType:e.recordType,awemeInfo:l})},a=(0,m.useCallback)(async()=>{var e,t,l,i,n,o;let a="app_continued"===(0,K.Rs)("url_source"),d=Number((0,K.Rs)("from_app_id")),r=ra();if(!r)return;let s=await (0,iy.m_)({awemeId:r,originType:rl.F.RecommendInsert}),u=null!==(l=null==s?void 0:s.detail)&&void 0!==l?l:{};if(rd(u),ro(),a&&((null==s?void 0:s.statusCode)!==0||!u||(null==u?void 0:null===(e=u.chargeInfo)||void 0===e?void 0:e.is_charge_content))&&dQ.Z.sendLog("continued_broadcast_receive_sync_message",{scene:"video",stage:"fetch_aweme_fail",stage_detail:"recommend",item_id:r,status_code:null==s?void 0:s.statusCode,log_pb:null==s?void 0:s.logPb,filter_reason:null==s?void 0:null===(i=s.filterDetail)||void 0===i?void 0:i.filterReason,filter_detail:null==s?void 0:null===(n=s.filterDetail)||void 0===n?void 0:n.detailMsg,is_charge_video:!!(null==u?void 0:null===(o=u.chargeInfo)||void 0===o?void 0:o.is_charge_content),from_app_id:d}),null==u?!void 0:null===(t=u.chargeInfo)||void 0===t?!void 0:!t.is_charge_content)q.emit(q.EVENT.recommendInsertVideo,u)},[]),r=(0,m.useCallback)(async()=>{var e,t,l,a,d,r,s,u,c,v;if(!n||![d9.b.Default,d9.b.Open].includes(null!==(l=null==i?void 0:null===(e=i.info)||void 0===e?void 0:e.continuationState)&&void 0!==l?l:0))return;let m=await (0,re.mZ)();if(m.liveMulticastInfo){null===(s=m.liveMulticastInfo.awemeInfo)||void 0===s||null===(r=s.cellRoom)||void 0===r||null===(d=r.rawdata)||void 0===d||null===(a=d.owner)||void 0===a||a.web_rid;let{recordType:e,createTime:t}=m.liveMulticastInfo,l=(0,rt.bp)({uid:i.info.uid});if(e===Number(d9.ns.manual)){o({awemeInfo:m.liveMulticastInfo.awemeInfo,recordType:m.liveMulticastInfo.recordType});return}if(e===Number(d9.ns.auto)&&(()=>{if(!(!l||t&&ru()-t>=rs.CONTINUE_ALLOW))return o({awemeInfo:m.liveMulticastInfo.awemeInfo,recordType:m.liveMulticastInfo.recordType}),!0})())return}if(0===m.statusCode&&(null===(t=m.multicastList)||void 0===t?void 0:t.length)>0){let e=m.multicastList,t=m.multicastList[0];if(t.recordType===Number(d9.ns.manual)&&(null==t?void 0:null===(c=t.awemeInfo)||void 0===c?void 0:null===(u=c.chargeInfo)||void 0===u?void 0:u.is_charge_content)){o(t);return}if(t=null,!(0,rt.bp)({uid:null==i?void 0:null===(v=i.info)||void 0===v?void 0:v.uid}))return;e.forEach(e=>{var l,i,n,o,a;if(t||e.recordType!==Number(d9.ns.auto)||(null==e?void 0:null===(i=e.awemeInfo)||void 0===i?void 0:null===(l=i.chargeInfo)||void 0===l?void 0:l.is_charge_content)||(null!==(a=null==e?void 0:e.playProgress)&&void 0!==a?a:0)<rs.PLAY_PROGRESS||e.createTime&&ru()-e.createTime>=rs.CONTINUE_ALLOW)return;let d=Math.floor((null==e?void 0:null===(o=e.awemeInfo)||void 0===o?void 0:null===(n=o.video)||void 0===n?void 0:n.duration)/1e3);if(!(d>0))return;let r=d-e.playProgress;rs.VIDEO_FILTER.forEach(l=>{(-1===l[0]||d>l[0])&&(-1===l[1]||d<=l[1])&&(-1===l[2]||r>l[2])&&(t=e)})}),t&&o(t)}},[n,n]);(0,m.useEffect)(()=>{if(i.isLogin){let e=!Z.Le.getConfig(Z.gI.FirstEnterRecommend),t=async()=>{rn()||1!==abTestData.douyinMulticastLiveNew&&r()};if(!e)return q.listen(q.EVENT.firstEnterVideoPlay,t);t()}},[i.isLogin,r]);let s=(0,c.a)();(0,m.useEffect)(()=>{rn()&&a()},[s.search]),(0,m.useEffect)(()=>()=>{Z.Le.setConfig(Z.gI.FirstEnterRecommend,!0)},[])};var rv=new iY.h({first_feed_predict:{eventName:"first_feed_predict",params:{is_correct:0,first_type:0,incorrect_reason:"",predict_duration:0,status_code:"",feed_logid:"",predict_logid:"",first_aweme_id:""}}});let rm=e=>{let t=(0,m.useRef)(!1);(0,m.useEffect)(()=>{try{var l,i,n;if(t.current||e.awemeInfoList.length<2)return;t.current=!0;let o="useCache"===window.FEED_CACHE_INFO,a="topLive"===window.FEED_CACHE_INFO,d=window.FEED_CACHE_INFO&&!o?window.FEED_CACHE_INFO:void 0,r=o?null==e?void 0:null===(l=e.awemeInfoList)||void 0===l?void 0:l[1]:null==e?void 0:null===(i=e.awemeInfoList)||void 0===i?void 0:i[0],s={is_correct:(null==r?void 0:r.awemeType)===x.e.LiveCard===a?1:0,first_type:r.awemeType,incorrect_reason:d,predict_duration:0,first_aweme_id:null===(n=e.awemeInfoList[0])||void 0===n?void 0:n.awemeId};rv.sendLog("first_feed_predict",s)}catch(e){}},[e.awemeInfoList,e.feedLogId])};var r_=l("892766"),rf=l("76223"),rp=l("492652"),rh=l("109050");l("242079"),l("851912"),l("954372");class rg{setDbObject(e){this.dbObject=e}creatTable(e,t,l,i){var n,o;let a;return!(null===(n=this.dbObject)||void 0===n?void 0:n.objectStoreNames.contains(e))&&(a=null===(o=this.dbObject)||void 0===o?void 0:o.createObjectStore(e,t||{autoIncrement:!0}),this.creatIndex(a,{indexName:l,colName:l})),a}creatIndex(e,t){var l;let{indexName:i,colName:n,indexparam:o={unique:!0}}=t;null==e||null===(l=e.createIndex)||void 0===l||l.call(e,i,n,o)}getIndexData(e,t,l){return new Promise((i,n)=>{try{var o;let a=null===(o=this.dbObject)||void 0===o?void 0:o.transaction([e]);if(!a){n();return}let d=a.objectStore(e).index(t),r=null==d?void 0:d.get(l);r.onerror=e=>{n(e)},r.onsuccess=e=>{var t;(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.result)?i(e.target.result):i(null)}}catch(e){n(e)}})}addData(e,t){return new Promise((l,i)=>{try{if(!this.dbObject){i();return}let n=this.dbObject.transaction(e,"readwrite").objectStore(e).put(t);n.onsuccess=()=>{l(!0)},n.onerror=e=>{i(e)}}catch(e){i(e)}})}remove(e,t){return new Promise((l,i)=>{try{if(!this.dbObject){i();return}let n=this.dbObject.transaction(e,"readwrite").objectStore(e).delete(t);n.onsuccess=()=>{l(!0)},n.onerror=e=>{i(e)}}catch(e){i(e)}})}constructor(e,t=1){(0,nI._)(this,"openDb",void 0),(0,nI._)(this,"dbObject",void 0),(0,nI._)(this,"indexDB",void 0),this.indexDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.indexDB&&(this.openDb=this.indexDB.open(e,t))}}let ry=e=>{var t;return null!==(t=Math.floor(e/1e3))&&void 0!==t?t:0},rw={feedCacheTable:{tableName:"feedCache",indexName:"key",keyPath:"key",keyName:"feedCache",cookieKey:"feed_cache_data"},selectedFeedCacheTable:{tableName:"selectedFeedCache",indexName:"key",keyPath:"key",keyName:"selectedFeedCache",cookieKey:"SelectedFeedCache"}};class rI{get config(){return rw[this.dbKey]}get dbInstance(){return rI.dbInstance}set expiredTime(e){this._cookieExpiredTime=ry(e)}static init(){return rI.initPromise?rI.initPromise:(rI.initPromise=new Promise((e,t)=>{var l;rI.dbInstance=new rg("FeedDataBse",3);let{openDb:i}=null!==(l=this.dbInstance)&&void 0!==l?l:{};if(!i){t();return}i.onerror=e=>{},i.onsuccess=t=>{var l,i;null===(i=this.dbInstance)||void 0===i||i.setDbObject(null==t?void 0:null===(l=t.target)||void 0===l?void 0:l.result),e(!0)},i.onupgradeneeded=e=>{var t;null===(t=this.dbInstance)||void 0===t||t.setDbObject(e.target.result),Object.values(rw).forEach(e=>{var t;null===(t=this.dbInstance)||void 0===t||t.creatTable(e.tableName,{keyPath:e.keyPath,unique:!0},e.indexName,e.keyPath)})}}),rI.initPromise)}init(){return rI.init()}async addCache(e,t){var l,i,n;await (null===(l=this.dbInstance)||void 0===l?void 0:l.addData(this.config.tableName,(0,r._)((0,d._)({},e),{key:this.config.keyName})))&&ap.Q.setItem(this.config.cookieKey,null!=t?t:{uuid:e.uuid,scmVersion:e.scmVersion,date:e.date,dyQ:null==e?void 0:null===(i=e.awemeInfo)||void 0===i?void 0:i.dyQ,awemeId:null==e?void 0:null===(n=e.awemeInfo)||void 0===n?void 0:n.awemeId,awemeInfoVersion:e.awemeInfoVersion},this._cookieExpiredTime)}hasCacheCookie(){return ap.Q.hasItem(this.config.cookieKey)}getCache(){var e;return null===(e=this.dbInstance)||void 0===e?void 0:e.getIndexData(this.config.tableName,this.config.indexName,this.config.keyName).then(e=>e).catch(e=>{})}deleteCache(){var e;return ap.Q.setItem(this.config.cookieKey,{uuid:"",scmVersion:"",date:0,awemeInfoVersion:""},0),ap.Q.removeItem(this.config.cookieKey,"/"),null===(e=this.dbInstance)||void 0===e?void 0:e.remove(this.config.tableName,this.config.keyName)}constructor(e,t=86400){(0,nI._)(this,"dbKey",void 0),(0,nI._)(this,"_cookieExpiredTime",void 0),this.dbKey=e,this._cookieExpiredTime=t}}(0,nI._)(rI,"dbInstance",void 0),(0,nI._)(rI,"initPromise",void 0);class rx{async start(){var e,t;null===(t=rx.feedDb)||void 0===t||null===(e=t.init)||void 0===e||e.call(t)}initCacheFeed(){this.getCacheAwemeInfoPromise=this.getCacheAwemeInfo()}getCacheFeed(){return this.getCacheAwemeInfoPromise}deleteCacheFeed(){var e,t;this.getCacheAwemeInfoPromise=void 0,null===(t=rx.feedDb)||void 0===t||null===(e=t.deleteCache)||void 0===e||e.call(t),this._cacheFeed=[]}getCache(){var e,t;null===(t=rx.feedDb)||void 0===t||null===(e=t.getCache)||void 0===e||e.call(t)}get cacheFeed(){return this._cacheFeed}async checkAweme(e){var t;let l=[{item_id:e.awemeId,dy_q:e.dyQ,tag:e.isAds?2:0,potential_risk_level:0,authentication_token:""}],i=await (0,iQ.Y)(l);return(0!==i.statusCode||!((null===(t=i.result)||void 0===t?void 0:t.length)>0))&&!0}async preloadVideo(e){let t=document.createElement("video");t.src=e,t.onloadeddata=()=>{}}async getCacheAwemeInfo(){var e,t,l,i,n;await (null===(t=rx.feedDb)||void 0===t?void 0:null===(e=t.init)||void 0===e?void 0:e.call(t));let o=await this.getCache(),a=null==o?void 0:o.awemeInfo;if(a&&(null==o?void 0:o.videoData)){let e=o.videoData,t=URL.createObjectURL(e),d=(a.video.bitRateList||[]).find(e=>e.dataSize===a.video.playAddrSize)||(null===(l=a.video.bitRateList)||void 0===l?void 0:l[0]);return(d&&(d.playAddr=[{src:t}],d.playApi=t),a.video.bitRateList=d?[d]:[],a.video.playAddr=[{src:t}],a.video.playAddrH265=[{src:t}],a.video.playApi=t,a.video.playApiH265=t,this.preloadVideo(t),await this.checkAweme(a))?(this._cacheFeed=[a],[a]):(null==rx||null===(n=rx.feedDb)||void 0===n||null===(i=n.deleteCache)||void 0===i||i.call(n),!1)}return!1}async canSaveCacheFeed(e){var t,l,i,n;let{isLogin:o,uuid:a,scmVersion:d,maxAge:r}=e;if(!r)return!1;let s=await (null===(l=rx.feedDb)||void 0===l?void 0:null===(t=l.getCache)||void 0===t?void 0:t.call(l));return!s||!!("3.0"!==s.awemeInfoVersion||Date.now()-s.date>r)&&(await (null===(n=rx.feedDb)||void 0===n?void 0:null===(i=n.deleteCache)||void 0===i?void 0:i.call(n)),!0)}async saveCacheFeed(e){var t,l,i,n,o,a,d;let{awemeInfo:r,uuid:s,scmVersion:u}=e,c=((null==r?void 0:null===(t=r.video)||void 0===t?void 0:t.bitRateList)||[]).find(e=>0===e.isH265&&"mp4"===e.format),v=(null==c?void 0:c.playApi)||(null==r?void 0:null===(l=r.video)||void 0===l?void 0:l.playApi),m=(null==c?void 0:c.dataSize)||(null==r?void 0:null===(i=r.video)||void 0===i?void 0:i.playAddrSize);if(r&&v&&m){let e=Date.now(),t=v,l=await fetch(v).then(e=>(t=e.url,e.blob())),i=this.isValidUrl(t)?new URL(t).host:"";if(dQ.Z.sendLog("videoCacheInfo",{host:i,cache_size:m,aweme_id:r.awemeId,group_id:r.groupId,duration:Date.now()-e,is_success:(null==l?void 0:l.size)===m?1:0,vduration:`${null==r?void 0:null===(n=r.video)||void 0===n?void 0:n.duration}`}),dQ.Z.sendLog("prfTaskDataSize",{cdn_size:m,group_id:r.groupId,vduration:null==r?void 0:null===(o=r.video)||void 0===o?void 0:o.duration,is_cache:1,enter_from:(0,T.yW)()}),(null==l?void 0:l.size)===m){let e=Date.now();return await (null===(d=rx.feedDb)||void 0===d?void 0:null===(a=d.addCache)||void 0===a?void 0:a.call(d,{uuid:s,awemeInfo:r,videoData:l,scmVersion:u,date:e,awemeInfoVersion:"3.0"})),!0}}else dQ.Z.sendLog("videoCacheInfo",{is_success:0});return!1}constructor(e=172800){return(0,nI._)(this,"getCacheAwemeInfoPromise",void 0),(0,nI._)(this,"_cacheFeed",void 0),(0,nI._)(this,"isValidUrl",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(e)}),!rx.feedDb&&(rx.feedDb=Z.Le.getConfig(Z.gI.FeedDb)||new rI("feedCacheTable",e)),this._cacheFeed=[],!rx.instance&&(rx.instance=this),rx.instance}}(0,nI._)(rx,"feedDb",void 0),(0,nI._)(rx,"instance",void 0);let rb=()=>{let e=new Date().getHours();return(!(e>=20)||!(e<=22))&&!0},rE=e=>{var t,l,i,n;let{initialRecommendAwemeList:o}=e,{userInfo:a}=(0,rp.useUserContext)(),d=(0,rf.U)(),r=(0,m.useRef)(!1),s=(0,m.useRef)(!1),u=null==a?void 0:a.isLogin,c=null==a?void 0:null===(t=a.info)||void 0===t?void 0:t.uniqueId,v=!!(null==d?void 0:null===(l=d.recommendQuickStartV1)||void 0===l?void 0:l.cache),_=null!==(n=null==d?void 0:null===(i=d.recommendQuickStartV1)||void 0===i?void 0:i.expire)&&void 0!==n?n:0,f=(0,m.useCallback)(async()=>{if(!v)return;let e=new rx(_);try{var t,l,i;if(r.current||s.current)return;dQ.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"start"});let n=(null===(t=window)||void 0===t?void 0:t.version)||"";if(!await e.canSaveCacheFeed({isLogin:u,uuid:c,scmVersion:n,maxAge:_})){s.current=!!_,dQ.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"cache not needed"});return}r.current=!0;let o=await (0,rh.Nu)({tagId:"",pullType:8,count:1,refreshIndex:1,preFetch:!1,usePassThrough:!1,useProtobuf:!1,needTranslation:void 0},null),a=null==o?void 0:null===(i=o.awemeList)||void 0===i?void 0:null===(l=i.find)||void 0===l?void 0:l.call(i,e=>{var t,l,i;return!(0,en.p)(e)&&(null==e?void 0:e.isFromSort)!==!1&&(null==e?void 0:e.awemeType)===x.e.Normal&&!(null==e?void 0:null===(t=e.chargeInfo)||void 0===t?void 0:t.is_charge_content)&&(null==e?void 0:null===(l=e.video)||void 0===l?void 0:l.playAddrSize)&&(null==e?void 0:null===(i=e.video)||void 0===i?void 0:i.playAddrSize)<=314572800});if(!a){dQ.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"aweme invalid"});return}let d=await e.saveCacheFeed({awemeInfo:a,uuid:c,scmVersion:n});dQ.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:`cache ${d?"success":"fail"}`}),r.current=!1,s.current=d}catch(e){r.current=!1}},[u,c,_,v]);(0,m.useEffect)(()=>{let e;if(!v)return;let t=async()=>{clearTimeout(e),"hidden"===document.visibilityState&&rb()&&(e=setTimeout(f,3e4))};return document.addEventListener("visibilitychange",t),()=>{clearTimeout(e),document.removeEventListener("visibilitychange",t)}},[v,f]),(0,m.useEffect)(()=>{let e;if(!v||s.current)return;let t=v?6e4:0;return t&&rb()&&(e=setTimeout(f,t)),()=>{clearTimeout(e)}},[f,v]),(0,r_.O)(!0,()=>{f()}),(0,F.C)(()=>{},[]),(0,F.C)(()=>{try{if(v&&new rx(_).start(),(null==o?void 0:o.length)&&"topLive"===Z.Le.getConfig(Z.gI.isUseVideoCache)){var e;dQ.Z.sendLog("videoCacheStepInfo",{action:"checkTopLive",info:(null==o?void 0:null===(e=o[0])||void 0===e?void 0:e.awemeType)===x.e.LiveCard?"1":"0"})}}catch(e){}},[v])};var rT=l("328155"),rC=l("821408"),rN=l("128231"),rP=l.n(rN);let rS=()=>{let e=async()=>{var e,t;let l=Z.Le.getConfig(Z.gI.IsInMiniWin),i=null===(e=Z.Le.getConfig(Z.gI.AbtestData))||void 0===e?void 0:e.fixPause,n="visible"===document.visibilityState;if(l||n&&i)return;let o=await eS.invoke("isTopWebview");(null==o?void 0:o.data)===!1&&(q.emitAfterListen(q.EVENT.videoPause,"useCheckAllowPlay"),q.emitAfterListen(q.EVENT.livePause),null===(t=window.player)||void 0===t||t.pause())},t=rP()(async()=>{"hidden"===document.visibilityState&&e()},400);(0,F.C)(()=>{let l=(0,K.Rs)("open_mini_window");if(!(0,N.DT)()||l)return;let i=q.listen(q.EVENT.firstFrameReady,()=>{e()}),n=q.listen(q.EVENT.videoPlay,()=>{e()});return document.addEventListener("visibilitychange",t),()=>{i(),n(),document.removeEventListener("visibilitychange",t)}},[])},rL=e=>{let{setAwemeInfoList:t,swiper:l,hitOomOptimize:i}=e,n=(0,m.useRef)(!1),o=(0,m.useRef)(!1),a=(0,m.useRef)(!1),d=(0,m.useRef)(!1),r=(0,m.useRef)(0),s=(0,m.useRef)(),u=async()=>{let e=await eS.invoke("GET_APP_CONFIG_ITEM",{data:{key:"CloseLynxByDouyin",parse:!0}});return!!(null==e?void 0:e.data)},c=async()=>await eS.invoke("GET_APP_CONFIG_ITEM",{data:{key:"LynxDouyinInfo",parse:!0}}),v=e=>{var t,l,i,n,o,a;let{isInit:d,info:r,feedItem:s}=e||{};if(d){Z.Le.setConfig(Z.gI.PlayerStateFromLynx,{paused:!0});return}if(!r){Z.Le.setConfig(Z.gI.PlayerStateFromLynx,void 0);return}let u=((null==r?void 0:null===(l=r.data)||void 0===l?void 0:null===(t=l.forWeb)||void 0===t?void 0:t.seekDuration)||0)/1e3;Z.Le.setConfig(Z.gI.PlayerStateFromLynx,{paused:!!(null==r?void 0:null===(n=r.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:i.isPause),vid:null==s?void 0:s.awemeId,seekTime:u,muted:null==r?void 0:null===(a=r.data)||void 0===a?void 0:null===(o=a.forWeb)||void 0===o?void 0:o.isMute})},_=async e=>{var l,i,n,o,a,s,u,v,m;if(!e&&d.current)return;let _=e||await c();(!d.current&&(null==_?void 0:null===(n=_.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:null===(l=i.feedList)||void 0===l?void 0:l.length)||r.current!==(null==_?void 0:null===(s=_.data)||void 0===s?void 0:null===(a=s.forWeb)||void 0===a?void 0:null===(o=a.feedList)||void 0===o?void 0:o.length))&&(r.current=null==_?void 0:null===(m=_.data)||void 0===m?void 0:null===(v=m.forWeb)||void 0===v?void 0:null===(u=v.feedList)||void 0===u?void 0:u.length,t(e=>{var t,l,i,n;let o=(null==_?void 0:null===(l=_.data)||void 0===l?void 0:null===(t=l.forWeb)||void 0===t?void 0:t.feedList.map(e=>`${e.aweme_id}`))||[],a=(e||[]).filter(e=>!o.includes(`${e.awemeId}`));return[...(0,dI.TN)({awemeList:null==_?void 0:null===(n=_.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:i.feedList}),...a]}),d.current=!0)},f=(e,i)=>{(null==l?void 0:l.slideTo)&&(!a.current||i)&&t(t=>{var n,d,r,s,u,c,m,_,f;let p=t[null==e?void 0:null===(d=e.data)||void 0===d?void 0:null===(n=d.forWeb)||void 0===n?void 0:n.feedPlayIdx];return v({info:e,feedItem:p,isInit:!i}),o.current=!0,a.current=!0,l.slideTo(null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(r=s.forWeb)||void 0===r?void 0:r.feedPlayIdx,0),i&&(null===(f=window.player)||void 0===f||f.seek(null==e?void 0:null===(c=e.data)||void 0===c?void 0:null===(u=c.forWeb)||void 0===u?void 0:u.seekDuration,(null==e?void 0:null===(_=e.data)||void 0===_?void 0:null===(m=_.forWeb)||void 0===m?void 0:m.isMute)?"pause":"play")),t})},p=async()=>{await u()&&eS.invoke("SET_APP_CONFIG_ITEM",{data:{key:"LynxDouyinInfo",value:""}})},h=async function(e){var t,l,i;let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(n.current&&o.current&&a.current&&d.current){v(),s.current=void 0,p();return}let m=e||await c();s.current=m,await u()&&(r=!0),r&&(n.current=!0),(null==m?void 0:null===(i=m.data)||void 0===i?void 0:null===(l=i.forWeb)||void 0===l?void 0:null===(t=l.feedList)||void 0===t?void 0:t.length)?(_(m),f(m,r)):s.current=void 0},g=async e=>{eS.invoke("SET_APP_CONFIG_ITEM",{data:{key:"WebIsReady",value:"1"}})},y=()=>!1;!i&&(window.updateFeedByLynxInfo=h),(0,F.C)(()=>{if(!!y())h(s.current,!1)},[]),(0,F.C)(()=>{if(!!y())l&&!a.current&&h(s.current,!1)},[l]),(0,F.C)(()=>{if(!y())return;q.emitAfterListen(q.EVENT.livePause),v({isInit:!0});let e=q.listen(q.EVENT.firstFrameReady,()=>{g("firstFrameReady"),e()}),t=q.listen(q.EVENT.PlayerCreated,()=>{g("PlayerCreated"),t()}),l=q.listen(q.EVENT.videoPlay,()=>{g("videoPlay"),l()});return()=>{e(),t(),l()}},[])},rA=e=>{var t,l,i,n,o,a;let s=null===(i=window)||void 0===i?void 0:null===(l=i.TTE_ENV)||void 0===l?void 0:null===(t=l.initPageStore)||void 0===t?void 0:t.layoutInitialPropsInOffline;return(0,r._)((0,d._)({},e),{isSpider:!1,redirectFrom:void 0,ffDanmakuStatus:(null==s?void 0:null===(o=s.backendAbTest)||void 0===o?void 0:null===(n=o.danmaku)||void 0===n?void 0:n.douyin_danmaku)||0,danmakuSwitchStatus:(null==s?void 0:s.danmakuSwitchStatus)||0,freeAdStatus:(null==s?void 0:null===(a=s.freeAdStatus)||void 0===a?void 0:a.status)||0,isMobileSite:!1,useCache:!1,noUseCacheReson:"client_offline"})};var rk=l("459132");let rj=e=>{let{setAwemeInfoList:t,initialRecommendAwemeList:l=[]}=e;(0,F.C)(()=>{(async()=>{if((0,N.DT)()&&!rk.B.prefetchFromClientUsed&&window.clientNodePrefetchPromise){var e,i,n,o,a,d,r,s,u;if((null==l?void 0:l.length)>0){B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:0,cancel_reason:"has_init_list",data_length:0,status_code:0,jsb_cost:0});return}let c=new Date().getTime(),v=await window.clientNodePrefetchPromise;if(rk.B.setPerfetchUsed(),(null==v?void 0:null===(i=v.data)||void 0===i?void 0:null===(e=i.aweme_list)||void 0===e?void 0:e.length)>0&&(null===(n=v.data)||void 0===n?void 0:n.status_code)===0){let e=(null===(o=(0,rh.A)(null==v?void 0:v.data))||void 0===o?void 0:o.awemeList)||[];t(t=>{var l,i,n,o,a,d,r,s;return(null==t?void 0:t.length)?(B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.log_pb,cancel_reason:"has_list_data",data_length:null==v?void 0:null===(r=v.data)||void 0===r?void 0:null===(d=r.aweme_list)||void 0===d?void 0:d.length,status_code:String(null==v?void 0:null===(s=v.data)||void 0===s?void 0:s.status_code),jsb_cost:new Date().getTime()-c}),t):(rk.B.setIsUseNodeFetch(),B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:1,log_id:null==v?void 0:null===(l=v.data)||void 0===l?void 0:l.log_pb,cancel_reason:"",data_length:null==v?void 0:null===(n=v.data)||void 0===n?void 0:null===(i=n.aweme_list)||void 0===i?void 0:i.length,status_code:String(null==v?void 0:null===(o=v.data)||void 0===o?void 0:o.status_code),jsb_cost:new Date().getTime()-c}),e)})}else B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.log_pb,cancel_reason:(null==v?void 0:null===(d=v.data)||void 0===d?void 0:d.cancelReason)||"data_error",data_length:null==v?void 0:null===(s=v.data)||void 0===s?void 0:null===(r=s.aweme_list)||void 0===r?void 0:r.length,status_code:String(null==v?void 0:null===(u=v.data)||void 0===u?void 0:u.status_code),jsb_cost:new Date().getTime()-c})}})()},[l,t])};var rD=l("939965"),rR=l("766619");let rM=e=>{let{smartDataTrackConfig:t,authorCardPreload:l}=e||{};(0,m.useEffect)(()=>{if(!(!(0,$.km)(80)&&(0,$.i7)()))return;let{scene:i}=t||{};if(i===rR.P.AUTHOR_CARD_PRELOAD){var n;return null===(n=(0,rD.lZ)())||void 0===n||n.registerScene(rR.P.AUTHOR_CARD_PRELOAD,(0,r._)((0,d._)({},t),{abTestData:e,enableInference:!!(null==l?void 0:l.model_url)})),()=>{var e;null===(e=(0,rD.lZ)())||void 0===e||e.unregisterScene(rR.P.AUTHOR_CARD_PRELOAD)}}},[l,t])};l("950331");var rF=l("302653"),rB=l.n(rF),rO=l("238944"),rV=l("133359");let{useRecommendGuide:rW}=I.Z;(0,G.B1)({tag:"page_recommend"});let rU=(0,dy.C)((0,m.memo)(function(e){var t,i,n,o,a,_;let h=e;try{(0,N.DT)()&&(null===(i=window)||void 0===i?void 0:i.is_client_offline)&&(null===(a=window)||void 0===a?void 0:null===(o=a.TTE_ENV)||void 0===o?void 0:null===(n=o.initPageStore)||void 0===n?void 0:n.layoutInitialPropsInOffline)&&(h=rA(h))}catch(e){}let{isSpider:I,redirectFrom:b,ffDanmakuStatus:E=0,danmakuSwitchStatus:T=0,recommendAwemeList:C,recommendAwemeListPromise:P,firstSsrStatusCode:S,useCache:L,noUseCacheReson:k,otherInfo:G,quickPlayerVal:en,quickServerDataVal:eo}=h||{},ev=(0,p.d)();_=null==ev?void 0:ev.nonce;let em=I||(0,N._Q)(),[e_,ef]=(0,m.useState)(null!=C?C:[]),[ep,eh]=(0,m.useState)(null),[eg,ey]=(0,m.useState)(!1),[ew,eI]=(0,m.useState)(0),{isMobile:ex,isiPad:eb}=(0,M.X)(),[eE,eT]=(0,m.useState)(!0),[eN,eS]=(0,m.useState)(!0),eL=(0,m.useRef)(()=>{}),eA=(0,m.useRef)(null),ek=(0,m.useRef)(null),ej=(0,m.useRef)(null),eD=(0,m.useRef)(""),eR=(0,m.useRef)(()=>{}),eM=(0,m.useRef)(!1),{userInfo:eF,dispatch:eB}=(0,n_.useUserInfoContext)()||{userInfo:{}},{isLogin:eO,info:eV}=eF,eW=(0,A._)()||{},{modalVideoDetail:eU,changeSplashAdStatus:eH,splashAdStatus:eG,isSplashTransitionEnd:ez}=(0,dS.K)(e=>{let{modalVideoDetail:t,changeSplashAdStatus:l,splashAdStatus:i,isSplashTransitionEnd:n}=e;return{modalVideoDetail:t,changeSplashAdStatus:l,splashAdStatus:i,isSplashTransitionEnd:n}}),{removeSlideListButton:eZ}=(0,iu.Iq)(e=>{let{removeSlideListButton:t}=e;return{removeSlideListButton:t}}),eK=(0,y.Z)(()=>{try{var e;(null==ek?void 0:ek.current)&&(null==ek?void 0:null===(e=ek.current)||void 0===e?void 0:e.style)&&(ek.current.style.display="none")}catch(e){}eT(!1)}),eQ=(0,m.useMemo)(()=>{var e;return!!(0,N.DT)()||(null===(e=(0,z.V)())||void 0===e?void 0:e.isSupport)},[]);(0,F.C)(()=>{ef(function(){var e,t,l,i,n,o,a,d,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(rn()&&ra()===(null==s?void 0:null===(n=s[0])||void 0===n?void 0:n.awemeId))return rd(null==s?void 0:s[0]),ro(!0),rr(null==s?void 0:s[0]),[...s];if(null===(e=window.__QUICK_PLAYER)||void 0===e?void 0:e.recommendCacheList){s.unshift(...null===(o=window.__QUICK_PLAYER)||void 0===o?void 0:o.recommendCacheList);let e=rB()(s,"awemeId");return delete window.__QUICK_PLAYER.recommendCacheList,e}if(null===(t=window.__QUICK_PLAYER)||void 0===t?void 0:t.recommendDbAwemeInfo){s.unshift(null===(a=window.__QUICK_PLAYER)||void 0===a?void 0:a.recommendDbAwemeInfo);let e=rB()(s,"awemeId");return null===(r=window)||void 0===r||null===(d=r.__QUICK_PLAYER)||void 0===d||delete d.recommendDbAwemeInfo,e}return(null===(i=window)||void 0===i?void 0:null===(l=i.__QUICK_PLAYER)||void 0===l?void 0:l.recommendCachePromise)&&(window.__QUICK_PLAYER.recommendCachePromise.__flag=!0),s}(C))},[]),(0,rV.t)({landingMode:null==h?void 0:h.landingMode,landingReason:null==h?void 0:h.landingReason,isSelectPreferUser:null==h?void 0:h.isSelectPreferUser});let e$=(0,m.useRef)(!1);(0,m.useEffect)(()=>{var e,t,l,i;if(!eo)return;let n=null===(e=performance.getEntriesByName("RecommendQuickPlayerStreamLoad")[0])||void 0===e?void 0:e.startTime,o=null===(t=performance.getEntriesByName("RecommendCommonListLoad")[0])||void 0===t?void 0:t.startTime,a=(null===(l=window.__QUICK_PLAYER)||void 0===l?void 0:l.recommendCacheList)||[];!o&&!n&&(null==e_?void 0:e_[0])?performance.mark("RecommendCommonListLoad"):a.length&&n&&!e$.current&&(null===(i=window.__QUICK_PLAYER)||void 0===i||delete i.recommendCacheList,ef(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return rB()([...e,...a],"awemeId")}),e$.current=!0)},[null==e_?void 0:e_.length]),(0,m.useEffect)(()=>(Z.Le.setConfig(Z.gI.RecommendReqCount,(null==C?void 0:C.length)||0),(0,Z.Vv)(void 0),()=>{Z.Le.setConfig(Z.gI.RecommendReqCount,0)}),[]),(0,m.useEffect)(()=>{let e=setTimeout(()=>{eT(!1),eS(!1)},1e4);return()=>{e&&clearTimeout(e)}},[]);let eY=(0,m.useMemo)(()=>({cardBetween:12,upperSpace:0,nextSwiperHeaderHeight:0}),[]);rM(eW),dq(!1);let{refLiveStore:eq}=(0,el.g)({swiper:ep,setAwemeInfoList:ef,awemeInfoList:e_,refMixPlayer:eA,abTestData:eW,liveCardDisable:(0,N.DT)()}),{pageSpeed:eJ}=d8({swiper:ep,abTestData:eW});(0,ei.A)({awemeInfoList:e_,setAwemeInfoList:ef}),ea({awemeInfoList:e_,setAwemeInfoList:ef});let eX=(0,m.useCallback)(()=>{Z.Le.setConfig(Z.gI.VideoFeedList,{autoPlayCount:1})},[]);(0,eP.o)(()=>{let e=(0,K.Rs)("enter_recommend_method"),t=(0,K.Rs)("page_url");e&&B.logInstance.sendLog("enterRecommend",{enter_from:"recommend",enter_method:e,page_url:null==t?void 0:t.toString()})},[]),(0,m.useEffect)(()=>{let{adCommentAIPreloadStatus:e=H.AdCommentAIPreloadStatus.Off,commentAiPreloadStatus:t=H.CommentAIPreloadStatus.Off}=null!=eW?eW:{},i=[H.AdCommentAIPreloadStatus.Off],n=[H.CommentAIPreloadStatus.Off,H.CommentAIPreloadStatus.CommentPreloadAll];!(i.includes(e)&&n.includes(t))&&(0,Q.N)(async()=>{let{Pylon:e,EBiz:t}=await l.e("74770").then(l.bind(l,198991));new e({biz:t.DOUYIN_WEB_RECOMMEND})},!1)},[null==eW?void 0:eW.adCommentAiPreloadStatus,null==eW?void 0:eW.commentAiPreloadStatus]);let{fetchSlideList:e0,statusCode:e1,refRefreshIndex:e2,isListError:e4,setIsListError:e3,setRefreshIndex:e5}=(0,d7.b)({abTestData:eW,isLogin:eO,refCancelTabFeedFunc:eL,retryFuncRef:eR,ffDanmakuStatus:E,danmakuSwitchStatus:T,initialRecommendAwemeList:C,initialRecommendAwemeListPromise:P});rj({setAwemeInfoList:ef,initialRecommendAwemeList:C}),rE({initialRecommendAwemeList:C}),dx({setAwemeInfoList:ef,swiper:ep,changeSplashAdStatus:eH}),rL({setAwemeInfoList:ef,swiper:ep,hitOomOptimize:!1}),rS(),j();let{deleteCurrentSwiper:e6,nextPageFunc:e8,lastPageFunc:e7,retryFunc:e9}=(0,ed.zg)({swiper:ep,awemeInfoList:e_,setAwemeInfoList:ef,fetchSlideList:e0,swiperCallBack:e=>{eX(),eS(!1)},fromTab:er.B.RECOMMEND,abTestData:eW,initialRecommendAwemeList:C,initialRecommendAwemeListPromise:P,enableSlideBlockedLog:!0});eR.current=e9;let{isFirstScreenFrame:te}=dJ({awemeInfoList:e_,abTestData:eW});d0(),d2(),d5(),d6({list:e_,ssrStatusCode:null!=S?S:-9,csrStatusCode:null!=e1?e1:-9,refreshIndex:e2.current});let{recommendGuideChild:tt,recommendGuideVisible:tl,handleCloseGuide:ti,useNewUserSoundGuide:tn}=rW({swiper:ep,isCanShow:!eg&&!eU,enterFrom:"recommend",awemeInfoList:e_,isCloseInGuide:!0,slot:es.t6.OUTSIDE,disableLottie:(0,$.b_)()||(0,$.Sb)(),newUserGuide:1,removeSlideListButton:eZ});rc({setAwemeInfoList:ef,swiper:ep,userInfo:eF});let to=(0,m.useMemo)(()=>{var e,t;return(Z.Le.setConfig(Z.gI.FeedBackInfo,{refreshIndex:e2.current,activeIndex:null!==(t=null==ep?void 0:ep.activeIndex)&&void 0!==t?t:-1,awemeInfoList:null==e_?void 0:null===(e=e_.map)||void 0===e?void 0:e.call(e_,e=>e.awemeType)}),0===e_.length&&e1===O.ERROR_CODE.ERROR_NO_NETWORK)?(null==eH||eH(V.QB.Normal),(0,u.jsx)(D.oO,{slot:es.t6.OCCUPATION})):e4&&0===e_.length?(Y.oe.event.error({name:Y.Mo.FeedServerError,report:{tab:"recommend",statusCode:e1,logId:eD.current}}),dQ.Z.sendLog("feedServerError",{status_code:e1,log_id:eD.current}),null==eH||eH(V.QB.Normal),(0,u.jsx)(D.nl,{title:"服务器出现问题",desc:"请刷新页面重试",slot:es.t6.OCCUPATION,primaryButtonTitle:"刷新",primaryButtonAction:()=>window.location.reload()})):null},[e1,e4,e_]),{updateActiveIndex:ta}=(0,dg.Z)({swiper:ep,awemeInfoList:e_,fetchSlideList:e0,setAwemeInfoList:ef,abTestData:eW});(0,m.useEffect)(()=>q.listen(q.EVENT.refreshPage,()=>{ta(0,!0),(0,ed.JA)({refCancelTabFeedFunc:eL,setAwemeInfoList:ef,fetchSlideList:e0,fromTab:er.B.RECOMMEND}),e3(!1)}),[e0]),(0,m.useEffect)(()=>{(async()=>{let[e]=await Promise.all([W.get({key:U.TccKey.CommonSetting,defaultValue:U.TCC_DEFAULT_VALUE_MAP.get(U.TccKey.CommonSetting)})]);!e.showFeedUserGuide&&ey(!0)})()},[]),(0,eP.o)(()=>(eX(),()=>{eX()}),[]),(0,m.useEffect)(()=>{document.body.style.minWidth="580px"},[]),(0,dh.Z)("RECOMMEND_INDEX_RENDER",{abTestData:eW,awemeInfoList:e_,banRecommendGuide:eg,statusCode:e1,slideHeight:eY});let td=(0,R.Z)({refMixPlayer:eA}),tr=(0,y.Z)(e=>{e6(e)});(0,m.useEffect)(()=>{var e;if(!eM.current)Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!!(null===(e=e_[0])||void 0===e?void 0:e.libfinsertTaskId)}),eM.current=!0},[e_]),(0,m.useEffect)(()=>{let e=e_.map((e,t)=>({vid:e.awemeId,isLive:e.awemeType===x.e.LiveCard,isActive:t===ew}));q.emit(q.EVENT.changeVideoListContext,{list:e})},[e_,ew]);let ts=(0,m.useRef)({}),tu=(0,y.Z)(e=>{let{from:t}=e||{};if(tl&&ti({scroll:"mouse",keyboard:"keyboard",click_button:"next_video_button"}[t]),!tl)"auto"===t&&(0,Z.Vv)(ec.PagingType.auto),e8(e)}),tc=(0,y.Z)(e=>{e7(e)}),tv=J.t.isOptimizeFeed(eW)?tc:e7,{isAiSearchShow:tm}=(0,db.E)(),t_=(0,m.useMemo)(()=>({paddingLeft:0,paddingRight:tm?312:eZ?12:68}),[tm,eZ]),tf=dl.o;(0,w.C)(eC.w3.components.recommend_page),!function(){let{awemeFeed:e}=(0,dE.j)(),t=(0,m.useRef)(!1);(0,rC.M)(),(0,dW.w)(()=>{e.getValue("modalAwemeInfo")&&((0,rT.Nr)(location.pathname)?t.current=!0:e.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null}))},[]),(0,m.useLayoutEffect)(()=>q.listen(q.EVENT.exitChildRoute,()=>{"/"!==location.pathname&&t.current&&(t.current=!1,e.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null}))}),[])}();let tp=(0,c.a)(),{isFromLynx:th}=(0,l2.H)(),tg="/"===tp.pathname||tp.pathname.startsWith("/root/live");rm({feedLogId:eD.current,awemeInfoList:e_,otherInfo:G});let ty=(0,dE.j)(),{awemeFeed:tw}=ty,tI=(0,s._)(ty,["awemeFeed"]);return(0,eP.o)(()=>{if((null==eW?void 0:eW.themeColorOptimize)===H.ThemeColorOptimize.V3)return(0,rO.x)(),()=>{(0,rO.x)()}},[eW]),(0,u.jsxs)(dE.b,{context:(0,r._)((0,d._)({},tI),{metaCtxId:"recommend"}),children:[(0,u.jsx)(dM,{isSpider:em,redirectFrom:b}),(0,u.jsx)(d$,{abTestData:eW}),(0,u.jsx)(f,{resolve:P}),(0,u.jsxs)(eu.ZP,{isVideoSupportMP4:eQ,onSwiper:eh,abTestData:eW,isDefaultShowSideBar:!1,swiperStyle:t_,cardBetween:eY.cardBetween,upperSpace:eY.upperSpace,nextSwiperHeaderHeight:eY.nextSwiperHeaderHeight,data:e_,scene:es.R5.Recommend,splashAdStatus:eG,useWheelListener:eG===V.QB.Normal,swiperClassName:g()({[dY.splashTransition]:eG===V.QB.Normal&&!ez&&!(0,$.b_)()}),pagingSpeed:eJ,children:[(0,u.jsx)(l3.p,{}),te&&eQ&&tt,to,(0,u.jsx)(tf,{"data-e2e":"feed-item",className:g()(dY.swiperItem,"page-recommend-container",{[dY.noSelect]:!!(null==eW?void 0:eW.shitCardCss),[dY.clientMiniWin]:!!td}),slot:es.t6.INSIDE,children:e=>{let{slideData:t,activeIndex:l,currentIndex:i}=e,n=(!!eq.current[0]||i>0)&&(0,X.g)({abTestData:eW});if(eI(l),ta(l),l>=2&&(0,dw.U)(),!(t&&1>=Math.abs(l-i)))return null;{var o,a;let e=l===i&&!((0,ee.B)()&&(null==t?void 0:t.awemeType)===x.e.LiveCard)&&!(!tg&&(null==t?void 0:t.awemeType)===x.e.LiveCard),d=l-1===i,r=l+1===i,s=null==t?void 0:t.awemeId;return e&&!ts.current[s]&&(ts.current[s]=!0,Z.Le.setConfig(Z.gI.FeedLatestViewedAweme,{awemeId:s})),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l3.p,{isActive:e}),(0,u.jsx)(v.NoSSR,{children:(0,u.jsx)(dN.ce,{isVideoSupportMP4:eQ,InnerPlayer:n?dp:iv,isDyPlayer:n,videoRef:e?eA:ej,className:g()(dY.content),isFullScreen:(0,et.r)(),item:t,deleteCurrentSwiper:tr,playNextFunc:tu,playPrevFunc:tv,isActive:e,isFirst:0===i,isFirstLive:!!(null==eq?void 0:null===(o=eq.current)||void 0===o?void 0:o[0]),isNext:r,isPrev:d,isLast:i===e_.length-1,index:i,from:dP.x_.recommend,tab:dP.x_.recommend,swiper:ep,isClientMiniWin:td,splashAdStatus:eG,changeSplashAdStatus:eH,isSplashTransitionEnd:ez,onReady:eK,isShowGuide:tl,useNewUserSoundGuide:tn})}),eE&&0===i&&!th()&&!(null==eW?void 0:null===(a=eW.webcodecRecommend)||void 0===a?void 0:a.open)&&(0,u.jsx)(dV,{ref:ek,isLive:(null==t?void 0:t.awemeType)===x.e.LiveCard,awemeInfo:t,abtestData:eW})]})}}}),0===e_.length&&e1!==O.ERROR_CODE.ERROR_NO_NETWORK&&(0,u.jsx)(dC.e,{abTestData:eW,slot:es.t6.INSIDE}),!ex&&!eb&&!eZ&&(0,u.jsx)(dL.z,{isVideoSupportMP4:eQ,show:e_.length>0&&eG===V.QB.Normal,playNextFunc:()=>{tu({from:"click_button"})},playPrevFunc:()=>{e7({from:"click_button"})},swiper:ep,className:g()("recommend-out-switch-btn"),awemeInfoList:e_,slot:es.t6.OUTOFCONTAINER,from:dP.x_.recommend})]}),(0,u.jsx)(dT.IsLivingPlugin,{activeIndex:ew,dataList:e_,setDataList:ef,scene:"recommend"}),!!en&&!eo&&(0,u.jsx)(dA,{awemeInfo:(null==ev?void 0:null===(t=ev.firstLoadCache)||void 0===t?void 0:t.recommend)?void 0:null==C?void 0:C[0],isFromLynx:th(),removeSlideListButton:eZ})]})}),e=>(0,E.oS)(e))},543763:function(e,t,l){l(250440),l(874386);var i=l(88648),n=l(302653),o=l.n(n),a=l(302461),d=l(828782),r=l(66627),s=l(401156),u=l(441447),c=l(725887),v=l(832052),m=l(104869);let _=e=>{var t,l,i;return(null==e?void 0:e.awemeId)||(null==e?void 0:null===(i=e.cellRoom)||void 0===i?void 0:null===(l=i.rawdata)||void 0===l?void 0:null===(t=l.owner)||void 0===t?void 0:t.web_rid)};t.Z=e=>{let{swiper:t,fetchSlideList:l,awemeInfoList:n,setAwemeInfoList:f,abTestData:p}=e,h=(0,i.useRef)(0),g=(0,i.useRef)(!1),y=(0,i.useRef)(!1),w=e=>{let{currentAwemeId:l}=e;h.current<=n.length-1&&f(e=>{let i=e.filter((e,t)=>t<=h.current).map(e=>_(e)),n=e.map((e,t)=>t>h.current||_(e)===l?e:null).filter(e=>!!e),o=n.findIndex(e=>!i.includes(_(e)));return -1!==o?(h.current=o,null==t||t.slideTo(o,0),y.current=!1):(h.current=0,setTimeout(()=>{null==t||t.slideTo(0,0)},0),y.current=!0),n})},I=async e=>{var t,i;let{currentAwemeId:n}=e,o=await l({mode:"loadmore",pull_type:18,refresh_type:18});0===o.statusCode&&(null===(t=o.data)||void 0===t?void 0:t.length)&&f(e=>{let t=(o.data||[]).filter(t=>!e.find(e=>_(e)===_(t)));return[...e.map((e,l)=>{if(_(e)===n)return e;if(l>h.current&&!(null==e?void 0:e.isAds)&&[v.e.Normal,v.e.Note].includes(null==e?void 0:e.awemeType)&&t.length){let e=t[0];return t.splice(0,1),e}return e}),...t]}),0===o.statusCode&&!(null===(i=o.data)||void 0===i?void 0:i.length)&&y.current&&!o.hasMore&&(h.current=0,y.current=!1,u.emit(u.EVENT.refreshPage))};return(0,a.o)(()=>{var e;return(0,m.oX)(async()=>{if(!g.current&&!!t&&"number"==typeof(null==t?void 0:t.activeIndex)){g.current=!0;try{let e=_(n[t.activeIndex]);w({currentAwemeId:e}),await I({currentAwemeId:e})}catch(e){}g.current=!1}},!(null==t?void 0:null===(e=t.slides)||void 0===e?void 0:e.length))},[l,t,n,f]),(0,i.useEffect)(()=>{if(y.current&&n.length>1){var e,l,i;y.current=!1;let n=null===(e=c.Le.getConfig(c.gI.IsSidebarShow))||void 0===e?void 0:e.isModal,o=null===(l=c.Le.getConfig(c.gI.IsInLookMiniModal))||void 0===l?void 0:l.isInMiniModal,a=null===(i=c.Le.getConfig(c.gI.IsInModalVideo))||void 0===i?void 0:i.isInModal;!n&&!o&&!a&&(null==t||t.slideNext())}},[t,n]),(0,i.useEffect)(()=>{if(n.length){let e=o()(n,e=>_(e));e.length!==n.length&&f(e)}},[n,f]),{updateActiveIndex:(e,t)=>{(0,m.C6)(),t?h.current=e:h.current=Math.max(e,h.current);let l=(0,d.FJ)().awemePcClient||"0.0.0";(0,d.DT)()&&(0,r.y)(l,">=","4.3.0")&&(0,s.PZ)(n,h.current)}}}},505725:function(e,t,l){l.d(t,{m:function(){return v}}),l(250440),l(874386),l(675373);var i=l(88648),n=l(987475),o=l(245861),a=l(847191),d=l(725887),r=l(828782),s=l(529596),u=l(379788),c=l(54730);let v=e=>{let{awemeInfo:t,abtestData:l,isActive:v,isLogin:m,player:_}=e,[f,p]=(0,i.useState)(!1),h=(0,i.useRef)(!1),g=(0,o.p)(t),y=(0,i.useMemo)(()=>{var e;return null===(e=d.Le.getConfig(d.gI.WallPaperIds))||void 0===e?void 0:e.includes(null==t?void 0:t.awemeId)},[t]);return(0,i.useEffect)(()=>{let e=async()=>{if(!(!1===m||!v||y||g||(0,r.DT)()||(0,r.tq)())){if(h.current){p(!0);return}try{var e;let[l,i]=await Promise.all([(0,s.Y)(),(0,u.lx)({secUid:null===(e=t.authorInfo)||void 0===e?void 0:e.secUid})]);(function(e,t,l){var i,o,d,r;let s=new Date().getTime(),u=null!==(o=(0,a.$o)(n.LocalStorageKeys.PostGuideDownloadClient))&&void 0!==o?o:{lastTimestamp:0,showTimes:0},v=s-u.lastTimestamp>=864e5,m=u.showTimes<10;if(e===c.Q.Normal&&v&&m&&!1===l&&[1,2].includes(null==t?void 0:null===(i=t.authorInfo)||void 0===i?void 0:i.followStatus)){let e=null!==(r=null===(d=(0,a.$o)(n.LocalStorageKeys.PostGuideDownloadClient))||void 0===d?void 0:d.showTimes)&&void 0!==r?r:0;return(0,a.qQ)(n.LocalStorageKeys.PostGuideDownloadClient,{lastTimestamp:new Date().getTime(),showTimes:e+1}),!0}return!1})(null==i?void 0:i.accountType,t,l)&&(h.current=!0,p(!0))}catch(e){}}};if(_)return _.once("timeupdate",e),()=>{_.off("timeupdate",e)}},[l,t,v,m,y,g,_]),{isShowGuideDownload:f}}},549909:function(e,t,l){l.d(t,{b:function(){return o}});var i=l(88648),n=l(441447);let o=e=>{let{isActive:t,player:l}=e;(0,i.useEffect)(()=>{if(t){let e=null,t=n.listen(n.EVENT.liveModalShow,()=>{l&&(e=n.listen(n.EVENT.liveModalClose,()=>{var e;null==l||null===(e=l.play)||void 0===e||e.call(l)}))});return()=>{null==t||t(),null==e||e()}}},[t,l])}},415124:function(e,t,l){l.d(t,{F:function(){return h}});var i=l(520739);l(413806),l(826893),l(250440),l(874386);var n=l(563097),o=l(88648),a=l(946075),d=l(734123),r=l(725887),s=l(441447),u=l(335101),c=l(443073),v=l(289228);let m=()=>{var e,t;return null!==(t=null===(e=r.Le.getConfig(r.gI.TabTenVVID))||void 0===e?void 0:e.split(",").length)&&void 0!==t?t:0},_=e=>{let{from:t="",isActive:l=!1,awemeInfo:i}=null!=e?e:{},n=(0,a.k)();(0,o.useEffect)(()=>n.listen(()=>{r.Le.setConfig(r.gI.TabTenVVID,"")}),[]),(0,o.useEffect)(()=>{var e;let t=null!==(e=r.Le.getConfig(r.gI.TabTenVVID))&&void 0!==e?e:"";l&&!(null==t?void 0:t.includes(null==i?void 0:i.awemeId))&&r.Le.setConfig(r.gI.TabTenVVID,`${null!=t?t:""}${t?",":""}${null==i?void 0:i.awemeId}`)},[l,null==i?void 0:i.awemeId])},f=()=>!1,p=e=>{let{awemeInfo:t,isActive:l,abtestData:i,isMiniWin:n=!1}=e,a=(0,u.n)(),[r,c]=(0,o.useState)(""),[v,p]=(0,o.useState)(0);(0,o.useEffect)(()=>{if(!l||!f())return;let e=e=>{let{currentTime:t}=e;p(t)};return null==a||a.on(d.Events.TIME_UPDATE,e),()=>{null==a||a.off(d.Events.TIME_UPDATE,e)}},[a,l]),(0,o.useEffect)(()=>{let e=s.listen(s.EVENT.closeOtherTip,e=>{"WatchLaterGuide"!==e&&c("")});return()=>e()},[]),_(e);let h=m();return(0,o.useEffect)(()=>{r&&c(""),p(0)},[l,t,a]),(0,o.useEffect)(()=>{n&&c("")},[n]),(0,o.useEffect)(()=>{if(!l||r||n)return},[l,t,v,i,h,r,n,a]),null},h=e=>{let t=(0,c.N)();return(0,n.jsx)(v.k,{componentName:"PositionBox",Slardar:t,children:(0,n.jsx)(p,(0,i._)({},e))})}},815242:function(e,t,l){l.d(t,{i:function(){return c}}),l(429532);var i=l(371790),n=l(656600),o=l(725887),a=l(113925),d=l(736054),r=l(903220),s=l(713533),u=l(739444);function c(e){var t;let{awemeInfo:l,abtestData:c={},isInnerFeed:v=!1,isMultiInstanceScene:m=!1,isActive:_,getFullscreenTarget:f}=e,p={},h=(0,s.YO)({abtestData:c,awemeInfo:l,isInnerFeed:v});return Object.assign(p,(0,u.k)({awemeInfo:l,abtestData:c,enableSr:h}),(0,r.QF)({awemeInfo:l,abtestData:c,enableSr:h})),(0,a.Zf)({config:p,awemeInfo:l,abtestData:c}),(0,d.LX)({config:p,awemeInfo:l,abtestData:c,isMultiInstanceScene:m}),(0,s.nq)({config:p,abtestData:c,enableSr:h}),p.autoplay=_,"function"==typeof f&&(p.fullscreenTarget=f()),i.t.isOptimizeUpdateTime(c)&&(!(p.time&&"object"==typeof p.time)&&(p.time={}),p.time.smartRender=!0),n.f.isDots(c)&&(!(p.progresspreview&&"object"==typeof p.progresspreview)&&(p.progresspreview={}),p.progresspreview.isDotAdaptWidth=!1),(null===(t=o.Le.getConfig(o.gI.AbtestData))||void 0===t?void 0:t.startOpt)&&(p.loadStartDelay=!0),p}},128439:function(e,t,l){l.d(t,{g:function(){return o}});var i=l(399242),n=l(798644);let o=e=>{if(!!e){if(n.s.getAllPlayer().find(e=>n.s.getPlayerScene(e.playerId)===i.lT.Modal)){var t;null===(t=e.pause)||void 0===t||t.call(e),e.config.autoplay=!1,e.autoplay=!1}}}},821408:function(e,t,l){l.d(t,{M:function(){return r}});var i=l(88648),n=l(302461),o=l(458343),a=l(909543),d=l(328155);let r=()=>{let{pathname:e}=(0,a.a)(),t=(0,i.useRef)(!0),l=(0,i.useRef)(e),r=(0,d.Nr)(e),s=(0,i.useRef)(!1);(0,n.o)(()=>{if(s.current){s.current=!1;return}performance.mark("recommend_mounted"),t.current&&(t.current=!1)},[e]),(0,i.useEffect)(()=>{if(!!r)return()=>{location.pathname===l.current&&(s.current=!0)}},[r]),(0,o.w)(()=>{performance.getEntriesByName("recommend_mounted").length>0&&performance.clearMarks("recommend_mounted")},[])}},970224:function(e,t,l){l(429532);var i=l(88648);function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i])}return e}).apply(this,arguments)}let o=i.forwardRef(function(e,t){return i.createElement("svg",n({viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,ref:t},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 38C20 32.4772 24.4772 28 30 28H90C95.5229 28 100 32.4772 100 38V74C100 79.5229 95.5229 84 90 84H72V91L82.5231 95.3846C83.4174 95.7573 84 96.6311 84 97.6C84 98.9255 82.9255 100 81.6 100H72H48H38.4C37.0745 100 36 98.9255 36 97.6C36 96.6311 36.5826 95.7573 37.4769 95.3846L48 91V84H30C24.4772 84 20 79.5228 20 74V38ZM70.2929 58.7071L60.7071 68.2929C60.3166 68.6834 59.6834 68.6834 59.2929 68.2929L49.7071 58.7071C49.0771 58.0771 49.5233 57 50.4142 57H55L55 46C55 45.4477 55.4477 45 56 45L64 45C64.5523 45 65 45.4477 65 46L65 57H69.5858C70.4767 57 70.9229 58.0771 70.2929 58.7071Z",fill:"currentColor"}))});o.elementType="Icon",t.Z=o},135738:function(e,t,l){l.d(t,{Z:function(){return m}});var i=l("134761"),n=l("520739"),o=l("878389");l("268917"),l("429532");var a=l("303256");l("544943"),l("874386"),l("413806"),l("826893");function d(){return Date.now()}l("250440"),l("779788");class r{config(e){window.collectEvent(`${this._name}.config`,e)}event(e,t){window.collectEvent(`${this._name}.${e}`,t)}init(e){window.collectEvent(`${this._name}.init`,e)}start(){window.collectEvent(`${this._name}.start`)}constructor(e){this._name=e}}let s=1;class u{get videoSize(){if(!this._player)return{width:0,height:0,play_width:0,play_height:0};let{clientWidth:e,clientHeight:t,videoWidth:l,videoHeight:i}=this._player;return{width:l,height:i,play_width:e,play_height:t}}initTea(e){let{TeaCtor:t=r}=e,l=this._Tea=new t(`douyin-player-logger-${s++}`),{user_unique_id:i,teaInitPre:n,user_id:o,device_id:a}=e;n&&n(l),l.init({app_id:7497}),l.start(),l.config({user_unique_id:i||o,device_id:a})}push(e){if(e.timestamp=d(),(e=(0,o._)((0,n._)({},e,this.videoSize),{core_type:this._player.srcObject?"mediastream":"media"})).play_current_time=this._player.currentTime,e.cdn_play_url=this._player.src,!!e.cdn_play_url){{var t,l;e.live_stream_session_id=function(e,t){if("string"==typeof e)return new URLSearchParams(e.split("?")[1]).get(t)}(e.cdn_play_url,"_session_id"),e.random_session_id=+e.cdn_play_url.includes("rsi=0"),e.play_format="string"!=typeof(l=e.cdn_play_url)?"unknown":l.indexOf(".flv")>-1?"flv":l.indexOf(".m3u8")>-1?"m3u8":l.indexOf(".mp4")>-1?"mp4":l.indexOf(".sdp")>-1?"rtm":"unknown";let{url:i,protocol:n}=(null===(t=this._player.config)||void 0===t?void 0:t.baseConfig)||{};try{e.base_config=JSON.stringify({url:i,protocol:n})}catch(e){}}e.visible=document.visibilityState,e.muted=+this._player.muted,Object.assign(e,function(){let e={cpu_core_number:-1,memory_usage:-1,network_downlink:-1};try{var t;e.cpu_core_number=navigator.hardwareConcurrency||-1,e.memory_usage=navigator.deviceMemory||-1,e.network_downlink=null===(t=navigator.connection)||void 0===t?void 0:t.downlink,void 0==e.network_downlink&&(e.network_downlink=-1)}catch(e){}return e}(),this.commonParams),this.send(e)}}send(e){var t;if(null===(t=this.isDisableReport)||void 0===t?!void 0:!t.call(this,e.event_key,e))this.onReport&&this.onReport(e.event_key,e),this._Tea.event(e.event_key,e)}constructor(e,t){(0,i._)(this,"commonParams",void 0),(0,i._)(this,"_player",void 0),(0,i._)(this,"onReport",void 0),(0,i._)(this,"isDisableReport",void 0),(0,i._)(this,"updateCommonParams",e=>{Object.assign(this.commonParams,e)}),this.initTea(e),this.commonParams=t,this.onReport=e.onReport,this.isDisableReport=e.isDisableReport,this._player=e.player}}let c=e=>{let{TTCommon:t}=window;return t?(c=e=>{if(!e)return 0;try{let{alg_type:l,sharp_level:i,scale_type:n,sr_enable:o,sr_local_error:a,proc_avg:d,render_from:r}=JSON.parse(t.executeWithElement(e,"getSrCurrentInfo",""))||{};return{is_super_resolution:3===o&&0===a||!a&&d>0?1:0,sr_alg_type:l,sr_sharp_level:i,sr_scale_type:n,sr_enable:o,sr_local_error:a,sr_render_from:r}}catch(e){return{}}})(e):(c=()=>{},{})};class v{init(){this.initLog(),this.initEvt()}initLog(){let e=function(e){let{player:t,project_key:l,user_id:i,device_id:o,user_unique_id:a,app_name:d,cdn_ip:r,aid:s,is_preview:u,codec_type:c,ext:v,product_line:m="live"}=e;return(0,n._)({project_key:l,product_line:m,live_sdk_version:"2",player_sdk_version:t.version,logger_version:"0.11.16",report_version:"5",user_id:i,device_id:o,uuid:a,app_name:d,cdn_ip:r,is_wasm:0,review_is_live:2,aid:s,live_id:`${s}-${i}-${Date.now()}`,is_preview:u?1:0,codec_type:c||"h264",ua:navigator.userAgent,href:window.location.href,fps:-1,logger_init_time:Date.now(),dpr:devicePixelRatio||1},v)}(this.options);this.log={start_play:{start_play_time:0,event_key:"start_play"},first_frame:{start:0,first_frame_view:0,event_key:"first_frame",first_sei_delay:0,ntp_sync:0,ntp_delta:0,ttfb:-1,ttdb:-1,ttfb_end:0},first_frame_failed:{code:void 0,msg:"",event_key:"first_frame_failed"},stall:{reason:0,stall_start:0,stall_end:0,ready_state:0,event_key:"stall"},play_stop:{code:0,stop_time:0,drop_percent:0,is_stream_received:0,stall_count:0,stall_time:0,retry_count:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,event_key:"play_stop",dns_parse_time:-1,redirect:-1,ttfb:-1,buffered:[],is_firstframe_received:0,meta:null},playing:{index:0,stall_count:0,stall_time:0,play_time:1e4,retry_count:0,is_last:0,video_buffer_time:0,audio_buffer_time:0,speed_switch_count:0,speed_switch_info:"none",download_speed:0,decode_fps:0,render_fps:0,drop_count:0,drop_percent:0,sei_source:"",sei_delay:0,ntp_sync:0,ntp_delta:0,event_key:"playing",stop_time:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,rtm_network:[]},play_error:{code:void 0,info:"",event_key:"play_error"},play_low_decode:{fps:-1,decode_fps:-1,bitrate:-1,url:-1,msg:"",event_key:"play_low_decode"},play_av_unsync:{aDts:-1,vDts:-1,frameLength:-1,currentTime:-1,duration:0,event_key:"play_av_unsync"},play_loadstream:{loadstream_url:"",event_key:"play_loadstream"},play_stream_loaded:{event_key:"play_stream_loaded"},play_metadata_loaded:{metadata_type:"",event_key:"play_metadata_loaded"},play_demux_error:{msg:"",event_key:"play_demux_error"},play_stream_discontinue:{type:"",dts:-1,event_key:"play_stream_discontinue"},pause:{event_key:"pause"},play_url_change:{event_key:"play_url_change"},play_result:{event_key:"play_result",result:0,threshold:this.options.playResultThreshold||25e3,is_threshold:0,start:0},play_ended:{event_key:"play_ended"},play_chase_frame:{event_key:"play_chase_frame"},play_audio_gap:{event_key:"play_audio_gap"},play_audio_overlap:{event_key:"play_audio_overlap"},degrade:{event_key:"degrade"},worker_message:{event_key:"worker_message"}},this.tea=new u(this.options,e)}initEvt(){var e,t,l;let i=this._player;i&&(this._player.on(a.le.SEI,this.handleSEIParsed),this._player.on(a.le.FLVERROR,this.handleError),this._player.on(a.le.TTFB,this.handleTTFB),this._player.on(a.le.RESPONSEHEADERS,this.setCdnIp),this._player.on(a.le.METADATA,this.handleMetaDataLoaded),this._player.on(a.le.PROP_SPEED,this.handleSpeedUpdate),this._player.once(a.le.KEYFRAME,this.handleKeyframe),this._player.on(a.le.PROP_ENDEDSTATUS,this.handleEndStatus),this._player.on(a.le.RTM_NETWORK,this.handleRTMNetwork),null===(e=this._player._core)||void 0===e||e.on("srstate_change",this.handleSRStateChange),null===(t=this._player._core)||void 0===t||t.on("workerinit",this.handleWorkerInit),null===(l=this._player._core)||void 0===l||l.on("unsync",this.handleAVUnsync),i.addEventListener("loadstart",this.reportStartPlay),i.addEventListener("loadeddata",this.reportFirstframe),i.addEventListener("canplay",this.handleCanplay),i.addEventListener("waiting",this.handleWaiting),i.addEventListener("playing",this.handleOncePlaying),i.addEventListener("playing",this.handlePlaying),i.addEventListener("timeupdate",this.handleTimeupdate),i.addEventListener("ended",this.handleEnd),i.addEventListener("pause",this.handlePause),i.addEventListener("error",this.handleError),i.addEventListener("degrade",this.handleDegrade),this.initWindowListener())}offEvt(){var e,t,l;let i=this._player;i&&(this._player.off(a.le.SEI,this.handleSEIParsed),this._player.off(a.le.FLVERROR,this.handleError),this._player.off(a.le.TTFB,this.handleTTFB),this._player.off(a.le.RESPONSEHEADERS,this.setCdnIp),this._player.off(a.le.METADATA,this.handleMetaDataLoaded),this._player.off(a.le.PROP_SPEED,this.handleSpeedUpdate),this._player.off(a.le.KEYFRAME,this.handleKeyframe),this._player.off(a.le.PROP_ENDEDSTATUS,this.handleEndStatus),this._player.off(a.le.RTM_NETWORK,this.handleRTMNetwork),null===(e=this._player._core)||void 0===e||e.off("srstate_change",this.handleSRStateChange),null===(t=this._player._core)||void 0===t||t.off("workerinit",this.handleWorkerInit),null===(l=this._player._core)||void 0===l||l.off("unsync",this.handleAVUnsync),i.removeEventListener("loadstart",this.reportStartPlay),i.removeEventListener("loadeddata",this.reportFirstframe),i.removeEventListener("canplay",this.handleCanplay),i.removeEventListener("waiting",this.handleWaiting),i.removeEventListener("playing",this.handleOncePlaying),i.removeEventListener("playing",this.handlePlaying),i.removeEventListener("timeupdate",this.handleTimeupdate),i.removeEventListener("ended",this.handleEnd),i.removeEventListener("pause",this.handlePause),i.removeEventListener("error",this.handleError),i.removeEventListener("degrade",this.handleDegrade),this.removeWindowListener())}initWindowListener(){window.addEventListener("beforeunload",this.destroyFunc)}removeWindowListener(){window.removeEventListener("beforeunload",this.destroyFunc)}stallEnd(){let e=d();if(this.inWaitingStart){let t=e-this.inWaitingStart;t>200&&(this.log.play_stop.stall_count++,this.log.play_stop.stall_time+=t,this.log.playing.stall_time+=e-Math.max(this.inWaitingStart,this.log.playing.timestamp),this.log.stall.stall_end=e,this.log.playing.stall_count++,this.tea.push(this.log.stall))}this.inWaitingStart=0}reportPause(){this.log.pause.timestamp=d(),this.tea.push(this.log.pause)}handleUserLeave(){if(!this.destroyed&&!!this.started)this.updatePlayStopParams(),this.reportPlayStop(),this.clearPlayingInterval()}reportPlayStop(){this.tea.push(this.log.play_stop)}updatePlayStopParams(){let e=d(),t=e-this.log.start_play.start_play_time,{play_stop:l}=this.log;if(this.inWaitingStart&&e-this.inWaitingStart>200&&(l.stall_time+=e-this.inWaitingStart),this.inWaitingStart=0,Object.assign(l,{stall_time_per_100sec:l.stall_time/t*100,stall_count_per_100sec:1e3*l.stall_count/t*100}),0===this.log.play_stop.stall_count_per_100sec&&(this.log.play_stop.stall_time_per_100sec=0),!(this.log.play_stop.stall_time_per_100sec>100)&&!(this.log.play_stop.stall_time_per_100sec<0))this.log.playing.index?(Object.assign(this.log.playing,{is_last:1}),this.reportPlaying(!1)):(this.log.play_stop.error_code=this.log.play_error.code,this.log.play_stop.error_info=this.log.play_error.msg),Object.assign(l,{duration:t/1e3,play_time:t})}reportPlaying(e){this.log.playing.index++;let t=this.log.playing.timestamp,l=0,i=d();this.inWaitingStart&&this.inWaitingStart<i&&(l=Math.min(this.log.playing.play_time,i-Math.max(this.inWaitingStart,t))),this.getPlayerQuality(),this.getPlayerBuffer(),this.updateSpeedAndFPS();let a=i-t;a<0&&(a=1e4),l>200&&(this.log.playing.stall_time+=l,this.log.playing.stall_count++),Object.assign(this.log.playing,{duration:e?0:a/1e3,stall_time_per_100sec:e?0:this.log.playing.stall_time/a*100,stall_count_per_100sec:e?0:1e3*this.log.playing.stall_count/a*100,first_frame_view:this.log.first_frame.first_frame_view}),this.log.playing.video_render_stall_time_per_100sec=this.log.playing.stall_time_per_100sec,this.log.playing.video_render_stall_count_per_100sec=this.log.playing.stall_count_per_100sec,this.log.playing.timestamp=i,this.tea.push(Object.assign((0,o._)((0,n._)({},c(this._player._video)),{time_hour:new Date(i).getHours()}),this.log.playing)),this.log.playing.stall_time=0,this.log.playing.stall_count=0,this.log.playing.rtm_network=[]}setPlayResultTimer(){this.clearPlayResultTimer(),this.log.play_result.start=d(),this.playResultTimer=setTimeout(()=>{if(!(this.log.play_result.timestamp>=this.log.play_result.start))this.log.play_result.elapsed=d()-this.log.play_result.start,this.log.play_result.is_shorter=+(this.log.play_result.elapsed<this.log.play_result.threshold),!this.log.play_result.is_shorter&&(this.log.play_result.is_threshold=1,this.tea.push(this.log.play_result))},this.log.play_result.threshold)}clearPlayResultTimer(){clearTimeout(this.playResultTimer)}clearPlayingInterval(){clearInterval(this.intervalId)}getPlayerBuffer(){let e=this._player,t=e.buffered;if(t){let l=Math.max(0,t.length-1);try{let i=(t.end(l)-e.currentTime)*1e3;return this.log.playing.audio_buffer_time=this.log.playing.video_buffer_time=i,i}catch(e){}}return 0}getBuffered(){let e=[];try{for(let t=0;t<this._player.buffered.length;t++)e.push([this._player.buffered.start(t),this._player.buffered.end(t)])}catch(e){}return e}getPlayerQuality(){let e=this._player;try{let t=e.getVideoPlaybackQuality();this.log.playing.drop_count=t.droppedVideoFrames-this.tempDroppedFrameCount,this.log.playing.drop_percent=this.log.playing.drop_count/(t.totalVideoFrames-this.tempTotalFrameCount),this.log.play_stop.drop_percent=t.droppedVideoFrames/t.totalVideoFrames,this.tempDroppedFrameCount=t.droppedVideoFrames,this.tempTotalFrameCount=t.totalVideoFrames,this.log.stall.drop_count=this.log.playing.drop_count,this.log.stall.drop_percent=this.log.playing.drop_percent}catch(e){}}updateSpeedAndFPS(){if(this.speedInfo){let{totalByteSize:e,recentSpeed:t,renderFrames:l}=this.speedInfo,i=d(),n=i-this.playingSpeedInfoCache.timestamp;if(this.playingSpeedInfoCache.timestamp){if(e>=this.playingSpeedInfoCache.totalByteSize){let l=e-this.playingSpeedInfoCache.totalByteSize;this.log.playing.downloaded_size=l,this.log.playing.download_speed=8*l/n,this.log.playing.current_speed=t/8e3}else this.log.playing.downloaded_size=e,this.log.playing.download_speed=t/1e3,this.log.playing.current_speed=t/8e3;this.log.playing.render_fps=(l-this.playingSpeedInfoCache.renderFrames)/n*1e3}else this.log.playing.downloaded_size=e,this.log.playing.current_speed=t/8e3;this.playingSpeedInfoCache={totalByteSize:e,renderFrames:l,timestamp:i}}}constructor(e){var t,l=this;(0,i._)(this,"options",void 0),(0,i._)(this,"_player",void 0),(0,i._)(this,"log",{}),(0,i._)(this,"tea",void 0),(0,i._)(this,"inWaitingStart",0),(0,i._)(this,"tempDroppedFrameCount",0),(0,i._)(this,"tempTotalFrameCount",0),(0,i._)(this,"started",!1),(0,i._)(this,"firstFrameViewed",!1),(0,i._)(this,"destroyed",!1),(0,i._)(this,"speedInfo",void 0),(0,i._)(this,"playingSpeedInfoCache",{renderFrames:0,totalByteSize:0,timestamp:0}),(0,i._)(this,"playResultTimer",void 0),(0,i._)(this,"intervalId",void 0),(0,i._)(this,"reportUrlChange",e=>{this.tea.push(Object.assign(this.log.play_url_change,{url:e}))}),(0,i._)(this,"updateExt",e=>{var t;null===(t=this.tea)||void 0===t||t.updateCommonParams(e)}),(0,i._)(this,"reportStartPlay",()=>{this.log.start_play.start_play_time=d(),!this.started&&this.tea.push(this.log.start_play),this.started=!0,this.setPlayResultTimer()}),(0,i._)(this,"handleTTFB",e=>{let{responseUrl:t,url:l,elapsed:i}=e;this.log.first_frame.ttfb=i||-1,this.log.first_frame.is_redirect=+(t!==l)}),(0,i._)(this,"setCdnIp",e=>{var t;let{headers:l}=e;l&&(null===(t=this.tea)||void 0===t||t.updateCommonParams({cdn_ip:l["x-server-ip"]||l["X-Server-Ip"]||l["X-SERVER-IP"]}))}),(0,i._)(this,"handleMetaDataLoaded",e=>{let{trackType:t,codec:l}=e;this.log.play_metadata_loaded.meta=e,this.log.play_metadata_loaded.codec=l,this.log.play_metadata_loaded.mediaType=t,"video"===t&&this.tea.updateCommonParams({codec_type:l}),this.tea.push(this.log.play_metadata_loaded)}),(0,i._)(this,"handleSpeedUpdate",e=>{if(this.speedInfo=e,this.speedInfo){let{recentSpeed:e,renderFrames:t}=this.speedInfo;this.log.stall.current_speed=e/8e3,this.log.stall.render_fps=t}}),(0,i._)(this,"handleKeyframe",e=>{this.log.play_stop.is_firstframe_received=1,this.log.play_stop.firstframe_pts=e.pts}),(0,i._)(this,"handleEndStatus",()=>{this.stallEnd()}),(0,i._)(this,"handleRTMNetwork",e=>{this.log.playing.rtm_network.push(e)}),(0,i._)(this,"handleSRStateChange",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.running?l.log.playing.is_super_resolution=1:(l.log.playing.is_super_resolution=0,l.log.playing.sr_code=e.code,l.log.playing.sr_message=e.message)}),(0,i._)(this,"handleWorkerInit",e=>{let{costtime:t,workerReadyTime:l,workerinitStartTime:i}=e.detail||e,a=l>this.log.start_play.start_play_time?l-i:0;this.log.play_stop.worker_init_cost=this.log.first_frame.worker_init_cost=a,this.tea.push((0,o._)((0,n._)({},this.log.worker_message),{cost_time:t,worker_init_cost:a}))}),(0,i._)(this,"handleAVUnsync",e=>{let{currentTime:t,gap:l}=e.detail||e;this.tea.push((0,o._)((0,n._)({},this.log.play_av_unsync),{currentTime:t,duration:l}))}),(0,i._)(this,"handleWaiting",()=>{!this.inWaitingStart&&this.firstFrameViewed&&(this.inWaitingStart=this.log.stall.stall_start=d(),this.log.stall.play_current_time=this._player.currentTime,this.log.stall.buffered=this.getBuffered(),this.log.stall.start_diff=this.inWaitingStart-this.log.first_frame.timestamp,this.log.stall.audio_buffer_time=this.getPlayerBuffer())}),(0,i._)(this,"handleCanplay",()=>{this.stallEnd(),this.reportFirstframe()}),(0,i._)(this,"handleOncePlaying",()=>{if(this._player.removeEventListener("playing",this.handleOncePlaying),this._player.paused){this.handlePause();return}this.playingSpeedInfoCache={totalByteSize:0,renderFrames:0,timestamp:0},this.reportPlaying(!0),this.clearPlayingInterval();this.intervalId=setInterval(()=>{(100>Math.abs(d()-this.log.playing.timestamp-1e4)||d()-this.log.playing.timestamp>=1e4)&&(this._player?this._player.paused?this.handlePause():this.reportPlaying(!1):this.destroyFunc())},1e3)}),(0,i._)(this,"handlePlaying",()=>{this.stallEnd()}),(0,i._)(this,"handleTimeupdate",()=>{this.stallEnd()}),(0,i._)(this,"handleSEIParsed",e=>{if(100===e.code){let t;let{log:{playing:l,first_frame:i,play_result:n}}=this;try{t=new TextDecoder("utf-8").decode(e.content)}catch(l){t=function(e){var t,l,i,n,o;for(t="",i=e.length,l=0;l<i;)switch((n=e[l++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(n);break;case 12:case 13:t+=String.fromCharCode((31&n)<<6|63&(o=e[l++]));break;case 14:o=e[l++],t+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&e[l++])<<0)}return t}(e.content)}t=t.slice(t.indexOf("{"),t.lastIndexOf("}")+1);try{let e=JSON.parse(t),o=e.ts||e.heart_beat&&e.heart_beat.ts;if(Object.assign(i,e.loudness),Object.assign(n,e.loudness),!o){l.sei_string=t;return}l.sei_delay=d()-o,i.first_sei_delay=l.sei_delay,l.sei_source=e.source,l.ntp_sync=0,i.ntp_sync=0}catch(e){l.sei_string=t}l.sei_delay?l.sei_string=void 0:l.sei_string=t}}),(0,i._)(this,"handlePause",()=>{this.stallEnd(),this.clearPlayingInterval(),this.reportPlaying(!1),this._player.addEventListener("playing",this.handleOncePlaying),this.reportPause()}),(0,i._)(this,"handleEnd",()=>{this.stallEnd(),this.clearPlayingInterval(),this.log.playing.is_last=1,this.reportPlaying(!1),this.tea.push(this.log.play_stop)}),(0,i._)(this,"handleError",e=>{e=e.detail||e;let t=this._player.error||{};Object.assign(this.log.play_error,{code:e.httpCode||e.code||t.code,info:e.message||t.message}),this.tea.push(this.log.play_error),!this.destroyed&&(!this.firstFrameViewed&&(Object.assign(this.log.first_frame_failed,{code:this.log.play_error.code,msg:e.message||t.message}),void 0!==this.log.first_frame_failed.timestamp&&(this.log.first_frame_failed.timestamp=d()),this.tea.push(this.log.first_frame_failed),!this.log.play_result.is_threshold&&(this.clearPlayResultTimer(),this.log.play_result.reason=e.message||t.message,this.log.play_result.code=this.log.play_error.code,this.tea.push(this.log.play_result))),this.handleUserLeave())}),(0,i._)(this,"handleDegrade",e=>{Object.assign(this.log.degrade,{message:e.message}),this.tea.push(this.log.degrade)}),(0,i._)(this,"reportFirstframe",()=>{if(this.firstFrameViewed)return;this.firstFrameViewed=!0;let e=d();Object.assign(this.log.first_frame,{first_frame_view:e-this.log.start_play.start_play_time,buffered:this.getPlayerBuffer()}),this.tea.push(this.log.first_frame),this.clearPlayResultTimer(),this.log.play_result.result=1,this.tea.push(this.log.play_result),this.log.play_stop.is_stream_received=1}),(0,i._)(this,"destroyFunc",()=>{!this.destroyed&&(this.handleUserLeave(),this.destroyed=!0,this.offEvt(),this.clearPlayingInterval(),this.clearPlayResultTimer())}),this.options=(t=e,(0,n._)({onReport:()=>{}},t)),this._player=this.options.player,this.init()}}class m{bindUrlChange(){this.player.on("urlchange",this.restart)}offUrlChange(){this.player.off("urlchange",this.restart)}updateExt(e){this.options.ext=(0,n._)({},this.options.ext,e),this.logger.updateExt(e)}destroy(){this.logger.destroyFunc(),this.offUrlChange()}constructor(e){(0,i._)(this,"player",void 0),(0,i._)(this,"options",void 0),(0,i._)(this,"logger",void 0),(0,i._)(this,"restart",e=>{let{url:t}=e;this.logger.reportUrlChange(t),this.destroy(),this.logger=new v(this.options),this.bindUrlChange(),this.logger.reportStartPlay()}),this.options=e,this.logger=new v(e),this.player=this.options.player,this.bindUrlChange(),this.logger.reportStartPlay()}}}}]);