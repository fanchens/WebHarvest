"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["87191"],{248234:function(){},159362:function(e,t,n){n.d(t,{X:function(){return l}});var r=n(465769);let l=e=>({enter_from:(0,r.vM)()||"",group_id:(null==e?void 0:e.awemeId)||"",author_id:(null==e?void 0:e.authorUserId)||""})},433814:function(e,t,n){n.d(t,{f:function(){return d},w:function(){return s}});var r=n(134761),l=n(520739),i=n(878389);n(675373),n(874386);var a=n(476775),o=n(480005),s={Unknown:0,0:"Unknown",USER_NOTE:1,1:"USER_NOTE",DRAFT_NOTE:2,2:"DRAFT_NOTE",DEFAULT_NOTE:3,3:"DEFAULT_NOTE"};let d=new class e{getKey(e,t){return`${e}-${t}`}async getNoteAndFetchIfNotExist(e,t){let n=null==e?void 0:e.awemeId,r=null==e?void 0:e.authenticationToken,s=this.getNote(n,t);if(s)return s;let d=await (0,a.h4)({itemId:n,authenticationToken:r});if(0===d.status_code){let e=(0,i._)((0,l._)({},d.note||{}),{points:null==d?void 0:d.points,url_list:null==d?void 0:d.url_list});return(0,o.J)(null==d?void 0:d.url_list),this.setNote(n,t,e),e}return null}getNote(e,t){let n=this.getKey(e,t);return this.notes.get(n)||null}setNote(e,t,n){let r=this.getKey(e,t);this.notes.set(r,n)}getAllNotes(){return this.notes}clearNote(e,t){let n=this.getKey(e,t);this.notes.delete(n)}clearAllNotes(){this.notes.clear()}constructor(){(0,r._)(this,"notes",new Map)}};"undefined"!=typeof window&&(window.__noteManager=d)},302270:function(e,t,n){n.r(t),n.d(t,{default:function(){return ep}});var r=n("563097"),l=n("88648"),i=n("860923"),a=n("713097"),o=n.n(a),s=n("520739"),d=n("878389");n("874386");var u=n("877639"),c=n.n(u),v=n("734123"),f=n("439837"),h=n.n(f),m=n("124919"),p=n("196425"),g=n("643385"),w=n("742740"),_=n("441447"),y=n("465769"),x=n("732178"),E=n("433814"),k=n("739375"),b=n("754758"),T=n("69714"),N=n("328702"),I=n("692859"),C=n("70054"),S=n("55582"),L=n("874969");n("510426"),n("411628"),n("397278"),n("982730"),n("567227"),n("724341"),n("566540"),n("248234");var M=n("114843"),j=n("475586"),U=n("28791"),D=n("394405"),R=n("76392"),$=n("133490"),A=n("111187"),O=n("112987"),H=n("160812"),P=n("449381"),z=n("476934"),Z=n("607588"),F=n("604246"),K=n("588009"),V=n("756622"),q=n("912814"),W=n("807186"),Y=n("159362"),B=n("446654"),X=n("108513"),Q=n("625633");let G=async()=>V.default,J=e=>{let{awemeInfo:t,enterMethod:n,noteTypeRef:l,player:i}=e;return e=>[[D.b,{editor:e}],[q.Z,{editor:e,resizeable:!1}],[j.r,{editor:e}],[U.u,{editor:e}],[R.f,{editor:e}],[$.d,{editor:e}],[A.T,{editor:e}],[O.n,{editor:e}],[H.p,{editor:e}],[P.X,{editor:e}],[z.f,{editor:e}],[Z.W,{editor:e,shortcutsMap:W.Q}],new X.b({editor:e,clickPreventDefault:!0,onClick:e=>{null==i||i.seek(e);let r=(0,Y.X)(t);p.K.sendLog("pcAiNotePageTimestampClick",(0,d._)((0,s._)({},r),{timestamp_title:(0,Q._)(e),timestamp_position:"detail_tab",note_type:l.current&&l.current===E.w.DEFAULT_NOTE?"default":l.current?"new":"",enter_method:n}))}}),new F.U({editor:e,markdownOptions:{types:[F.C.heading,F.C.ul,F.C.ol,F.C.checkbox,F.C.bold,F.C.italic,F.C.underline,F.C.blockQuote,F.C.strikethrough,F.C.horizontal]}}),[B.Z,{editor:e,renderEquationContent:t=>{let{displayMode:n,equation:l,zoneId:i,lineState:a}=t;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(K.b,{value:l,getKatex:G,viewDisplay:n,placeholder:"new equation...",errorPlaceholder:"LaTex error",onDidRender:()=>{var t;let n=null===(t=e.virtualListManager)||void 0===t?void 0:t.getVirtualListModuleOfZone(i);(null==n?void 0:n.isEnabled)&&a&&n.notifyInnerNodeLayoutUpdate(a)}})})}}]]};var ee=n("638781"),et=n("402339"),en={"pc-editor-container":"PxljFsqy","ai-note-tip":"ZgXHAqgp",divider:"h1ELrORU"};let er={[k.h.ContentState]:b.M,[k.h.ZoneState]:T.i,[k.h.Range]:N.e,[k.h.UndoModule]:I.j0,[k.h.InputModel]:C.Z};var el=e=>{let{className:t,content:n,player:i,awemeInfo:a,noteType:s,enterMethod:d,onEditorReady:u}=e,[c,v]=(0,l.useState)(null),f=(0,l.useRef)(null),h=(0,l.useRef)(null);h.current=c;let m=(0,l.useRef)(s);m.current=s;let g=(0,l.useCallback)(async e=>{e&&(v(e),null==u||u(e))},[n,u,null==a?void 0:a.awemeId]),w=(0,l.useCallback)(e=>{e.level===S.WV.FATAL&&p.K.sendLog("pcAiNoteError",{type:"editor_fail"})},[]);return(0,l.useEffect)(()=>{c&&(async()=>{try{let e=(0,et.d)(n),t=await (0,ee.w)(e);c.setContent(t)}catch(e){p.K.sendLog("pcAiNoteError",{type:"INIT"})}})()},[c,n]),(0,l.useEffect)(()=>()=>{var e,t;null===(t=h.current)||void 0===t||null===(e=t.destroy)||void 0===e||e.call(t),h.current=null},[]),(0,r.jsxs)("div",{spellCheck:"false",ref:f,className:o()(en["pc-editor-container"],t),id:"pc-editor-container",children:[(0,r.jsx)(L.h,{editable:!1,copyable:!0,className:"pc-rich-text-editor",businessKey:"pc-rich-text-editor",schema:M.Z,register:J({awemeInfo:a,enterMethod:d,player:i,noteTypeRef:m}),onInit:g,onError:w,modules:er,scroller:f.current||!1,fgMap:{}}),n&&(0,r.jsxs)("div",{className:en["ai-note-tip"],children:[(0,r.jsx)("div",{className:en.divider})," ",(0,r.jsx)("span",{children:"内容由AI生成，用户可自行编辑内容"})," ",(0,r.jsx)("div",{className:en.divider})]})]})};let ei=(0,l.forwardRef)((e,t)=>(0,r.jsx)("svg",(0,d._)((0,s._)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,r.jsx)("path",{d:"M4.22 1.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 1 1-1.06-1.06L7.94 6 4.22 2.28a.75.75 0 0 1 0-1.06z",fill:"#fff"})}))),ea=(0,l.forwardRef)((e,t)=>(0,r.jsxs)("svg",(0,d._)((0,s._)({width:16,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,r.jsx)("path",{d:"M12.275 9.909a.36.36 0 0 1 .176.044.32.32 0 0 1 .157.21c.041.184.103.413.19.63.089.22.195.408.315.526.119.118.305.222.525.31.216.085.443.145.626.185a.32.32 0 0 1 .209.156.36.36 0 0 1 0 .353.321.321 0 0 1-.209.156c-.182.04-.41.102-.626.188-.22.087-.406.193-.525.31-.12.12-.226.307-.315.528-.087.217-.15.446-.19.63a.32.32 0 0 1-.157.208.36.36 0 0 1-.353 0 .32.32 0 0 1-.155-.21 4.173 4.173 0 0 0-.188-.629c-.088-.221-.193-.408-.313-.527-.117-.118-.302-.222-.521-.31a4.19 4.19 0 0 0-.627-.187.32.32 0 0 1-.21-.157.361.361 0 0 1 0-.352.32.32 0 0 1 .21-.157c.184-.04.412-.101.627-.186.219-.087.404-.191.522-.309.12-.118.225-.305.312-.526.086-.216.146-.445.187-.629a.32.32 0 0 1 .156-.21.36.36 0 0 1 .177-.045z",fill:"#fff"}),(0,r.jsx)("path",{d:"M12.275 9.909a.36.36 0 0 1 .176.044.32.32 0 0 1 .157.21c.041.184.103.413.19.63.089.22.195.408.315.526.119.118.305.222.525.31.216.085.443.145.626.185a.32.32 0 0 1 .209.156.36.36 0 0 1 0 .353.321.321 0 0 1-.209.156c-.182.04-.41.102-.626.188-.22.087-.406.193-.525.31-.12.12-.226.307-.315.528-.087.217-.15.446-.19.63a.32.32 0 0 1-.157.208.36.36 0 0 1-.353 0 .32.32 0 0 1-.155-.21 4.173 4.173 0 0 0-.188-.629c-.088-.221-.193-.408-.313-.527-.117-.118-.302-.222-.521-.31a4.19 4.19 0 0 0-.627-.187.32.32 0 0 1-.21-.157.361.361 0 0 1 0-.352.32.32 0 0 1 .21-.157c.184-.04.412-.101.627-.186.219-.087.404-.191.522-.309.12-.118.225-.305.312-.526.086-.216.146-.445.187-.629a.32.32 0 0 1 .156-.21.36.36 0 0 1 .177-.045z",fill:"#fff"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.435 2.144a2.016 2.016 0 0 1 2.851 0l.566.566a2.016 2.016 0 0 1 0 2.85L7.12 12.292c-.256.255-.558.46-.89.601l-2.298.975c-1.14.483-2.287-.666-1.804-1.804l.974-2.297c.141-.333.346-.635.601-.89l6.732-6.733zM4.564 9.736a1.601 1.601 0 0 0-.343.506l-.974 2.297a.16.16 0 0 0 .161.222l.05-.013 2.295-.973c.19-.08.362-.197.508-.343l5.364-5.364L9.928 4.37 4.564 9.736zm7.863-6.733a.8.8 0 0 0-1.132 0l-.507.508 1.697 1.697.508-.508a.8.8 0 0 0 0-1.13l-.566-.567z",fill:"#fff"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.435 2.144a2.016 2.016 0 0 1 2.851 0l.566.566a2.016 2.016 0 0 1 0 2.85L7.12 12.292c-.256.255-.558.46-.89.601l-2.298.975c-1.14.483-2.287-.666-1.804-1.804l.974-2.297c.141-.333.346-.635.601-.89l6.732-6.733zM4.564 9.736a1.601 1.601 0 0 0-.343.506l-.974 2.297a.16.16 0 0 0 .161.222l.05-.013 2.295-.973c.19-.08.362-.197.508-.343l5.364-5.364L9.928 4.37 4.564 9.736zm7.863-6.733a.8.8 0 0 0-1.132 0l-.507.508 1.697 1.697.508-.508a.8.8 0 0 0 0-1.13l-.566-.567z",fill:"#fff"}),(0,r.jsx)("path",{d:"M3.405 2.3c.04 0 .089.008.135.034.049.027.102.08.12.16.032.14.08.316.146.482.068.17.149.312.24.403.091.09.234.17.403.237.165.065.34.111.48.142.08.018.132.071.16.12a.276.276 0 0 1 0 .27.246.246 0 0 1-.16.12c-.14.03-.314.077-.48.143a1.224 1.224 0 0 0-.402.238 1.22 1.22 0 0 0-.241.404 3.215 3.215 0 0 0-.146.482.245.245 0 0 1-.119.16.278.278 0 0 1-.271 0 .245.245 0 0 1-.119-.161 3.209 3.209 0 0 0-.144-.482 1.216 1.216 0 0 0-.238-.404c-.09-.09-.233-.17-.4-.237a3.188 3.188 0 0 0-.48-.143.246.246 0 0 1-.16-.12.276.276 0 0 1 0-.27.245.245 0 0 1 .16-.12c.141-.031.315-.078.48-.143.168-.066.31-.146.4-.236.091-.09.171-.233.238-.402.066-.166.113-.341.143-.482a.245.245 0 0 1 .12-.16.278.278 0 0 1 .135-.035z",fill:"#fff"}),(0,r.jsx)("path",{d:"M3.405 2.3c.04 0 .089.008.135.034.049.027.102.08.12.16.032.14.08.316.146.482.068.17.149.312.24.403.091.09.234.17.403.237.165.065.34.111.48.142.08.018.132.071.16.12a.276.276 0 0 1 0 .27.246.246 0 0 1-.16.12c-.14.03-.314.077-.48.143a1.224 1.224 0 0 0-.402.238 1.22 1.22 0 0 0-.241.404 3.215 3.215 0 0 0-.146.482.245.245 0 0 1-.119.16.278.278 0 0 1-.271 0 .245.245 0 0 1-.119-.161 3.209 3.209 0 0 0-.144-.482 1.216 1.216 0 0 0-.238-.404c-.09-.09-.233-.17-.4-.237a3.188 3.188 0 0 0-.48-.143.246.246 0 0 1-.16-.12.276.276 0 0 1 0-.27.245.245 0 0 1 .16-.12c.141-.031.315-.078.48-.143.168-.066.31-.146.4-.236.091-.09.171-.233.238-.402.066-.166.113-.341.143-.482a.245.245 0 0 1 .12-.16.278.278 0 0 1 .135-.035z",fill:"#fff"})]}))),eo=(e,t,n,r)=>{let i=(0,l.useRef)({}),a=(0,l.useRef)(n);(0,l.useEffect)(()=>{a.current=n},[n]);let o=(0,l.useCallback)(e=>{let t=i.current[e.time];!t&&(t=c()(e=>{a.current(e)},5e3,{leading:!0,trailing:!1}),i.current[e.time]=t),t(e)},[]);(0,l.useEffect)(()=>{if(!r)return;let n=null,l=setTimeout(()=>{let r=e.current;if(!!r&&0!==t.length)n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){let n=e.target.getAttribute("data-chapter-time");if(n){let e=t.find(e=>e.time===Number(n));e&&o(e)}}})},{root:r,threshold:.5}),t.forEach(e=>{let t=r.querySelector(`[data-chapter-time='${e.time}']`);t&&n.observe(t)})},1e3);return()=>{clearTimeout(l),n&&n.disconnect(),Object.values(i.current).forEach(e=>{var t;return null==e?void 0:null===(t=e.cancel)||void 0===t?void 0:t.call(e)})}},[e,t,r,o])};var es=n("417194");let ed=(e,t)=>{var n;let[r,i]=(0,l.useState)(null),[a,o]=(0,l.useState)(!0),s=null==t?void 0:null===(n=t.info)||void 0===n?void 0:n.uid,d=(0,l.useCallback)(async()=>{if(!(null==e?void 0:e.awemeId)){o(!1);return}o(!0);try{let t=await E.f.getNoteAndFetchIfNotExist(e,s);i(t)}catch(e){i(null),p.K.sendLog("pcAiNoteError",{type:"detail_get_note_error",detail:(null==e?void 0:e.message)||""})}finally{o(!1)}},[null==e?void 0:e.awemeId,s]);return(0,l.useEffect)(()=>{d()},[d]),(0,l.useEffect)(()=>{let t=_.listen(_.EVENT.closeAiNoteCard,async t=>{let{awemeId:n}=t;(null==e?void 0:e.awemeId)===n&&(await (0,es._v)(300),d())});return()=>{t()}},[null==e?void 0:e.awemeId,d]),{note:r,loading:a,refresh:d}};var eu=n("128231"),ec=n.n(eu);let ev=(e,t,n)=>{let r=(0,l.useCallback)(()=>{if(e.current){let r;let l=e.current.getBoundingClientRect(),i=e.current.closest("#relatedVideoCard");if(i){let e=i.offsetHeight;r=e-((null==l?void 0:l.top)-i.getBoundingClientRect().top)-16-42-12}else r=window.innerHeight-(null==l?void 0:l.top)-16-42-12;let a=`${Math.max(r,260)}px`;e.current.style.height=t||null===n?a:"auto",e.current.style.maxHeight=a}},[t,null==n?void 0:n.detail,e]);(0,l.useEffect)(()=>{setTimeout(()=>{r()},50)},[r]),(0,l.useEffect)(()=>{let e=ec()(r,300);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[r])};var ef={previewNoteContainer:"LPWZyDv8",header:"yjgoSMfv",headerLeft:"uXmHCbV0",title:"b2e6g5qP",subTitle:"i7jZ6HBP",content:"az_1hfAM",notReadyContent:"xMYPQx7K",contentHeader:"Qnmwsf3M",contentFooter:"ld2A7KOR",arrow:"fnFq3UFz",errorMessage:"lJ5uD70t",refresh:"tcHXQ5RM"},eh=e=>{var t;let{className:n,awemeInfo:i,userInfo:a}=e,{player:u}=(0,l.useContext)(g.v),f=l.useRef(null),k=l.useRef(null),b=l.useRef(!1),{note:T,loading:N,refresh:I}=ed(i,a),C=(0,l.useMemo)(()=>(null==T?void 0:T.detail)||"",[T]),S=(0,l.useMemo)(()=>{var e;return(null==T?void 0:null===(e=T.points)||void 0===e?void 0:e.map(e=>({time:e.timestamp})))||[]},[T]),L=(0,l.useMemo)(()=>null==T?void 0:T.type,[T]),M=L&&L===E.w.DEFAULT_NOTE?"default":L?"new":"",j=(0,l.useMemo)(()=>(null==T?void 0:T.save_time)*1e3,[null==T?void 0:T.save_time]),U=new Date(j||0).toDateString()===new Date().toDateString(),D=(0,l.useMemo)(()=>{var e;return{enter_from:(0,w.yW)(),group_id:null==i?void 0:i.awemeId,note_type:M,author_id:null==i?void 0:null===(e=i.authorInfo)||void 0===e?void 0:e.uid}},[null==i?void 0:i.awemeId,null==i?void 0:null===(t=i.authorInfo)||void 0===t?void 0:t.uid,null==T?void 0:T.type]);eo(f,S,e=>{p.K.sendLog("pcAiNotePageTimestampShow",(0,d._)((0,s._)({},D),{timestamp_title:(0,Q._)(null==e?void 0:e.time),timestamp_position:"detail_tab",note_type:M}))},C),ev(f,N,T),(0,l.useEffect)(()=>{var e;if(!u)return;let t=c()(e=>{if(b.current||L!==E.w.DEFAULT_NOTE||!e||!f.current)return;let t=[...S].reverse().find(t=>(null==t?void 0:t.time)<=e);if(t&&t.time!==k.current){let e=f.current.querySelector(`[data-chapter-time='${t.time}']`);if(e){let n=f.current,r=e.offsetTop-100;Math.abs(n.scrollTop-r)>20&&(n.scrollTo({top:r,behavior:"smooth"}),k.current=t.time)}}},300),n=e=>{var n;t(null!==(n=e.currentTime)&&void 0!==n?n:0)};return null==u||null===(e=u.on)||void 0===e||e.call(u,v.Events.TIME_UPDATE,n),()=>{var e;null==u||null===(e=u.off)||void 0===e||e.call(u,v.Events.TIME_UPDATE,n)}},[S,u]),(0,l.useEffect)(()=>{let e=f.current;if(!e||N)return;let t=()=>{!b.current&&p.K.sendLog("detailTabAiNoteCardSlide",D),b.current=!0};return e.addEventListener("wheel",t,{passive:!0}),e.addEventListener("touchstart",t,{passive:!0}),()=>{e.removeEventListener("wheel",t),e.removeEventListener("touchstart",t)}},[D,N]),(0,l.useEffect)(()=>{!N&&T&&p.K.sendLog("detailTabAiNoteCardShow",D)},[N,D]);let R=()=>{var e;_.emit(_.EVENT.toggleAiCard,{tab:x.X.Note,awemeId:i.awemeId,aiNoteEnterMethod:"detail_tab"}),p.K.sendLog("aiNoteButtonEnter",{enter_from:(0,w.yW)(),enter_method:"detail_tab",group_id:null==i?void 0:i.awemeId,author_id:null==i?void 0:null===(e=i.authorInfo)||void 0===e?void 0:e.uid,player_display_mode:(0,y.Ok)()}),p.K.sendLog("detailTabAiNoteCardClick",D)},$=!N&&null!==T;return(0,r.jsxs)("div",{className:o()(ef.previewNoteContainer,n),children:[(0,r.jsxs)("div",{className:ef.header,children:[(0,r.jsxs)("div",{className:ef.headerLeft,children:[(0,r.jsx)(ea,{className:ef.icon}),(0,r.jsx)("span",{className:ef.title,children:"AI 笔记"})]}),(0,r.jsx)("div",{className:ef.headerRight,children:!!j&&(0,r.jsx)("div",{className:ef.subTitle,children:U?`${h()(j).format("HH:mm")} 修改`:`${h()(j).format("YYYY-MM-DD")} 修改`})})]}),(0,r.jsx)("div",{className:ef.contentHeader}),(0,r.jsx)("div",{className:o()(ef.content,{[ef.notReadyContent]:N||null===T}),ref:f,onClick:$?R:void 0,children:N?(0,r.jsx)(m.g,{}):null===T?(0,r.jsxs)("div",{className:ef.errorMessage,children:["服务异常，重新",(0,r.jsx)("span",{onClick:I,className:ef.refresh,children:"刷新"}),"拉取数据"]}):(0,r.jsx)(el,{content:C,onEditorReady:()=>{},className:ef.previewRichTextEditor,awemeInfo:i,player:u,noteType:L,enterMethod:()=>{}})}),$&&(0,r.jsxs)("div",{className:ef.contentFooter,onClick:R,children:["查看并编辑 AI 笔记",(0,r.jsx)(ei,{className:ef.arrow})]})]})},em={videoDetailContainer:"hBtFezpE"},ep=e=>{var t;let{awemeInfo:n,classNames:l,userInfo:a,abtestData:s}=e,d=(null==n?void 0:null===(t=n.douyinPcVideoExtra)||void 0===t?void 0:t.aiNoteV2)===1;return(0,r.jsxs)("div",{className:o()(l,em.videoDetailContainer),children:[(0,r.jsx)(i.default,{awemeInfo:n,type:"tab",isTopicLinkSearchResult:!0,abtestData:s}),d&&(0,r.jsx)(eh,{awemeInfo:n,className:em.previewRichTextEditor,userInfo:a})]})}},114843:function(e,t,n){n(250440);var r=n(910893),l=n(940493);t.Z=new r.V({enter:{displayEnter:!0},bold:{mark:!0},fontcolor:{mark:!0},fontweight:{mark:!0},italic:{mark:!0,tailInherit:!1},fontfamily:{mark:!0},fontsize:{mark:!0},underline:{mark:!0},strikethrough:{mark:!0},"comment-.*":{mark:!0},backcolor:{mark:!0},backgroundcolor:{mark:!0},"at-holder":{mark:!0},"at-uuid_.*":{mark:!0},"clientside-mention-placeholder":{mark:!0},"inline-code":{mark:!0,tailInherit:!1},"url-.*":{mark:!0,tailInherit:!1,refresh:!0},"clientside-highlight":{mark:!0},hyperlink:{mark:!0,tailInherit:!1,refresh:!0},"horizontal-line":{display:l.v.block,displayEnter:!1},textcolor:{mark:!0},aceTable:{display:l.v.block,displayEnter:!1,attributes:e=>["author"].includes(e)},image:{display:l.v.block,displayEnter:!1},video:{display:l.v.block,displayEnter:!1},language:{display:l.v.block,displayEnter:!1},heading:{lmkr:!0},list:{lmkr:!0},"noah-artifact":{display:l.v.block,displayEnter:!1,attributes:e=>["language","content"].includes(e)}})},807186:function(e,t,n){n.d(t,{Q:function(){return l}});var r=n(692859);let l=[{key:r.$l,shortcut:{windows:{ctrlKey:!0,keyCode:90},mac:{metaKey:!0,keyCode:90}}},{key:r.zq,shortcut:[{windows:{ctrlKey:!0,keyCode:90,shiftKey:!0},mac:{metaKey:!0,keyCode:90,shiftKey:!0}},{windows:{ctrlKey:!0,keyCode:89}}]}]},108513:function(e,t,n){n.d(t,{b:function(){return g}});var r=n("134761"),l=n("520739"),i=n("878389"),a=n("368200");n("874386"),n("897860");var o=n("563097"),s=n("30706"),d=n("432349"),u=n("88648"),c=n("713097"),v=n.n(c),f="m3kDy6F4",h="Ix3wyZuW",m=n("625633");let p=e=>{var{children:t}=e,n=(0,a._)(e,["children"]);let[r,d]=(0,u.useState)(!1);return(0,o.jsx)(s.Z,(0,i._)((0,l._)({},n),{className:v()(f,{[h]:r}),onSelect:()=>{d(!0)},onDeselect:()=>{d(!1)},children:t}))};class g extends d.S{match(e){return e===g.KEY}render(e){let{attributes:t}=e,n=parseInt(t["start-time"],10);if(isNaN(n))return null;let r=(0,m._)(n);return(0,o.jsx)(p,{"data-chapter-time":n,autoSelectOnClick:!1,disableDefaultSelected:!0,onClick:e=>{var t,r;this.props.clickPreventDefault&&(e.preventDefault(),e.stopPropagation()),null===(t=(r=this.props).onClick)||void 0===t||t.call(r,n)},children:r})}constructor(e){super(),(0,r._)(this,"props",void 0),(0,r._)(this,"editorCollectText",e=>{let t=parseInt(e.attributes["start-time"],10);!isNaN(t)&&(e.text=`[章节时间 ${(0,m._)(t)}]`)}),this.props=e}}(0,r._)(g,"KEY","chaptertime")},446654:function(e,t,n){n(284961),n(826893),n(429532);var r=n(479782),l=n(975917);class i extends r.C{serialize(e){var t;let{type:n,op:r}=e;if(n===l.T.LEAF&&(null==r?void 0:null===(t=r.attributes)||void 0===t?void 0:t.equation))try{let t=r.attributes.equation,n=document.createElement("span");n.className="editor-kit-equation",n.setAttribute("data-equation",t),n.setAttribute("data-equation-type","katex");let l=t.replace(/\n/g," ").trim(),i=`$$${l}$$`;return n.innerHTML=i,n.style.whiteSpace="nowrap",n.style.display="inline",Object.assign(e,{node:n})}catch(e){}return e}}t.Z=i},912814:function(e,t,n){n.d(t,{Z:function(){return v}}),n("874386");var r=n("563097"),l=n("618849"),i=n("30706"),a=n("88648"),o=n("162095"),s="GD5Q9mxF",d="kh5D4GZp";let u=e=>{let{src:t,children:n}=e,[l,i]=(0,a.useState)(!1),u=(0,a.useCallback)(e=>{i(e)},[]),c=(0,a.useCallback)(()=>{i(!0)},[]);return(0,a.useEffect)(()=>{let e=e=>{e.stopPropagation(),e.preventDefault()};return l&&(document.addEventListener("keydown",e,!0),document.addEventListener("keyup",e,!0),document.addEventListener("keypress",e,!0)),()=>{document.removeEventListener("keydown",e,!0),document.removeEventListener("keyup",e,!0),document.removeEventListener("keypress",e,!0)}},[l]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{onDoubleClick:c,children:n}),(0,r.jsx)(o.ImagePreview,{disableDownload:!0,maskClosable:!1,className:s,previewCls:d,src:t,visible:l,onVisibleChange:u})]})};class c extends l.E{render(e){var t,n;if((null==e?void 0:null===(t=e.attributes)||void 0===t?void 0:t.isSkeleton)!=="true"){let t=super.render(e),l=null==e?void 0:null===(n=e.attributes)||void 0===n?void 0:n.src;return l?(0,r.jsx)(i.Z,{autoSelectOnClick:!1,disableDefaultSelected:!0,children:(0,r.jsx)(u,{src:l,children:t})}):t}return(0,r.jsx)(i.Z,{autoSelectOnClick:!1,disableDefaultSelected:!0,children:(0,r.jsx)(o.Skeleton,{placeholder:(0,r.jsx)(o.Skeleton.Title,{style:{width:"100%",height:"150px",marginBottom:12,marginTop:12,backgroundImage:"linear-gradient(90deg, rgba(255,255,255, 0.12) 25%, rgba(255,255,255, 0.16) 44%, rgba(255,255,255, 0.12) 88%)"}}),loading:!0,active:!0})})}}var v=c},625633:function(e,t,n){n.d(t,{_:function(){return o}});var r=n(577603),l=n.n(r),i=n(439837),a=n.n(i);a().extend(l());let o=e=>{if(isNaN(e)||e<0)return"";let t=a().duration(e,"seconds");return t.asHours()>=1?t.format("HH:mm:ss"):t.format("mm:ss")}},124916:function(e,t,n){n.d(t,{AY:function(){return g},Au:function(){return y},Rl:function(){return w},Y$:function(){return x},Yr:function(){return p},c$:function(){return _},hu:function(){return m}});var r=n(134761),l=n(520739),i=n(878389);n(874386),n(209955),n(338172),n(268917),n(284961),n(826893),n(50013),n(565306),n(838906);var a=n(419936),o=n.n(a);n(23902);var s=n(744483),d=n.n(s),u=n(300277),c=n.n(u);n(890896),n(461819);var v=n(866152),f=n(11622);class h extends Error{constructor(...e){super(...e),(0,r._)(this,"name","assert_error")}}let m=(e,t)=>{if(!e){if(d()(t))throw t;throw new h(t)}},p="doc-reference",g={"<":"&#x3C;",">":"&#x3E;",'"':"&#x22;"},w=(e,t,n)=>{var r,a;if(c()(t)&&c()(n))return e;if(c()(n)){let n=null===(a=e[v.HP.INSERT])||void 0===a?void 0:a.slice(null!=t?t:0);return(0,i._)((0,l._)({},e),{[v.HP.INSERT]:n})}let o=null===(r=e[v.HP.INSERT])||void 0===r?void 0:r.slice(null!=t?t:0,null!=n?n:0);return(0,i._)((0,l._)({},e),{[v.HP.INSERT]:o})},_=e=>{var t;return o()(e)?e.map(e=>{var t;return null!==(t=e.insert)&&void 0!==t?t:""}).join(""):null!==(t=e.insert)&&void 0!==t?t:""},y=e=>e instanceof f.I,x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(null==e?void 0:e.length)?e.flatMap(e=>[{start:e.endIndex,end:e.endIndex,insert:`<reference type="end" id=${e.referenceId}>`}]):[]}},480005:function(e,t,n){n.d(t,{J:function(){return l},O:function(){return i}});var r=n(134761);n(874386),n(250440);let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.length>0){let n=e.map(e=>{var n,r,l;return{uri:null==e?void 0:e.uri,url:null!==(l=t?null==e?void 0:null===(n=e.urlList)||void 0===n?void 0:n[0]:null==e?void 0:null===(r=e.url_list)||void 0===r?void 0:r[0])&&void 0!==l?l:""}}).filter(e=>e.uri&&e.url);n.length>0&&i.addOnlineMappings(n)}},i=new class e{findUriByUrl(e,t){for(let[n,r]of e.entries())if(r===t||(null==t?void 0:t.includes(n)))return n}addLocalMapping(e,t){this.localUriToUrl.set(e,t)}addOnlineMapping(e,t){this.onlineUriToUrl.set(e,t)}addOnlineMappings(e){e.forEach(e=>{let{uri:t,url:n}=e;return this.addOnlineMapping(t,n)})}getUrlFromUri(e){var t;return null!==(t=this.onlineUriToUrl.get(e))&&void 0!==t?t:this.localUriToUrl.get(e)}getUriFromUrl(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n?this.findUriByUrl(this.onlineUriToUrl,e):null!==(t=this.findUriByUrl(this.onlineUriToUrl,e))&&void 0!==t?t:this.findUriByUrl(this.localUriToUrl,e)}getAllMappings(){return{local:this.localUriToUrl,online:this.onlineUriToUrl}}clear(){this.localUriToUrl.clear(),this.onlineUriToUrl.clear()}constructor(){(0,r._)(this,"localUriToUrl",new Map),(0,r._)(this,"onlineUriToUrl",new Map)}}},402339:function(e,t,n){n.d(t,{d:function(){return i}}),n(284961),n(826893),n(338172);var r=n(480005);let l=/!\[(.*?)\]\((.*?)\)/g,i=e=>e?e.replace(l,(e,t,n)=>{if(null==n?void 0:n.startsWith("http"))return e;let l=r.O.getUrlFromUri(n);return l?`![${t}](${l})`:e}):""},638781:function(e,t,n){n.d(t,{w:function(){return er}});var r=n("520739"),l=n("878389");n("110006"),n("826893"),n("874386");var i=n("756622"),a=n("438638"),o=n("504807"),s=n("524007"),d=n("11622"),u=n("471448");n("50013"),n("981168");var c=n("209239");n("209955");var v=n("124916");let f=e=>(0,v.Au)(e)?e:e.target,h=e=>(0,v.Au)(e)?new u.D:e.deltaSet,m=(e,t)=>{for(let n of e){if(t(n))return n;if((0,o.UY)(n)){let e=m(n.children,t);if(e)return e}}},p=(e,t)=>(0,c.X)(e.type,"root")?new d.I().insertLineMarker().concat(f(t).insertEnter()):f(t).insertEnter(),g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!(null==t?void 0:t.length)||!e)return e;let n=[...t].sort((e,t)=>e.start-t.start),r=e,l=0;for(let t of n){let{start:n,end:i,insert:a}=t;if(n<0||i>e.length||n>i)continue;let o=n+l,s=i+l;r=r.slice(0,o)+a+r.slice(s),l+=a.length-(i-n)}return r};n("897860"),n("338172");let w=e=>{let t=e.match(/type=&#x22;(\w+)&#x22;/),n=e.match(/id=(\d+)/),r=t?t[1]:null;return{type:r,id:n?parseInt(n[1],10):null}},_={name:"html",match:e=>{var t;return(null==e?void 0:e.type)==="html"&&(null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.startsWith(`${v.AY["<"]}reference`))},converter(e){let{content:t}=e,{type:n,id:r}=w(t.value);return n&&r?{target:new d.I().insert("*",{[v.Yr]:`${r}`,type:n}),deltaSet:new u.D}:{target:new d.I,deltaSet:new u.D}}},y={name:"heading",converter(e){let{content:t,getConvert:n}=e,r=n(t.children);return{target:new d.I().insertLineMarker({heading:`h${t.depth}`}).concat(f(r)).insertEnter(),deltaSet:h(r)}}},x={name:"paragraph",converter(e){let{content:t,getConvert:n,parent:r}=e,l=n(t.children);return{target:p(r,l),deltaSet:h(l)}}},E={name:"text",converter(e){let{content:t}=e;return{target:new d.I().insert(t.value),deltaSet:new u.D}}},k={name:"emphasis",converter(e){let{content:t,getConvert:n}=e,r=n(t.children),l=f(r);return{target:l.compose(new d.I().retain(l.length(),{italic:"true"})),deltaSet:h(r)}}},b={name:"strong",converter(e){let{content:t,getConvert:n}=e,r=n(t.children),l=f(r);return{target:l.compose(new d.I().retain(l.length(),{bold:"true"})),deltaSet:h(r)}}},T={name:"delete",converter(e){let{content:t,getConvert:n}=e,r=n(t.children),l=f(r);return{target:l.compose(new d.I().retain(l.length(),{strikethrough:"true"})),deltaSet:h(r)}}},N={name:"break",converter:()=>({target:new d.I().insert("\n"),deltaSet:new u.D})};n("950331"),n("268917");var I=n("564981");let C={name:"list",converter(e){let{content:t,getConvert:n}=e,r=t.children.map((e,n)=>({item:e,start:(t.start||1)+n,level:1,isOrdered:!!t.ordered})).reverse(),l=new u.D,i=new d.I;for(;r.length;){let e=r.pop();(0,v.hu)(e);let{item:t,start:a,level:o,isOrdered:s}=e,{checked:d}=t;null!==d?i.insertLineMarker({list:`${d?"check":"done"}${o}`,"ol-id":(0,I.D)(8),start:"3"}):s?i.insertLineMarker({list:`number${o}`,"ol-id":(0,I.D)(8),start:String(a),"origin-start":String(a)}):i.insertLineMarker({list:`bullet${o}`});let u=[];for(let e of t.children)if("list"===e.type)u.unshift(...e.children.map((t,n)=>({item:t,start:(e.start||1)+n,level:o+1,isOrdered:!!e.ordered})).reverse());else{let t=n([e]);l=l.compose(h(t)),i=i.concat(f(t))}r.push(...u)}return{target:i,deltaSet:l}}};n("779788");let S={name:"link",converter(e){let{content:t,getConvert:n}=e,r=n(t.children),l=f(r);return{target:l.compose(new d.I().retain(l.length(),{hyperlink:JSON.stringify({href:t.url,linkId:(0,I.D)(10)})})),deltaSet:h(r)}}},L={name:"linkReference",converter(e){let{root:t,content:n,getConvert:r}=e,l=r(n.children),i=f(l),a=m(t.children,e=>"definition"===e.type&&e.identifier===n.identifier);return{target:a?i.compose(new d.I().retain(i.length(),{hyperlink:JSON.stringify({href:a.url,linkId:(0,I.D)(10)})})):i,deltaSet:h(l)}}},M={name:"definition",converter:()=>({target:new d.I,deltaSet:new u.D})},j={name:"image",converter(e){let{content:t}=e,{alt:n,url:r}=t;return{target:new d.I().insertLineMarker().insert(" ",{alt:null!=n?n:"",image:"true",src:r,uuid:(0,I.D)(8)}),deltaSet:new u.D}}},U={name:"imageReference",converter(e){let{root:t,content:n}=e,{alt:r}=n,l=m(t.children,e=>"definition"===e.type&&e.identifier===n.identifier);return{target:l?new d.I().insertLineMarker().insert(" ",{alt:null!=r?r:"",image:"true",src:l.url,uuid:(0,I.D)(8)}):new d.I().insert(null!=r?r:""),deltaSet:new u.D}}},D={name:"blockquote",converter(e){let{content:t,getConvert:n}=e,r=n(t.children);return{target:new d.I().insertLineMarker({blockquote:"true"}).concat(f(r)).insertEnter(),deltaSet:h(r)}}};n("954372");let R=/^<u>([\s\S]*)<\/u>$/,$={name:"html",match:e=>R.test(e.value),converter:e=>{let{content:t}=e,n=t.value.match(R),r=n?n[1]:"";return{target:new d.I().insert(r,{underline:"true"}),deltaSet:new u.D}}};n("413806"),n("668156"),n("242079"),n("851912"),n("927234"),n("284961");let A=Object.fromEntries(Object.entries({"<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;"}).map(e=>{let[t,n]=e;return[n,t]})),O=RegExp(Object.keys(A).join("|"),"g"),H=e=>e?e.replace(O,e=>A[e]):"";var P=n("439837"),z=n.n(P),Z=n("577603"),F=n.n(Z);z().extend(F());let K=e=>{let t=H(e).match(/data-time=['"](\d{2}:\d{2}:\d{2})['"]/);if(t&&t[1]){let e=t[1].split(":").map(Number);return{timeInSeconds:z().duration({hours:e[0],minutes:e[1],seconds:e[2]}).asSeconds()}}return{timeInSeconds:null}},V={name:"html",match:e=>(null==e?void 0:e.type)==="html"&&/chaptertime/.test((null==e?void 0:e.value)||""),converter(e){let{content:t}=e,{timeInSeconds:n}=K(t.value||"");return null===n||n<0||n>86400?{target:new d.I,deltaSet:new u.D}:{target:new d.I().insert(" ",{"start-time":String(n),chaptertime:"true"}),deltaSet:new u.D}}};n("214478"),n("807192"),n("99891");let q=e=>{try{let t=new DOMParser().parseFromString(e,"text/html").querySelector("[data-type=inline-math],[data-type=block-math]");if(!t)return;let n=t.dataset.value,r=t.dataset.type;if(!n)return;return{tex:window.atob(n),isInline:"inline-math"===r}}catch(e){return}},W={name:"html",converter(e){let{content:t}=e,n=q(t.value);if(n){let{tex:e,isInline:t}=n;return{target:t?new d.I().insert(" ",{equation:e}):new d.I().insertLineMarker().insert(" ",{equation:e}).insertEnter(),deltaSet:new u.D}}return{target:new d.I,deltaSet:new u.D}}},Y={name:"thematicBreak",converter:()=>({target:new d.I().insertLineMarker().insert("*",{"horizontal-line":"true"}).insertEnter(),deltaSet:new u.D})},B={name:"inlineMath",converter(e){let{content:t}=e;return{target:new d.I().insert(" ",{equation:t.value}),deltaSet:new u.D}}},X={name:"math",converter(e){let{content:t}=e;return{target:new d.I().insertLineMarker().insert(" ",{equation:t.value}).insertEnter(),deltaSet:new u.D}}};var Q=n("134761");n("250440");var G=n("236919");class J extends G.XS{constructor(...e){super(...e),(0,Q._)(this,"name","transform_invalid_reference_quote"),(0,Q._)(this,"config",{priority:2}),(0,Q._)(this,"modifier",(e,t)=>{var n;let{insertAfter:r,skip:l,parent:i}=t;if(!!["root","blockquote"].includes(null==i?void 0:i.type)&&!!(0,o.Xd)(e,"html")&&!!(null===(n=e.value)||void 0===n?void 0:n.startsWith(`${v.AY["<"]}reference`)))l(),r([],!0)})}}let ee=e=>{let{root:t,content:n,plugins:r,parent:l,getConvert:i}=e,a=r.find(e=>{var t,r;return null!==(r=null===(t=e.match)||void 0===t?void 0:t.call(e,n))&&void 0!==r?r:e.name===n.type});return a?a.converter({root:t,parent:l,content:n,getConvert:i}):{target:new d.I,deltaSet:new u.D}},et=e=>{let{plugins:t,root:n,contents:r,parent:l}=e,i=new d.I,a=new u.D;if(!r.length)return{target:i,deltaSet:a};for(let e of r){let r=ee({content:e,plugins:t,root:n,parent:l,getConvert:r=>et({plugins:t,root:n,contents:r,parent:e})});i=i.concat(f(r)),a=a.compose(h(r))}return{target:i,deltaSet:a}},en=e=>{let t=et({plugins:[y,x,E,k,b,T,N,C,S,L,M,j,U,D,$,V,_,W,Y,B,X],root:e,contents:e.children,parent:e});return new u.D().compose(new d.I({zoneId:s.S}).concat(f(t))).compose(h(t))},er=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{indentedCode:n}=t,s=t.referenceData;e=g(e,(0,v.Y$)(s));let{ast:d}=(0,a.w)((0,l._)((0,r._)({},t),{katex:i.default,source:e,enabledHtmlTags:["u"],astPlugins:[new J]}));return en(null!=d?d:(0,o.eL)(e,{enableIndentedCode:n}))}},65743:function(e,t,n){n(874386);var r=n(563097),l=n(88648),i=n(734123),a=n(713097),o=n.n(a),s=n(128231),d=n.n(s),u=n(725887),c=n(465769),v=n(852664),f=n(451118),h=n(28528),m=n(613480),p=n(514243),g=n(355253);t.Z=l.memo(e=>{let{children:t,lineClamp:n=2,btnClassName:a,onlyKey:s="",maxLine:w=999,btnOnClick:_,renderContent:y,lineHeight:x=20,renderButton:E,player:k,showExpandButton:b=!0,renderBeforeContent:T,className:N}=e,[I,C]=(0,l.useState)(!1),[S,L]=(0,l.useState)(!1),M=(0,l.useRef)(w);M.current=w;let[j,U]=(0,l.useState)(n),{isFullScreen:D,isCssFullScreen:R}=(0,l.useContext)(m.C),$=(0,l.useRef)(null),[A,O]=(0,l.useState)(!1),[H,P]=(0,l.useState)(()=>{let e=u.Le.getConfig(u.gI.IsInModalVideo),t=(null==e?void 0:e.isInModal)||!1;return"video_detail"===(0,c.vM)()&&!D&&!R&&!t&&!0});(0,l.useEffect)(()=>{if(k){let e=e=>{let t=u.Le.getConfig(u.gI.IsInModalVideo),n=(null==t?void 0:t.isInModal)||!1;"video_detail"!==(0,c.vM)()||e||R||n?P(!1):P(!0)};return k.on(i.Events.FULLSCREEN_CHANGE,e),()=>{k.off(i.Events.FULLSCREEN_CHANGE,e)}}},[]),(0,l.useEffect)(()=>{O((0,v.i7)()&&!(0,v.GP)())},[]);let z=(0,l.useCallback)(d()(()=>{(0,l.startTransition)(()=>{if((null==$?void 0:$.current)&&!S){let{scrollHeight:e,clientHeight:t,clientWidth:r}=null==$?void 0:$.current;if(!!r)t>0&&(e-t>15||e>=x*n+15)?C(!0):C(!1)}})},500),[x,n,S]);return(0,l.useEffect)(()=>{let e=null;return $.current&&(e=f.Z.bind($.current,z)),()=>{e&&(null==e||e())}},[z]),(0,l.useEffect)(()=>{L(!1),U(n),C(!1),z()},[s,n,x]),(0,r.jsx)("div",{className:o()(p.default.wrapper,{[p.default.notChrome]:!A,[p.default.isDetailSearch]:H,[p.default.isFixAfter]:!b}),children:(0,r.jsxs)("div",{ref:$,className:o()(p.default.text,N,{[p.default.expandText]:S,[p.default.lowChome]:(0,v.h5)("69.0"),[p.default.isSafari]:(0,v.G6)()}),style:{"--lineClamp":j,"--lineHeight":`${x}px`,"--maxHeight":`${x*j}px`},children:[(0,r.jsx)("div",{className:o()(p.default.btnWrap,{[p.default.btnShow]:I,[p.default.isUnfold]:S}),style:{height:`${x-2}px`},children:b&&(0,r.jsx)("button",{type:"button",onClick:e=>{if(!S){let e=(0,g.Y)(x,k);e&&(M.current=e)}U(e=>e===n?M.current:n),L(e=>!e),_&&_(S),(null==e?void 0:e.target)&&e.target.blur()},className:o()(a,p.default.btn),children:E?E(S):S?h.a.t("fold",{},"收起"):h.a.t("expand",{},"展开")})}),T&&T(I),y&&y({isUnfold:S}),"function"==typeof t?t(I):t]})})})},860923:function(e,t,n){n.r(t),n(874386);var r=n(563097),l=n(88648),i=n(713097),a=n.n(i),o=n(406852),s=n(132607),d=n(832052),u=n(477667),c=n(828782),v=n(441447),f=n(742740),h=n(737271),m=n(465769),p=n(824790),g=n(768492),w=n(907170),_=n(494613),y=n(961412),x=n(115627),E=n(398569),k=n(533155),b=n(554631),T=n(335101),N=n(65743),I=n(873647);t.default=e=>{var t;let{isTopicLinkSearchResult:n,awemeInfo:i,isTopicLinkDetail:C,abtestData:S,handleMobileSiteClick:L,onClose:M,type:j="default"}=e,{awemeType:U,awemeId:D,authorInfo:R,logPb:$,textExtra:A,webRawData:O,mixInfo:H}=i||{},P=(0,T.n)(),z=(0,l.useRef)(null),{uid:Z,nickname:F,remarkName:K}=R||{},{changeKeyword:V,resetSearchParams:q}=(0,o.w)(),[W,Y]=(0,l.useState)(!1),B=(0,l.useRef)(),{isShowTitleAndDescAlone:X,finalTitle:Q,title:G,desc:J,computedTextExtra:ee}=(0,I.Q)({awemeInfo:i,abTestData:S}),et=(e,t,r)=>{var l;let i=null==S?void 0:S.searchOpenCurrentTab;((null==i?void 0:i.save_status)!==1||(0,c.DT)()||(null===(l=window)||void 0===l?void 0:l.location.pathname)!=="/")&&n&&v.emit(v.EVENT.videoPause,"VideoInfoSideCard_clickHashtag_cover"),k.Z.sendLog("clickTitleHashtag",{hashtag:t.slice(1),urlParamList:["previous_page"],author_id:Z,group_id:D,log_pb:$,enter_from:(0,f.yW)(),is_full_screen:(0,h.r)()?"1":"0",tag_id:e,status:"on",player_display_mode:(0,m.Ok)()})},en=e=>{v.emit(v.EVENT.videoPause,"VideoInfoSideCard_clickAuthorHead_cover"),k.Z.sendLog("clickTitleAt",{to_user_id:e,urlParamList:["previous_page"],author_id:Z,group_id:D,log_pb:$,enter_from:(0,f.yW)(),is_full_screen:(0,h.r)()?"1":"0"})},er=(e,t,n,r)=>{var l;let a=null==S?void 0:S.searchOpenCurrentTab;((null==a?void 0:a.save_status)!==1||(0,c.DT)()||(null===(l=window)||void 0===l?void 0:l.location.pathname)!=="/")&&v.emit(v.EVENT.videoPause,"VideoInfoSideCard_clickSearchText_cover"),(0,E.v2)(e,{source:"related_search_anchor_v2"},(null==S?void 0:S.open_current_tab)===1,(null==S?void 0:S.save_video)===1,(null==S?void 0:S.clientSpaV2)===s.CommonSwitch.On&&(0,c.DT)(),V,q),k.Z.sendLog("trendingWordsClick",{enter_group_id:D,enter_group_type:U===d.e.Note?"aweme_image":"aweme_video",group_id:t,search_position:(0,f.yW)(),words_content:e,words_position:n,impr_id:(0,p.U)(i).impr_id})},el=(0,l.useCallback)((e,t,n)=>{k.Z.sendLog("trendingWordsShow",{enter_group_id:D,enter_group_type:U===d.e.Note?"aweme_image":"aweme_video",group_id:t,search_position:(0,f.yW)(),words_content:e,words_position:n,impr_id:(0,p.U)(i).impr_id})},[D,U,i]),ei=(0,l.useCallback)(()=>{var e,t;if(!!(null==B?void 0:B.current))Y((null==B?void 0:null===(e=B.current)||void 0===e?void 0:e.scrollHeight)>(null==B?void 0:null===(t=B.current)||void 0===t?void 0:t.clientHeight))},[]);return(0,l.useEffect)(()=>{var e,t,n,r,l,i;let a=e=>{var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e)};return null==z||null===(t=z.current)||void 0===t||null===(e=t.addEventListener)||void 0===e||e.call(t,"scroll",a),null==z||null===(r=z.current)||void 0===r||null===(n=r.addEventListener)||void 0===n||n.call(r,"wheel",a),null==z||null===(i=z.current)||void 0===i||null===(l=i.addEventListener)||void 0===l||l.call(i,"touchstart",a),()=>{var e,t,n,r,l,i;null==z||null===(t=z.current)||void 0===t||null===(e=t.removeEventListener)||void 0===e||e.call(t,"scroll",a),null==z||null===(r=z.current)||void 0===r||null===(n=r.removeEventListener)||void 0===n||n.call(r,"wheel",a),null==z||null===(i=z.current)||void 0===i||null===(l=i.removeEventListener)||void 0===l||l.call(i,"touchstart",a)}},[]),(0,l.useEffect)(()=>{ei()},[Q,ei]),(0,l.useEffect)(()=>(window.addEventListener("resize",ei),()=>{window.removeEventListener("resize",ei)}),[ei]),(0,r.jsxs)("div",{ref:z,className:a()(_.default.videoInfoSideCard,{[_.default.tab]:"tab"===j}),onMouseEnter:()=>{v.emit(v.EVENT.videoStopPlayNext,{openSideCard:!0})},onMouseLeave:()=>{v.emit(v.EVENT.videoRemoveStopPlayNext,{openSideCard:!0})},children:[(0,r.jsxs)("div",{className:_.default.header,children:[(0,r.jsx)("div",{className:_.default.account,children:(0,r.jsxs)("div",{className:_.default.accountWrapper,children:[(0,r.jsx)("span",{className:_.default.accountName,children:(0,r.jsx)(y.Z,{text:`@${K||F}`})}),(0,r.jsx)("span",{className:_.default.videoCreateTime,children:`\xb7 ${(0,w.MH)(1e3*i.createTime)}`})]})}),"default"===j&&(0,r.jsx)("div",{className:_.default.closeBtn,onClick:M,children:(0,r.jsx)(x.Z,{src:u.Z,width:36,height:36,viewBox:"0 0 36 36",className:_.default.icons})})]}),(0,r.jsxs)("div",{className:_.default.content,ref:B,children:["tab"===j&&(0,r.jsx)(N.Z,{lineHeight:26,lineClamp:(null==i?void 0:null===(t=i.douyinPcVideoExtra)||void 0===t?void 0:t.aiNoteV2)===1?10:999999,onlyKey:null==i?void 0:i.awemeId,btnClassName:_.default.button,btnOnClick:()=>{},renderContent:e=>{let{isUnfold:t}=e,o=(0,r.jsx)(y.Z,{wrapperClassName:_.default.videoTitleWrapper,className:a()(_.default.videoTitle,_.default.adaptive),userTextClassName:a()(_.default.hashTagSpan,_.default.userText),hashTagClassName:a()({[_.default.linkHashTag]:n}),getHashTagHref:(e,t)=>n?`https://www.douyin.com/search/${encodeURIComponent(e)}?source=pc_click_hashtag_feed&enter_from=${(0,m.vM)()}&aweme_id=${i.awemeId}&gid=${i.groupId}`:C?(0,g.bP)(t):"",text:Q,getSearchTextUrl:(e,t)=>`https://www.douyin.com/search/${encodeURIComponent(e)}?source=title_named_entity&enter_from=${(0,m.vM)()}&aweme_id=${i.awemeId}&gid=${i.groupId}`,isRemoveRowspan:!1,textExtra:A,awemeInfo:i,onClickHashtag:L||et,onClickUser:L||en,onSearchTextClick:L||er,onSearchTextMounted:el,enterMethod:"video_title_at",searchWordsType:b.L.VideoInfoTitle,abTestData:S,player:P,children:(null==H?void 0:H.currentEpisode)&&(0,r.jsxs)("span",{children:["第",null==H?void 0:H.currentEpisode,"集："]})});return l.createElement("div",{className:_.default.title,style:{display:"inline"}},o)},className:_.default.textMultiLineExpansionOldWrap}),"tab"!==j&&X&&(0,r.jsxs)("div",{className:a()(_.default.videoTitle,_.default.adaptive,_.default.aloneVideoTitle),children:[(null==H?void 0:H.currentEpisode)&&(0,r.jsxs)("span",{children:["第",null==H?void 0:H.currentEpisode,"集："]}),(0,r.jsx)("span",{children:G})]}),"tab"!==j&&(0,r.jsx)(y.Z,{wrapperClassName:_.default.videoTitleWrapper,className:a()(_.default.videoTitle,_.default.adaptive),userTextClassName:a()(_.default.hashTagSpan,_.default.userText),hashTagClassName:a()({[_.default.linkHashTag]:n}),getHashTagHref:(e,t)=>n?`https://www.douyin.com/search/${encodeURIComponent(e)}?source=pc_click_hashtag_feed&enter_from=${(0,m.vM)()}&aweme_id=${i.awemeId}&gid=${i.groupId}`:C?(0,g.bP)(t):"",text:X?J:Q,getSearchTextUrl:(e,t)=>`https://www.douyin.com/search/${encodeURIComponent(e)}?source=title_named_entity&enter_from=${(0,m.vM)()}&aweme_id=${i.awemeId}&gid=${i.groupId}`,isRemoveRowspan:!1,textExtra:ee,awemeInfo:i,onClickHashtag:L||et,onClickUser:L||en,onSearchTextClick:L||er,onSearchTextMounted:el,enterMethod:"video_title_at",searchWordsType:b.L.VideoInfoTitle,abTestData:S,player:P,children:(null==H?void 0:H.currentEpisode)&&!X&&(0,r.jsxs)("span",{children:["第",null==H?void 0:H.currentEpisode,"集："]})}),W&&"tab"!==j&&(0,r.jsx)("div",{className:_.default.noMore,children:"暂时没有更多内容"})]})]})}},873647:function(e,t,n){n.d(t,{Q:function(){return u}});var r=n("520739"),l=n("878389");n("874386"),n("826893"),n("268917"),n("455663"),n("675373");var i=n("88648"),a=n("894621");n("338172");var o=n("725887"),s=n("487330");let d=e=>{let{awemeInfo:t}=e,{desc:n,webRawData:r}=t,{isMainland:l}=(0,s.Iq)(e=>{let{isMainland:t}=e;return{isMainland:t}}),[d,u]=(0,i.useState)(`${n}${(null==r?void 0:r.targetTitle)?`\\N${null==r?void 0:r.targetTitle}`:""}`);return(0,i.useEffect)(()=>{(null==r?void 0:r.targetTitle)?u(`${n}\\N${null==r?void 0:r.targetTitle}`):u(n)},[r,n]),(0,i.useEffect)(()=>{var e;let t=o.Le.getConfig(o.gI.AbtestData);(null==t?void 0:t.i18nAb)&&!l&&!(null===(e=navigator)||void 0===e?void 0:e.language.startsWith("zh"))&&!r.targetTitle&&(async()=>{let e=await (0,a.O9)({sourceText:n,targetLanguage:"en"});if(0===e.statusCode){var t,r;let l=null===(r=e.translation)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.translation;u(`${n}\\N${l}`)}})()},[r,l,n]),{finalTitle:d}},u=e=>{var t;let{awemeInfo:n,abTestData:o}=e,{itemTitle:u,caption:c,textExtra:v}=n,{isMainland:f}=(0,s.Iq)(e=>{let{isMainland:t}=e;return{isMainland:t}}),h=(0,i.useRef)(null),m=(null==o?void 0:o.videoInfoTitleDisplayStrategy)===1&&!!(null===(t=n.itemTitle)||void 0===t?void 0:t.trim()),{finalTitle:p}=d({awemeInfo:n}),[g,w]=(0,i.useState)(u),[_,y]=(0,i.useState)(c),x=(0,i.useMemo)(()=>{let e;if(!m||!v||!Array.isArray(v)||0===v.length)return v;let t=[],n=/#[^\s#]+/g;for(;e=n.exec(_);)t.push({hashtagName:e[0].substring(1),start:e.index,end:e.index+e[0].length});return v.filter(e=>t.some(t=>t.hashtagName===e.hashtagName)).map(e=>{let n=t.find(t=>t.hashtagName===e.hashtagName);return(0,l._)((0,r._)({},e),{start:(null==n?void 0:n.start)||0,end:(null==n?void 0:n.end)||0})})},[m,v,_]),[E,k]=(0,i.useState)(1),[b,T]=(0,i.useState)(!1),N=(0,i.useMemo)(()=>m?Math.max(1,3-E):3,[m,E]);return(0,i.useLayoutEffect)(()=>{if(!h.current)return;let e=e=>{var t;if(!e){k(1),T(!1);return}let n=null===(t=getComputedStyle(e))||void 0===t?void 0:t.lineHeight;k(Math.round(e.offsetHeight/parseFloat(n))),T(function(e){if(!(e instanceof HTMLElement))return!1;let t=getComputedStyle(e);return"hidden"===t.overflow&&("nowrap"===t.whiteSpace?e.scrollWidth>e.offsetWidth:!!t.webkitLineClamp&&e.scrollHeight>e.offsetHeight)}(e))};if(e(h.current),"undefined"!=typeof ResizeObserver){let t=new ResizeObserver(t=>{e(t[0].target)});return t.observe(h.current),()=>{t.disconnect()}}{let t=()=>e(h.current);return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}},[h.current]),(0,i.useEffect)(()=>{f?(w(u),y(c)):(async()=>{let e=await Promise.all([(0,a.O9)({sourceText:u,targetLanguage:"en"}),(0,a.O9)({sourceText:c,targetLanguage:"en"})]);if(e.every(e=>0===e.statusCode)){var t,n,r,l;let[i,a]=e;w(null===(n=i.translation)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.translation),y(null===(l=a.translation)||void 0===l?void 0:null===(r=l[0])||void 0===r?void 0:r.translation)}})()},[f,u,c]),{isShowTitleAndDescAlone:m,finalTitle:p,title:g,desc:_,computedTextExtra:x,titleElRef:h,descLine:N,isTitleWrapped:b}}},476775:function(e,t,n){n.d(t,{wH:function(){return _},h4:function(){return x},yu:function(){return w},p:function(){return g},HV:function(){return y},Ym:function(){return p},G:function(){return E},fS:function(){return k}});var r=n("520739"),l=n("878389"),i=n("66863");n("284961"),n("826893");var a=n("281481"),o=n.n(a),s=n("960734"),d=n.n(s),u=n("419936"),c=n.n(u);function v(e){if(c()(e))return e.map(e=>v(e));if(d()(e)&&null!==e){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[o()(n)]=v(e[n]));return t}return e}function f(e){if(c()(e))return e.map(e=>f(e));if(d()(e)&&null!==e){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)]=f(e[n]));return t}return e}var h=n("842602");let{COMMON_SEARCH_PARAMS:m}=n("576660")||{},p=async e=>{let t=f(e);return v(await (0,i.U2)("/aweme/v1/web/douyin/select/study/ai_assistant/note/gen",(0,r._)({},m,t)))},g=async e=>{let t=f(e);return v(await (0,i.U2)("/aweme/v1/web/douyin/select/study/ai_assistant/note/save",(0,r._)({},m,t)))},w=async e=>{var t;let n=f(e),a=await (0,i.U2)("/aweme/v1/web/douyin/select/study/ai_assistant/note/list",(0,r._)({},m,n));return v((0,l._)((0,r._)({},a),{ai_note_list:(null===(t=a.ai_note_list)||void 0===t?void 0:t.map(e=>(0,l._)((0,r._)({},e),{related_item_info:e.related_item_info?(0,h.s0)(e.related_item_info):void 0})))||[]}))},_=async e=>{var t,n;let a=f(e),o=await (0,i.U2)("/aweme/v1/web/douyin/select/study/ai_assistant/note/get",(0,r._)({},m,a));return v((0,l._)((0,r._)({},o),{ai_note_info:(0,l._)((0,r._)({},o.ai_note_info),{related_item_info:(null===(t=o.ai_note_info)||void 0===t?void 0:t.related_item_info)?(0,h.s0)(null===(n=o.ai_note_info)||void 0===n?void 0:n.related_item_info):void 0})}))},y=async e=>{let t=f(e);return v(await (0,i.U2)("/aweme/v1/web/douyin/select/study/ai_assistant/note/delete",(0,r._)({},m,t)))},x=async e=>{let t=f(e);return await (0,i.U2)("/aweme/v1/web/note/get/",(0,r._)({},m,t))},E=async e=>await (0,i.v_)("/aweme/v1/web/note/gen/",(0,r._)({},m),(0,r._)({},e)),k=async e=>await (0,i.v_)("/aweme/v1/web/note/upsert/",(0,r._)({},m),(0,r._)({},e),{headers:{"Content-Type":"application/json"},isDataUseJson:!0})},74394:function(){}}]);