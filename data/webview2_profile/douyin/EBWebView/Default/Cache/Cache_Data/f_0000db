"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["33235"],{504625:function(e,t){t.Z={switch:"tMqkS46E",checked:"_Ioc3QzW"}},632168:function(e,t){t.Z={full:"aWUFxyvW",enterRoom:"lPOF_UNl",loaded:"_ISFVfJd",enterRoomIcon:"X8tZCAb3"}},805652:function(e,t){t.Z={liveTitle:"LgHq3PbL",text:"zV4wzltK",userCount:"zBxhJBXm"}},541671:function(e,t){t.Z={livingPlayer:"MR5iyRn7",hideLoadingAndControl:"KnGa6bTq",appOnly:"j54OJYbU",layoutCommon:"O9ENko9T",layoutLike:"HWXkuQI4",basicPlayerPip:"ujvi6Ali",isImmersive:"Lq7W1XKA"}},773768:function(e,t){t.Z={container:"elRUuzsS",toolbar:"PI6ImCXQ",menu:"if7C8ipZ",tags:"L5MQ4Qvg",tips:"yaQJImEq",label:"DS6IBtKl",goDownload:"xyK16f29",text:"IUilDqvc",picked:"h5ykWpRZ",show:"M2TwwxDB",hidden:"N9ADC7YB"}},980981:function(e,t){t.Z={app_only:"JLqHnzHG",content:"fElrJFEA",qrcode:"JwQhs9jY",toast:"HGRdqyVW",guide:"J5f5nA69",scan_icon:"WdeRd8G1"}},279775:function(e,t,n){let i;n.r(t),n.d(t,{default:function(){return e3}}),n("179133"),n("826893"),n("874386"),n("250440");var r=n("563097"),o=n("88648"),l=n("567754"),a=n("909543"),s=n("553542"),u=n("782580"),_=n("400582"),d=n("632766"),c=n("700177"),h=n("582746"),E=n("746309"),m=n("236603"),v=n("737466"),f=n("472434"),I=n("981116"),P=n("57350"),T=n("495123"),L=n("167951"),N=n("504229"),p=n("63405"),S=n("24819"),g=n("861396"),C=n("57718"),A=n("94680"),y=n("719469"),R=n("487330"),b=n("273312"),O=n("780977"),w=n("289228"),Y=n("520739"),k=n("878389"),x=n("459198"),M=n("818597"),U=n("945388"),K=n("528898"),Z=n("40699"),V=n("713097"),D=n.n(V),j=n("128231"),F=n.n(j),G=n("755262"),H=n("714102"),W=n("441447"),B=n("53562");(0,B.Pi)(function(e){let{domain:t,pathname:n,children:i,isDetail:o}=e,l=(0,M.o)(),{forceTheme:a,hideErrorStyle:s,showFooter:u}=l.layoutStore;return(0,r.jsxs)("div",{className:D()(Z.Z.scroll,a,{[Z.Z.detailScroll]:o}),id:K.IS,ref:e=>t===U.LIVE_XIGUA_DOMAIN&&W.emit(W.EVENT.globalScrollEl,e),onScroll:F()(e=>{var t,n,i,r;(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.scrollTop)!==void 0&&W.emit(W.EVENT.tabContainerScroll,{tab:"live",scrollTop:null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.scrollTop}),(null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.scrollTop)>200&&(null==l||null===(r=l.appStore)||void 0===r||r.setHomeNeedIntial(!0))},20),children:[(0,r.jsx)("div",{className:D()({[Z.Z.xiguaNormal]:t===U.LIVE_XIGUA_DOMAIN&&!(0,G.H)(n,t),[Z.Z.xiguaPadding]:(0,G.H)(n,t),[Z.Z.error]:s,[Z.Z.loadingStyle]:o}),children:i}),u&&(0,r.jsx)(H.$,{})]})});let Q=(0,B.Pi)(function(e){let{children:t}=e,{pathname:n}=(0,a.a)(),i=n.includes("/live/"),o=i?D()(Z.Z.scroll,{[Z.Z.detailScroll]:!0}):"";return(0,r.jsx)("div",{className:o,id:K.IS,style:i?{}:{display:"contents"},children:t})});var q=n("134761");n("954372");var $=n("742401"),X=n("869718"),z=n("516136"),J=n("611651"),ee=n("413435"),et=n("668363"),en=n("31543"),ei=n("738299"),er=n("789113"),eo=n("94659"),el=n("104013");class ea extends eo.Z{get audiencePanelStatus(){return this.audienceTccStatus}get audienceStatus(){return this.audienceSwitchStatus&&this.audienceAuthStatus}constructor(){super(),(0,q._)(this,"audienceSwitchStatus",!0),(0,q._)(this,"audienceAuthStatus",!1),(0,q._)(this,"audienceTccStatus",!1),(0,q._)(this,"audienceSelectTab",30),(0,q._)(this,"showEntrance",!1),(0,q._)(this,"onlineScore1000Num",0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{audienceSwitchStatus:el.observable,audienceAuthStatus:el.observable,audienceTccStatus:el.observable,audienceSelectTab:el.observable,showEntrance:el.observable,onlineScore1000Num:el.observable,audiencePanelStatus:el.computed,audienceStatus:el.computed,setAudienceSwitchStatus:el.action,setAudienceAuthStatus:el.action,setAudienceTccStatus:el.action,setAudienceSelectTab:el.action,setShowEntrance:el.action,setOnlineScore1000Num:el.action})}),(0,q._)(this,"setAudienceSelectTab",e=>this.audienceSelectTab=e),(0,q._)(this,"setShowEntrance",e=>this.showEntrance=e),(0,q._)(this,"setOnlineScore1000Num",e=>this.onlineScore1000Num=e),(0,q._)(this,"setAudienceSwitchStatus",e=>this.audienceSwitchStatus=e),(0,q._)(this,"setAudienceAuthStatus",e=>this.audienceAuthStatus=e),(0,q._)(this,"setAudienceTccStatus",e=>this.audienceTccStatus=e);this.makeObservable()}}var es=n("367846"),eu=n("665600"),e_=n("62323"),ed=n("647245"),ec=n("679272"),eh=n("207123"),eE=n("187308"),em=n("134888");class ev extends eo.Z{constructor(){super(),(0,q._)(this,"cameraInfo",{}),(0,q._)(this,"mainCameraInfo",{}),(0,q._)(this,"cameraInfoList",[]),(0,q._)(this,"multiCameraLogParams",{}),(0,q._)(this,"switchCameraNumber",0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{cameraInfo:el.observable,mainCameraInfo:el.observable,cameraInfoList:el.observable,setCameraInfo:el.action,setMainCameraInfo:el.action,setCameraInfoList:el.action,setMultiCameraLogParams:el.action,multiCameraLogParams:el.observable,switchCameraNumber:el.observable,setSwitchCameraNumber:el.action})}),(0,q._)(this,"setSwitchCameraNumber",e=>{this.switchCameraNumber=e}),(0,q._)(this,"setMultiCameraLogParams",e=>{this.multiCameraLogParams=e}),(0,q._)(this,"reset",()=>{this.cameraInfo={},this.mainCameraInfo={},this.cameraInfoList=[]}),(0,q._)(this,"setCameraInfo",e=>{"function"==typeof e?this.cameraInfo=e(this.cameraInfo):this.cameraInfo=e}),(0,q._)(this,"setMainCameraInfo",e=>{"function"==typeof e?this.mainCameraInfo=e(this.mainCameraInfo):this.mainCameraInfo=e}),(0,q._)(this,"setCameraInfoList",e=>{"function"==typeof e?this.cameraInfoList=e(this.cameraInfoList):this.cameraInfoList=e});this.makeObservable()}}var ef=n("736145");class eI extends eo.Z{constructor(){super(),(0,q._)(this,"participatedLotterys",[]),(0,q._)(this,"landingPageType","userMain"),(0,q._)(this,"currentLottery",{}),(0,q._)(this,"leftTimeFromShortTouch",0),(0,q._)(this,"candidateState",0),(0,q._)(this,"isFirstLoad",!0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{landingPageType:el.observable,participatedLotterys:el.observable,currentLottery:el.observable,leftTimeFromShortTouch:el.observable,candidateState:el.observable,isFirstLoad:el.observable,setIsFirstLoad:el.action})}),(0,q._)(this,"setParticipatedLotterys",e=>this.participatedLotterys=e),(0,q._)(this,"setLandingPageType",e=>this.landingPageType=e),(0,q._)(this,"setCurrentLottery",e=>this.currentLottery=e),(0,q._)(this,"setLeftTimeFromShortTouch",e=>this.leftTimeFromShortTouch=e),(0,q._)(this,"setCandidateStat",e=>this.candidateState=e),(0,q._)(this,"setIsFirstLoad",e=>this.isFirstLoad=e);this.makeObservable()}}class eP extends eo.Z{constructor(){super(),(0,q._)(this,"rechargeAuthStatus",!1),(0,q._)(this,"showGiftRechargeContainer",!1),(0,q._)(this,"remoteRechargeContainerRendered",!1),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{rechargeAuthStatus:el.observable,setRechargeAuthStatus:el.action,showGiftRechargeContainer:el.observable,setShowGiftRechargeContainer:el.action,remoteRechargeContainerRendered:el.observable,setRemoteRechargeContainerRendered:el.action})}),(0,q._)(this,"setRechargeAuthStatus",e=>this.rechargeAuthStatus=e),(0,q._)(this,"setShowGiftRechargeContainer",e=>this.showGiftRechargeContainer=e),(0,q._)(this,"setRemoteRechargeContainerRendered",e=>this.remoteRechargeContainerRendered=e);this.makeObservable()}}var eT=n("234532");class eL extends eo.Z{constructor(){super(),(0,q._)(this,"isFirstLoad",!0),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{isFirstLoad:el.observable,setIsFirstLoad:el.action})}),(0,q._)(this,"setIsFirstLoad",e=>this.isFirstLoad=e);this.makeObservable()}}var eN=n("408019");class ep extends eo.Z{setShowShare(e){this.showShare=e}setLeft(e){this.left=e}setTop(e){this.top=e}setHeight(e){this.height=e}setShareFrom(e){this.shareFrom=e}constructor(){super(),(0,q._)(this,"showShare",!1),(0,q._)(this,"left",void 0),(0,q._)(this,"top",void 0),(0,q._)(this,"height",void 0),(0,q._)(this,"shareFrom","lottery"),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{showShare:el.observable,left:el.observable,top:el.observable,height:el.observable,shareFrom:el.observable,setShowShare:el.action,setLeft:el.action,setTop:el.action,setHeight:el.action,setShareFrom:el.action})});this.makeObservable()}}var eS=n("7396"),eg=n("436886"),eC=n("105200"),eA=n("651688"),ey=n("867204"),eR=n("213987");class eb extends eo.Z{get screenMode(){return this.isFullScreen?ey.wq.FULL_SCREEN:this.isTheaterOn?ey.wq.THEATER:ey.wq.NORMAL}constructor(){super(),(0,q._)(this,"isTheaterOn",!1),(0,q._)(this,"isFullScreen",!1),(0,q._)(this,"isPause",!1),(0,q._)(this,"playerInstance",null),(0,q._)(this,"playerLoggerInstance",null),(0,q._)(this,"isPlayed",!1),(0,q._)(this,"loggerOptions",{}),(0,q._)(this,"isPlay",0),(0,q._)(this,"isLoadedData",!1),(0,q._)(this,"fullscreenTarget",null),(0,q._)(this,"makeObservable",()=>{(0,el.makeObservable)(this,{isTheaterOn:el.observable,isFullScreen:el.observable,isPause:el.observable,playerInstance:el.observable,playerLoggerInstance:el.observable,setPlayerInstance:el.action,setPlayerLoggerInstance:el.action,setIsTheaterOn:el.action,setIsFullScreen:el.action,setIsPause:el.action,setIsPlayed:el.action,isPlayed:el.observable,screenMode:el.computed,loggerOptions:el.observable,setLoggerOptions:el.action,isPlay:el.observable,setIsPlay:el.action,isLoadedData:el.observable,setIsLoadedData:el.action,fullscreenTarget:el.observable,setFullScreenTarget:el.action})}),(0,q._)(this,"setFullScreenTarget",e=>{this.fullscreenTarget=e}),(0,q._)(this,"setIsLoadedData",e=>{this.isLoadedData=e}),(0,q._)(this,"setIsPlay",e=>{this.isPlay=e}),(0,q._)(this,"setLoggerOptions",e=>{this.loggerOptions=e}),(0,q._)(this,"setIsPlayed",e=>{this.isPlayed=e}),(0,q._)(this,"setPlayerInstance",e=>{this.playerInstance=e}),(0,q._)(this,"setPlayerLoggerInstance",e=>{this.playerLoggerInstance=e}),(0,q._)(this,"setIsTheaterOn",e=>{this.isTheaterOn=e}),(0,q._)(this,"setIsFullScreen",e=>{this.isFullScreen=e}),(0,q._)(this,"setIsPause",e=>{this.isPause=e});this.makeObservable(),(0,el.reaction)(()=>this.isTheaterOn,(e,t)=>{t&&!e&&((0,eR.q)("ISLAND_SYNC_HEADER"),(0,eR.q)("ISLAND_LAYOUT_NAVIGATION"))})}}var eO=n("356700"),ew=n("758801");(0,B.DT)($.s);let eY=["appStore","userStore","homeStore","roomStore","layoutStore","streamStore","cameraStore","paidLiveStore","detailExtra"];class ek{constructor(){(0,q._)(this,"appStore",new J.Z),(0,q._)(this,"userStore",new X.Z),(0,q._)(this,"homeStore",new ee.Z),(0,q._)(this,"roomStore",new z.Z(this)),(0,q._)(this,"linkmicStore",new et.ZP(this)),(0,q._)(this,"giftStore",new en.Z),(0,q._)(this,"propStore",new ei.Z),(0,q._)(this,"pkStore",new er.Z),(0,q._)(this,"audienceStore",new ea),(0,q._)(this,"fansClubStore",new es.Z),(0,q._)(this,"layoutStore",new eu.Z),(0,q._)(this,"streamStore",new e_.Z),(0,q._)(this,"cameraStore",new ev),(0,q._)(this,"hourRankListStore",new ed.Z),(0,q._)(this,"feedStore",new ec.Z),(0,q._)(this,"singletonStore",new eh.Z),(0,q._)(this,"hybridStore",new eE.Z),(0,q._)(this,"eventStore",new em.Z(this)),(0,q._)(this,"paidLiveStore",new ef.ZP),(0,q._)(this,"lotteryStore",new eI),(0,q._)(this,"rechargeStore",new eP),(0,q._)(this,"ecomStore",new eN.Z),(0,q._)(this,"activityIndicatorStore",new eT.Z),(0,q._)(this,"redpacketStore",new eL),(0,q._)(this,"shareStore",new ep),(0,q._)(this,"vipStore",new eS.Z),(0,q._)(this,"giftGuideStore",new eg.Z),(0,q._)(this,"detailExtra",new eC.Z),(0,q._)(this,"rightPanelStore",new eA.Z(this.activityIndicatorStore)),(0,q._)(this,"playerStore",new eb),(0,q._)(this,"chatStore",new eO.Z),(0,q._)(this,"vrStore",new ew.Z(this)),(0,q._)(this,"hydrate",e=>{eY.forEach(t=>{this[t].hydrate(e[t])})}),(0,q._)(this,"reset",e=>{var t,n;Object.entries(this).filter(e=>{let[t]=e;return/Store$/.test(t)}).filter(t=>{let[n]=t;return!Array.isArray(e)||e.indexOf(n)>=0}).forEach(e=>{let[t,n]=e;(null==n?void 0:n.reset)&&(null==n||n.reset()),(null==n?void 0:n.resetStore)&&(null==n||n.resetStore())}),(null===(t=this.detailExtra)||void 0===t?void 0:t.reset)&&(null===(n=this.detailExtra)||void 0===n||n.reset())})}}var ex=n("612774"),eM=n("171091"),eU=n("914104"),eK=n("228733"),eZ=n("236732"),eV=n("909497"),eD=n("157703"),ej=n("715709"),eF=n("243321"),eG=n("109539"),eH=n("66047");let{user:eW,ABtestContext:eB}=ex,eQ=()=>{let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(0,d.ZP)({service_name:"webcast.douyin.live_pc",key:"message_websocket_params"}).then(e=>{t(e)})},[]),(0,r.jsx)(eM.Z,{websocketKey:e})};function eq(){let e=(0,M.o)(),t=(0,L.Es)();(0,o.useEffect)(()=>{var n;null==e||null===(n=e.userStore)||void 0===n||n.setOdin(t)},[t]);let{userInfo:n}=(0,eG.useUserInfoContext)();return(0,o.useEffect)(()=>{var e;let t=null==n?void 0:null===(e=n.info)||void 0===e?void 0:e.uid;t&&(0,eU.oG)(t)},[n]),(0,r.jsx)(r.Fragment,{})}function e$(){let{webrid:e}=(0,s.U)();(0,eH._)();let t={};return"object"==typeof window&&(t=(0,l.parse)(window.location.search)),(0,eV.w)({webRid:e,query:t}),(0,eK.Z)(),(0,r.jsx)(eZ.Z,{})}let eX=()=>{let e=(0,o.useMemo)(()=>(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){let e=new ek;return!$.s&&(window.__STORE__=e),e}let n=null!=i?i:new ek;return(Object.keys(e).length&&n.hydrate(e),$.s)?n:(window.__STORE__=n,!i&&(i=n),n)})({},!0),[]),t=(0,o.useRef)(e);return(0,o.useEffect)(()=>{let e=t.current;return()=>{setTimeout(()=>{try{var t,n,i;null==e||null===(t=e.singletonStore.message)||void 0===t||t.stop(),null==e||null===(n=e.singletonStore.message)||void 0===n||n.destroy(),null==e||null===(i=e.reset)||void 0===i||i.call(e),Object.keys(e).forEach(t=>{Object.keys(e[t]).forEach(n=>{e[t][n]=null}),e[t]=null})}catch(e){}},1e3)}},[]),(0,o.useEffect)(()=>()=>{(0,eD.pk)(),(0,ej.Ue)()},[]),(0,o.useEffect)(()=>{try{eD.sA.liveAppRenderStart()}catch(e){}},[]),(0,r.jsx)(x.n,{children:(0,r.jsx)(Q,{children:(0,r.jsxs)(M.x.Provider,{value:e,children:[(0,r.jsx)(eq,{}),(0,r.jsx)(eQ,{}),(0,r.jsx)(e$,{})]})})})};var ez=e=>{let t=(0,o.useMemo)(()=>{if(!$.s)return(0,eU.OK)()},[]);return(0,r.jsx)(eF.k,(0,k._)((0,Y._)({},e),{componentName:"SpaLiving",_slardarInstance:t,children:(0,r.jsx)(eX,(0,Y._)({},e))}))};function eJ(){let e=(0,h.Z)(),t=(0,L.Es)();(0,o.useEffect)(()=>{var n;null==e||null===(n=e.userStore)||void 0===n||n.setOdin(t)},[t]),(0,o.useEffect)(()=>{if(!!(0,N.sF)())p.asyncCall(p.AsyncCallMethod.XRequestFullScreen)},[]);let{userInfo:n}=(0,eG.useUserInfoContext)();return(0,o.useEffect)(()=>{var e;let t=null==n?void 0:null===(e=n.info)||void 0===e?void 0:e.uid;t&&(0,E.oG)(t)},[n]),(0,r.jsx)(r.Fragment,{})}function e0(){let{webrid:e}=(0,s.U)();(0,eH._)();let t={};return"object"==typeof window&&(t=(0,l.parse)(window.location.search)),(0,y.Z)({webRid:e,query:t}),(0,O.Z)(),(0,S.Z)(),(0,r.jsx)(A.C,{preview:{}})}(0,c.jq)(),(0,f.zA)(),(0,E.XM)();let e1=()=>{let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(0,d.ZP)({service_name:"webcast.douyin.live_pc",key:"message_websocket_params"}).then(e=>{t(e)})},[]),(0,r.jsx)(g.Z,{websocketKey:e})},e2=()=>{let{webrid:e}=(0,s.U)();(0,o.useEffect)(()=>{var e,t;if(null===m.sA||void 0===m.sA||m.sA.liveAppRenderStart(),"live.douyin.com"!==window.location.host&&(null===(t=window)||void 0===t?void 0:null===(e=t.location)||void 0===e?void 0:e.search.includes("r_player=1"))){let e=performance.now()-window.ENTER_ROOM_BY_REUSE_PLAYER;null===m.sA||void 0===m.sA||m.sA.liveUrlLoadEnd(e),window.ENTER_ROOM_BY_REUSE_PLAYER=0,window.PLAYING_START_BY_REUSE_PLAYER=Date.now()}return()=>{(0,m.pk)(),(0,v.Ue)()}},[]);let t=(0,a.a)(),n=(0,o.useMemo)(()=>(0,I.M)({},!0),[]),i=(0,o.useRef)(n),l=(0,eH._)()||{},u=(0,o.useRef)(!1),{followListRoomData:_}=(0,R.Iq)(e=>{let{followListRoomData:t}=e;return{followListRoomData:t}});if((null==l?void 0:l.liveInnerFeed)&&!u.current){var d,c,h;(null==t?void 0:null===(d=t.pathname)||void 0===d?void 0:d.search("/follow/live"))!==-1&&(null==n||null===(h=n.feedStore)||void 0===h||h.addFeedList(null==_?void 0:null===(c=_.filter(e=>null==e?void 0:e.roomId))||void 0===c?void 0:c.map(e=>{var t;let{__fakeAwemeInfo:{authorInfo:n},webRid:i,roomId:r}=e;return{room:null==n?void 0:n.roomData,web_stream_url:null==n?void 0:null===(t=n.roomData)||void 0===t?void 0:t.additional_stream_url,web_rid:i,roomId:r}})),u.current=!0)}return(0,o.useEffect)(()=>{let e=i.current;return()=>{1!==Number(l.liveInnerFeed)&&2!==Number(l.liveInnerFeed)&&setTimeout(()=>{try{var t,n,i;null==e||null===(t=e.singletonStore.message)||void 0===t||t.stop(),null==e||null===(n=e.singletonStore.message)||void 0===n||n.destroy(),null==e||null===(i=e.reset)||void 0===i||i.call(e),Object.keys(e).forEach(t=>{Object.keys(e[t]).forEach(n=>{e[t][n]=null}),e[t]=null})}catch(e){}},1e3)}},[]),(0,r.jsx)(T.n,{children:(0,r.jsx)(P.r,{children:(0,r.jsxs)(C.x.Provider,{value:n,children:[(0,r.jsx)(eJ,{}),(0,r.jsx)(e1,{}),(0,r.jsx)(e0,{})]})})})};var e3=()=>{var e;let t=(0,b.j)();null===_.Z||void 0===_.Z||null===(e=_.Z.recordEnterEndTimeStamp)||void 0===e||e.call(_.Z);let n=(0,a.a)(),i=o.useMemo(()=>null==n?void 0:n.search.includes("use_new_preview=true"),[n]);return(0,r.jsx)(w.k,{componentName:"LivePage",children:(0,u.getInNewProjectPreviewABWithoutStoreCheck)(t)||i?(0,r.jsx)(ez,{}):(0,r.jsx)(e2,{})})}},722107:function(e,t,n){n.d(t,{o:function(){return d}}),n(110006),n(826893);var i=n(563097);n(88648);var r=n(217713),o=n(672129),l=n(876599),a=n(168334),s=n(162095),u=n(509090);let _=(()=>{let e="screen_chat_ignore_send_confirm";return{get:()=>"true"===localStorage.getItem(e),set(t){localStorage.setItem(e,t?"true":"false")}}})(),d=async(e,t)=>{var n;if(!e)return!0;if((null!==(n=t.emojiCount)&&void 0!==n?n:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";try{let t=e.match(/\[.*?\]/g);return t?t.length:0}catch(e){return 0}}(t.text))>3)return u.F.info("最多可添加3个表情"),!1;let{diamond_count:d,style:c}=e;if(_.get()||!c||(0,o.BC)(c)||!d)return!0;let h=function(e){switch(e){case r.Qz.Base:return"基础弹幕";case r.Qz.Advanced:return"高级弹幕";case r.Qz.Supreme:return"至尊弹幕";default:return""}}(c),E=!1,m=await (0,a.S)({title:"确认支付",footerFill:!0,content:(0,i.jsxs)("div",{className:l.Z.content,children:[(0,i.jsxs)("p",{className:l.Z.text,children:["使用",h,"需要支付",d,"钻，确认支付并发送弹幕吗？"]}),(0,i.jsx)(s.Checkbox,{className:l.Z.checkbox,"aria-label":"screen_chat_send_confirm",onChange:e=>{E=!!e.target.checked},children:"下次不再提醒"})]}),width:300});return m&&_.set(E),m}},169094:function(e,t,n){var i=n(520739),r=n(878389);n(874386);var o=n(563097),l=n(948375),a=n(503866),s=n(88648),u=n(850634),_=n(818597),d=n(505575),c=n(70755),h=n(881243),E=n(159344),m=n(53562);let v=e=>{let{playerInstance:t}=e,{eventStore:{playerEvent:n}}=(0,_.o)(),[i,r]=(0,s.useState)(!1),[d,m]=(0,s.useState)(!1),v=(0,s.useRef)(!1);(0,s.useEffect)(()=>()=>{v.current=!0},[]);let f=s.useRef(!0),I=(0,l.Z)(()=>{var e,i;null!==(i=(e=window).__INVISIBLE_QUERY__)&&void 0!==i||(e.__INVISIBLE_QUERY__={}),window.__INVISIBLE_QUERY__.if_browser_limited=1;null==n||n.volumeBrowserLimitedMute(),f.current&&(setTimeout(()=>{if(!!t.paused)t.muted=!0,t.play(),setTimeout(()=>{(0,a.w)(!1),t.once(u.FP.VOLUMECHANGE,()=>{!v.current&&m(!1)})})},0),f.current=!1,m(!0),null==n||n.volumeBrowserLimitedToastShow())});(0,s.useEffect)(()=>{if(!!t)return t.on(u.FP.AUTOPLAY_WAS_PREVENTED,I),()=>{null==t||t.off(u.FP.AUTOPLAY_WAS_PREVENTED,I)}},[t]),(0,s.useEffect)(()=>{if(!t)return;let e=e=>{var n,i;if(!t)return;let r=null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.tagName;if("INPUT"!==r&&"TEXTAREA"!==r&&(null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.contentEditable)!=="true")(null==e?void 0:e.code)==="KeyP"&&!(e.shiftKey||e.metaKey||e.ctrlKey)&&(t.muted=!t.muted)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t]);let P=(0,l.Z)(()=>{null==n||n.volumeBrowserLimitedClickOpen(),t&&(t.muted?t.muted=!1:t.volume=.5,t.emit("volumechange")),m(!1)}),T=(0,s.useCallback)(()=>{null==n||n.volumeBrowserLimitedClickClose(),m(!1)},[]);return(0,o.jsx)(c.l,{showHint:d,priority:2,duration:30,delay:0,onClose:()=>{m(!1)},children:(0,o.jsx)(h.I,{className:E.Z.cancelMute,onClose:T,onModalVisibleChange:r,onOpen:P,preventModalVisible:i})})};t.C=(0,m.Pi)(e=>{let{player:t}=(0,d.n)();return(0,o.jsx)(v,(0,r._)((0,i._)({},e),{playerInstance:t}))})},36964:function(e,t,n){n.d(t,{Z:function(){return T}}),n("675373");var i=n("563097");n("88648");var r=n("700061"),o=n("246647"),l=n("595902"),a=n("745618"),s=n("300253"),u=n("338426"),_=n("446042"),d=n("770732"),c=n("645260"),h=n.n(c),E="GkkH0S6K",m="oaf6Ibtx",v="XS8pzVXh",f=n("713097"),I=n.n(f);let P=(0,s.n)((0,u.ZP)(()=>Promise.all([n.e("70505"),n.e("75404")]).then(n.bind(n,487289)),{ssr:!1}),{name:o.l.ChatRoom,renderWhen:l._.FirstFrame,fallback:(0,i.jsx)("div",{className:I()(E,m),children:(0,i.jsx)("div",{className:v})})});(0,_.GI)({name:o.l.ChatRoom,condition:e=>{let{store:t}=e,{roomStore:{roomInfo:n},vrStore:{isImmersive:i}}=t;return h()(n,"web_rid")&&!i},Component:P,index:0});var T=(0,a.OV)({Component:()=>(0,i.jsx)(d.Z,{name:o.l.ChatRoom}),layoutName:r.t.RightBackgroundLayout,ComponentName:o.l.RoomLogic,index:0})},457958:function(e,t,n){n.d(t,{A:function(){return s}});var i=n(563097),r=n(309244),o=n(713097),l=n.n(o);n(88648);var a=n(414655);let s=e=>{let{count:t,className:n,renderSVG:o}=e;return(0,i.jsxs)("span",{className:l()(a.Z.userCount,n),children:[o?o():(0,i.jsx)(r.Z,{}),(0,i.jsx)("span",{className:a.Z.count,children:t||"0"})]})}},424784:function(e,t,n){n.d(t,{s:function(){return y}});var i=n(520739),r=n(368200);n(675373),n(874386);var o=n(563097),l=n(88648),a=n(338426),s=n(103423),u=n(713097),_=n.n(u),d=n(818597),c=n(505575),h=n(53562),E=n(873791),m=n(828782),v=n(796591),f=n(309931);let I=(0,a.ZP)(()=>Promise.all([n.e("74792"),n.e("66135"),n.e("5498"),n.e("21189"),n.e("12563"),n.e("96919"),n.e("47457"),n.e("77616"),n.e("69775")]).then(n.bind(n,756574)),{ssr:!1}),P=new E.N,T="__Live_Share_Mouse_Enter",L="__Live_Share_Mouse_Leave",N="__Live_Share_Choose_Friend",p="__Live_Share_Share_To_Friend",S="__Live_Share_Share_Success",g="__Live_Share_Outer_Click",C="__Live_Share_Outer_Failed",A="__Live_Share_Close",y=e=>{var t,n,r,o,l,a,s;let{onMouseEnter:u,onMouseLeave:_,onChooseFriend:d,onShareToFriend:c,onShareSuccess:h,onOuterClick:E,onShareFailed:m,onShareClose:f,store:I,shareFrom:y}=e,R=e=>function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];null==e||e(...n)},b={[g]:R(E),[T]:R(u),[L]:R(_),[N]:R(d),[p]:R(c),[S]:R(h),[C]:R(m),[A]:R(f)};return Object.keys(b).forEach(e=>{P.on(e,b[e])}),null==I||null===(t=I.shareStore)||void 0===t||t.setShowShare(!0),null==I||I.shareStore.setShareFrom(y||"lottery"),"share_icon"===y&&window.collectEvent("livesdk_share_icon_click",(0,i._)({room_id:null==I?void 0:null===(r=I.roomStore)||void 0===r?void 0:null===(n=r.roomInfo)||void 0===n?void 0:n.roomId,anchor_id:null==I?void 0:null===(s=I.roomStore)||void 0===s?void 0:null===(a=s.roomInfo)||void 0===a?void 0:null===(l=a.room)||void 0===l?void 0:null===(o=l.owner)||void 0===o?void 0:o.id_str},(0,v.Nu)())),()=>{var e;null==I||null===(e=I.shareStore)||void 0===e||e.setShowShare(!1),Object.keys(b).forEach(e=>{P.off(e,b[e])})}};t.Z=(0,h.Pi)(e=>{let{className:t=""}=e,n=(0,r._)(e,["className"]),{player:a}=(0,c.n)(),{shareStore:u,roomStore:h}=(0,d.o)(),E=(0,l.useRef)(null),y=e=>function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];P.emit(e,...n)};return(0,l.useEffect)(()=>{let e=e=>{let t=e.target.parentNode;for(;t;){if(t===E.current)return;t=t.parentNode}P.emit(g,e)};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}},[]),(0,l.useEffect)(()=>{if(u.showShare&&(null==h?void 0:h.roomInfo)){var e,t,n,r;window.collectEvent("livesdk_share_card_show",(0,i._)({share_from:null==u?void 0:u.shareFrom,room_id:null==h?void 0:null===(e=h.roomInfo)||void 0===e?void 0:e.roomId,anchor_id:null==h?void 0:null===(r=h.roomInfo)||void 0===r?void 0:null===(n=r.room)||void 0===n?void 0:null===(t=n.owner)||void 0===t?void 0:t.id_str},(0,v.Nu)()))}},[u.shareFrom,u.showShare]),f.createPortal((0,o.jsx)("div",{className:_()(s.Z.liveShare,t,{[s.Z.isInClient]:(0,m.DT)()}),ref:E,style:{left:u.left,top:u.top,display:u.showShare?"block":"none"},children:(0,o.jsx)(I,(0,i._)({player:a,shareeListHeight:u.height,onMouseEnter:y(T),onMouseLeave:y(L),handleChooseFriend:y(N),handleShareToFriend:y(p),handleShareSuccess:y(S),handleShareError:y(C),handleShareClose:y(A),shareFrom:null==u?void 0:u.shareFrom,hidden:!u.showShare},n))}),document.body)},{forwardRef:!1})},688658:function(e,t,n){n.r(t),n.d(t,{RotatePlugin:function(){return a.Z},DetailContextMenuPlugin:function(){return eL.Z},GroupFightPlugin:function(){return ed.Z},DanmaSetting:function(){return C.Z},RTCLayerPlugin:function(){return er.Z},HintContainerPlugin:function(){return Y},UgcAvatar:function(){return em.Z},ServiceCenterPlugin:function(){return eC.Z},VolumeWheelPlugin:function(){return D.Z},PaidLivePlugin:function(){return X.Z},GroupLivePlugin:function(){return ep.Z},LiveReserveCard:function(){return eE.Z},TripleScreenPlugin:function(){return s.Z},VipLiveBoundaryPlugin:function(){return $},AudioRoomPlugin:function(){return et.Z},GiftMenuPlugin:function(){return ey.Z},PausePop:function(){return eT.Z},LinkMicApplyPlugin:function(){return eP},TopEffectPlugin:function(){return eu},LinkMicLayoutPlugin:function(){return J.Z},LinkMicPlayModeLimitPlugin:function(){return en.Z},AdaptedBySEIPlugin:function(){return G},InPicturePlugin:function(){return r.Z},GiftEffectPlugin:function(){return I.Z},WaterMark:function(){return eg.Z},OrderSingPlugin:function(){return e_.Z},GiftTrayPlugin:function(){return P.Z},PKViewPlugin:function(){return W.Z},ToolBarPlugin:function(){return U.Z},GuestBattlePlugin:function(){return eh},LiveFromAppTips:function(){return eS.Z},RefreshPlugin:function(){return O.Z},UpdateFunctionTypePlugin:function(){return el.Z},ShortTouchPlugin:function(){return B.Z},VideoRoomPlugin:function(){return ee.Z},QualitySwitchNewPlugin:function(){return b},EffectPlugin:function(){return g},PlayerTeaLogPlugin:function(){return Z.Z},PKSEIPlugin:function(){return j.Z},VrPlugin:function(){return eA.Z},DoubleScreenPlugin:function(){return eN.Z},VipViewPlugin:function(){return Q.Z},PlayerLoggerPlugin:function(){return K.Z},LiveLike:function(){return y.Z},AdminPrivilegePlugin:function(){return ei.Z},EffectSwitchPlugin:function(){return f.Z},ChangeDynamicBg:function(){return ef.Z},GroupLive:function(){return ev.Z},VolumeMemoryPlugin:function(){return v},LinkMicDynamicPlugin:function(){return eo.Z},LeadingLoginPlugin:function(){return z.Z},CancelMutePlugin:function(){return k.Z},PicturePlugin:function(){return o.Z},FoldChatRoomCommentPlugin:function(){return l.Z},PlayerEndCover:function(){return V.Z},NewPlayerErrorCover:function(){return H.Z},TheaterPlugin:function(){return i.Z},GlobalControlPlugin:function(){return M},DanmakuNewPlugin:function(){return A.Z}});var i=n("421632"),r=n("540293"),o=n("550131"),l=n("12488"),a=n("54762"),s=n("180894");n("675373");var u=n("700061"),_=n("246647"),d=n("595902"),c=n("745618"),h=n("300253"),E=n("338426");let m=(0,h.n)((0,E.ZP)(()=>Promise.resolve().then(n.bind(n,928406)),{ssr:!1}),{name:_.l.VolumeMemoryPlugin,renderWhen:d._.LivingInit});var v=(0,c.OV)({Component:m,layoutName:u.t.PlayerControlLayout,ComponentName:_.l.VolumeMemoryPlugin,index:0}),f=n("493153"),I=n("725805"),P=n("51526"),T=n("563097");n("88648");var L=n("446042"),N=n("770732"),p=n("736579");let S=(0,h.n)((0,E.ZP)(()=>Promise.all([n.e("26835"),n.e("48539")]).then(n.bind(n,366622)),{ssr:!1}),{name:_.l.EFFECT_PLUGIN,renderWhen:p.d.afterComponent(_.l.ChatRoom),taskPriority:"user-visible"});(0,L.GI)({name:_.l.EFFECT_PLUGIN,condition:e=>{let{store:t}=e,{feedStore:{isActive:n}}=t;return n},Component:S,index:0});var g=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.EFFECT_PLUGIN}),layoutName:u.t.GiftEffectLayout,ComponentName:_.l.EFFECT_PLUGIN,index:0}),C=n("910417"),A=n("541403"),y=n("185067");let R=(0,h.n)((0,E.ZP)(()=>n.e("54691").then(n.bind(n,361602)),{ssr:!1}),{name:_.l.QUALITY_SWITCH,renderWhen:d._.LivingInit});(0,L.GI)({name:_.l.QUALITY_SWITCH,condition:()=>!0,Component:R,index:0});var b=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.QUALITY_SWITCH}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.QUALITY_SWITCH,index:0}),O=n("450360");let w=(0,h.n)((0,E.ZP)(()=>n.e("98058").then(n.bind(n,868734)),{ssr:!1}),{name:_.l.HintContainerPlugin,renderWhen:d._.FirstFrame,taskPriority:"user-visible"});(0,L.GI)({name:_.l.HintContainerPlugin,condition:e=>{var t;let{store:n}=e;return null==n?void 0:null===(t=n.feedStore)||void 0===t?void 0:t.isActive},Component:w,index:0});var Y=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.HintContainerPlugin}),layoutName:u.t.TipsLayout,ComponentName:_.l.HintContainerPlugin,index:0}),k=n("591614");let x=(0,h.n)((0,E.ZP)(()=>n.e("22299").then(n.bind(n,985455)),{ssr:!1}),{name:_.l.GlobalControlPlugin,renderWhen:p.d.afterComponent(_.l.ChatRoom),taskPriority:"background"});(0,L.GI)({name:_.l.GlobalControlPlugin,condition:e=>{var t;let{store:n}=e;return null==n?void 0:null===(t=n.feedStore)||void 0===t?void 0:t.isActive},Component:x,index:0});var M=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.GlobalControlPlugin}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.GlobalControlPlugin,index:0}),U=n("279910"),K=n("393840"),Z=n("113810"),V=n("322604"),D=n("475274"),j=n("148541");let F=(0,h.n)((0,E.ZP)(()=>Promise.resolve().then(n.bind(n,335771)),{ssr:!1}),{name:_.l.AdaptedBySEIPlugin,renderWhen:d._.LivingInit});(0,L.GI)({name:_.l.AdaptedBySEIPlugin,condition:e=>{let{pipContext:t}=e;return!0},Component:F,index:0});var G=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.AdaptedBySEIPlugin}),layoutName:u.t.PlayerControlLayout,ComponentName:_.l.AdaptedBySEIPlugin,index:0}),H=n("357720"),W=n("425641"),B=n("476068"),Q=n("917460");let q=(0,h.n)((0,E.ZP)(()=>n.e("7680").then(n.bind(n,6858)),{ssr:!1}),{name:_.l.VIP_LIVE_BOUNDARY,renderWhen:p.d.afterComponent(_.l.ChatRoom),taskPriority:"background"});(0,L.GI)({name:_.l.VIP_LIVE_BOUNDARY,condition:()=>!0,Component:q,index:0});var $=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.VIP_LIVE_BOUNDARY}),layoutName:u.t.TipsLayout,ComponentName:_.l.VIP_LIVE_BOUNDARY,index:0}),X=n("354391"),z=n("427950"),J=n("231761"),ee=n("466193"),et=n("94667"),en=n("627179"),ei=n("839274"),er=n("602956"),eo=n("925025"),el=n("312894"),ea=n("618618");let es=(0,h.n)((0,E.ZP)(()=>n.e("71361").then(n.bind(n,437473)),{ssr:!1}),{name:_.l.TopEffectPlugin,renderWhen:p.d.afterComponent(_.l.ChatRoom),taskPriority:"user-visible"});(0,L.GI)({name:_.l.TopEffectPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},roomStore:{roomStatus:i}}=t;return n&&i!==ea.LV.END},Component:es,index:0});var eu=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.TopEffectPlugin}),layoutName:u.t.GiftTrayLayout,ComponentName:_.l.TopEffectPlugin,index:0}),e_=n("413221"),ed=n("154692");let ec=(0,h.n)((0,E.ZP)(()=>n.e("62099").then(n.bind(n,947217)),{ssr:!1}),{name:_.l.GuestBattlePlugin,renderWhen:d._.FirstFrame,taskPriority:"user-visible"});(0,L.GI)({name:_.l.GuestBattlePlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},linkmicStore:{isGuestBattle:i}}=t;return n&&i},Component:ec,index:0});var eh=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.GuestBattlePlugin}),layoutName:u.t.LinkMicAnimationLayout,ComponentName:_.l.GuestBattlePlugin,index:0}),eE=n("577630"),em=n("949235"),ev=n("471121"),ef=n("251015");let eI=(0,h.n)((0,E.ZP)(()=>n.e("46722").then(n.bind(n,85822)),{ssr:!1}),{name:_.l.LinkMicApplyPlugin,renderWhen:d._.FirstFrame,taskPriority:"background"});(0,L.GI)({name:_.l.LinkMicApplyPlugin,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},linkmicStore:{linkRoomType:i},roomStore:{roomStatus:r}}=t;return!!(n&&i&&r!==ea.LV.END)},Component:eI,index:0});var eP=(0,c.OV)({Component:()=>(0,T.jsx)(N.Z,{name:_.l.LinkMicApplyPlugin}),layoutName:u.t.LinkMicLayout,ComponentName:_.l.LinkMicApplyPlugin,index:0}),eT=n("642029"),eL=n("174911"),eN=n("135591"),ep=n("287454"),eS=n("92639"),eg=n("726028"),eC=n("741597"),eA=n("584366"),ey=n("368974")},106798:function(e,t,n){n(675373);var i=n(563097);n(88648);var r=n(300253),o=n(246647),l=n(595902),a=n(745618),s=n(700061),u=n(338426),_=n(770732),d=n(446042);let c=(0,r.n)((0,u.ZP)(()=>Promise.all([n.e("76746"),n.e("84425"),n.e("95395"),n.e("91039")]).then(n.bind(n,493504)),{ssr:!1}),{name:o.l.OperatingBar,renderWhen:l._.FirstFrame});(0,d.GI)({name:o.l.OperatingBar,condition:e=>{let{store:t}=e,{feedStore:{isActive:n},roomStore:{inRoomOnAppView:i},vipStore:{showVipLiveBoundary:r},vrStore:{isImmersive:o}}=t;return n&&!i&&!r&&!o},Component:c,index:0}),t.Z=(0,a.OV)({Component:()=>(0,i.jsx)(_.Z,{name:o.l.OperatingBar}),layoutName:s.t.BottomLayout,ComponentName:o.l.OperatingBar,index:1})},361602:function(e,t,n){n.r(t),n.d(t,{QualitySwitchPluginWrapper:function(){return y},default:function(){return R}}),n("874386"),n("250440");var i=n("563097"),r=n("88648"),o=n("713097"),l=n.n(o),a=n("88478"),s=n("892814"),u=n("18043"),_=n("441447"),d="nMP5L4c4",c="E5GerkUB",h=n("850670"),E=n("818597"),m=n("53562"),v=n("700045"),f=n("645260"),I=n.n(f),P=n("505575"),T=n("618618"),L=n("42872"),N=n("358472"),p=n("182794"),S=n("782580"),g=n("19670"),C=n("442761");let A=r.forwardRef((e,t)=>{let{streamData:n,defaultQuality:o,qualityList:h,player:m,sessionId:v,screenMode:f,roomId:I="",isAsianGames:P,isActivity:T,setNoStream:L,showRefreshPage:N}=e,{streamStore:{setCurrentQuality:p,currentQuality:A}}=(0,E.o)(),[y,R]=r.useState(o),[b,O]=r.useState(!1),w=r.useRef(o),Y=r.useCallback(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||e!==y)e&&h.includes(e)&&(R(e),requestAnimationFrame(()=>{_.emit(_.EVENT.syncLiveMemoryState,{clarity:e}),_.emit(_.EVENT.syncInteraction)}),(0,g.WH)("QualitySwitchPlugin_handleQuality",{quality:e,passive:t}),!t&&(0,u.QX)(e))},[h,y]);r.useEffect(()=>{let e=_.listen(_.EVENT.syncLiveMemoryState,e=>{(null==e?void 0:e.clarity)&&Y(e.clarity,null==e?void 0:e.clarityPassive)});return()=>e()},[Y]),r.useImperativeHandle(t,()=>({getCurrentQuality:()=>w.current,setCurrentQuality:(e,t)=>{Y(e,t)},getCurrentQualityList:()=>h})),r.useEffect(()=>{var e;w.current=y;let t=new CustomEvent("webcast_qualityEvent",{detail:{roomId:I,isLive:1,quality:y}});null===(e=document)||void 0===e||e.dispatchEvent(t)},[y]),r.useEffect(()=>{_.emit(_.EVENT.syncLiveMemoryState,{clarity:A,clarityPassive:!!(0,S.getAbrQualityAB)()||void 0})},[A]),r.useEffect(()=>{p(o)},[o]);let k=(0,C.wi)();return(0,a.$)({stream:n,quality:y,onSwitch:O,isUse:!k,sessionId:v,player:m,screenMode:f,qualityList:h,setNoStream:L,isActivity:T,showRefreshPage:N,roomId:I}),(0,s.v)({stream:n,quality:y,onSwitch:O,isUse:k,qualityList:h,player:m,screenMode:f}),(0,i.jsx)("div",{"data-wide":!0,className:l()(d,"QualitySwitchNewPlugin",{[c]:P}),children:r.Children.map(e.children,e=>r.isValidElement(e)?r.cloneElement(e,{quality:y,qualityList:h}):null)})});A.displayName="QualitySwitchPlugin";let y=(0,m.Pi)((0,h.rW)(A));var R=(0,m.Pi)(e=>{var t;let{streamStore:{streamInfoFromLiving:n,setCurrentQuality:o,watchingFinished:l,currentQuality:a},playerStore:{screenMode:s},roomStore:{roomInfo:u,isAsianGames:_,roomStatus:d,setIsShowRefreshPage:c},userStore:{userInfo:h},linkmicStore:{linkStatus:m}}=(0,E.o)(),{stream:f,startQuality:S,qualities:g,common:C,url:A,options:R,openIntercepted:b,interceptedQuality:O,openTryWatching:w}=n||{},{player:Y}=(0,P.n)(),k=I()(u,"room.id_str"),x=r.useMemo(()=>({streamData:f,defaultQuality:e.defaultQuality||S,qualityList:g,sessionId:null==C?void 0:C.session_id,screenMode:s,url:e.url||A,roomId:k,player:Y,isAsianGames:_,showRefreshPage:c,containerClassName:"QualitySwitchPluginContainer"}),[f,S,g,C,A,k,Y,_,s]),M=r.useMemo(()=>({setCurrentQuality:o}),[]),U=r.useMemo(()=>({options:R,stream:f}),[R,f]),K=(0,L.j_)([null==R?void 0:null===(t=R.default_quality)||void 0===t?void 0:t.sdk_key,(0,N.Hs)(b?O:void 0)]);return m!==T.cK.LINKED&&d!==T.LV.END&&Object.keys(f||{}).length&&S?(0,i.jsx)(p.T,{maxAbrQuality:K,qualities:g,streamInfo:U,setQuality:o,disableChange:w&&!l,children:(0,i.jsx)(y,{index:9,props:x,children:(0,i.jsx)(v.F,{qualityHandler:M,player:Y,openIntercepted:b,interceptedQuality:O,openTryWatching:w&&!l,screenMode:s,watchingFinished:l,streamOptions:R,isLogin:null==h?void 0:h.id_str,streamInfo:U})})}):null})},954909:function(e,t,n){n.d(t,{t:function(){return i}});var i={auto:"auto",origin:"origin",uhd:"uhd",hd:"hd",sd:"sd",ld:"ld"}},911651:function(e,t,n){n.r(t),n.d(t,{VolumeWheel:function(){return I},default:function(){return P}}),n("777180"),n("897860"),n("250440");var i=n("563097"),r=n("850634"),o=n("850670"),l=n("834737"),a=n("88648"),s=n("47047"),u=n("725887"),_=n("367271"),d=n("520739"),c=n("878389");let h=(0,a.forwardRef)((e,t)=>(0,i.jsxs)("svg",(0,c._)((0,d._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,i.jsx)("path",{d:"M7 14a2 2 0 0 1 2-2h1l4.36-3.633a1 1 0 0 1 1.64.768v13.73a1 1 0 0 1-1.64.768L10 20H9a2 2 0 0 1-2-2v-4zM18 19a3 3 0 1 0 0-6v6z",fill:"#fff"}),(0,i.jsx)("path",{d:"M18 23.734l.095-.007A7.75 7.75 0 0 0 18 8.266v2.507a5.25 5.25 0 0 1 0 10.454v2.507z",fill:"#fff"})]})));var E=n("664956"),m=n("796474");let v=(e,t)=>{if(!(null==e?void 0:e.current))return;let n=e.current;if(n.muted){n.muted=!1,n.volume="up"===t?.05:0;return}let i="up"===t?n.volume+.05:n.volume-.05;i=Math.max(i=Math.min(i,1),0),n.volume=Number(i.toFixed(2)),0===i&&(n.muted=!0)},f=(e,t)=>{if(!(null==e?void 0:e.current))return;let n=e.current;if(n.muted){n.muted=!1,n.volume=Math.max(t/100,0);return}let i=n.volume+t/100;i=Math.max(i=Math.min(i,1),0),n.volume=Number(i.toFixed(2)),0===i&&(n.muted=!0)},I=(0,o.nl)(e=>{let{isActive:t,index:n,defaultIcon:o}=e,{playerRef:_,el:d}=(0,a.useContext)(r.ET),c=(0,a.useRef)(null);return(0,a.useEffect)(()=>{var e;if(!t)return;let n=null==d?void 0:d.querySelector(".douyin-player-volume"),i=null==d?void 0:d.querySelector(".douyin-player-volume-slider"),r=e=>{let t=(0,s.Q5)();e.stopPropagation(),e.preventDefault();let n=(t?1:-1)*parseInt(String(e.deltaY/20),10);0!==n&&f(_,n)},o=e=>{let{code:t}=e;if(u.Le.getConfig(u.gI.DisableNextPre)&&["ArrowUp","ArrowDown"].includes(e.code)){e.stopPropagation(),e.preventDefault(),"ArrowUp"===e.code?v(_,"up"):"ArrowDown"===e.code&&v(_,"down");return}let n=e.target,i=null==n?void 0:n.tagName;if("INPUT"!==i&&"TEXTAREA"!==i&&(null==n?void 0:n.contentEditable)!=="true"){if(e.shiftKey&&("Equal"===t||"Minus"===t)){var r,o;null===(r=c.current)||void 0===r||r.focus(),"Equal"===t?v(_,"up"):v(_,"down"),null===(o=c.current)||void 0===o||o.blur()}}},l=()=>{u.Le.setConfig(u.gI.DisableNextPre,!0)},a=()=>{u.Le.setConfig(u.gI.DisableNextPre,!1)},h=e=>{e.stopPropagation()};return null==n||n.addEventListener("wheel",r),null==n||n.addEventListener("mouseover",l),null==n||n.addEventListener("mouseout",a),null===(e=document)||void 0===e||e.addEventListener("keydown",o),null==i||i.addEventListener("pointerdown",h),()=>{var e;null==n||n.removeEventListener("wheel",r),null==n||n.removeEventListener("mouseover",l),null==n||n.removeEventListener("mouseout",a),null===(e=document)||void 0===e||e.removeEventListener("keydown",o),null==i||i.removeEventListener("pointerdown",h)}},[t]),(0,i.jsx)(l.dm,{ref:c,index:n,props:{IconVolume:o?void 0:h,IconVolumeSmall:o?void 0:E.Z,IconVolumeMuted:o?void 0:m.Z,showVolume:!0}})});var P=()=>{let{isLivingPip:e}=(0,_.ds)();return(0,i.jsx)(I,{isActive:!0,position:e?0:1,index:e?2:4})}},861481:function(e,t,n){n.r(t),n.d(t,{LinkMicPlayModeLimitPlugin:function(){return N}}),n(250440);var i=n(879962),r=n(505575),o=n(850634),l=n(618618),a=n(669417),s=n(614316),u=n(623527),_=n(828782),d=n(632766),c=n(645260),h=n.n(c),E=n(96008),m=n.n(E),v=n(88648),f=n(104013),I=n(818597),P=n(432431),T=n(360977),L=n(53562);let N=e=>{let{isVerifyed:t}=e,{roomStore:{roomInfo:n,setNotSupportReason:c},linkmicStore:{setIsPlayModeNotSupport:E,imLinkMicLayout:L,uiLayout:N,setAsrSubtitle:p},singletonStore:{message:S},userStore:{userInfo:g},eventStore:{linkmicEvent:C}}=(0,I.o)(),{player:A}=(0,r.n)(),y=(0,T.kF)(),R=v.useCallback(()=>{a.kg.info("玩法限制",(0,f.toJS)(n)),E(!0),c(l.Ly.MULTI_CONSUMER_LINE)},[E,n]),b=(0,v.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h()(n,"room.linker_detail.linker_ui_layout");(null==g?void 0:g.isReady)&&((0,s.Qz)({anchor_id:h()(n,"anchor.id_str",""),room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:Number(Object.keys(h()(n,"room.linker_map",{}))),playmode:h()(n,"room.linker_detail.linker_play_modes",[]),ui_layout:e}),a.kg.event(`[${u.Tn.Error}]${u.Mo.LiveNotSupportError}`,{room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:Number(Object.keys(h()(n,"room.linker_map",{}))),playmode:h()(n,"room.linker_detail.linker_play_modes",[]),ui_layout:e,is_client:(0,_.DT)()}))},[n,g]);v.useEffect(()=>{let e=h()(n,"room.linker_detail.linker_ui_layout"),t=Number(Object.keys(h()(n,"room.linker_map",{}))),i=h()(n,"room.linker_detail.linker_play_modes",[]);(e||t||(null==i?void 0:i.length)>0)&&a.kg.event("linkmic_user_page_view",{room_id:null==n?void 0:n.roomId,user_id:null==g?void 0:g.id_str,scene:t,playmode:i,ui_layout:e,is_client:(0,_.DT)()})},[n,g]),v.useEffect(()=>{(async()=>{let e=h()(n,"room.linker_detail.linker_ui_layout"),t=await (0,d.ZP)({service_name:"webcast.douyin.live_pc",key:"linkmic_not_support_uilayout"}),{uilayout:i}=t[null==y?void 0:y.XTTENV]?t[null==y?void 0:y.XTTENV]:t,r=e=>{if(i&&(null==i?void 0:i.includes(e)))return b(e),!0};[e,N].some(e=>r(e))&&R()})()},[n,N]);let O=h()(n,"room.live_room_mode"),w=v.useCallback(e=>{if(100===e.code)try{var t,r,o;let a=new TextDecoder().decode(e.content),s=(0,i.KR)(a);if(void 0===L&&s&&s.ktv_sei&&(null==s?void 0:null===(t=s.ktv_sei)||void 0===t?void 0:t.scene)>0&&(null==s?void 0:null===(r=s.ktv_sei)||void 0===r?void 0:r.scene)!==3&&R(),s&&s.app_data)m()();else if(null==s?void 0:null===(o=s.source)||void 0===o?void 0:o.includes("TTLiveSDK")){let e=h()(n,"room.basis.is_customize_audio_room",!1);O===l.ke.AUDIO&&!e&&R()}}catch(e){}},[R,L,O,n]);return v.useEffect(()=>(null==A||A.on(o.FP.SEI,w),()=>{null==A||A.off(o.FP.SEI,w)}),[A,w]),v.useEffect(()=>{let e=h()(n,"room.linker_map",{}),t=h()(n,"room.linker_detail.linker_play_modes",[]),i=!1;(e[P.xs.Scene_AudioChatRoom]||e[P.xs.Scene_VideoChatRoom]||e[P.xs.Scene_VideoEqualRoom])&&t.forEach(e=>{e===P.V0.LinkmicPlayMode_Teamfight&&(b(),i=!0)}),e[P.xs.Scene_AudioChatRoom]&&(t.includes(P.V0.LinkmicPlayMode_Teamfight)||t.includes(P.V0.LinkmicPlayMode_AudioChat_3x3_N_EMPTY))&&(i=!1),t.forEach(e=>{e===P.V0.LinkmicPlayMode_KTVSingingChallenge&&(b(),i=!0)}),(t.includes(P.V0.LinkmicPlayMode_Teamfight)||t.includes(P.V0.LinkmicPlayMode_AudioChat_3x3_N_EMPTY))&&(i=!1),i&&R()},[R,n]),v.useEffect(()=>null==S?void 0:S.on("KtvChallengeConfigMessage",e=>{e.forEach(e=>{let{method:t,payload:n}=e;if(!!t&&!!n)"WebcastKtvChallengeConfigMessage"===t&&(null==n?void 0:n.switch_status)==="1"&&R()})}),[R,S]),null};t.default=(0,L.Pi)(N)},513081:function(e,t,n){n.d(t,{M2:function(){return l},_q:function(){return s},dE:function(){return a}}),n(250440);var i=n(39738),r=n(829021),o=n(782580);let l=(e,t)=>{if([void 0,null,""].includes(e))return;let n=Number(e);if(t){let e=t.find(e=>n===e.id);if(e)return e.value}switch(n){case i.V_.LINKMICUILAYOUT_VIDEOCHAT_DYNAMICLAYOUT1V6:return r.yP.VIDEO_DYNAMIC_FLOAT;case i.V_.LINKMICUILAYOUT_VIDEOCHAT_ENLARGEGUEST1V6:case i.V_.LINKMICUILAYOUT_VIDEOCHATFLOATWINDOWLAYOUT:return r.yP.VIDEO_1V6;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_3X3:return r.yP.VIDEO_GRID;case i.V_.LINKMICUILAYOUT_VIDEOEQUALDYNAMICLAYOUT:return r.yP.VIDEO_DYNAMIC;case i.V_.LINKMICUILAYOUT_CROSSROOMLINKMIC_6V6:return r.yP.VIDEO_6V6;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8:return r.yP.AUDIO_1V8;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_3X3:return r.yP.AUDIO_GRID;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V3:return r.yP.VIDEO_1_V_3;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V6:return r.yP.VIDEO_1_V_6;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_LEFT1V8:return r.yP.VIDEO_1_V_8;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_TOP1V8:return r.yP.VIDEO_T1_V_B8;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_STAGE:return r.yP.AUDIO_1V8_STAGE;case i.V_.LINKMICUILAYOUT_VIDEOEQUAL_DYNAMICLAYOUT1V8FIX:return r.yP.VIDEO_1V8;case i.V_.LINKMICUILAYOUT_VIDEO_2V4V4:return r.yP.VIDEO_2V4V4;case i.V_.LINKMICUILAYOUT_LIVE_PARTNER_DYNAMIC:return r.yP.MATE_CUSTOM;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_TOP2V4V4:return r.yP.AUDIO_DOUBLE_C;case i.V_.LINKMICUILAYOUT_AUDIOCHAT_1V8_ENLARGE_STAGE:if((0,o.getInLiveAudioLayoutOptAB)())return r.yP.AUDIO_1V8_STAGE;return r.yP.AUDIO_1V8;default:return}},a=e=>"new_audience"===e,s=(e,t)=>{if([e,t].some(e=>!e))return{top:0,left:0,right:0,bottom:0};let n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=i.top-n.top,o=i.left-n.left,l=o+t.clientWidth,a=r+t.clientHeight;return{top:r,left:o,right:l,bottom:a}}},846296:function(e,t,n){n(250440);var i=n(513081),r=n(618618),o=n(614316),l=n(818597),a=n(432431),s=n(615323),u=n(632766),_=n(645260),d=n.n(_),c=n(88648),h=n(608261);t.Z=()=>{let{linkmicStore:{setPlayModes:e,setImLinkMicLayout:t,setUiLayout:n,setFunctionType2:_,linkRoomType:E,setIsPlayModeNotSupport:m,layoutConfig:v,setLayoutConfig:f},singletonStore:{message:I},roomStore:{roomInfo:P,setNotSupportReason:T},userStore:{userInfo:L}}=(0,l.o)();(0,c.useEffect)(()=>{let r=d()(P,"room.linker_detail.linker_play_modes",[]),o=d()(P,"room.linker_detail.linker_ui_layout");e(r),n(o),(0,h.D)().includes(Number(o))?t((0,i.M2)(o)):(0,u.ZP)({service_name:"webcast.douyin.live_pc",key:"linkmic_layout_config"}).then(e=>{e&&(f(e),t((0,i.M2)(o,e)))}),_(d()(P,"room.linker_detail.function_type"))},[P,t,_,e]);let N=(0,c.useCallback)((e,t,n)=>{(null==L?void 0:L.isReady)&&(0,o.Qz)({anchor_id:d()(P,"anchor.id_str",""),room_id:null==P?void 0:P.roomId,user_id:null==L?void 0:L.id_str,scene:e,playmode:t,ui_layout:n})},[P,L]);(0,c.useEffect)(()=>{if(!E)return null==I?void 0:I.on("LinkMicMethod",e=>{e.forEach(e=>{let{method:o,payload:l}=e;if(!o||!l)return;let u=Number(l.message_type);if("WebcastLinkMicMethod"===o&&u===s.iM.TYPE_TURNON){let{ui_layout:e}=l;n(e);let r=(0,i.M2)(e,v);r&&t(r)}if(u===s.iM.TYPE_TURNON){let{scene:e,play_modes:t=[],ui_layout:n}=l;if(e){let i=Number(e);(i===a.xs.Scene_KTV||i===a.xs.Scene_VideoKTV)&&(m(!0),N(i,t,n),T(r.Ly.MULTI_KTV))}}})})},[E,v,t,m,T])}},489011:function(e,t,n){n.d(t,{SX:function(){return l},dY:function(){return r},oQ:function(){return o}});var i=n(572932);let r=e=>`sslocal://webcast_webview?url=https%3A%2F%2Flf-webcast-gr-sourcecdn.bytegecko.com%2Fobj%2Fbyte-gurd-source-gr%2Fwebcast%2Fmono%2Fh5%2Frevenue_gift_exhibition_hall_h5_douyin%2Fpages%2Fgift_list%2Findex.html%3Fprofile_user_id%3D${e}%26showPcClose%3Dtrue`,o=(e,t)=>{let n="";return n=t?encodeURIComponent(`${t}?profile_user_id=${e}`):encodeURIComponent(`${i.w.Exhibition}&profile_user_id=${e}`),`sslocal://lynxview?url=${n}&type=popup&gravity=bottom&height_percent=75&web_bg_color=ff060a19&radius=23&radius_bottom_right=0&radius_bottom_left=0&enable_preload=all&add_safe_area_height=0&use_wk_falcon=2`},l=()=>`sslocal://lynxview?url=${encodeURIComponent(i.w.Exhibition)}&type=popup&gravity=bottom&height_percent=75&web_bg_color=ff060a19&radius=23&radius_bottom_right=0&radius_bottom_left=0&enable_preload=all&add_safe_area_height=0&use_wk_falcon=2`},705189:function(e,t,n){n(675373);var i=n(246647),r=n(595902),o=n(300253),l=n(338426);t.Z=(0,o.n)((0,l.ZP)(()=>n.e("86354").then(n.bind(n,963063)),{ssr:!1}),{name:i.l.RoomMessageConsume,renderWhen:r._.LivingInit})},590928:function(e,t,n){n.d(t,{H:function(){return m}});var i=n(520739),r=n(878389);n(563097);var o=n(818597),l=n(88648),a=n(787277),s=n(937382),u=n(443646),_=n(169961),d=n(645260),c=n.n(d),h=n(828782),E=n(314325);let m=()=>{let e=l.useMemo(h.tq,[]),{streamStore:t,roomStore:n}=(0,o.o)(),d=(0,_.T)(),{disabledH265:m,setStreamInfoFromLiving:v,setWatchingFinished:f}=t||{},{isPullDataExsit:I}=n||{},{stream:P,common:T,options:L}=(0,a.kA)({disabledH265:m||e,doubleScreenAB:!0,isPullDataExsit:I}),N=(0,E.dM)(L),{openIntercepted:p,interceptedQuality:S,openTryWatching:g,qualities:C,startQuality:A,bitrate:y}=(0,s.Z)({stream:P,defaultQuality:N}),R=(0,E.AH)(),b=l.useMemo(()=>c()(T,"secret_key",""),[T]),{url:O,lowUrl:w,backupUrl:Y,H264Url:k}=(0,a.le)({stream:P,startQuality:A}),x=(0,l.useMemo)(()=>{let e=[];try{e=Object.keys(P||{}).filter(e=>"ao"!==e).map(e=>{let t;try{t=JSON.parse(P[e].main.sdk_params)}catch(e){t={resolution:"0x0"}}return{quality:e,resolution:t.resolution,url:(0,u.uC)(P[e].main.flv)}})}catch(t){e=[]}let t={resolutions:e,dividing:R,useArea:(null==d?void 0:d.liveUseArea)===1,useScore:R>0,useLongFirstframe:(null==d?void 0:d.liveUseFirstFrame)===1};return(0,r._)((0,i._)({},t),{switchUrl:O,lowUrl:w})},[P,d]);return(0,l.useEffect)(()=>{g&&f(!1)},[g]),(0,l.useEffect)(()=>{v({stream:P,common:T,options:L,openIntercepted:p,interceptedQuality:S,openTryWatching:g,qualities:C,startQuality:A,bitrate:y,secret_key:b,dividing:R,resolutionsel:x,url:O,lowUrl:w})},[P,T,L,p,S,g,C,A,y,b,R,x,O,w]),{stream:P,common:T,options:L,openIntercepted:p,interceptedQuality:S,openTryWatching:g,qualities:C,startQuality:A,bitrate:y,secret_key:b,dividing:R,resolutionsel:x,url:O,lowUrl:w,backupUrl:Y,H264Url:k}}},144020:function(e,t,n){n.d(t,{AY:function(){return a},HI:function(){return s},NY:function(){return l},WK:function(){return o},kc:function(){return i},t0:function(){return r}});var i={WEBCAST_CHAT_MESSAGE:"WebcastChatMessage",WEBCAST_GIFT_MESSAGE:"WebcastGiftMessage"};let r=12e3,o=[{desc:"一行",value:.1,key:1,log:.1},{desc:"两行",value:.2,key:5,log:.2},{desc:"25%",value:.25,key:2,log:.4},{desc:"50%",value:.5,key:3,log:.5},{desc:"80%",value:.8,key:4,log:.8}],l=[{desc:"超小",value:16,width:`${16}px`,key:5,log:-1},{desc:"小号",value:20,width:"20px",key:1,log:0},{desc:"适中",value:24,width:`${22}px`,key:2,log:1},{desc:"大号",value:28,width:`${26}px`,key:3,log:2},{desc:"超大",value:32,width:`${30}px`,key:4,log:3}],a=[{desc:"较慢",value:1.5*r,key:1,log:0},{desc:"适中",value:1.2*r,key:2,log:1},{desc:"较快",value:.9*r,key:3,log:2}],s={opacity:80,area:3,fontSize:1,speed:1,giftOn:!0,packageOn:!0}},344226:function(e,t,n){var i=n(134761);n(268917),n(527785),n(981168);var r=n(104013);t.Z=new class e{defineIoc(e){!this.iocList.find(t=>t.name===e.name&&t.index===e.index)&&this.iocList.push(e)}getIocList(e){return Object.values(this.iocList.filter(t=>t.condition(e)).reduce((e,t)=>((!e[t.name]||e[t.name].index<t.index)&&(e[t.name]=t),e),{}))}getIocItem(e,t){return this.iocList.filter(e=>e.name===t).filter(t=>t.condition(e)).sort((e,t)=>t-e)[0]}constructor(){(0,i._)(this,"iocList",[]),(0,i._)(this,"context",{}),(0,r.makeAutoObservable)(this)}}},237298:function(e,t,n){n.d(t,{P:function(){return l},i:function(){return a}});var i=n(563097),r=n(88648);let o=r.createContext({}),l=e=>(0,i.jsx)(o.Provider,{value:e.value,children:e.children}),a=()=>r.useContext(o)},470245:function(e,t,n){n.d(t,{Gw:function(){return a},bU:function(){return s}});var i=n(563097),r=n(88648),o=n(736579);let l=r.createContext(null),a=e=>{let{children:t,uuid:n}=e,a=(0,r.useMemo)(()=>new o.d(n),[n]),s=(0,r.useRef)(a);return s.current=a,(0,r.useEffect)(()=>()=>{var e;null==s||null===(e=s.current)||void 0===e||e.destroy()},[]),(0,i.jsx)(l.Provider,{value:a,children:t})},s=()=>r.useContext(l)},217713:function(e,t,n){n.d(t,{Qz:function(){return i}});var i={Admin:0,0:"Admin",Base:1,1:"Base",Advanced:2,2:"Advanced",Supreme:3,3:"Supreme"}},271242:function(e,t,n){n.d(t,{W6:function(){return i}});var i={TPYE_LINKER_UNKNOWN:0,0:"TPYE_LINKER_UNKNOWN",TYPE_LINKER_CREATE:1,1:"TYPE_LINKER_CREATE",TYPE_LINKER_CLOSE:2,2:"TYPE_LINKER_CLOSE",TYPE_LINKER_INVITE:3,3:"TYPE_LINKER_INVITE",TYPE_LINKER_APPLY:4,4:"TYPE_LINKER_APPLY",TYPE_LINKER_REPLY:5,5:"TYPE_LINKER_REPLY",TPYE_LINKER_ENTER:6,6:"TPYE_LINKER_ENTER",TPYE_LINKER_LEAVE:7,7:"TPYE_LINKER_LEAVE",TYPE_LINKER_PERMIT:8,8:"TYPE_LINKER_PERMIT",TPYE_LINKER_CANCEL_INVITE:9,9:"TPYE_LINKER_CANCEL_INVITE",TYPE_LINKER_WAITING_LIST_CHANGE:10,10:"TYPE_LINKER_WAITING_LIST_CHANGE",TYPE_LINKER_LINKED_LIST_CHANGE:11,11:"TYPE_LINKER_LINKED_LIST_CHANGE",TYPE_LINKER_UPDATE_USER:12,12:"TYPE_LINKER_UPDATE_USER",TPYE_LINKER_KICK_OUT:13,13:"TPYE_LINKER_KICK_OUT",TPYE_LINKER_CANCEL_APPLY:14,14:"TPYE_LINKER_CANCEL_APPLY",TYPE_LINKER_BAN:15,15:"TYPE_LINKER_BAN",TYPE_LINKER_DISPATCH_ITEM:16,16:"TYPE_LINKER_DISPATCH_ITEM",TYPE_LINKER_VIOLATION_REMINDER:17,17:"TYPE_LINKER_VIOLATION_REMINDER",TYPE_LINKER_UPDATE_LINK_TYPE_APPLY:18,18:"TYPE_LINKER_UPDATE_LINK_TYPE_APPLY",TYPE_LINKER_UPDATE_LINK_TYPE_REPLY:19,19:"TYPE_LINKER_UPDATE_LINK_TYPE_REPLY",TYPE_LINKER_AVATAR_AUDIT:20,20:"TYPE_LINKER_AVATAR_AUDIT",TYPE_APPlY_EXPIRED:22,22:"TYPE_APPlY_EXPIRED",TYPE_APPLY_STRONG_REMINDER:23,23:"TYPE_APPLY_STRONG_REMINDER",TYPE_ANCHOR_STREAM_SWITCH:24,24:"TYPE_ANCHOR_STREAM_SWITCH",TYPE_LINKER_CLICK_SCREEN:25,25:"TYPE_LINKER_CLICK_SCREEN",TYPE_LINKER_LOCK_POSITION:26,26:"TYPE_LINKER_LOCK_POSITION",TYPE_LINKER_FOLLOW_STRONG_GUIDE:27,27:"TYPE_LINKER_FOLLOW_STRONG_GUIDE",TYPE_LINKER_SHARE_VIDEO_IM:28,28:"TYPE_LINKER_SHARE_VIDEO_IM",TYPE_GUEST_INVITE:29,29:"TYPE_GUEST_INVITE",TYPE_GUEST_EXIT_CAST_SCREEN:30,30:"TYPE_GUEST_EXIT_CAST_SCREEN",TYPE_LINKER_SWITCH_SCENE:31,31:"TYPE_LINKER_SWITCH_SCENE",TYPE_LINK_PHASEINFO:32,32:"TYPE_LINK_PHASEINFO",TYPE_LINKER_CHANGE_PLAY_MODE:33,33:"TYPE_LINKER_CHANGE_PLAY_MODE",TYPE_LOW_BALANCE_FOR_PAID_LINKMIC:34,34:"TYPE_LOW_BALANCE_FOR_PAID_LINKMIC",TYPE_DEGRADE_ALERT:35,35:"TYPE_DEGRADE_ALERT",TYPE_ENLARGE_GUEST_INVITE:36,36:"TYPE_ENLARGE_GUEST_INVITE",TYPE_ENLARGE_GUEST_REPLY:37,37:"TYPE_ENLARGE_GUEST_REPLY",TYPE_ENLARGE_GUEST_APPLY:38,38:"TYPE_ENLARGE_GUEST_APPLY",TYPE_LINK_PREPARE_APPLY:39,39:"TYPE_LINK_PREPARE_APPLY",TYPE_LINK_CANCEL_PREPARE_APPLY:40,40:"TYPE_LINK_CANCEL_PREPARE_APPLY",TYPE_LINKER_CROSS_ROOM_UPDATE:41,41:"TYPE_LINKER_CROSS_ROOM_UPDATE",TYPE_LINKER_CHANGE_MULTI_PK_TEAM_INFO:42,42:"TYPE_LINKER_CHANGE_MULTI_PK_TEAM_INFO",TYPE_CROSS_ROOM_LINK_INVITE:43,43:"TYPE_CROSS_ROOM_LINK_INVITE",TYPE_CROSS_ROOM_LINK_REPLY:44,44:"TYPE_CROSS_ROOM_LINK_REPLY",TYPE_CROSS_ROOM_LINK_CANCEL_INVITE:45,45:"TYPE_CROSS_ROOM_LINK_CANCEL_INVITE",TYPE_LINK_RESUME_AUDIENCE:46,46:"TYPE_LINK_RESUME_AUDIENCE",TYPE_LINK_BATTLE_CONNECT:47,47:"TYPE_LINK_BATTLE_CONNECT",TYPE_RESUME_APPLY:48,48:"TYPE_RESUME_APPLY",TYPE_CROSS_ROOM_RTC_INFO:49,49:"TYPE_CROSS_ROOM_RTC_INFO",TYPE_ANCHOR_UPDATE_LINKMIC_CONFIG:50,50:"TYPE_ANCHOR_UPDATE_LINKMIC_CONFIG",TYPE_ANCHOR_UPDATE_LAYOUT:51,51:"TYPE_ANCHOR_UPDATE_LAYOUT",TYPE_APPLY_RANK_CHANGE:52,52:"TYPE_APPLY_RANK_CHANGE",TYPE_CHANGE_MEDIA_INFO:53,53:"TYPE_CHANGE_MEDIA_INFO",TYPE_LINKER_UILAYOUT_CHANGE:54,54:"TYPE_LINKER_UILAYOUT_CHANGE",TYPE_UPDATE_WAITING_USER_OFFSET:55,55:"TYPE_UPDATE_WAITING_USER_OFFSET",TYPE_REMOVE_WAITING_USER:56,56:"TYPE_REMOVE_WAITING_USER",TYPE_LINKER_PREPARE_INVITE:57,57:"TYPE_LINKER_PREPARE_INVITE",TYPE_LINKER_PREPARE_REPLY:58,58:"TYPE_LINKER_PREPARE_REPLY",TYPE_LINKER_CONFIRM_UNSILENCE:59,59:"TYPE_LINKER_CONFIRM_UNSILENCE",TYPE_LINKER_SWITCH_CHANNEL_INVITE:60,60:"TYPE_LINKER_SWITCH_CHANNEL_INVITE",TYPE_LINKER_SWITCH_CHANNEL_REPLY:61,61:"TYPE_LINKER_SWITCH_CHANNEL_REPLY",TYPE_LINKER_SWITCH_CHANNEL_CANCEL:62,62:"TYPE_LINKER_SWITCH_CHANNEL_CANCEL",TYPE_AUDIO_AVATAR_NOTICE:63,63:"TYPE_AUDIO_AVATAR_NOTICE",TYPE_RTC_ACTION:64,64:"TYPE_RTC_ACTION",TYPE_LINKER_CROSS_LINK_INFO_UPDATE:65,65:"TYPE_LINKER_CROSS_LINK_INFO_UPDATE",TYPE_LINKER_CROSS_LINK_FINISH:66,66:"TYPE_LINKER_CROSS_LINK_FINISH",TYPE_INIT_CHAT_ROOM:67,67:"TYPE_INIT_CHAT_ROOM",TYPE_LINKER_AUDIENCE_WAITING_LIST_CHANGE:68,68:"TYPE_LINKER_AUDIENCE_WAITING_LIST_CHANGE",TYPE_LINKER_UPDATE_LINK_TYPE_FORCE_OPEN_CAMERA:69,69:"TYPE_LINKER_UPDATE_LINK_TYPE_FORCE_OPEN_CAMERA",TYPE_LINKER_ENLARGE_UPDATE:70,70:"TYPE_LINKER_ENLARGE_UPDATE",TPYE_LINKER_SYS_KICK_OUT:101,101:"TPYE_LINKER_SYS_KICK_OUT",TPYE_LINKER_SYNC_WRDS:1e4,1e4:"TPYE_LINKER_SYNC_WRDS",TYPE_LINKER_POS_ATTR:10001,10001:"TYPE_LINKER_POS_ATTR",TYPE_RTS_UPDATE_STATUS:10002,10002:"TYPE_RTS_UPDATE_STATUS"}},809218:function(e,t,n){n.d(t,{K:function(){return _},M:function(){return d}});var i=n(818597),r=n(88648),o=n(717864),l=n(802913),a=n(725887),s=n(544406),u=n(797973);function _(e){return"uhd"===e}function d(){let{triggerDownloadClient:e}=(0,o.o)({channelId:l.g.Lv4k}),{roomStore:{isOlympicGame:t,setIsEnableOlympic4k:n}}=(0,i.o)(),_=(0,u.Z)(async()=>{try{window.collectEvent("add_to_desktop_click",{type:"4k",channel_id:l.g.Lv4k,enter_from:"live_detail",ug_channel_id:a.Le.getConfig(a.gI.WebUgChannelId)||""}),await s.a.openClient()}catch(t){e()}});return(0,r.useEffect)(()=>{n(t)},[t]),{enableOlympic4k:t,rediectDownload:t,openOrDownloadClient:_}}},877033:function(e,t,n){n.d(t,{v0C:function(){return v}});var i=n(134761),r=n(520739),o=n(878389);n(413806),n(826893),n(284961),n(927234),n(874386);var l=n(167951),a=n(742401),s=n(136832),u=n(914104),_=n(661898),d=n(785632),c=n(455239),h=n(214068),E=n(659933),m=n(782580);n(393738);class v extends _.TQ{setImRequestPath(e){this.polling.props.im_path=e}setWebsocketKey(e){this.polling.props.websocket_key=e}setInsertKey(e,t){this.insertData={insert_task_id:e,live_reason:t}}getimReponseHeader(){return this.headers.fetchHeader}getCursor(){var e;return null===this||void 0===this?void 0:null===(e=this.cursor)||void 0===e?void 0:e._first_cursor}getPolling(){return this.polling}getDecoder(){return null===this||void 0===this?void 0:this.decoder}getimPushResponseHeader(){return this.headers.pushHeader}getimHeader(){return this.headers}subscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.C7.ASYNC;if(n===h.C7.ASYNC){let n=e.split(",").map(e=>this.on(e.replace(d.nl,""),t));return()=>{n.forEach(e=>e())}}let i=e=>t([e]);this.cachedHandler.set(t,i);let r=e.split(",").map(e=>this.syncOn(e.replace(d.nl,""),i));return()=>{this.cachedHandler.delete(t),r.forEach(e=>e())}}unsubscribe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.C7.ASYNC;if(n===h.C7.ASYNC){e.split(",").forEach(e=>this.off(e.replace(d.nl,""),t));return}let i=this.cachedHandler.get(t);this.cachedHandler.delete(t),e.split(",").forEach(e=>this.syncOff(e.replace(d.nl,""),i))}start(e){var t,n,i,o,l,s,_,c;arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{this.systemEmitter.on("header",(e,t)=>{if("http"===e&&!this.headers.fetchHeader){this.headers.fetchHeader=t;return}if("socket"===e){this.headers.pushHeader=t;return}});let u="15";if(!a.s){let e=(null===(s=window)||void 0===s?void 0:null===(l=s.__STORE__)||void 0===l?void 0:null===(o=l.roomStore)||void 0===o?void 0:null===(i=o.roomInfo)||void 0===i?void 0:null===(n=i.room)||void 0===n?void 0:null===(t=n.room_auth)||void 0===t?void 0:t.FirstFeedHistChat)||0;2===e&&(u="0")}"string"==typeof e?super.start({room_id:e,identity:d.nN.Audience,need_persist_msg_count:u,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason}):super.start((0,r._)({identity:d.nN.Audience,need_persist_msg_count:u,insert_task_id:this.insertData.insert_task_id,live_reason:this.insertData.live_reason},e))}catch(e){try{(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",categories:{message:null==e?void 0:e.message,stack:null==e?void 0:null===(c=e.stack)||void 0===c?void 0:null===(_=c.toString)||void 0===_?void 0:_.call(c)},level:"warn",type:"log"}})}catch(e){}}}queuePush(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(e=>this.mock(e.method,e))}constructor(){var e;super(E.C,{host:(0,s.iE)().API_DOMAIN,aid:"6383",live_id:1,app_name:"douyin_web",did_rule:3,endpoint:"live_pc",support_wrds:1,user_unique_id:null===(e=(0,l.Es)())||void 0===e?void 0:e.user_unique_id,im_path:"/webcast/im/fetch/",websocket_key:[]},[],{emitter:new c.Q,get backdropWhenHidden(){if("undefined"==typeof window||(0,m.getInLiveMsgFetchOpt)())return[];return["ChatMessage","GiftMessage","LikeMessage"]},wrdsV1:["WebcastPaidLiveTypeModifyMessage"]}),(0,i._)(this,"headers",{}),(0,i._)(this,"insertData",{insert_task_id:"",live_reason:""}),(0,i._)(this,"cachedHandler",new Map);let t=(0,o._)((0,r._)({},this.wrds),{subscribe:(e,t)=>{let n=e.split(",").map(n=>this.wrds.on("RoomDataSyncMessage",e,t,"v1"));return()=>{n.forEach(e=>e())}},unsubscribe:(e,t)=>{e.split(",").forEach(e=>{this.wrds.off("RoomDataSyncMessage",e,t)})}});this.wrds=t,!a.s&&(window.__use_isaac_sdk=!0),this.systemEmitter.on("downgrade",e=>{var t,n,i,r,o,l;this.downgrade(e),(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-downgrade",metrics:{downgrade:1},categories:{type:scope,userId:null===(i=window.INITIAL_STATE)||void 0===i?void 0:null===(n=i.userStore)||void 0===n?void 0:null===(t=n.userInfo)||void 0===t?void 0:t.id_str,roomId:null===(l=window.INITIAL_STATE)||void 0===l?void 0:null===(o=l.roomStore)||void 0===o?void 0:null===(r=o.roomInfo)||void 0===r?void 0:r.roomId},type:"event"}})}),this.systemEmitter.on("error",(e,t)=>{var n,i,r,o,l,a;(0,u.OK)().report({ev_type:"custom",payload:{name:"im-sdk-error",metrics:{[e]:1},categories:{type:e,userId:null===(r=window.INITIAL_STATE)||void 0===r?void 0:null===(i=r.userStore)||void 0===i?void 0:null===(n=i.userInfo)||void 0===n?void 0:n.id_str,roomId:null===(a=window.INITIAL_STATE)||void 0===a?void 0:null===(l=a.roomStore)||void 0===l?void 0:null===(o=l.roomInfo)||void 0===o?void 0:o.roomId},content:`${t}`,level:"warn",type:"log"}})})}}},324867:function(e,t,n){var i=n(520739),r=n(878389);n(413806),n(826893),n(284961),n(429532),n(338172),n(882732),n(544943),n(874386),n(675373),n(779788);var o=n(567754),l=n(119566),a=n(136832),s=n(742401);let u=e=>e.split("?")[0].replace(/\//g,"_"),_=(e,t)=>{let n=(0,o.parse)(t.split("?")[1]),r=t.split("?")[0],u=(0,i._)({aid:6383,device_platform:"web"},n);!s.s&&Object.assign(u,(0,l.f)());let _=(0,o.stringify)(u);return r.startsWith("http")?`${r}?${_}`:s.s&&!a.r8?`consul:${e}${r}?${_}`:`${(0,a.ZP)().API_DOMAIN+r}?${_}`},d={"Content-type":"application/x-www-form-urlencoded"},c=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"webcast.web.api",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=_(o,t);if(null==e||e.logger.info("request path:",a),!e)return window.fetch(a,(0,r._)((0,i._)({credentials:"same-origin"},n),{headers:(0,i._)({},d,n.headers)}));{var s,c,h,E,m,v;let o=(0,i._)((0,r._)((0,i._)({handleMethod:u(t)},n),{metrics:e.metrics,headers:(0,i._)((0,r._)((0,i._)({},null!==(s=e.app.config.fetch.headers)&&void 0!==s?s:{}),{Cookie:e.headers.cookie,"user-agent":e.headers["user-agent"],"x-use-ppe":null!==(c=e.headers["x-use-ppe"])&&void 0!==c?c:"","x-use-boe":null!==(h=e.headers["x-use-boe"])&&void 0!==h?h:"","x-tt-env":null!==(E=e.headers["x-tt-env"])&&void 0!==E?E:"","X-Real-IP":e.headers["x-real-ip"],"X-Forwarded-For":e.header["x-forwarded-for"]}),d,n.headers)}),null!=l?l:{});e.headers["x-tt-stress"]&&(o.headers["x-tt-stress"]=e.headers["x-tt-stress"]);try{e.measureTime("fetch");let t=await e.fetch(a,o);return e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:t.status,retry:0,error:0}),t}catch(n){null===(v=e.metrics)||void 0===v||null===(m=v.emitCounter)||void 0===m||m.call(v,"isomorphic_request.retry",1,e.app.config.psm,{url:a});let t=await e.fetch(a,o).catch(t=>{throw e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:-1,retry:1,error:1}),t});return e.measureTimeEnd("fetch",{url:new URL(a).pathname,status:t.status,retry:1,error:0}),t}}};t.ZP=c},951320:function(e,t,n){n.d(t,{S:function(){return N}});var i=n(520739),r=n(878389),o=n(368200);n(675373),n(874386);var l=n(563097),a=n(88648),s=n(355011),u=n(338426),_=n(315985),d=n(817938),c=n(155845),h=n(95596),E=n(207480),m=n(713097),v=n.n(m),f=n(35841),I=n(517054),P=n(740824);let T=(0,u.ZP)(()=>Promise.all([n.e("22556"),n.e("23145"),n.e("21248"),n.e("11073"),n.e("8734")]).then(n.bind(n,54291)),{ssr:!1});function L(e){let t=(0,a.useRef)(null),[n,u]=(0,a.useState)(!1);(0,_.Z)(()=>u(!1),t);let{maxLength:h,placeholder:E,disabled:m,className:L,onSend:N}=e,p=(0,o._)(e,["maxLength","placeholder","disabled","className","onSend"]),{enablePrivilegeDanmu:S,showPrivilegePanel:g}=(0,I.B3)(e=>({enablePrivilegeDanmu:e.enable,showPrivilegePanel:e.showPanel})),C=(0,s._i)(e=>e.editor),A=(0,s._i)(e=>e.isEmpty),y=(0,d.Z)(null==C?void 0:C.getRootContainer());(0,c.Z)("enter",e=>{e.preventDefault(),y&&(null==N||N())},{exactMatch:!0,useCapture:!0});let R=(0,I.MW)()||E;return(0,l.jsxs)("div",(0,r._)((0,i._)({},p),{className:v()(L,f.Z.commentEditorWrap,y&&f.Z.focus,(n||y||!A||g)&&f.Z.focusOrNoEmpty),onClick:()=>{u(!0),null==C||C.focus()},"data-e2e":"live-chatting",ref:t,children:[S&&(0,l.jsx)(P.K,{className:f.Z.danmakuSwitch}),(0,l.jsx)(T,{editable:!m,placeholder:R,maxLength:g?15:h,className:f.Z.commentEditor})]}))}let N=(0,a.memo)(e=>(0,l.jsx)(h.k2,{componentName:E.l.COMMENT_EDITOR,children:(0,l.jsx)(L,(0,i._)({},e))}))},130047:function(e,t,n){n(874386);var i=n(563097),r=n(88648);n(414621);var o=n(713097),l=n.n(o),a=n(605430),s=n(842197),u=n(971475),_=n(520339);t.Z=function(e){let{className:t,onEmojiClick:n,style:o,emojiList:d,showEmoji:c,emojiTea:h,setShowEmoji:E}=e,{list:m}=(0,r.useContext)(a.Z),{roomStore:{activityEmojiGroup:v}}=(0,_.oR)(),[f,I]=r.useState([]),P=(null==m?void 0:m.length)>0?m:d,T=(0,r.useRef)(null),[L,N]=r.useState(!1);r.useEffect(()=>{if(c){var e,t;null==h||h.livesdkEmojiShow({tab_title:null==v?void 0:null===(t=v[0])||void 0===t?void 0:null===(e=t.emoji_group)||void 0===e?void 0:e.name}),window.__act_message_source__=""}I((0,s.PA)(P))},[P,c,v]);let p=(0,r.useCallback)(function(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];i&&(null==h||h.livesdkEmojiClick({emoji_name:e.display_name,tab:t})),null==n||n(e)},[n]),S=(0,r.useCallback)(e=>{var t,n;(null==T?void 0:T.current)&&!(null==T?void 0:null===(n=T.current)||void 0===n?void 0:null===(t=n.contains)||void 0===t?void 0:t.call(n,null==e?void 0:e.target))&&L&&(null==E||E(!1))},[L]);(0,r.useEffect)(()=>(document.addEventListener("click",S),!L&&N(!0),()=>{document.removeEventListener("click",S)}),[L,N,S]);let g=(0,r.useRef)(null);return(0,r.useEffect)(()=>{g.current&&g.current.addEventListener("wheel",e=>{e.stopPropagation()})},[]),(0,i.jsx)("div",{className:l()("emoji-panel",t),style:o,onClick:e=>e.stopPropagation(),ref:T,children:(0,i.jsxs)("div",{className:"emoji-panel-list",onWheel:e=>{e.stopPropagation()},ref:g,children:[(null==f?void 0:f.length)>0&&(0,i.jsxs)("div",{className:"emoji-panel__common",children:[(0,i.jsx)("h3",{children:"最常使用"}),(0,i.jsx)("div",{className:"emoji-panel__common-use-list",children:null==f?void 0:f.map(e=>(0,i.jsx)("img",{onClick:()=>n&&p(e,"quick"),src:e.url,className:l()("emoji-panel__common-img")}))})]}),(0,i.jsx)(u.Z,{onClick:e=>n&&p(e,"all",!1),emojiTea:h}),(0,i.jsxs)("div",{className:"emoji-panel__all",children:[(null==f?void 0:f.length)>0&&(0,i.jsx)("h3",{children:"全部表情"}),(0,i.jsx)("div",{className:"emoji-panel__all-list",children:null==P?void 0:P.map(e=>(0,i.jsx)("img",{onClick:()=>n&&p(e,"all"),src:e.url,className:l()("emoji-panel__all-img")}))})]})]})})}},794006:function(e,t,n){n.d(t,{_:function(){return f}});var i=n("520739"),r=n("878389");n("874386");var o=n("563097"),l=n("88648");n("706652");var a=n("713097"),s=n.n(a),u=n("7981"),_=n("39072"),d=n("921028"),c=n("605430"),h=n("842197"),E=n("971475"),m=function(e){let{className:t,style:n,emojiList:i,emojiTea:r,onEmojiClick:a}=e,{list:u}=(0,l.useContext)(c.Z),[_,d]=l.useState([]),m=(null==u?void 0:u.length)>0?u:i,v=(0,l.useRef)(null);l.useEffect(()=>{d((0,h.PA)(m))},[m]);let f=(0,l.useCallback)((e,t)=>{null==r||r.livesdkEmojiClick({emoji_name:e.display_name,tab:t}),null==a||a(e)},[a]),I=(0,l.useRef)();return(0,l.useEffect)(()=>{I.current&&I.current.addEventListener("wheel",e=>{e.stopPropagation()})},[]),(0,o.jsx)("div",{className:s()("emoji-panel-normal-wrapper",t),style:n,ref:v,children:(0,o.jsxs)("div",{className:"emoji-panel-list",onWheel:e=>{e.stopPropagation()},ref:I,children:[(null==_?void 0:_.length)>0&&(0,o.jsxs)("div",{className:"emoji-panel__common",children:[(0,o.jsx)("h3",{children:"最常使用"}),(0,o.jsx)("div",{className:"emoji-panel__common-use-list",children:null==_?void 0:_.map(e=>(0,o.jsx)("img",{onClick:()=>f(e,"quick"),src:e.url,className:s()("emoji-panel__common-img")},e.url))})]}),(0,o.jsx)(E.Z,{onClick:e=>a&&f(e,"all"),emojiTea:r}),(0,o.jsxs)("div",{className:"emoji-panel__all",children:[(null==_?void 0:_.length)>0&&(0,o.jsx)("h3",{children:"全部表情"}),(0,o.jsx)("div",{className:"emoji-panel__all-list",children:null==m?void 0:m.map(e=>(0,o.jsx)("img",{onClick:()=>f(e,"all"),src:e.url,className:s()("emoji-panel__all-img")},e.url))})]})]})})},v=n("520339");let f=l.memo(l.forwardRef((e,t)=>{let{wrapStyle:n,style:a,emojiList:c,onEmojiClick:h,emojiTea:E}=e,[f,I]=(0,l.useState)(!1),[P,T]=(0,l.useState)("emoji"),L=(0,l.useCallback)(()=>{I(!1)},[]);(0,l.useEffect)(()=>(document.addEventListener("click",L),()=>{document.removeEventListener("click",L)}),[]),(0,l.useImperativeHandle)(t,()=>({show:e=>{I(!0),e&&T(e)},hide:()=>{I(!1)},toggle:()=>{I(!f)}}));let{isInPreview:N}=(0,v.DQ)();return(0,o.jsx)("div",{ref:t,className:s()("emoji-panel-wrapper",f?"":"invisible",{isInPreview:N}),onClick:e=>{e.stopPropagation()},style:n,children:(0,o.jsx)("div",{style:(0,r._)((0,i._)({},a),{height:"100%"}),children:(0,o.jsx)(u.Z,{defaultActiveKey:"emoji",activeKey:P,items:[{label:"小表情",key:"emoji",children:(0,o.jsx)(m,{emojiList:c,onEmojiClick:h,emojiTea:E})},{label:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.jsx)(_.Z,{style:{marginRight:"4px"}}),"会员表情"]}),key:"vipEmoji",children:(0,o.jsx)(d.E,{})}]})})})}))},842197:function(e,t,n){n.d(t,{BQ:function(){return c},M9:function(){return l},PA:function(){return _},p3:function(){return a},qA:function(){return u},yO:function(){return d}}),n(927234),n(268917),n(874386),n(413806),n(826893),n(981168),n(779788);var i=n(193533),r=n.n(i);n(645260);var o=n(311474);function l(e){return e?"string"==typeof e?e:"number"==typeof e?`${e}`:r().fromBits(e.low,e.high,e.unsigned).toString():""}n(88648);let a=e=>{var t,n;return l((null==e?void 0:null===(n=e.payload)||void 0===n?void 0:null===(t=n.common)||void 0===t?void 0:t.msg_id)||(0,o.Z)())},s=e=>!isNaN(Number(e)),u=e=>Object.keys(e).filter(e=>!s(e)).map(t=>e[t]),_=e=>{let t={};try{var n;t=JSON.parse(null!==(n=window.localStorage.getItem("commonEmoji"))&&void 0!==n?n:"")}catch(e){t={}}let i=Object.keys(t),r=[];return i.length>0&&i.forEach((t,n)=>{if(n<6){var i;let n=null==e?void 0:null===(i=e.filter(e=>(null==e?void 0:e.display_name)===t))||void 0===i?void 0:i[0];n&&r.push(n)}}),r},d=(e,t)=>{let n=e.split(/(\[.*?])/),i=[];return t?(n.forEach(e=>{var n;null==t||null===(n=t.emoji_group)||void 0===n||n.emoji_list.forEach(n=>{var r;e===`[${null==t?void 0:null===(r=t.emoji_group)||void 0===r?void 0:r.name}_${null==n?void 0:n.name}]`&&i.push(n)})}),i):i},c=(e,t)=>{if(0===d(e,t).length||!t)return"";try{var n;let i=[];return null==t||null===(n=t.emoji_group)||void 0===n||n.emoji_list.forEach(n=>{var r;let o=`[${null==t?void 0:null===(r=t.emoji_group)||void 0===r?void 0:r.name}_${null==n?void 0:n.name}]`,l=0,a=0;for(let t=0;t<e.length;t++){let r=e[t];"["===r&&(l=t),"]"===r&&(a=t,e.slice(l,a+1)===o&&i.push({type:1,value:n.id,start:l,length:o.length}))}}),i.sort((e,t)=>e.start-t.start),JSON.stringify(i)}catch(e){return""}}},403300:function(e,t,n){var i=n(520739),r=n(878389),o=n(563097),l=n(88648);let a=(0,l.forwardRef)((e,t)=>(0,o.jsx)("svg",(0,r._)((0,i._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.5 10a2 2 0 0 1 2-2h13a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-13a2 2 0 0 1-2-2V10zm3 4.5v-2h1.499V11h2v2.5a1 1 0 0 1-1 1H10.5zM20 11h-2v2.498a1 1 0 0 0 1 1h2.5v-2H20V11zm0 8.5h1.5v-2H19a1 1 0 0 0-1 1V21h2v-1.5zM12 21v-1.498h-1.5v-2H13a1 1 0 0 1 1 1V21h-2z",fill:"#fff"})})));t.Z=a}}]);