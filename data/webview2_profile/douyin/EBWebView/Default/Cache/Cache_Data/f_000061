"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["16064"],{730510:function(e,l,t){t.d(l,{z:function(){return g}}),t("874386");var i=t("563097"),n=t("88648"),o=t("713097"),a=t.n(o),d=t("441447"),r=t("343049"),s=t("465769"),u=t("30593"),c=t("140447"),v=t("49279"),m=t("66047"),_=t("575030"),f="jLGIrBFY",p="BEL49lJv",h=t("487330");let g=e=>{let{abtest:l,show:t,awemeInfoList:o,swiper:g,playNextFunc:y,playPrevFunc:w,className:I,defaultCssHidden:x=!0,from:b,isVideoSupportMP4:E=!0}=e,{fullScreenQuestionVars:T}=(0,h.Iq)(e=>{let{fullScreenQuestionVars:l}=e;return{fullScreenQuestionVars:l}}),[C,S]=(0,n.useState)(0),[N,P]=(0,n.useState)(!0),{awemeFeed:A}=(0,v.j)(),L=A.useValue("modalAwemeInfo",e=>e?"inner":"outer"),k=!A.useValue("nextAwemeInfo",Boolean),j=!A.useValue("prevAwemeInfo",Boolean),D=(0,m._)();return((0,n.useEffect)(()=>{if(g){let e=()=>{S(null==g?void 0:g.activeIndex)};try{g.on("slideChange",e),e()}catch(e){}return()=>{try{g.off("slideChange",e)}catch(e){}}}},[g]),(0,n.useEffect)(()=>{let e=d.listen(d.EVENT.changeVideoSideBar,e=>{let{isShowRelatedCard:l}=e;"Boolean"===(0,r.tQ)(l)&&P(l)});return()=>e()},[]),(0,c.Z)("OutsideSwitchButton",{abtest:l,awemeInfoList:o,swiper:g,className:I,innerDisableNext:k,innerDisablePrev:j,stream:L,activeIndex:C,sideBarShow:N}),t)?(0,i.jsx)(u.I,{playNextFunc:()=>{if(!_.f.playNextInterceptor(T))A.getValue("modalAwemeInfo")?A.dispatch("activeIndex",A.getValue("activeIndex")+1):y()},playPrevFunc:()=>{if(!_.f.playPrevInterceptor(T))A.getValue("modalAwemeInfo")?A.dispatch("activeIndex",A.getValue("activeIndex")-1):w()},className:a()(f,{[p]:x&&!N},I),disableNext:E&&"outer"!==L?k:!("recommend"===(0,s.vM)()&&(null==D?void 0:D.enableNextSlide))&&C===o.length-1,disablePrev:E&&"outer"!==L?j:0===C||!o[C-1]}):null}},832181:function(e,l,t){let i,n,o,a;t.d(l,{p:function(){return rq}});var d=t("520739"),r=t("878389"),s=t("368200");t("874386"),t("927234"),t("250440"),t("675373"),t("338172");var u=t("563097"),c=t("909543"),v=t("549519"),m=t("88648");function _(e){let l=e.resolve instanceof Promise?(0,m.use)(e.resolve):e.resolve,t="function"==typeof e.children?e.children(l):e.children;return(0,u.jsx)(u.Fragment,{children:t})}function f(e){return(0,u.jsx)(m.Suspense,{fallback:e.fallback,children:(0,u.jsx)(_,{resolve:e.resolve,children:e.children})})}var p=t("811796"),h=t("713097"),g=t.n(h),y=t("948375"),w=t("465571"),I=t("476261"),x=t("832052"),b=t("399242"),E=t("265656"),T=t("742740"),C=t("455499"),S=t("828782"),N=t("324794"),P=t("564231"),A=t("533155"),L=t("66047"),k=t("798644");let j=()=>{let e=(0,L._)(),l=(0,N.h)(e=>e.setSmallWindowScene),t=(0,m.useCallback)(e=>{try{var t;let i=k.s.getPlayer(e);if(!i||(null==i?void 0:null===(t=i.config)||void 0===t?void 0:t.awemeType)!==x.e.Normal)return;navigator.mediaSession&&navigator.mediaSession.setActionHandler&&navigator.mediaSession.setActionHandler("enterpictureinpicture",async function(){if((0,E.Dx)()){var e,t,n,o,a,d;l(P.T.AutoPip),A.Z.sendLog("autoSmallWindow",{enter_from:(0,T.yW)(),group_id:(null==i?void 0:null===(e=i.config)||void 0===e?void 0:e.vid)||(null==i?void 0:null===(o=i.config)||void 0===o?void 0:null===(n=o.baseConfig)||void 0===n?void 0:null===(t=n.mediaInfo)||void 0===t?void 0:t.id)}),null===(d=i.plugins)||void 0===d||null===(a=d.pip)||void 0===a||a.requestPIP()}})}catch(e){}},[]);(0,m.useEffect)(()=>{if(!(0,C.Kv)()||(0,S.DT)()||(0,S.tq)()||!(null==e?void 0:e.enableAutoPip))return;let l=k.s.addCb({event:b.Lw.OnRegister,cb:e=>{let{playerId:l}=e;(0,E.Dx)()&&t(l)}});return()=>{l(),navigator.mediaSession.setActionHandler("enterpictureinpicture",null)}},[])};var D=t("336347"),R=t("948431"),M=t("867961"),F=t("791483"),B=t("623582"),O=t("597087"),V=t("737470"),W=t("594235"),U=t("888163"),H=t("132607"),G=t("607412"),z=t("453498"),Z=t("725887"),K=t("983253"),Q=t("781926"),$=t("852664"),Y=t("623527"),q=t("441447"),J=t("371790"),X=t("792639"),ee=t("797460"),el=t("737271"),et=t("259624"),ei=t("286350"),en=t("245861"),eo=t("401156");let ea=e=>{let{awemeInfoList:l,setAwemeInfoList:t}=e,i=(0,m.useRef)(!1);(0,m.useEffect)(()=>{(0,eo.xg)()&&(null==l?void 0:l.length)&&!i.current&&(t(l.filter(e=>!(0,en.p)(e))),i.current=!0)},[l])};var ed=t("254890"),er=t("798256"),es=t("118687"),eu=t("212623"),ec=t("953342"),ev=t("53659"),em=t("982755"),e_=t("580264"),ef=t("338478"),ep=t("226683"),eh=t("320028"),eg=t("985703"),ey=t("119422"),ew=t("774281"),eI=t("637632"),ex=t("504995"),eb=t("756560"),eE=t("376978"),eT=t("613480"),eC=t("876877"),eS=t("652458");t("544943"),t("179133"),t("826893"),t("819117");var eN=t("302461"),eP=t("63405");let eA=()=>{(0,eN.o)(()=>{if((0,S.DT)()){let e;let l=new URLSearchParams(window.location.search);eP.invoke("isMiniWindowLoading").then(l=>{e=null==l?void 0:l.data}).finally(()=>{"1"===l.get("open_mini_window")&&!1!==e&&setTimeout(()=>{q.emit(q.EVENT.changeMinWindows,{event:"check",isMiniWin:!1,clickMethod:"default",source:"small_window_widget"}),l.delete("open_mini_window"),window.history.pushState({},"",`?${l.toString()}`),Z.Le.setConfig(Z.gI.IsMiniWinFromWidget,!0),setTimeout(()=>{eP.invoke("mainViewMoveTopByBounds")},100)},30)})}},[])};var eL=t("998415"),ek=t("62234"),ej=t("91178"),eD=t("957777"),eR=t("601109");let eM=(0,m.forwardRef)((e,l)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({width:88,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,u.jsx)("rect",{width:88,height:32,rx:16,fill:"#000",fillOpacity:".34"}),(0,u.jsx)("rect",{x:".25",y:".25",width:87.5,height:31.5,rx:15.75,stroke:"#fff",strokeOpacity:".2",strokeWidth:".5"}),(0,u.jsx)("path",{d:"M17.218 10.206h3.766v4.256H19.78v2.31h1.358v.896H19.78v2.506c.476-.168.938-.35 1.358-.532v.91c-1.232.546-2.646 1.05-4.27 1.526l-.28-.91c.196-.056.378-.098.56-.154v-5.082h.826v4.844c.322-.098.63-.196.924-.294v-6.02h-1.68v-4.256zm2.87 3.416v-2.576h-1.974v2.576h1.974zm3.598 2.016V9.576h.952v6.356c-.028 2.968-.826 5.138-2.38 6.51l-.756-.658c1.26-1.092 1.974-2.73 2.142-4.928a8.95 8.95 0 0 1-1.918 1.722l-.532-.896a9.345 9.345 0 0 0 2.492-2.044zm4.662-4.326l.854.406c-.462 1.12-1.008 2.1-1.624 2.926l-.756-.532a11.526 11.526 0 0 0 1.526-2.8zm-1.652 4.956v4.55c0 .28.126.42.406.42h.616c.266 0 .448-.098.546-.266.14-.238.224-.91.28-2.002l.882.28c-.084 1.386-.252 2.226-.504 2.52-.224.252-.56.378-1.022.378h-1.092c-.728 0-1.078-.378-1.078-1.12V9.576h.966v5.67a14.193 14.193 0 0 1 2.59 2.184l-.574.868a14.556 14.556 0 0 0-2.016-2.03zm-4.508-4.564c.476.826.924 1.736 1.344 2.73l-.742.364c-.448-1.008-.91-1.904-1.414-2.702l.812-.392zm9.534-1.946c.952.742 1.75 1.484 2.394 2.212l-.728.742c-.574-.714-1.358-1.484-2.366-2.296l.7-.658zm8.512 12.39c-.798 0-1.666-.014-2.604-.028-.952-.014-1.722-.098-2.296-.252-.588-.168-1.106-.518-1.554-1.022-.196-.238-.392-.35-.574-.35-.336 0-.91.644-1.694 1.96l-.756-.672c.756-1.204 1.414-1.932 2.002-2.184v-4.242h-2.016v-.952h2.982v5.25c.112.084.238.182.364.322.364.392.742.686 1.148.882.448.182 1.12.28 1.988.308.77.014 1.736.028 2.884.028.616 0 1.232-.014 1.876-.014.63-.014 1.12-.028 1.456-.056l-.252 1.022h-2.954zm-.42-1.876h-1.988l-.224-.966c.644.042 1.274.07 1.862.07.392 0 .602-.196.602-.574v-5.95h-5.292v-.994h5.292V9.59h1.022v2.268h2.072v.994h-2.072v6.188c0 .812-.434 1.232-1.274 1.232zM36.3 14.098c.896 1.036 1.582 1.946 2.058 2.73l-.812.56c-.504-.84-1.176-1.764-2.03-2.786l.784-.504zm15.064-4.746c.266.504.518 1.064.77 1.694h5.096v.966H46.856v3.136c-.056 3.066-.532 5.516-1.442 7.364l-.826-.742c.784-1.596 1.204-3.794 1.232-6.622v-4.102h5.208c-.224-.546-.49-1.05-.77-1.498l1.106-.196zm18.242 7.882v5.152h-1.022v-.742H61.5v.742h-1.022v-5.152h9.128zM61.5 20.692h7.084V18.2H61.5v2.492zm-.182-8.19a10.19 10.19 0 0 1-1.694 1.792l-.602-.798c1.26-1.008 2.128-2.254 2.576-3.724l1.008.112a9.11 9.11 0 0 1-.686 1.652h2.744V9.548h1.022v1.988h4.578v.966h-4.578v2.268h5.642v.994H58.672v-.994h5.992v-2.268h-3.346z",fill:"#fff",fillOpacity:".9"})]})));var eF=t("115627"),eB=t("289228"),eO=t("443073");let eV=e=>{let{playNextFunc:l,awemeInfo:t}=e;return(0,u.jsx)("div",{className:eR.default.container,children:(0,u.jsx)("div",{className:eR.default.btn,onClick:()=>{l(),B.logInstance.sendLog("brandAdSkip",{group_id:null==t?void 0:t.awemeId})},children:(0,u.jsx)(eF.Z,{src:eM,width:"88",height:"32",viewBox:"0 0 88 32"})})})},eW=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"SlientPlayPlugin",Slardar:l,children:(0,u.jsx)(eV,(0,d._)({},e))})};t("268917");var eU=t("590682"),eH=t("981182"),eG=t("851161"),ez=t("877639"),eZ=t.n(ez),eK=t("116861"),eQ=t("684767"),e$=t("335101");let eY=e=>{let{brandAdComponentItem:l,openUrl:t,isActive:i,awemeInfo:n,position:o="center"}=e,a=(0,e$.n)();(0,m.useEffect)(()=>{var e;let t=q.listen(q.EVENT.quitInnerFeed,()=>{var e;((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle")}),n=q.listen(q.EVENT.InnerFeedReady,()=>{var e;((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.m)("brandMiddle")});return((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")?(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle"):(0,eb.m)("brandMiddle"),!i&&(0,eb.m)("brandMiddle"),()=>{t(),n(),(0,eb.m)("brandMiddle")}},[l,i]),(0,m.useEffect)(()=>{let e=e=>{var a,d,r,s,u,c,v,m,_,f,p;if((0,eK.j)(e.code,e.keyCode)||(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.nodeName)==="INPUT"||(null==e?void 0:null===(d=e.target)||void 0===d?void 0:d.nodeName)==="TEXTAREA"||(null==e?void 0:null===(r=e.target)||void 0===r?void 0:r.contentEditable)==="true"||!i||!l)return;let h=(null==l?void 0:null===(s=l.brand_ad_component_float_tip)||void 0===s?void 0:s.actions)||[],g=null===(u=k.s.getAllPlayer())||void 0===u?void 0:u.length;h.includes("KEYBOARD")&&1===g&&(q.emit(q.EVENT.videoPause,"useBrandOpenEvent"),B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(v=n.webRawData)||void 0===v?void 0:null===(c=v.brandAd)||void 0===c?void 0:c.brand_type],img_url:null==l?void 0:null===(m=l.brand_ad_component_float_tip)||void 0===m?void 0:m.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener")),h.includes("KEYBOARD_SPACE")&&1===g&&(32===e.keyCode||"Space"===e.code)&&(B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(f=n.webRawData)||void 0===f?void 0:null===(_=f.brandAd)||void 0===_?void 0:_.brand_type],img_url:null==l?void 0:null===(p=l.brand_ad_component_float_tip)||void 0===p?void 0:p.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener"))},d=eZ()(()=>{var e,n;if(!!i&&!!l)((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("WHEEL")&&1===(null===(n=k.s.getAllPlayer())||void 0===n?void 0:n.length)&&(q.emit(q.EVENT.videoPause,"useBrandOpenEvent_wheelHandler"),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener"))},5e3,{trailing:!1});return document.addEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.addEventListener("wheel",d,!0),()=>{document.removeEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.removeEventListener("wheel",d,!0)}},[l,t,i,a,n,o])};var eq=t("902676"),eJ=t("901046"),eX=t("769901");let e0=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p}=e||{},[h,y]=(0,m.useState)(!1),[w,I]=(0,m.useState)(!1),x=(0,m.useRef)(!1);(0,eG.e)({timerCb:e=>{if(x.current)return;let{currentTime:l,isEnd:t}=e,i=p.show_time,n=p.show_time+.5;l>=i&&y(!0),l>=n&&I(!0),t&&!x.current&&(y(!0),I(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let b=eZ()(e=>{var l,t;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null==p?void 0:p.img_url,position:"center",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"splash_ad"});return}q.emit(q.EVENT.videoPause,"MiddleFloatTip_onClick")},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(eq.default.adWrapper,v,{[eq.default.show]:h}),style:{width:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.width,height:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.height},children:(0,u.jsxs)(eJ.a,{onClick:e=>b(e),className:eq.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:[(0,u.jsx)("img",{className:eq.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),y(!1),x.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}}),p.has_guide&&w&&(0,u.jsx)("img",{src:eX,className:eq.default.tapIcon})]})})},e1=e=>{var l,t,i,n;let{awemeInfo:o,className:a,isActive:d,onBrandComponentClose:r,onBrandComponentShow:s}=e||{},[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(!1),[p,h]=(0,m.useState)(),y=(0,m.useRef)([]),w=null==o?void 0:null===(l=o.webRawData)||void 0===l?void 0:l.brandAd;return((0,eG.e)({timerCb:e=>{var l,t;let i=!1;for(let n=0;n<(null===(l=w.biz_content.brand_ad_component_config)||void 0===l?void 0:l.middle.length);n++){let l=null===(t=w.biz_content.brand_ad_component_config)||void 0===t?void 0:t.middle[n];if(void 0===l.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&l.brand_ad_component_type===V.Wy.Img){h(l),i=!0;break}}else if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&e.currentTime<=l.brand_ad_component_float_tip.disappear_time&&l.brand_ad_component_type===V.Wy.Img){h(l),i=!0;break}}!i&&h(null)},stopBySeeking:!1,awemeInfo:o,isActive:d,needInit:!0}),eY({brandAdComponentItem:p,openUrl:w.open_url,isActive:d,awemeInfo:o}),(0,m.useEffect)(()=>{var e,l,t,i,n;p&&!y.current.includes(null==p?void 0:null===(e=p.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==o?void 0:null===(t=o.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"center",icon_type:"image"}),y.current.push(null===(n=p.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[p]),_||c||(null==p?void 0:p.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsx)("div",{className:g()(a,eH.default.container),style:{bottom:`${null!==(n=null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:null===(t=i.position)||void 0===t?void 0:t.bottom)&&void 0!==n?n:96}px`},children:(0,u.jsx)(e0,{awemeInfo:o,isActive:d,onBrandComponentClose:()=>{null==r||r(),f(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==w?void 0:w.brand_type]})},onImgError:()=>{v(!0)},brandAdComponentFloatTip:p.brand_ad_component_float_tip})})};function e2(e){var l,t,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(l=v.webRawData)||void 0===l?void 0:l.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.middle)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(t=i.brand_ad_component_float_tip)||void 0===t?void 0:t.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.middle)||void 0===r?void 0:r.length)>0?(0,u.jsx)(e1,(0,d._)({},e)):null}let e4=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"MiddleFeedBrandAd",Slardar:l,children:(0,u.jsx)(e2,(0,d._)({},e))})};var e3=t("495437"),e5=t("30593"),e6=t("135638"),e8=t("644071"),e7=t("675221"),e9=t("508471"),le=t("770268"),ll=t("213794"),lt=t("957504"),li=t("270547"),ln=t("625617"),lo=t("820510"),la=t("804074"),ld=t("415124"),lr=t("23171"),ls=t("954196"),lu=t("462471"),lc=t("765208"),lv=t("872068"),lm=t("578925"),l_=t("183762"),lf=t("567341"),lp=t("259702"),lh=t("433012"),lg=t("309063"),ly=t("38790"),lw=t("275740"),lI=t("992074"),lx=t("443291"),lb=t("420863"),lE=t("513709"),lT=t("302759"),lC=t("640829"),lS=t("529961"),lN=t("742758"),lP=t("140786");t("413806");var lA=t("162095"),lL=t("594649"),lk=t("490377"),lj=t("99888"),lD=t("860805");let lR=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{let e=(0,em.Rx)(l);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(i=>{!t[i]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:i,adType:V.Z9.Download,logId:null==l?void 0:l.logPb,creativeId:null==e?void 0:e.creative_id}})})},[t,l])};var lM=t("85154"),lF=t("999981"),lB=t("212271"),lO=t("801636");let lV=e=>{let{awemeInfo:l,isActive:t,adData:i,isHide:n=!1}=e||{},{product_name:o,button_background_color:a,ad_title:d,word_image_url:r,image_url:s,button_text:c}=i,v=(0,m.useRef)(0);(0,m.useEffect)(()=>{if(t){var e,i;let t=(0,em.Rx)(l),n=null==t?void 0:null===(i=t.track_url_list)||void 0===i?void 0:null===(e=i.url_list)||void 0===e?void 0:e[0];n&&(0,lj.R)(n)}},[l,t]);let{displayState:_}=(0,lF.I)({awemeInfo:l,isActive:t,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),f=eZ()((e,t)=>{if(_===lB.cL.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(l);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedDownloadAd",cid:null==i?void 0:i.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1});return(0,m.useEffect)(()=>{v.current=0},[l]),(0,m.useEffect)(()=>{let e;if(!!t)return _===lB.cL.NORMAL_LIGHT&&v.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),v.current+=1},1e3)),()=>{clearTimeout(e)}},[t,_]),lR({awemeInfo:l,adData:i}),(0,u.jsx)("div",{className:g()(lM.default.adWrapper,{[lM.default.hasTransition]:!(_===lB.cL.HIDDEN||n),[lM.default.adWrapperHidden]:_===lB.cL.HIDDEN||n}),id:lM.default.adWrapper,children:(0,u.jsxs)("div",{className:lM.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:lM.default.adSource,onClick:e=>f(e,lB.tU.Source),children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:lM.default.adIcon}),(0,u.jsx)("span",{className:lM.default.adName,children:o})]}),_>lB.cL.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,lB.tU.Title),className:lM.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:r,iconHeight:30,iconWidth:30,className:lM.default.moreIcon}),(0,u.jsx)("div",{className:lM.default.split}),(0,u.jsx)("div",{className:lM.default.adTitle,children:d})]}),(0,u.jsx)("div",{className:lM.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>f(e,lB.tU.Button),style:{background:_<=lB.cL.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:a},children:(0,u.jsx)("span",{children:c||"立即下载"})})})]})})};function lW(e){let{awemeInfo:l}=e||{},t=(0,ey.L)(l),i=(0,lk.rQ)(l);return t&&i?(0,u.jsx)(lV,(0,r._)((0,d._)({},e),{adData:i})):null}let lU=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"FeedDownloadAd",Slardar:l,children:(0,u.jsx)(lW,(0,d._)({},e))})};var lH=t("350173");let lG=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{var e;let i=(0,em.Rx)(l);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!t[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:e,adType:V.Z9.Mp,logId:null==l?void 0:l.logPb,creativeId:null==i?void 0:i.creative_id}})});let n=(0,em.BD)(l);(null==n?void 0:null===(e=n.lynx_raw_data)||void 0===e?void 0:e.web_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"web_url",adType:V.Z9.Mp,logId:null==l?void 0:l.logPb,creativeId:null==i?void 0:i.creative_id}})},[t,l])},lz=e=>{let l=(0,m.useRef)(null),{awemeInfo:t,isActive:i,adData:n,isHide:o=!1}=e||{},{product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v}=n,_=(0,m.useRef)(0),f=eZ()((e,l)=>{if(p===lB.cL.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(t);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedMpAd",cid:null==i?void 0:i.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1}),{displayState:p}=(0,lF.I)({awemeInfo:t,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});return(0,m.useEffect)(()=>{_.current=0},[t]),(0,m.useEffect)(()=>{let e;if(!!i)return p===lB.cL.NORMAL_LIGHT&&_.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),_.current+=1},1e3)),()=>{clearTimeout(e)}},[i,p]),lG({awemeInfo:t,adData:n}),(0,u.jsx)("div",{ref:l,className:g()(lH.default.adWrapper,{[lH.default.hasTransition]:!(p===lB.cL.HIDDEN||o),[lH.default.adWrapperHidden]:p===lB.cL.HIDDEN||o}),id:lH.default.adWrapper,children:(0,u.jsxs)("div",{className:lH.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:lH.default.adSource,onClick:e=>f(e,lB.tU.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:lH.default.adIcon}),(0,u.jsx)("span",{className:lH.default.adName,children:a})]}),p>lB.cL.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,lB.tU.Title),className:lH.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:lH.default.moreIcon}),(0,u.jsx)("div",{className:lH.default.split}),(0,u.jsx)("div",{className:lH.default.adTitle,children:r})]}),(0,u.jsx)("div",{className:lH.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>f(e,lB.tU.Button),style:{background:p<=lB.cL.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{children:v||"立即试玩"})})})]})})};function lZ(e){let{awemeInfo:l}=e||{},t=(0,ew.u)(l),i=(0,lk.rQ)(l);return t&&i?(0,u.jsx)(lz,(0,r._)((0,d._)({},e),{adData:i})):null}let lK=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"FeedMpAd",Slardar:l,children:(0,u.jsx)(lZ,(0,d._)({},e))})};var lQ=t("57196"),l$=t("734415"),lY=t("827053"),lq=t("455344"),lJ=t("579272"),lX=t("198178"),l0=t("444493"),l1=t("135058"),l2=t("238430"),l4=t("128439"),l3=t("99459"),l5=t("67120"),l6=t("535874"),l8=t("200600"),l7=t("708334"),l9=t("63260"),te=t("351087"),tl=t("177592"),tt=t("193463"),ti=t("522728"),tn=t("783983"),to=t("731851"),ta=t("866402"),td=t("846455"),tr=t("505725"),ts=t("357083"),tu=t("492368");t("838368"),t("368529");var tc=t("148091"),tv=t("549909"),tm=t("837997");t("275377");var t_=t("36727"),tf=t("544994"),tp=t("805796"),th=t("751403"),tg=t("914592"),ty=t("52678"),tw=t("929767"),tI=t("378056"),tx=t("338426"),tb=t("207761"),tE=t("734123");let tT="RECOMMAND_LOGIN_PROMPT_TIMESTAMP",tC=new Date().toDateString(),tS=0,tN=0,tP=0,tA=()=>{var e,l;return(null===(l=window)||void 0===l?void 0:null===(e=l.localStorage)||void 0===e?void 0:e.getItem(tT))===tC||!1},tL=async()=>{try{n=!0}catch(e){}},tk=async(e,l)=>{if(tA())return()=>null;if(void 0===n&&await tL(),tA())return()=>null;clearInterval(i);let t=()=>{e.pause()};if(tN>42e4){var o,a;l(),null===(a=window)||void 0===a||null===(o=a.localStorage)||void 0===o||o.setItem(tT,tC),clearInterval(i)}let d=()=>{tS=Date.now()},r=()=>{tS=0};return e.on(tE.Events.PLAY,d),e.on(tE.Events.PAUSE,r),i=setInterval(()=>{tS>0&&(tN+=1e3)>42e4&&clearInterval(i)},1e3),()=>{e&&(e.off(tE.Events.PLAY,d),e.off(tE.Events.PAUSE,r),e.off(tE.Events.CANPLAY,t)),tS=0,clearInterval(i)}},tj=async(e,l)=>{if(tA())return()=>null;if(void 0===n&&await tL(),tA())return()=>null;let t=()=>{e.pause()};if(++tP>15){var i,o;l(),null===(o=window)||void 0===o||null===(i=o.localStorage)||void 0===i||i.setItem(tT,tC)}return()=>{e&&e.off(tE.Events.CANPLAY,t)}};var tD=t("582296");let tR=(0,tx.ZP)(()=>t.e("30868").then(t.bind(t,950300)),{ssr:!1}),tM=e=>{var l;let{userInfo:t,isActive:i,dispatch:n,abtestData:o}=e,{isLogin:a}=t,d=(0,e$.n)(),[r,s]=(0,m.useState)(),[c,v]=(0,m.useState)(!1);(0,m.useEffect)(()=>{!i&&s(!1)},[i]);let _=(0,m.useCallback)(()=>{s(!1),d&&d.play()},[d]),f=(0,m.useCallback)(e=>{let{enterMethod:l="video_login_guide",isVideoGuide:t="0"}=e;(0,tD.default)({success:()=>{n({type:"updateUserInfo"})},enterMethod:l,teaEvtParams:{is_video_guide:t}})},[n,o]),p=(null===(l=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===l?void 0:l.isInMiniModal)||!1;return(0,m.useEffect)(()=>{if(d&&i&&!1===a&&!p){let e=()=>null,l=()=>null;return(async()=>{e=await tk(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})}),l=await tj(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})})})(),()=>{null==e||e(),null==l||l()}}},[d,i,a]),(0,m.useEffect)(()=>{(async()=>{v(await (0,tb.isHideLoginGuide)(o))})()},[o]),!p&&!1===a&&i&&r&&!c?(0,u.jsx)(tR,{handleHideMask:_,handleLoginAfter:e=>f(e)}):null},tF=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"RecommendLoginGuide",Slardar:l,children:(0,u.jsx)(tM,(0,d._)({},e))})};var tB=t("910443"),tO=t("220922"),tV=t("260224"),tW=t("466428"),tU=t("926116"),tH=t("502449"),tG=t("827914"),tz=t("680319"),tZ=t("79139"),tK=t("119715"),tQ=t("815242"),t$=t("801517"),tY=t("85517"),tq=t("656600"),tJ=t("847191"),tX=t("987475");let t0=e=>{let{isInnerFeed:l,awemeId:t,isActive:i}=e,[n,o]=(0,m.useState)(!1),a=(0,m.useRef)(),d=(0,m.useRef)(!1),r=(0,m.useRef)("");return(0,eN.o)(()=>{if(tq.f.isOfflineClientResizeGuide())return;let e=q.listen(q.EVENT.changeMinWindows,e=>{var n;let{isMiniWin:a,source:s}=e;if((null===(n=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===n?!void 0:!n.isInMiniModal)||!!l)i&&!a&&"resize"===s&&!(0,tJ.$o)(tX.LocalStorageKeys.ResizeGuideTimes)&&(o(!0),d.current=l,r.current=t,(0,tJ.qQ)(tX.LocalStorageKeys.ResizeGuideTimes,1))});return()=>null==e?void 0:e()},[i,l,t]),(0,m.useEffect)(()=>{n&&(!i||r.current!==t||l!==d.current)&&o(!1)},[n,i,t,l]),(0,m.useEffect)(()=>{n&&(a.current=setTimeout(()=>{o(!1)},5e3))},[n]),n};var t1=t("757118"),t2=t("382299");let t4=e=>{let{log:l,isFromLynx:t,onCloseLynx:i,getLynxInfo:n}=(0,t2.H)();l("usePlayByLynx",e);let{isActive:o,player:a}=e||{},[d,r]=(0,m.useState)(t()),s=(0,m.useRef)(!1),u=(0,m.useRef)(!1),c=o&&(d||void 0===d&&t()),v=(0,m.useRef)(0),_=()=>{if(l("usePlayByLynx onSeek",u.current,null==a?void 0:a.currentTime,v.current),!u.current){var e,t,i,o;u.current=!0;let l=n();(null==l?void 0:null===(e=l.progressBarInfo)||void 0===e?void 0:e.timeCurrent)&&(!(null==a?void 0:a.currentTime)||(null==a?void 0:a.currentTime)<=v.current+5)&&(null==a||null===(i=a.seek)||void 0===i||i.call(a,(null==l?void 0:null===(t=l.progressBarInfo)||void 0===t?void 0:t.timeCurrent)/1e3+(((null==a?void 0:a.currentTime)||0)-v.current),(null==l?void 0:l.isPlay)?"play":"pause"),(null==l?void 0:l.isPlay)||null==a||null===(o=a.pause)||void 0===o||o.call(a))}p("onSeek")},f=e=>{var t,i,o;l("usePlayByLynx onVolumeChange",e);let d=n();if((null==d?void 0:d.isMute)===void 0||(null==a?void 0:a.muted)!==(null==d?void 0:d.isMute)||(null==a?void 0:a.volume)!==(null==d?void 0:d.volume)){if(null==d?void 0:null===(t=d.progressBarInfo)||void 0===t?void 0:t.timeCurrent){u.current=!0,l("usePlayByLynx onVolumeChange seek");let e=(null==d?void 0:null===(i=d.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,t=!!(null==d?void 0:d.isPlay);null==a||null===(o=a.seek)||void 0===o||o.call(a,e,t?"play":"pause")}p("onVolumeChange")}},p=e=>{l("usePlayByLynx closeLynxWindow",e),r(!1),i("closeLynxWindow")},h=()=>{l("usePlayByLynx onPlay",s.current),setTimeout(()=>{var e,i,o,d,r;if(t()&&s.current){let t=n();(null==t?void 0:null===(e=t.progressBarInfo)||void 0===e?void 0:e.timeCurrent)&&(u.current=!0,l("usePlayByLynx onPlay seek"),null==a||null===(o=a.seek)||void 0===o||o.call(a,(null==t?void 0:null===(i=t.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,"pause"),null==a||null===(d=a.pause)||void 0===d||d.call(a)),p("onPlay");return}t()&&(l("usePlayByLynx onPlay pause"),null==a||null===(r=a.pause)||void 0===r||r.call(a),v.current=(null==a?void 0:a.currentTime)||0)},100)},g=e=>{var t,i,o;l("usePlayByLynx onShowDouyinWindow",e);let d=n();if(null==d?void 0:null===(t=d.progressBarInfo)||void 0===t?void 0:t.timeCurrent){u.current=!0,l("onShowDouyinWindow seek",e);let t=(null==d?void 0:null===(i=d.progressBarInfo)||void 0===i?void 0:i.timeCurrent)/1e3,n=!!(null==d?void 0:d.isPlay);null==a||null===(o=a.seek)||void 0===o||o.call(a,t,n?"play":"pause")}p("onShowDouyinWindow"+e)},y=e=>{l("usePlayByLynx setCanPlay"),(null==e?void 0:e.action)==="switch_play_pause"&&(s.current=!0),(null==e?void 0:e.action)==="dislike"&&g("dislike")};(0,m.useEffect)(()=>{l("usePlayByLynx LynxPlayReady",o,a,c),o&&a&&c&&t()&&(l("usePlayByLynx LynxPlayReady2"),q.emit(q.EVENT.LynxPlayReady,{isReady:!0,player:a}),a.pause(),a.on("user_action",y),a.on("play",h),a.on("seeking",_),a.on("volumechange",f));let e=q.listen(q.EVENT.closeLynxWindow,()=>{r(!1)});return()=>{null==a||a.off("user_action",y),null==a||a.off("play",h),null==a||a.off("seeking",_),null==a||a.off("volumechange",f),null==e||e()}},[o,a,c,t])};var t3=t("656482"),t5=t("316914"),t6=t("645227"),t8=t("565603"),t7=t("766621");let t9=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p,onBrandComponentShow:h}=e||{},[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(!1),b=(0,m.useRef)(!1);(0,eG.e)({timerCb:e=>{if(b.current)return;let{currentTime:l,isEnd:t}=e,i=p.show_time,n=p.show_time+.5;l>=i&&(w(!0),null==h||h()),l>=n&&x(!0),t&&!b.current&&(w(!0),null==h||h(),x(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let E=eZ()(e=>{var l,t;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null==p?void 0:p.img_url,position:"bottom",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}q.emit(q.EVENT.videoPause,"BottomFloatTip_onClick")},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(t7.default.adWrapper,v,{[t7.default.show]:y}),style:{width:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.width,height:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.height},children:(0,u.jsx)(eJ.a,{onClick:e=>E(e),className:t7.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:(0,u.jsx)("img",{className:t7.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),w(!1),b.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}})})})},ie=(0,m.forwardRef)((e,l)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({width:46,height:23,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,u.jsx)("path",{d:"M0 4a4 4 0 0 1 4-4h38a4 4 0 0 1 4 4v15a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4z",fill:"#000",fillOpacity:".3"}),(0,u.jsx)("path",{opacity:".7",d:"M13.487 7.68c.19.36.37.76.55 1.21h3.64v.69h-7.41v2.24c-.04 2.19-.38 3.94-1.03 5.26l-.59-.53c.56-1.14.86-2.71.88-4.73V8.89h3.72c-.16-.39-.35-.75-.55-1.07l.79-.14zm13.532 5.63v3.68h-.73v-.53h-5.06v.53h-.73v-3.68h6.52zm-5.79 2.47h5.06V14h-5.06v1.78zm-.13-5.85c-.34.46-.74.89-1.21 1.28l-.43-.57c.9-.72 1.52-1.61 1.84-2.66l.72.08c-.13.42-.29.81-.49 1.18h1.96V7.82h.73v1.42h3.27v.69h-3.27v1.62h4.03v.71h-9.04v-.71h4.28V9.93h-2.39zM31.455 14.434a.78.78 0 0 0 1.103 1.104l2.434-2.435 2.435 2.434a.78.78 0 0 0 1.103-1.103L36.095 12l2.435-2.434a.78.78 0 0 0-1.103-1.103l-2.435 2.434-2.434-2.434a.78.78 0 1 0-1.103 1.103L33.889 12l-2.434 2.434z",fill:"#fff"})]}))),il=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,className:c,isActive:v,onBrandComponentClose:_,onBrandComponentShow:f}=e||{},[p,h]=(0,m.useState)(!1),[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(),b=(0,m.useRef)([]),E=null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:l.brandAd;return((0,eG.e)({timerCb:e=>{var l,t;let i=!1;for(let n=0;n<(null===(l=E.biz_content.brand_ad_component_config)||void 0===l?void 0:l.bottom.length);n++){let l=null===(t=E.biz_content.brand_ad_component_config)||void 0===t?void 0:t.bottom[n];if(void 0===l.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&l.brand_ad_component_type===V.Wy.Img){x(l),i=!0;break}}else if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&e.currentTime<=l.brand_ad_component_float_tip.disappear_time&&l.brand_ad_component_type===V.Wy.Img){x(l),i=!0;break}}!i&&(x(null),null==_||_())},stopBySeeking:!1,awemeInfo:s,isActive:v,needInit:!0}),eY({brandAdComponentItem:I,openUrl:E.open_url,isActive:v,awemeInfo:s,position:"bottom"}),(0,m.useEffect)(()=>{var e,l,t,i,n;I&&!b.current.includes(null==I?void 0:null===(e=I.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"bottom",icon_type:"image"}),b.current.push(null===(n=I.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[I]),y||p||(null==I?void 0:I.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsxs)("div",{className:"xgplayer-bottom-brand-ad",children:[(0,u.jsx)(eF.Z,{onClick:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},width:"46",height:"23",viewBox:"0 0 46 23",src:ie,className:t8.default.close,style:{bottom:`${null==I?void 0:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:null===(t=i.close_btn_position)||void 0===t?void 0:t.bottom}px`,right:`${null==I?void 0:null===(o=I.brand_ad_component_float_tip)||void 0===o?void 0:null===(n=o.close_btn_position)||void 0===n?void 0:n.right}px`}}),(0,u.jsx)("div",{className:g()(c,t8.default.container),style:{bottom:null!==(r=null===(d=I.brand_ad_component_float_tip)||void 0===d?void 0:null===(a=d.position)||void 0===a?void 0:a.bottom)&&void 0!==r?r:0},children:(0,u.jsx)(t9,{awemeInfo:s,isActive:v,onBrandComponentClose:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},onBrandComponentShow:f,onImgError:()=>{h(!0)},brandAdComponentFloatTip:I.brand_ad_component_float_tip})})]})};function it(e){var l,t,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(l=v.webRawData)||void 0===l?void 0:l.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.bottom)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(t=i.brand_ad_component_float_tip)||void 0===t?void 0:t.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.bottom)||void 0===r?void 0:r.length)>0?(0,u.jsx)(il,(0,d._)({},e)):null}let ii=e=>{let l=(0,eO.N)();return(0,u.jsx)(eB.k,{componentName:"BottomFeedBrandAd",Slardar:l,children:(0,u.jsx)(it,(0,d._)({},e))})};var io=t("816242"),ia=t("427477"),id=t("954270"),ir=t("930193"),is=t("457309"),iu=t("487330"),ic=t("314331");let iv=(0,m.memo)((0,m.forwardRef)((e,l)=>{var t,i,n,o,a,r,s,c,v,_,f,p,h,y,I,E,T,C,N,P,A,L,j,D,R,F,B;let{isActive:O,isNext:W,isPrev:U,isFirst:H,isLast:z,index:K,awemeInfo:Q,nextAwemeInfo:Y,prevAwemeInfo:q,playNextFunc:J,abtestData:X,deleteCurrentSwiper:ee,toggleComment:el,onAvatarClick:et,fullScreenTarget:ei,logParams:eo,videoToast:ea,followHandler:ed,playPrevFunc:er,userInfo:es,dispatch:eu,isShowCssFullScreenGuide:ec,isAuthorCardShow:eN,isShowRelatedCard:eP,children:eR,videoHashtagClassName:eM,isShowGuide:eF,videoTags:eB,showPlaySwitch:eO=!0,moreBoxShowList:eV={notInterestingIcon:!0,unfollow:!0,report:!0},shortCutFiltered:eU,positionBoxClassName:eH,actionFollow:eG,actionUnFollow:ez,isInnerFeed:eZ,isOuterFeedSplash:eK,onRelatedClick:eQ,onCooperationAuthorClick:e$,isShowCooperation:eY,isAdShortCut:eq=!0,onShopAnchorClick:eJ=()=>{},onActivityCardClick:eX,onDouPlusClick:e0,onSodaClick:e1,onShopAnchorMouseEnter:e2=()=>{},onShopAnchorMouseLeave:lA=()=>{},isShowAdCard:lL=!1,sideBarShow:lk,slardarInstance:lj,defaultIsPageFullScreen:lD,avatarTipText:lR,LiveSliderCard:lM,onDislike:lF,disableShortCut:lB,isDislike:lO,isShowShopSideCard:lV,splashAdStatus:lW,changeSplashAdStatus:lH,onReady:lG,hasPlaceholder:lz=!0,disableFullScreenSearchBar:lZ=!1,isVideoSupportMP4:tx,useNewUserSoundGuide:tb,isMultiInstanceScene:tE=!1,chapterProps:tT,setContainerPlayer:tC,recommendTagProps:tS,canShowListenVideo:tN=!1,listenFeedNextAwemeInfo:tP,listenFeedPrevAwemeInfo:tA,aiNoteProps:tL,isShowAiCard:tk,sideCardContext:tj,isFirstLive:tD}=e,{isiPad:tR,isMobile:tM}=(0,M.X)(),{isMainland:tq,isWebMiniWin:tJ,pipWindow:tX,isListenVideoMiniWin:t8,fullScreenQuestionVars:{isShowingQuestion:t7}={isShowingQuestion:!1}}=(0,iu.Iq)(e=>{let{isMainland:l,isWebMiniWin:t,pipWindow:i,isListenVideoMiniWin:n,fullScreenQuestionVars:o}=e;return{isMainland:l,isWebMiniWin:t,pipWindow:i,isListenVideoMiniWin:n,fullScreenQuestionVars:o}}),{isFromLynx:t9}=(0,t2.H)(),[ie,il]=(0,m.useState)(!1),{isClientMiniWin:it,isCssFullScreen:iv,isFullScreen:im,setIsSideBarShowFunc:i_,setSlideVideoTab:ip}=(0,m.useContext)(eT.C),ih=(0,m.useRef)(null),{hasChapterBar:ig}=(0,l0.W)(X,Q,null===(t=ih.current)||void 0===t?void 0:t.player),[iy,iw]=(0,m.useState)(!1),iI=(0,S.DT)(),ix=(0,eI.x)(),ib=t0({isInnerFeed:eZ,awemeId:null==Q?void 0:Q.awemeId,isActive:O}),iE=(0,m.useCallback)(()=>iw(!0),[]),iT=(0,m.useCallback)(()=>iw(!1),[]);(0,m.useEffect)(()=>{eZ&&iw(!1)},[eZ]);let iC=(0,m.useMemo)(()=>tJ||it||t8,[tJ,it,t8]),{enablePip:iS}=(0,l5.$)({abtestData:X,awemeInfo:Q});(0,m.useEffect)(()=>{var e,l,t,i;let n=null===(e=ih.current)||void 0===e?void 0:e.player;if(O&&(null==n?void 0:n.isQuickPlayer)){if(iS){let e=null==n?void 0:null===(l=n.root)||void 0===l?void 0:l.querySelector(".xgplayer-pip .xg-tips");e&&(e.innerHTML=`小窗模式${ev.SHORTCUT_KEY.pip.badgeText?`<span class="shortcutKey">${ev.SHORTCUT_KEY.pip.badgeText}</span>`:""}`)}else null==n||null===(i=n.root)||void 0===i||null===(t=i.querySelector(".xgplayer-pip"))||void 0===t||t.setAttribute("style","display: none !important")}},[null===(i=ih.current)||void 0===i?void 0:i.player,iS,O]);let{isShow:iN}=(0,l6.BJ)({useIdleCallback:!(0,$.b_)(),isActive:O,timeout:5e3,delay:(0,$.b_)()&&!t9()?1e3:0,once:!0,immediately:!(0,$.b_)()||(0,l1.GP)(Q)||t9()});(0,l8.j)({player:null==ih?void 0:null===(n=ih.current)||void 0===n?void 0:n.player,isActive:O,abValue:X}),(0,tZ.g)({player:null==ih?void 0:null===(o=ih.current)||void 0===o?void 0:o.player,awemeInfo:Q}),(0,t$.G)({player:null==ih?void 0:null===(a=ih.current)||void 0===a?void 0:a.player,awemeInfo:Q,scene:"pc_web",abtestData:X}),(0,m.useImperativeHandle)(l,()=>{var e;return{getPlayer:()=>ih.current.getPlayer(),player:null===(e=ih.current)||void 0===e?void 0:e.player}}),(0,l7.V)({awemeInfo:Q}),(0,l9.D)({awemeInfo:Q,isActive:O}),(0,m.useEffect)(()=>{O&&!eZ&&Z.Le.setConfig(Z.gI.InnerAutoPlay,null)},[O,eZ,Q]);let iP=(0,m.useMemo)(()=>{let e=(0,tQ.i)({abtestData:X,awemeInfo:Q,isInnerFeed:eZ,isMultiInstanceScene:tE});return e.startTime=(0,ej.v)(Q.awemeId),e.pip&&(e.pip.showIcon=iS),e},[Q,X,iS]);(0,te.O)({player:null===(r=ih.current)||void 0===r?void 0:r.player,isActive:O,awemeInfo:Q,abtestData:X,isWebMiniWin:tJ}),(0,tl.w)({player:null===(s=ih.current)||void 0===s?void 0:s.player,isActive:O,awemeInfo:Q,abtestData:X,isInnerFeed:eZ}),(0,tt.K)({abtestData:X,isActive:O,player:null===(c=ih.current)||void 0===c?void 0:c.player});let iA=(0,ex.D)(Q),{noPaidVideo:iL}=(0,ti.B)({awemeInfo:Q});(0,t6.u)({awemeInfo:Q,player:null===(v=ih.current)||void 0===v?void 0:v.player});let{isDanmuIcon:ik,hideList:ij,isChapterIcon:iD,chapterMaxWidth:iR,isAiNoteIcon:iM}=(0,tn.Cy)({isActive:O,abtestData:X,player:null===(_=ih.current)||void 0===_?void 0:_.player,hasChapter:ig,hasAiNote:null==tL?void 0:tL.useable,isMiniWin:iC,showAutoPlay:!iL,showInnerAutoplay:eZ&&!iL,showSubtitles:!!(null==Q?void 0:Q.claInfo),showFakeScreen:(null==Q?void 0:Q.awemeType)!==x.e.Note,showPlayBackRatio:(null==Q?void 0:Q.awemeType)!==x.e.Note,showWatchLater:iA,isClientMiniWin:it}),iF=(0,m.useMemo)(()=>{var e;return[...(null==eV?void 0:eV.notInterestingIcon)?[]:[null===(e=ev.getShortcut().dislike)||void 0===e?void 0:e.badgeText],...eU||[]]},[null==eV?void 0:eV.notInterestingIcon,eU]),iB=(0,m.useMemo)(()=>(0,em.Jt)(Q),[Q]),iO=(0,m.useMemo)(()=>(0,em.gc)(Q),[Q]),iV=(0,m.useMemo)(()=>(0,en.p)(Q),[Q]),iW=lW===V.QB.Normal||!iV;(0,m.useEffect)(()=>{var e,l,t,i,n,o,a,d,r,s;if(!!H&&!!iV)return lW===V.QB.Fullscreen?((0,eb.o)({pauseCustomShortcut:!0,pausePlayControlShortcut:!0},"splashAd"),tm.DJ.pause(["close","help"]),(null===(e=ih.current)||void 0===e?void 0:e.player)&&(null===(n=ih.current)||void 0===n||null===(i=n.player)||void 0===i||null===(t=i.controls)||void 0===t||null===(l=t.hide)||void 0===l||l.call(t))):((null===(o=ih.current)||void 0===o?void 0:o.player)&&(null===(s=ih.current)||void 0===s||null===(r=s.player)||void 0===r||null===(d=r.controls)||void 0===d||null===(a=d.show)||void 0===a||a.call(d)),tm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")),()=>{tm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")}},[lW]),(0,to._)({awemeInfo:Q,prevAwemeInfo:q,isInnerFeedModel:eZ&&O});let{idlCallBackFlag:iU}=(0,ta.o)({isActive:W,once:!0}),{flag:iH}=(0,td.z)({isNext:W,positionIndex:K,abtestData:X}),iG=(0,m.useRef)(!1),iz=(0,m.useMemo)(()=>{var e;let l=null===(e=k.s.getAllPlayer())||void 0===e?void 0:e.length;return!!iG.current||(eE.H.revertRecommendCreateNextVideo(X)?O||U||W:1===K&&(!!(l>1)||!!iH)||O||U||W&&iU&&1!==K)},[O,U,W,K,iU,iH]);iG.current=iz;let{isShowGuideDownload:iZ}=(0,tr.m)({abtestData:X,awemeInfo:Q,isActive:O,isLogin:null==es?void 0:es.isLogin,player:null===(f=ih.current)||void 0===f?void 0:f.player});(0,m.useEffect)(()=>{2===K&&Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!1})},[K]);(0,ts.Q)({player:null===(p=ih.current)||void 0===p?void 0:p.player,isActive:O,abtestData:X,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:iB&&(0,em.Gu)(Q)&&eq?[]:["showAdDetail"],awemeInfo:Q,showAdMenu:iB&&(0,em.Gu)(Q),disableShortCut:lB||!tx||t7,disableAllNativeShortCut:lB||!tx||t7,isClientMiniWin:it,pipWindow:tX,isLogin:null==es?void 0:es.isLogin}),(0,tv.b)({isActive:O,player:null===(h=ih.current)||void 0===h?void 0:h.player}),(0,w.C)(eC.w3.components.recommend_video),(0,l2.P)({player:null===(y=ih.current)||void 0===y?void 0:y.player}),eA();let{isOnByOuter:iK}=(0,tu.U)({playerReady:ie,config:iP,isActive:O,awemeInfo:Q,player:null===(I=ih.current)||void 0===I?void 0:I.player,setIsSideBarShowFunc:i_,setSlideVideoTab:ip}),iQ={scene:b.lT.Recommend,awemeInfo:Q,abtestData:X,userInfo:es,isMiniWin:iC,isActive:O,isInnerFeed:eZ,player:null==ih?void 0:null===(E=ih.current)||void 0===E?void 0:E.player,fullScreenTarget:ei},{anchorList:i$,hasJingxuanActivity:iY}=(0,ir.e)({abtestData:X,awemeInfo:Q}),iq=(0,io.$)({abTestData:X,awemeInfo:Q})&&!iY;(0,m.useEffect)(()=>{if(O&&!eZ&&ie){var e;return(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"show"),()=>{var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"leave")}}},[O,Q,eZ,ie,X]),t4({player:null==ih?void 0:null===(T=ih.current)||void 0===T?void 0:T.player,isActive:O}),(0,t5.M)({awemeInfo:Q,player:null==ih?void 0:null===(C=ih.current)||void 0===C?void 0:C.player,noPaidVideo:iL,isInnerFeed:eZ});let{listenVideoDisablePrev:iJ,listenVideoDisableNext:iX}=(0,tK.T)({isAuthorCardShow:eN,isFirst:H,isLast:z,isShowRelatedCard:eP,canUseListenFeed:!0,listenFeedPrevAwemeInfo:tA,listenFeedNextAwemeInfo:tP,prevAwemeInfo:q,nextAwemeInfo:Y,isInnerFeed:eZ,isActive:O}),i0=(null==X?void 0:X.reuseVideo)&&!((null==X?void 0:null===(N=X.recommendQuickStartV1)||void 0===N?void 0:N.val)&&0===K&&!tD||iV||eK),i1=i0?ek.Y:eL.f;return(0,ic.O)({abtestData:X,player:null==ih?void 0:null===(P=ih.current)||void 0===P?void 0:P.player,awemeInfo:Q,isActive:O}),(0,u.jsxs)(u.Fragment,{children:[!lZ&&(iv||im)&&O&&!iC&&(0,u.jsx)(lX.default,(0,d._)({},iQ)),(0,u.jsxs)(i1,{xgplayerConfig:iP,isInitPlayer:iz,style:(0,d._)({height:"100%",width:"100%"},t8?{display:"none"}:{}),className:g()(eS.default.container,"chapterPlayerStyle","MediaNotSupportStyle","lowPopup"),ref:ih,slardarInstance:lj,onReady:e=>{var l,t,i;null==lG||lG(),il(!0),(null===(l=(0,G.bE)("player_ready"))||void 0===l?void 0:l.length)<1&&(0,G.B1)({tag:"player_ready"}),e&&(e.canCheckNotUse=!0),iV&&H&&!eZ&&lW!==V.QB.Normal&&(null==e||null===(i=e.controls)||void 0===i||null===(t=i.hide)||void 0===t||t.call(i))},awemeInfo:Q,scene:b.lT.Recommend,setContainerPlayer:tC,abtestData:X,children:[(0,u.jsx)(tc.V,{awemeInfo:Q,isActive:O,timeout:(0,$.b_)()?4e3:2e3,isFirst:H}),(0,u.jsx)(eD.p,{isActive:O,onRegisterSuccess:()=>{O&&(0,l4.g)(ih.current.player)},scene:b.lT.Recommend}),(0,u.jsx)(ej.t,{awemeInfo:Q,player:null===(A=ih.current)||void 0===A?void 0:A.player,isActive:O}),!iC&&iV&&H&&lW===V.QB.Fullscreen&&(0,u.jsx)(eW,{awemeInfo:Q,playNextFunc:()=>{null==lH||lH(V.QB.Normal),J()}}),!iC&&iV&&H&&!eZ&&(0,u.jsx)(e4,{isActive:O,awemeInfo:Q,onBrandComponentShow:()=>{},onBrandComponentClose:()=>{}}),!iC&&(0,em.Kf)(Q)&&!eZ&&(0,u.jsx)(ii,{isActive:O,awemeInfo:Q,onBrandComponentShow:()=>{iw(!0)},onBrandComponentClose:()=>{iw(!1)}}),!tx&&(0,u.jsx)(tG.X,{awemeId:null==Q?void 0:Q.awemeId}),iW&&(0,u.jsx)("div",{className:g()(eS.default.splashAdComponent,{[eS.default.enterTransition]:iV&&!eZ}),children:(0,u.jsxs)(e3.n,{isActive:O,controlHeight:b.fp.MidHigh,isMiniWin:iC,position:"right",awemeInfo:Q,className:eH,abtestData:X,from:b.lT.Recommend,children:[eO&&!it&&iN||tJ?(0,u.jsx)(e5.I,{playPrevFunc:er,playNextFunc:J,disablePrev:H&&!(eN||eP)||(eN||eP)&&!q,disableNext:z&&!(eN||eP)||(eN||eP)&&!Y,className:g()(eS.default.playSwitchContainer,e6.m4,"filter-bg",{[eS.default.isWebMiniWinSwitch]:tJ})}):null,!it&&iN&&tx&&(0,u.jsx)(e8.InteractionNew,{canShowListenVideo:tN,playPrevFunc:er,playNextFunc:J,listenFeedPrevAwemeInfo:tA,listenFeedNextAwemeInfo:tP,prevAwemeInfo:q,nextAwemeInfo:Y,isAuthorCardShow:eN,isShowRelatedCard:eP,isFirst:H,isLast:z,canUseListenFeed:!0,actionFollow:eG,actionUnFollow:ez,awemeInfo:Q,toggleComment:e=>{if(!eZ){var l;(0,Z.xL)(Q,null==ih?void 0:null===(l=ih.current)||void 0===l?void 0:l.player,"clickComment")}return null==el?void 0:el(e)},loginUserInfo:es,loginDispatch:eu,deleteCurrentSwiper:ee,fullScreenTarget:ei,onAvatarClick:(e,l)=>{if(!eZ){var t;(0,Z.xL)(Q,null==ih?void 0:null===(t=ih.current)||void 0===t?void 0:t.player,"head")}return null==et?void 0:et(e,l)},onFollowBtnClick:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"follow")}},onShareToFriend:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"share")}},onDouPlusClick:e0,abtestData:X,videoToast:ea,isActive:O,followHandler:ed,reportExtraParams:eo,recordPreferVideoSwitch:!eZ,canShowAvatarFollowBtn:!iO,canShowAvatarAdBtn:iO,canShowAvatarTip:!(iB&&(0,em.Gu)(Q)),canShowDislikeTip:!0,moreBoxShowList:(0,d._)({shortcutList:!0},eV),className:e6.m4,avatarTipText:lR,showMusicDetail:!(iB&&(0,em.Gu)(Q)),from:b.lT.Recommend,LiveSliderCard:lM,onRelatedClick:eQ,videoTags:eB,onDislike:lF,isInnerFeed:eZ,scene:"aweme_video_feed_pc",isShowAiCard:tk,recommendTriggered:null==tS?void 0:tS.recommended,showRecommendToFriend:!!tS})]})}),lz&&!iV?(0,u.jsx)(e7._,{awemeInfo:Q,isActive:O,controlHeight:iV?b.fp.SplashControls:b.fp.MidHigh,abtestData:X}):null,(null==Q?void 0:null===(L=Q.chargeInfo)||void 0===L?void 0:L.is_charge_content)&&(0,u.jsx)(e9.V,{awemeInfo:Q,isActive:O,isMiniWin:iC,isShowReplay:!iC}),(null==Q?void 0:null===(j=Q.video)||void 0===j?void 0:j.duration)>18e4&&(0,u.jsx)(le.S,{awemeInfo:Q,isActive:O,isLogin:null==es?void 0:es.isLogin,isMiniWin:iC}),(0,u.jsx)(ll.V,{awemeInfo:Q,isActive:O}),(0,u.jsx)(lt.h,{awemeInfo:Q,isActive:O,isUseOneCheck:eZ,playPrevFunc:er,playNextFunc:J,deleteCurrentSwiper:ee}),eZ||!iN||iL?null:(0,u.jsx)(li.kL,{isActive:O,awemeInfo:Q,playNextFunc:J,ablePlayNext:!(z&&!(eN||eP)||(eN||eP)&&!Y),shortcutDisabled:tR||tM,scene:b.lT.Recommend}),eZ&&iN?(0,u.jsx)(ln.Ot,{isActive:O,awemeInfo:Q,playPrevFunc:er,playNextFunc:J,ablePlayPrev:!((eN||eP)&&!q),ablePlayNext:!((eN||eP)&&!Y),hide:ij.some(e=>e[0]===tn.p7.InnerAutoPlayer),abtestData:X,isWebMiniWin:tJ}):null,iN&&!iL?(0,u.jsx)(e6.SD,{isOnByOuter:iK,isActive:O,awemeInfo:Q,abtestData:X,isInnerFeed:eZ,isOutFeed:!eZ,hide:ij.some(e=>e[0]===tn.p7.Clear)}):null,iN?(0,u.jsx)(th.SE,{isActive:O,awemeInfo:Q,abtestData:X}):null,iN&&iA&&!tJ?(0,u.jsx)(lo.vq,{isActive:O,awemeInfo:Q,abtest:X,isLogin:null==es?void 0:es.isLogin,loginDispatch:eu,toast:ea,logParams:eo}):null,iS&&(0,u.jsx)(la._,{isActive:O,awemeInfo:Q,abtestData:X,isReusePlayer:i0}),(0,u.jsx)(ld.F,{isActive:O,awemeInfo:Q,isLogin:null==es?void 0:es.isLogin,loginDispatch:eu,abtestData:X,from:b.lT.Recommend,logParams:eo,isMiniWin:iC}),iI&&(0,u.jsx)(lr.zm,{isActive:O,awemeInfo:Q,isInnerFeed:eZ,resizeMiniWindowGuideShow:ib,abtestData:X}),iN&&(0,u.jsx)(ls.k,{isActive:O,onVolumeShortCutChange:()=>{var e;(0,l3.t)(null===(e=ih.current)||void 0===e?void 0:e.player)}}),(0,u.jsx)(lu.g,{isActive:O,abtestData:X,awemeInfo:Q}),(0,u.jsx)(lc.b,{isActive:O}),(0,u.jsx)(lv.h,{isActive:O}),!(0,l1.GP)(Q)&&(0,u.jsx)(lm.Z,{awemeInfo:Q,userInfo:es,isActive:O,isNext:W,isPrev:U,logParams:eo,index:K}),(0,u.jsx)(l_.L,{awemeInfo:Q,isActive:O,abtestData:X,suspendWhenMetaIsUndefined:!0,index:K}),(0,u.jsx)(lf.P,{isActive:O,awemeInfo:Q,abtestData:X,userInfo:es,enablePip:iS}),(0,u.jsx)(lp.E,{isActive:O,awemeInfo:Q,abtestData:X,userInfo:es,deleteCurrentSwiper:ee,config:iP,scene:b.lT.Recommend,isNext:W,currentIndex:K}),(0,u.jsx)(lh.q,{index:K,isActive:O,abtestData:X,awemeInfo:Q,isInnerFeed:eZ,scene:b.lT.Recommend}),(0,u.jsx)(lg.o,{isActive:O,awemeInfo:Q}),(null==Q?void 0:Q.awemeType)===x.e.Note?(0,u.jsx)(ly.PictureMode,{isActive:O,awemeInfo:Q,abTestData:X,logParams:eo,playNextFunc:J,playPrevFunc:er,isClientMiniWin:it,ablePlayPrev:!((eN||eP)&&!q),ablePlayNext:!((eN||eP)&&!Y),disableShortCut:lB,isShowSideBar:lk}):null,iN&&!iC?(0,u.jsx)(lw.t,{isActive:O,userInfo:es,dispatch:eu,abtestData:X,awemeInfo:Q,player:null==ih?void 0:null===(D=ih.current)||void 0===D?void 0:D.player,currentIndex:K,isInnerFeed:eZ}):null,eR,(0,u.jsx)(lI.x,{isActive:O,awemeInfo:Q,abTestData:X}),iB&&(0,u.jsx)(lx.K,{awemeInfo:Q,isActive:O}),iB&&iN&&(0,u.jsx)(t_.FeedbackAd,{awemeInfo:Q,deleteCurrentSwiper:ee,toast:ea,abtestData:X}),iN&&(0,u.jsx)(tH.PlayBackSetting,{disable:iB&&(0,em.Gu)(Q),isActive:O,awemeInfo:Q,abtest:X,logParams:eo,loginBlock:!(null==es?void 0:es.isLogin)&&!tJ,loginDispatch:eu,speedType:(0,$.G6)()?e_.$.Safari:e_.$.Normal}),iN&&tx&&(!iC||ix)?(0,u.jsx)(tw.I,{isActive:O,fullScreenTarget:ei,abtestData:X,isLogin:!!(null==es?void 0:es.isLogin),loginDispatch:eu}):null,!iC&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(lb.Danmaku,{isActive:O,awemeInfo:Q,userInfo:es,loginDispatch:eu,abtestData:X,isDanmuIcon:ik,currentIndex:K}),(0,u.jsx)(lE.e,{isActive:O,awemeInfo:Q,abtestData:X,aiNoteProps:tL,isAiNoteIcon:iM}),ig?(0,u.jsx)(lT.WC,{isActive:O,awemeInfo:Q,userInfo:es,loginDispatch:eu,abtestData:X,isChapterIcon:iD,chapterProps:tT,logParams:eo,chapterMaxWidth:iR}):null,iN?(0,u.jsx)(tg.Vw,{awemeInfo:Q,isShowGuide:ec,logParams:eo,isActive:O,defaultIsPageFullScreen:lD,abtestData:X}):null,(0,u.jsxs)(lC.r,{isActive:O,controlHeight:b.fp.MidHigh,position:"bottom",awemeInfo:Q,abtestData:X,children:[iN&&iW&&iq&&!(null==tS?void 0:tS.recommendTagType)&&(0,u.jsx)(io.n,{scene:"player",awemeInfo:Q}),iW&&!(0,id.$m)(Q)&&(null==tS?void 0:tS.recommendTagType)&&!(null==tS?void 0:tS.isShowVideoInfoSideCard)&&(0,u.jsx)(ia.B,(0,d._)({userInfo:es,awemeInfo:Q,player:null==ih?void 0:null===(R=ih.current)||void 0===R?void 0:R.player,abTestData:X},tS)),iN&&!iV&&i$.length>0&&(0,u.jsx)(is.E,{awemeInfo:Q,anchorList:i$,openActivityCard:eX,abtestData:X}),tq&&!iy&&iW&&(0,ef.n)(Q)&&!(0,ep.o4)(Q)&&iN&&(0,u.jsx)(lS.n,{awemeInfo:Q,onClick:eJ,isActive:O,onMouseEnter:e2,onMouseLeave:lA}),(0,eh.A)(Q)&&iN&&(0,u.jsx)(lN.X,{isActive:O,awemeInfo:Q,isHide:lL}),(0,eg.hj)(Q)&&(0,em.Gu)(Q)&&iN&&(0,u.jsx)(tp.FeedLiveAd,{isActive:O,awemeInfo:Q}),(0,ep.o4)(Q)&&(0,em.Gu)(Q)&&iN&&(0,u.jsx)(lP.b,{isHide:lV,isActive:O,awemeInfo:Q}),(0,ep.o4)(Q)&&!(0,em.Gu)(Q)&&iN&&(0,u.jsx)(tY.A,{isActive:O,awemeInfo:Q}),(0,ey.L)(Q)&&iN&&(0,u.jsx)(lU,{isActive:O,awemeInfo:Q,isHide:lL}),(0,ew.u)(Q)&&iN&&(0,u.jsx)(lK,{isActive:O,awemeInfo:Q,isHide:lL}),iW&&(0,u.jsx)("div",{className:g()(eS.default.splashAdComponent,{[eS.default.enterTransition]:iV&&!eZ}),children:(0,u.jsx)(lQ.VideoInfoNew,{isActive:O,awemeInfo:Q,userInfo:es,scene:b.lT.Recommend,isTopicLinkSearchResult:!0,videoHashtagClassName:eM,onSodaClick:e1,videoTags:eB||[],abTestData:X,isShowCreateTime:eZ||lk||!(iB&&(0,em.Gu)(Q)||iV),canMixListen:!eZ,isInnerFeed:eZ,showGuideDownloadClient:iZ,loginUserInfo:es,loginDispatch:eu,fullScreenTarget:ei,reportExtraParams:eo,onCooperationAuthorClick:e$,isShowCooperation:eY,showSideBar:lk,isShowBrandComponent:iy,onBrandComponentHide:iT,onBrandComponentShow:iE,onClickUserName:()=>{if(!eZ){var e;(0,Z.xL)(Q,null==ih?void 0:null===(e=ih.current)||void 0===e?void 0:e.player,"head")}},sideCardContext:tj,showExpandButtonInner:(null==X?void 0:X.aiNoteV2)===2})}),(0,u.jsx)(l$.H,{isActive:O,isAdAweme:iB,awemeInfo:Q,abtestData:X,toast:ea,playNextFunc:J})]}),tb?(0,u.jsx)(tz._q,{isActive:O,awemeId:null==Q?void 0:Q.awemeId,isShowGuide:eF,abtestData:X}):(0,u.jsx)(lY.x,{isActive:O,awemeInfo:Q,abtestData:X,isShowGuide:eF,scene:b.lT.Recommend}),iN&&iW?(0,u.jsx)(ty.h,{awemeInfo:Q,isActive:O,userInfo:es,disableShortCut:lB,abtestData:X}):null,iW&&iN?(0,u.jsx)(tI.MenuList,{isActive:O,abtestData:X,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:(0,em.Gu)(Q)&&iB&&eq?[]:["showAdDetail"],shortCutFiltered:iF,awemeInfo:Q,showEnterDetail:!(iB&&(0,em.Gu)(Q)),showAdMenu:iB&&(0,em.Gu)(Q),disableShortCut:lB,userInfo:es,showRecommendToFriend:!!tS}):null,!lO&&iN?(0,u.jsx)(tF,{isActive:O,userInfo:es,dispatch:eu,abtestData:X,awemeInfo:Q}):null,iN?(0,u.jsx)(lq.B,{awemeInfo:Q,abtestData:X,isActive:O}):null,(null==ij?void 0:ij.length)>0&&iN&&(0,u.jsx)(tf.SettingList,{isActive:O,awemeInfo:Q,hideList:ij,dispatch:eu,abtestData:X,userInfo:es,isAdAweme:iB&&(0,em.Gu)(Q)}),iN?(0,u.jsx)(tB.I,{abtestData:X,isActive:O,awemeInfo:Q,logParams:eo,isChapterScene:!0}):null,iN&&iZ?(0,u.jsx)(tO.PostGuideDownload,{isActive:O,awemeInfo:Q,userInfo:es,abtestData:X,isInnerFeed:eZ,player:null==ih?void 0:null===(F=ih.current)||void 0===F?void 0:F.player}):null,iN&&!iC&&(0,u.jsx)(t1.P,{abtestData:X,isActive:O,controlHeight:b.fp.MidHigh,hidePluginList:(null==ij?void 0:null===(B=ij.map)||void 0===B?void 0:B.call(ij,e=>null==e?void 0:e[0]))||[]})]}),(0,u.jsx)("div",{}),tJ&&(0,u.jsx)(tU.U,{awemeInfo:Q}),(0,u.jsx)("div",{}),it&&(0,u.jsxs)(u.Fragment,{children:[O&&iN&&(0,u.jsx)(tV.MiniWinMask,{isActive:O,awemeInfo:Q,abtestData:X,playPrevFunc:er,playNextFunc:J,disablePrev:H&&!(eN||eP)||(eN||eP)&&!q,disableNext:z&&!(eN||eP)||(eN||eP)&&!Y,ablePlayNext:!(z&&!(eN||eP)||(eN||eP)&&!Y),loginUserInfo:es,loginDispatch:eu,reportExtraParams:eo,recordPreferVideoSwitch:!0}),O&&iN&&!ix&&(0,u.jsx)(tW.N,{awemeInfo:Q})]}),O&&(0,u.jsx)(lJ.s,{}),(0,u.jsx)(t3.p,{isActive:O})]})]})}));var im=t("773238"),i_=t("669206"),ip=t("709950"),ih=t("850634"),ig=t("529596"),iy=t("379788"),iw=t("54730");let iI=e=>{let{awemeInfo:l,abtestData:t,isActive:i,isLogin:n}=e,o=(0,e$.n)(),[a,d]=(0,m.useState)(!1),r=(0,m.useRef)(!1),s=(0,en.p)(l),u=(0,m.useMemo)(()=>{var e;return null===(e=Z.Le.getConfig(Z.gI.WallPaperIds))||void 0===e?void 0:e.includes(null==l?void 0:l.awemeId)},[l]);return(0,m.useEffect)(()=>{let e=async()=>{if(!(!1===n||!i||u||s||(0,S.DT)()||(0,S.tq)())){if(r.current){d(!0);return}try{var e;let[t,i]=await Promise.all([(0,ig.Y)(),(0,iy.lx)({secUid:null===(e=l.authorInfo)||void 0===e?void 0:e.secUid})]);(function(e,l,t){var i,n,o,a;let d=new Date().getTime(),r=null!==(n=(0,tJ.$o)(tX.LocalStorageKeys.PostGuideDownloadClient))&&void 0!==n?n:{lastTimestamp:0,showTimes:0},s=d-r.lastTimestamp>=864e5,u=r.showTimes<10;if(e===iw.Q.Normal&&s&&u&&!1===t&&[1,2].includes(null==l?void 0:null===(i=l.authorInfo)||void 0===i?void 0:i.followStatus)){let e=null!==(a=null===(o=(0,tJ.$o)(tX.LocalStorageKeys.PostGuideDownloadClient))||void 0===o?void 0:o.showTimes)&&void 0!==a?a:0;return(0,tJ.qQ)(tX.LocalStorageKeys.PostGuideDownloadClient,{lastTimestamp:new Date().getTime(),showTimes:e+1}),!0}return!1})(null==i?void 0:i.accountType,l,t)&&(r.current=!0,d(!0))}catch(e){}}};if(o)return o.once(ih.FP.TIMEUPDATE,e),()=>{o.off(ih.FP.TIMEUPDATE,e)}},[t,l,i,n,u,s,o]),{isShowGuideDownload:a}};var ix=t("748900"),ib=t("107058"),iE=t("820855"),iT=t("355077"),iC=t("66627"),iS=t("444267"),iN=t("366068"),iP=t("92351"),iA=t("364979"),iL=t("180593"),ik=t("96570"),ij=t("29498"),iD=t("49279"),iR=t("251537");function iM(e){var l,t;return(null==e?void 0:null===(t=e.plugins)||void 0===t?void 0:null===(l=t.veStrategyVodLoggerPlugin)||void 0===l?void 0:l.cumulateTime)||0}var iF=t("282765"),iB=t("658228"),iO=e=>{var l;let{scene:t,awemeInfo:i,abtestData:n,userInfo:o,isClientMiniWin:a,isMiniWin:r,isInnerFeed:s,isActive:c,player:v}=e,{awemeFeed:_}=(0,iD.j)(),{supportAiTop1:f}=(0,iu.Iq)(e=>{let{supportAiTop1:l}=e;return{supportAiTop1:l}}),p=_.useValue("modalAwemeInfo",Boolean),h=_.useValue("feedType"),{isShowExtra:y,extraRef:w,searchBarProps:I,handleExitFullscreen:x}=(0,ij.Y)(i,v,c),E=(0,m.useRef)(null),T=(0,m.useRef)(p),[C,N]=(0,m.useState)(!1),P=(0,S.DT)()&&(0,iC.y)((0,S.FJ)().awemePcClient,">=","5.4.0"),[A,L]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{N(!p&&T.current),T.current=p},[p]),(0,m.useEffect)(()=>{if(!p&&E.current){var e;let l=null===(e=E.current)||void 0===e?void 0:e.aweme;q.emit(q.EVENT.postCurVideoInfo,{awemeId:l.awemeId,groupId:l.groupId,scene:E.current.scene,suggestWords:null==l?void 0:l.suggestWords})}},[p]),(0,m.useEffect)(()=>{!p&&(E.current={aweme:i,scene:t})},[i,p,t]),(0,m.useEffect)(()=>{if(v&&c){var e,l;(null===(e=Z.Le.getConfig(Z.gI.AbtestData))||void 0===e?void 0:e.cleanscreen)&&((null===(l=function(e,l){var t;let{pluginsConfig:i={}}=null!=e?e:{};return null!==(t=i[l])&&void 0!==t?t:{}}(v,iF.p7.ImmersiveSwitchSettingPlugin))||void 0===l?void 0:l.isOn)?L(!0):A&&L(!1));let t=e=>{var l;(null===(l=Z.Le.getConfig(Z.gI.AbtestData))||void 0===l?void 0:l.cleanscreen)&&L(e.isOn)};return v.on(iB.C.ImmersiveSwitchChange,t),()=>v.off(iB.C.ImmersiveSwitchChange,t)}},[v,c,s]),(0,u.jsxs)("div",{className:g()(iS.default.extraTL,"isDark",{[iS.default.extraShow]:y,[iS.default.clientHomeStyleWrap]:P}),ref:w,children:[p?(0,u.jsx)(iR.N,{exitTextProps:{getCurrentTab:()=>h,modalEnterFrom:t,isSelf:!1,uidEquals:(null==i?void 0:null===(l=i.authorInfo)||void 0===l?void 0:l.uid)===(null==o?void 0:o.uid),awemeInfo:i},onHandleReturn:()=>{_.dispatch("modalAwemeInfo",null)}}):(0,u.jsx)(ik.P,{onClick:x,isMiniWin:r,isClientMiniWin:a}),(0,u.jsx)("div",{className:g()(iS.default.searchCt,{[iS.default.hidden]:A}),children:(()=>{if((null==n?void 0:n.aiSearchAiInput)&&(null==n?void 0:n.aiSearchInputMiddleNew)&&f)return(0,u.jsx)(iN.default,(0,d._)({customProps:{isFullScreenShow:!0,isSmoothInnerFeed:p||C},userInfo:o,abTestData:n,playerProps:{awemeInfo:i,scene:t,fullScreenScene:b.lT.FullScreen}},I));if(!(null==n?void 0:n.aiSearchAiInput)&&(null==n?void 0:n.aiSearchInputMiddleNew)&&f)return(0,u.jsx)(iP.E1,(0,d._)({customProps:{isFullScreenShow:!0,isSmoothInnerFeed:p||C},userInfo:o,abTestData:n,playerProps:{awemeInfo:i,scene:t,fullScreenScene:b.lT.FullScreen}},I));if((null==n?void 0:n.aiSearchAiInput)&&!(null==n?void 0:n.aiSearchInputMiddleNew)&&f)return(0,u.jsx)(iA.E1,(0,d._)({customProps:{isFullScreenShow:!0,isSmoothInnerFeed:p||C},userInfo:o,abTestData:n,playerProps:{awemeInfo:i,scene:t,fullScreenScene:b.lT.FullScreen}},I));else return(0,u.jsx)(iL.default,(0,d._)({customProps:{isFullScreenShow:!0,isSmoothInnerFeed:p||C},userInfo:o,abTestData:n,playerProps:{awemeInfo:i,scene:t,fullScreenScene:b.lT.FullScreen}},I))})()})]})},iV=t("45585"),iW=t("384579"),iU=t("797734"),iH=t("56348"),iG=t("937841"),iz=t("275555"),iZ=t("111341"),iK=t("309931"),iQ=t("407544"),i$=t("465769"),iY=t("784415"),iq=t("326494"),iJ=t("645361"),iX=t("770068");let i0=0,i1=!1,i2=e=>{var l,t;let{isShowGuide:i,isActive:n,awemeId:o}=e,a=(0,e$.n)(),d=(0,m.useRef)(!1),[r,s]=(0,m.useState)(!1),{attemptOpen:c,executeClose:v}=(0,iQ.B)({popName:"浏览器限制-声音提醒",onOpen:()=>{s(!0)},onClose:()=>{s(!1)}});(0,m.useLayoutEffect)(()=>{if(!a||i)return;let e=()=>{if(!d.current)(0,iq.q)({player:a,onSuccess:()=>{!i&&i0<5&&c()}}),d.current=!0};return a.on(ih.FP.AUTOPLAY_WAS_PREVENTED,e),()=>{a.off(ih.FP.AUTOPLAY_WAS_PREVENTED,e)}},[a,i,n]),(0,m.useEffect)(()=>{if(!n||i||!a){v();return}if(!i1&&i0<5&&(a.muted||a.paused)){let e=setTimeout(()=>{a.muted=!1,a.paused&&setTimeout(()=>{a.play()}),d.current=!1,i1=!0},200);return()=>{clearTimeout(e)}}i0<5&&a.muted?c():v()},[i,n,a]);let _=!i&&r;(0,m.useEffect)(()=>{_&&n&&(i0+=1,iY.Z.sendLog("voiceBubbleShow",{enter_from:(0,i$.vM)()}))},[n,_]);let f=()=>{i0=5,v()};if((0,m.useEffect)(()=>{if(a){let e=e=>{((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume")&&f()};return a.on(ih.FP.USER_ACTION,e),()=>{a.off(ih.FP.USER_ACTION,e)}}},[a]),(0,m.useEffect)(()=>{if(a){let e=e=>{("volumeDown"===e.action||"volumeUp"===e.action)&&f()};return a.on(iB.C.CustomShortCut,e),()=>{a.off(iB.C.CustomShortCut,e)}}},[a]),(0,m.useEffect)(()=>{if(!!o)q.emit(q.EVENT.silentStatusChange,{awemeId:o,isAuto:!0,status:_})},[_,o]),!_)return null;let p=null==a?void 0:null===(t=a.getPlugin)||void 0===t?void 0:null===(l=t.call(a,"SoundGuideTooltipPlugin"))||void 0===l?void 0:l.root;return p?(0,iK.createPortal)((0,u.jsx)(iX.V,{onClose:f,onOpen:()=>{iY.Z.sendLog("clickVoiceBubble",{enter_from:(0,i$.vM)()}),a.muted=!1,f()},description:"当前为静音，是否要打开声音？"}),p):null},i4=e=>{let l=(0,iJ.N)();return(0,u.jsxs)(eB.k,{componentName:"NewUseSoundGuidePlugin",Slardar:l,children:[(0,u.jsx)(iX.I,(0,d._)({},e)),(0,u.jsx)(i2,(0,d._)({},e))]})};var i3=t("165007"),i5=t("506435"),i6=t("622273"),i8=t("646304"),i7=t("280837"),i9=t("872136"),ne=new i9.h({checkVideoUnsafe:{eventName:"check_video_unsafe",params:{aweme_ids:[],counts:0}},checkVideoUnsafeModal:{eventName:"check_video_unsafe_modal",params:{aweme_id:""}}});let nl={},nt=48e4;{let e=localStorage.getItem("check_safe_time");nt=e?Number(e):nt}let ni=e=>{let{awemeInfo:l,isActive:t,isUseOneCheck:i,playPrevFunc:n,playNextFunc:o,deleteCurrentSwiper:a}=e,d=(0,e$.n)(),[r,s]=(0,m.useState)(!1),[c,v]=(0,m.useState)(5),_=(0,y.Z)(async()=>{if(Date.now()-1e3*Number(l.dyQ)>nt){let e=l.awemeId,t=[{item_id:e,dy_q:l.dyQ,tag:l.isAds?2:0,potential_risk_level:0,authentication_token:""}],i=await (0,i8.Y)(t);0===i.statusCode&&(nl[e]=Date.now(),i.result.find(l=>l.item_id===e)&&(d.pause(),s(!0),ne.sendLog("checkVideoUnsafe",{aweme_ids:[l.awemeId],counts:1}),ne.sendLog("checkVideoUnsafeModal",{aweme_id:l.awemeId})));return}}),f=(0,m.useCallback)(async()=>{var e;let t=l.awemeId,i=null!==(e=Z.Le.getConfig(Z.gI.CheckAwemeList))&&void 0!==e?e:[],n=i.findIndex(e=>e.vid===t);if(-1!==n&&Date.now()-i[n].time>nt){let e=i.slice(n,n+6).map(e=>({item_id:e.vid,dy_q:e.dy_q,tag:e.tag,potential_risk_level:0,authentication_token:""})),o=await (0,i8.Y)(e);if(0===o.statusCode){let e=i.length;for(let l=n;l<Math.min(n+6,e);l++){let e=o.result.find(e=>e.item_id===i[l].vid);i[l].time=Date.now(),i[l].hasCheck=(null==e?void 0:e.safety_code)===0}Z.Le.setConfig(Z.gI.CheckAwemeList,i),o.result.find(e=>e.item_id===t)&&(d.pause(),s(!0),ne.sendLog("checkVideoUnsafeModal",{aweme_id:l.awemeId}));let a=o.result.filter(e=>e.item_id!==t&&1===e.safety_code).map(e=>e.item_id);q.emit(q.EVENT.checkSafeAwemeList,a),ne.sendLog("checkVideoUnsafe",{aweme_ids:o.result.map(e=>e.item_id),counts:o.result.length})}}},[d,l]),p=(0,m.useCallback)(async e=>{i?_():f()},[i,_,f]);return(0,i6.t)(e=>{!e&&t&&d&&_()}),(0,m.useEffect)(()=>{if(r&&c>0){d.pause();let e=setTimeout(()=>{v(c-1)},1e3);return()=>clearTimeout(e)}},[r,c]),(0,m.useEffect)(()=>{if(r&&0===c&&a){if(i){if("reverse"===Z.Le.getConfig(Z.gI.InnerAutoPlay).mode){n();return}o();return}a()}},[r,c,i,a]),(0,m.useEffect)(()=>{i&&(v(5),s(!1))},[i,l]),(0,m.useEffect)(()=>{if(d&&t)return d.on(ih.FP.FIRST_FRAME,p),d.on(ih.FP.REPLAY,p),()=>{d.off(ih.FP.FIRST_FRAME,p),d.off(ih.FP.REPLAY,p)}},[d,t,p]),r&&(0,u.jsxs)("div",{className:i7.default.container,children:[(0,u.jsx)("div",{className:i7.default.damaIcon}),(0,u.jsx)("div",{className:i7.default.damaText,children:"当前视频出现问题，无法播放"}),(0,u.jsxs)("div",{className:i7.default.damaTime,children:[(0,u.jsx)("span",{className:i7.default.nums,children:c}),(0,u.jsx)("span",{children:"秒后自动切换至下一个内容"})]})]})};var nn=t("883675"),no=t("530419"),na=t("210571"),nd=t("910427"),nr=t("281895"),ns=t("146586"),nu=t("204378"),nc=t("234594"),nv=t("989827"),nm=t("47047");let n_=e=>{var l,t,i;let{isActive:n}=e||{},{isMobile:o,isiPad:a}=(0,M.X)(),d=(0,e$.n)(),r=(0,nm.O)()||o||a?null==d?void 0:null===(l=d.getPlugin("progress"))||void 0===l?void 0:l.parent:null==d?void 0:null===(t=d.getPlugin("progress"))||void 0===t?void 0:t.outer,s=null==d?void 0:null===(i=d.getPlugin("volume"))||void 0===i?void 0:i.root;return(0,m.useEffect)(()=>{let e=e=>{null==e||e.stopPropagation()};return null==r||r.addEventListener("pointerdown",e),null==r||r.addEventListener("touchstart",e),null==s||s.addEventListener("pointerdown",e),null==s||s.addEventListener("touchstart",e),()=>{null==r||r.removeEventListener("pointerdown",e),null==r||r.removeEventListener("touchstart",e),null==s||s.removeEventListener("pointerdown",e),null==s||s.removeEventListener("touchstart",e)}},[r,s]),(0,m.useEffect)(()=>{if(d&&n){d.addClass("hide-loading");let e=setTimeout(()=>{d.removeClass("hide-loading")},2e3),l=()=>{d.removeClass("hide-loading"),clearTimeout(e)};return d.once("playing",l),()=>{clearTimeout(e),d.off("playing",l)}}},[n,d]),null},nf=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"SwiperFitPlugin",Slardar:l,children:(0,u.jsx)(n_,(0,d._)({},e))})},np=e=>{let{awemeInfo:l,isActive:t}=e,i=(0,e$.n)(),n=()=>{let e=Z.Le.getConfig(Z.gI.AwemePcRecRawData);return!e&&(e={videoPrefer:{fsn:[],like:[],halfMin:[],min:[]}},Z.Le.setConfig(Z.gI.AwemePcRecRawData,e)),e};return(0,m.useEffect)(()=>{if(i){let e=()=>{i.playTimestamp=new Date().getTime()};return null==i||i.on(ih.FP.PLAY,e),()=>i.off(ih.FP.PLAY,e)}},[i]),(0,m.useEffect)(()=>{if(i&&t){let e=()=>{var e;let{fsn:t}=n().videoPrefer;t.filter((e,l)=>l%2==0).includes(null==l?void 0:l.groupId)||t.push(null==l?void 0:l.groupId,null==l?void 0:null===(e=l.authorInfo)||void 0===e?void 0:e.uid),(0,Z.xL)(l,i,"fsn")};return null==i||i.on(ih.FP.ENDED,e),()=>null==i?void 0:i.off(ih.FP.ENDED,e)}},[i,t,l]),(0,m.useEffect)(()=>{if(i&&t)return()=>{[3e4,6e4].filter(e=>i.cumulateTime>=e).map(e=>3e4===e?"halfMin":"min").map(e=>{var t;return{field:e,groupId:null==l?void 0:l.groupId,authorId:null==l?void 0:null===(t=l.authorInfo)||void 0===t?void 0:t.uid}}).forEach(e=>{let t=n().videoPrefer[e.field];t.filter((e,l)=>l%2==0).includes(null==l?void 0:l.groupId)||t.push(e.groupId,e.authorId),(0,Z.xL)(l,i,e.field)}),i.cumulateTime<2e3&&(0,Z.xL)(l,i,"skip"),i.overallPlayTime?i.overallPlayTime+=i.cumulateTime:i.overallPlayTime=i.cumulateTime}},[i,t,l]),null},nh=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"CumulativeTime",Slardar:l,children:(0,u.jsx)(np,(0,d._)({},e))})};var ng=t("165674");let ny=e=>{let{awemeInfo:l,isActive:t}=e,i=(0,e$.n)(),n=(0,m.useRef)(!1),o=(0,m.useMemo)(()=>(0,em.Rx)(l),[l]);return(0,m.useEffect)(()=>{if(t){let e=Date.now(),t=k.s.getIsPageFullscreen(),i=(0,el.r)()?"browser_full":t?"web_full":"normal";return(0,lL.E)("show",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra,player_form:i}),()=>{var t;(0,lL.E)("show_over",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:Date.now()-e,player_form:i}),(0,lL.E)("break",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:Date.now()-e,video_length:null==l?void 0:null===(t=l.video)||void 0===t?void 0:t.duration})}}},[t,l]),(0,m.useEffect)(()=>{if(i){let e=()=>{(0,lL.E)("auto_play",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra})},l=()=>{(0,lL.E)("show_fail",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra}),(0,lL.E)("play_failed",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra})};return i.once(ih.FP.PLAY,e),i.once(ih.FP.ERROR,l),()=>{i.off(ih.FP.PLAY,e),i.off(ih.FP.ERROR,l)}}},[i,o]),(0,ng.u)(i,ih.FP.PLAY,()=>{(0,lL.E)("play",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,ng.u)(i,ih.FP.REPLAY,()=>{(0,lL.E)("auto_replay",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,ng.u)(i,ih.FP.ENDED,()=>{var e,t;(0,lL.E)("over",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra,duration:null==l?void 0:null===(e=l.video)||void 0===e?void 0:e.duration,video_length:null==l?void 0:null===(t=l.video)||void 0===t?void 0:t.duration})}),(0,ng.u)(i,ih.FP.VOLUMECHANGE,()=>{1===(0,tJ.$o)(tX.LocalStorageKeys.PLAYER_IS_MUTE)&&(0,lL.E)("mute",{tag:(0,lD.f)(),value:o.creative_id,log_extra:o.log_extra})}),(0,ng.u)(i,ih.FP.ERROR,()=>{!n.current&&(n.current=!0)}),null},nw=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"AdCommonHandler",Slardar:l,children:(0,u.jsx)(ny,(0,d._)({},e))})};var nI=t("944189"),nx=t("459307"),nb=t("512311"),nE=t("829097"),nT=t("264646"),nC=t("509090"),nS=t("109539"),nN=t("979571");let nP=e=>{let{onClose:l}=e;return(0,u.jsx)("div",{className:nT.default.container,onClick:l,children:(0,u.jsxs)("div",{className:nT.default.main,onClick:e=>e.stopPropagation(),children:[(0,u.jsx)("div",{className:nT.default.title,children:"抖音广告"}),(0,u.jsx)("div",{className:nT.default.detail,children:"抖音根据您的个人偏好向您展示广告，以向您提供更好的服务。如果您对于某条广告不感兴趣，您可以通过右键视频，点击“不感兴趣”，选择屏蔽您不感兴趣的广告内容，但这项设置不会改变您在抖音看到的广告数量。"}),(0,u.jsx)("div",{className:nT.default.close,children:(0,u.jsx)(nN.z,{svg:(0,u.jsx)(nb.Z,{}),onClick:l,style:{fontSize:"36px"}})})]})})},nA=e=>{let l=document.createElement("div"),t=(0,nI.createRoot)(l),i=document.body;if((0,el.r)()&&(i=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement),Z.Le.getConfig(Z.gI.IsShowAdIntroduction))return;Z.Le.setConfig(Z.gI.IsShowAdIntroduction,!0),i.appendChild(l);let n=e=>{let{fullscreen:l}=e;l&&o()},o=()=>{e.off("switch_fullscreen",n),t.unmount(),l.remove(),Z.Le.setConfig(Z.gI.IsShowAdIntroduction,!1)};e.on("switch_fullscreen",n),t.render((0,u.jsx)(nP,{onClose:o}))},nL=e=>{let{awemeInfo:l,toast:t,abtestData:i}=e,n=(0,e$.n)(),o=(0,m.useContext)(nS.Context),a=(0,m.useCallback)(async()=>{let e=(0,em.Rx)(l),i=await (0,nE.j$)({creative_id:e.creative_id,log_extra:e.log_extra,is_positive:1});(null==i?void 0:i.code)===0?t?t("操作成功，将持续优化推荐内容"):nC.F.info("操作成功，将持续优化推荐内容"):t?t("操作失败，请稍后重试"):nC.F.info("操作失败，请稍后重试"),(0,lL.E)("otherclick",{tag:(0,lD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"like"})},[l]),r=(0,m.useCallback)(async function(){let{onAddDislikeSuccess:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,em.Rx)(l),n=(0,eg.hj)(l)?{dislike_ad_type:"aweme_webcast"}:{},o=(0,em.Gu)(l)?"广告":"视频",a=await (0,nE.j$)((0,d._)({creative_id:i.creative_id,log_extra:i.log_extra},n));(null==a?void 0:a.code)===0?(t?t(`操作成功，将减少此类${o}出现`):nC.F.info(`操作成功，将减少此类${o}出现`),null==e||e()):t?t("操作失败，请稍后重试"):nC.F.info("操作失败，请稍后重试"),(0,lL.E)("otherclick",{tag:(0,lD.f)(),value:i.creative_id,log_extra:i.log_extra,refer:"feedback_button",right_click:"dislike"})},[l]),s=(0,m.useCallback)(async()=>{var e,t;let n=JSON.parse(null==l?void 0:l.rawAdData);(0,lL.E)("otherclick",{tag:(0,lD.f)(),value:n.creative_id,log_extra:n.log_extra,refer:"feedback_button",right_click:"report"}),q.emit(q.EVENT.videoPause),(0,nx.n)({creative_id:n.creative_id,log_extra:n.log_extra,title:"广告举报",user_id:null==o?void 0:null===(t=o.userInfo)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.uid,onClose:()=>{(0,eb.m)("adReportModal"),q.emit(q.EVENT.videoRemoveStopPlayNext)},onShow:()=>{q.emit(q.EVENT.videoStopPlayNext),(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"adReportModal")},onLoginSuccess:()=>{q.emit(q.EVENT.videoStopPlayNext)},loginDispatch:null==o?void 0:o.dispatch,abtestData:i})},[l,n,o,i]),u=(0,m.useCallback)(()=>{let e=JSON.parse(null==l?void 0:l.rawAdData);(0,lL.E)("otherclick",{tag:(0,lD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"advertising"}),q.emit(q.EVENT.videoPause)},[l]),c=(0,m.useCallback)(()=>{let e=JSON.parse(null==l?void 0:l.rawAdData);(0,lL.E)("otherclick",{tag:(0,lD.f)(),value:e.creative_id,log_extra:e.log_extra,refer:"feedback_button",right_click:"why"}),nA(n)},[n,l]);return(0,ng.u)(n,iB.C.AdLike,a),(0,ng.u)(n,iB.C.AdDislike,r),(0,ng.u)(n,iB.C.AdReport,s),(0,ng.u)(n,iB.C.AdThrow,u),(0,ng.u)(n,iB.C.AdIntroduce,c),null},nk=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"FeedbackAd",Slardar:l,children:(0,u.jsx)(nL,(0,d._)({},e))})};var nj=t("96648"),nD=t("202091"),nR=t("134761"),nM=t("784492"),nF=t("645003"),nB=t("506924");let nO=(0,m.forwardRef)((e,l)=>(0,u.jsx)("svg",(0,r._)((0,d._)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,u.jsx)("path",{d:"M4 1l5 5-5 5",stroke:"#fff",strokeOpacity:".9",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})}))),nV=(0,m.forwardRef)((e,l)=>(0,u.jsx)("svg",(0,r._)((0,d._)({width:31,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,u.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.54 8a1.04 1.04 0 1 0 0 2.08h13.92a1.04 1.04 0 1 0 0-2.08H8.54zm3.425 13.89a.448.448 0 0 0 0-.772l-3.47-2.043a.448.448 0 0 0-.675.386v4.086c0 .346.377.561.676.386l3.468-2.043zM7.5 15.242c0-.575.466-1.04 1.04-1.04h13.92a1.04 1.04 0 1 1 0 2.08H8.54a1.04 1.04 0 0 1-1.04-1.04zm7.44 5.16a1.04 1.04 0 0 0 0 2.08h7.52a1.04 1.04 0 1 0 0-2.08h-7.52z",fill:"#fff"})})));var nW=t("757858");function nU(){return(0,u.jsx)("div",{className:nB.default.xgTips,children:(0,u.jsx)("span",{children:"章节要点"})})}let nH=e=>{var l,t,i,n;let{awemeInfo:o,isChapterIcon:a,chapterProps:d,chapterMaxWidth:r,player:s,userInfo:c}=e,v=null!==(n=null==o?void 0:null===(l=o.chapterInfo)||void 0===l?void 0:l.list)&&void 0!==n?n:[],{chapterProgress:_,triggerChapterSliderShow:f}=d,p=(null==o?void 0:null===(t=o.chapterInfo)||void 0===t?void 0:t.isPoint)?1:0,h=o.authorInfo.uid===(null==c?void 0:null===(i=c.info)||void 0===i?void 0:i.uid),g=()=>{var e;return{enter_from:(0,i$.mo)(),enter_from_merge:(0,i$.vM)(),group_id:null==o?void 0:o.awemeId,author_id:null==o?void 0:null===(e=o.authorInfo)||void 0===e?void 0:e.uid,chapter_sequence_num_impr:"number"==typeof _&&-1!==_?_+1:null,is_knowledge_point:p,is_author:h?1:0}},y=(0,nF.Y)(()=>{B.logInstance.sendLog("chapterTagShow",g())}),w=()=>{B.logInstance.sendLog("chapterTagClick",g()),f()};if((0,m.useEffect)(()=>{var e,l;a?null===(e=s.root.querySelector(".chapterContainer"))||void 0===e||e.classList.add(nB.default.displayIcon):null===(l=s.root.querySelector(".chapterContainer"))||void 0===l||l.classList.remove(nB.default.displayIcon)},[a,s]),0===v.length)return null;let I=v[_];return(0,u.jsx)("div",{ref:y,children:a?(0,u.jsxs)("div",{className:nB.default.chapterIcon,children:[(0,u.jsx)(eF.Z,{src:nV,width:31,height:32,viewBox:"0 0 31 32",onClick:w}),(0,u.jsx)(nU,{})]}):(0,u.jsxs)("div",{className:nB.default.chapterBar,onClick:w,style:r?{maxWidth:`${r}px`}:void 0,children:[(0,u.jsx)("div",{className:nB.default.dividerSmall}),(0,u.jsx)("div",{className:nB.default.chapterTitle,children:-1===_?`章节要点：共${v.length}个`:`章节要点${_+1}：${null==I?void 0:I.desc}`}),(0,u.jsx)(eF.Z,{className:nB.default.arrowIcon,src:nO,width:12,height:12,viewBox:"0 0 12 12"})]})})};class nG extends ih.di{renderRoot(){var e;let l=null!==(e=this._config)&&void 0!==e?e:{};this.el&&(0,nW.s)(this,(0,u.jsx)(nH,(0,d._)({},l)))}beforeDestroy(){(0,nW.v)(this)}afterPlayerInit(){this.renderRoot()}configDidUpdate(){this.renderRoot()}render(){return`<div data-state="normal" class="${nB.default.chapterContainer} chapterContainer" data-e2e='chapter-container'></div>`}}(0,nR._)(nG,"pluginName",iF.p7.ChapterPlugin);let nz=(0,eB.h)(e=>{let{isActive:l,awemeInfo:t,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o,userInfo:a}=e,r=(0,e$.n)(),s={position:ih.PZ.CONTROL_LEFT,index:2.9,className:"douyin-player-chapter"};return(0,m.useEffect)(()=>{var e;if(r&&l&&(null==t?void 0:null===(e=t.chapterInfo)||void 0===e?void 0:e.status))return r.registerPlugin(nG,(0,d._)({player:r,awemeInfo:t,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o,userInfo:a},s)),()=>{if(!r.destroyed)r.getPlugin(iF.p7.ChapterPlugin)&&r.unRegisterPlugin(iF.p7.ChapterPlugin)}},[r,l,t,a]),(0,nM.Z)(()=>{r&&r.updatePluginConfig(iF.p7.ChapterPlugin,{isActive:l,awemeInfo:t,chapterProps:i,isChapterIcon:n,chapterMaxWidth:o})},[l,t,n,o,i]),null},"Chapter");var nZ=t("654688"),nK=t("667856"),nQ=t("88961"),n$=t("243150"),nY=t("907170"),nq=t("986694"),nJ=t("421953"),nX=new i9.h({recommendVideoToast:{eventName:"recommend_video_toast",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",label_related_action:"",label_text:"",like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_range:"mutual"}},cancelRecommendVideo:{eventName:"cancel_recommend_video",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",recommend_range:"mutual"}},friendsWatchingShow:{eventName:"friends_watching_show",params:{group_id:"",author_id:"",enter_from:"",is_friend_watching:0,like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_user_relation:"",recommend_user_app_list:""}},fromDiscoverLabel:{eventName:"from_discover_label",params:{group_id:"",author_id:"",action_type:"",enter_from:""}}});let n0=(0,m.forwardRef)((e,l)=>(0,u.jsxs)("svg",(0,r._)((0,d._)({xmlns:"http://www.w3.org/2000/svg",width:12,height:14,fill:"none",ref:l},e),{children:[(0,u.jsx)("g",{filter:"url(#arrowRight_svg__filter0_d_4446_15535)",children:(0,u.jsx)("g",{filter:"url(#arrowRight_svg__filter1_d_4446_15535)",children:(0,u.jsx)("path",{d:"M3.803 9.864a.75.75 0 0 1 0-1.061L6.606 6 3.803 3.197a.75.75 0 0 1 1.06-1.06L8.198 5.47a.75.75 0 0 1 0 1.06L4.864 9.864a.75.75 0 0 1-1.06 0z",fill:"#fff"})})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("filter",{id:"arrowRight_svg__filter0_d_4446_15535",x:-2,y:-1,width:16,height:16,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{dy:1}),(0,u.jsx)("feGaussianBlur",{stdDeviation:1}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),(0,u.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_4446_15535"}),(0,u.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_4446_15535",result:"shape"})]}),(0,u.jsxs)("filter",{id:"arrowRight_svg__filter1_d_4446_15535",x:3.083,y:1.417,width:6.833,height:10.167,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,u.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,u.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,u.jsx)("feOffset",{dx:".5",dy:".5"}),(0,u.jsx)("feGaussianBlur",{stdDeviation:".5"}),(0,u.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,u.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.7 0"}),(0,u.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_4446_15535"}),(0,u.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_4446_15535",result:"shape"})]})]})]})));var n1=t("980141");let n2=e=>{let{awemeInfo:l,recommendTagType:t,onClickGuideTag:i,onClickWhiteTag:n,className:o,userList:a,player:d,shouldShowFollowRecBtn:r,abTestData:s,guideTagTriggerSource:c,recommendTriggerSource:v,userInfo:_}=e,{userRecommendStatus:f,friendRecommendInfo:p,status:{allowSelfRecommendToFriend:h}={},stats:{recommendCount:y=0}={}}=l,{isLogin:w}=_,I=(0,m.useMemo)(()=>{let e=null==s?void 0:s.familiarRecommendEntranceCountLabelCondition;return e?y>e?`共${(0,nY.qe)(y)}人推荐`:"点击推荐":"点击推荐"},[s,y]),x=(0,m.useRef)("mutual"),b=async()=>{var e,i,n,o,a,d,r,s,u,m,_;if(!l||!t||2===f||(null==p?void 0:null===(e=p.label_user_list)||void 0===e?void 0:e.length)>0)return;let{data:h,statusCode:g}=await (0,nq.s$)();if(0===g){let{recommendVisibility:e}=h;x.current=0===e?"mutual":"fans"}nX.sendLog("recommendVideoToast",{group_id:null==l?void 0:l.awemeId,author_id:String(null==l?void 0:l.authorUserId),action_type:"show",relation_tag:null==l?void 0:null===(i=l.authorInfo)||void 0===i?void 0:i.followStatus,enter_from:(0,i$.vM)(),enter_method:"guide"===t?"label":v,label_related_action:c,label_text:"guide"===t?I:void 0,like_cnt:y,follow_cnt:"plus_one"===v?null==l?void 0:null===(a=l.friendRecommendInfo)||void 0===a?void 0:null===(o=a.label_user_list)||void 0===o?void 0:null===(n=o.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===1}))||void 0===n?void 0:n.length:void 0,mutual_cnt:"plus_one"===v?null==l?void 0:null===(s=l.friendRecommendInfo)||void 0===s?void 0:null===(r=s.label_user_list)||void 0===r?void 0:null===(d=r.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===2}))||void 0===d?void 0:d.length:void 0,friend_user_id:null==l?void 0:null===(_=l.friendRecommendInfo)||void 0===_?void 0:null===(m=_.label_user_list)||void 0===m?void 0:null===(u=m.map(e=>{var l;return null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid}))||void 0===u?void 0:u.join(","),recommend_range:x.current})},[E,T]=(0,nQ.Z)(null,void 0,[l,t]);(0,eN.o)(()=>{T&&b()},[T,l,t]),(0,eN.o)(()=>{var e,t,i,n,o,a,d,r,u,c,v,m,_,g,I;if(!!h&&!!(null==s?void 0:s.pcAllowRecommendToFriends)&&!!w&&!!T){if(2===f||(null==p?void 0:null===(e=p.label_user_list)||void 0===e?void 0:e.length)>0){let e=2!==f||(null==p?void 0:null===(t=p.label_user_list)||void 0===t?void 0:t.length)?3:0;nX.sendLog("friendsWatchingShow",{group_id:null==l?void 0:l.awemeId,author_id:String(null==l?void 0:l.authorUserId),enter_from:(0,i$.vM)(),is_friend_watching:e,like_cnt:e?y:void 0,follow_cnt:e?null==l?void 0:null===(o=l.friendRecommendInfo)||void 0===o?void 0:null===(n=o.label_user_list)||void 0===n?void 0:null===(i=n.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===1}))||void 0===i?void 0:i.length:void 0,mutual_cnt:e?null==l?void 0:null===(r=l.friendRecommendInfo)||void 0===r?void 0:null===(d=r.label_user_list)||void 0===d?void 0:null===(a=d.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===2}))||void 0===a?void 0:a.length:void 0,friend_user_id:null==l?void 0:null===(v=l.friendRecommendInfo)||void 0===v?void 0:null===(c=v.label_user_list)||void 0===c?void 0:null===(u=c.map(e=>{var l;return null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid}))||void 0===u?void 0:u.join(","),recommend_user_relation:null==l?void 0:null===(_=l.friendRecommendInfo)||void 0===_?void 0:null===(m=_.label_user_list)||void 0===m?void 0:m.map(e=>{var l,t;return`${null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid}:${null==e?void 0:null===(t=e.user)||void 0===t?void 0:t.follow_status}`}).join(","),recommend_user_app_list:null==l?void 0:null===(I=l.friendRecommendInfo)||void 0===I?void 0:null===(g=I.label_user_list)||void 0===g?void 0:g.map(e=>{var l;return`${null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid}:${null==e?void 0:e.recommend_app_id}`}).join(",")})}}},[l,T]);let C=()=>{null==i||i()},S=()=>{null==n||n()},N=()=>{null==d||d.emit(tE.Events.USER_ACTION,{action:"recommend",source:"plus_one"})},P=(0,m.useMemo)(()=>{var e,t,i,n,o,d;return(null==a?void 0:a.length)===1?(0,u.jsxs)("div",{className:nJ.default.recommendText,children:[(0,u.jsx)("span",{className:g()(nJ.default.nickname,nJ.default.singleUser),children:null==a?void 0:null===(d=a[0])||void 0===d?void 0:null===(o=d.user)||void 0===o?void 0:o.nickname}),"推荐"]}):(0,u.jsxs)("div",{className:nJ.default.recommendText,children:[(0,u.jsx)("span",{className:nJ.default.nickname,children:null==l?void 0:null===(n=l.friendRecommendInfo)||void 0===n?void 0:null===(i=n.label_user_list)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:null===(e=t.user)||void 0===e?void 0:e.nickname})," ","等 ",null==a?void 0:a.length," 人推荐"]})},[a]);return t?(0,u.jsx)("div",{className:g()("xgplayer-recommend-tag",nJ.default.wrapper,o),ref:E,children:(()=>{switch(t){case"guide":return(0,u.jsxs)("div",{className:g()(nJ.default.guideTagContainer),onClick:C,children:[(0,u.jsx)(n$.Z,{src:n1.Z,width:16,height:16,viewBox:"0 0 16 16"}),(0,u.jsx)("span",{className:nJ.default.text,children:I}),(0,u.jsx)(n$.Z,{src:n0,width:12,height:14,viewBox:"0 0 12 14"})]});case"white":return(null==a?void 0:a.length)>0?(0,u.jsxs)("div",{className:nJ.default.whiteTagContainer,children:[(0,u.jsxs)("div",{className:nJ.default.whiteTag,onClick:S,children:[(0,u.jsx)("div",{className:nJ.default.avatarList,children:null==a?void 0:a.slice(0,3).map((e,l)=>{var t,i,n,o;return(0,u.jsx)("img",{src:null==e?void 0:null===(n=e.user)||void 0===n?void 0:null===(i=n.avatar)||void 0===i?void 0:null===(t=i.url_list)||void 0===t?void 0:t[0],className:nJ.default.avatar,style:{zIndex:3-l}},(null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.uid)||l)})}),P]}),r&&(0,u.jsx)("div",{className:nJ.default.recommendIconWrapper,onClick:N,children:(0,u.jsx)(n$.Z,{src:n1.Z,width:16,height:16,viewBox:"0 0 16 16"})})]}):(0,u.jsx)("div",{});default:return(0,u.jsx)("div",{})}})()}):null};var n4=t("352026"),n3=t("139002"),n5={Photo:"photo",Name:"name",Blank:"blank",Pull:"pull",Button:"button",Source:"source",Title:"title",SupportArea:"support_area",SupportAreaCard:"support_area_card"},n6={AdProduct:"product",AdBackupProduct:"backup_product"},n8={HIDDEN:-1,"-1":"HIDDEN",MINI_DARK:0,0:"MINI_DARK",MINI_LIGHT:1,1:"MINI_LIGHT",NORMAL_LIGHT:2,2:"NORMAL_LIGHT"};function n7(e){let{showTimeList:l=[],isActive:t,awemeInfo:i,needInit:n=!0}=e,o=(0,e$.n)(),a=(0,m.useRef)(!0),d=(0,m.useRef)(!1),[r,s]=(0,m.useState)(n8.HIDDEN),[u=5,c=7,v=9]=l,_=(0,y.Z)(()=>{if(!d.current){var e,l;null==o||null===(e=o.on)||void 0===e||e.call(o,ih.FP.TIMEUPDATE,p),null==o||null===(l=o.on)||void 0===l||l.call(o,ih.FP.SEEKING,h)}d.current=!0}),f=(0,y.Z)(()=>{if(d.current){var e,l;null==o||null===(e=o.off)||void 0===e||e.call(o,ih.FP.TIMEUPDATE,p),null==o||null===(l=o.off)||void 0===l||l.call(o,ih.FP.SEEKING,h)}d.current=!1}),p=(0,y.Z)(e=>{let{currentTime:l}=e||{};l>=u&&l<c?s(e=>n?n8.MINI_DARK:e<=n8.MINI_DARK?n8.MINI_DARK:e):l>=c&&l<v?s(e=>n?n8.MINI_LIGHT:e<=n8.MINI_LIGHT?n8.MINI_LIGHT:e):l>=v&&(a.current=!1,s(e=>n?n8.NORMAL_LIGHT:e<=n8.NORMAL_LIGHT?n8.NORMAL_LIGHT:e),f())}),h=(0,y.Z)(e=>{let{currentTime:l}=e;if(0!==l){s(n8.NORMAL_LIGHT),f();let e=(0,em.Rx)(i);(0,lL.E)("drag_bar",{tag:(0,lD.f)(),value:e.creative_id,log_extra:e.log_extra})}a.current=!1}),g=(0,m.useCallback)(()=>{a.current=!0,s(n8.HIDDEN)},[]),w=(0,m.useCallback)(e=>{if(!e.length)return!1;let l=!0;for(let t in e)if("number"!=typeof e[t]){l=!1;break}return l},[]),I=(0,m.useCallback)(()=>{n&&(g(),_())},[n,g,_]);return(0,ng.u)(o,ih.FP.ENDED,I),(0,m.useEffect)(()=>{n?g():r===n8.HIDDEN&&g()},[t,g]),(0,nM.Z)(()=>{g()},[i]),(0,m.useEffect)(()=>t?!w([u,c,v])||u>=c||c>=v?s(n8.NORMAL_LIGHT):o&&a.current?(_(),()=>{f()}):void 0:void 0,[o,i,t,_,f]),(0,m.useEffect)(()=>{(null==o?void 0:o.currentTime)&&p({currentTime:o.currentTime})},[o]),{displayState:r}}let n9=e=>{let l=(0,m.useRef)(null),{awemeInfo:t,isActive:i,adData:n,isHide:o=!1}=e||{},{product_title:a,product_name:d,button_background_color:r,ad_title:s,word_image_url:c,image_url:v,button_text:_}=n,f=(0,m.useRef)(0),p=eZ()((e,l)=>{if(h===n8.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(t);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedAd",cid:null==i?void 0:i.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1}),{displayState:h}=n7({awemeInfo:t,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});(0,m.useEffect)(()=>{f.current=0},[t]);let y=(0,m.useMemo)(()=>{let e="";return h===n8.MINI_DARK||h===n8.MINI_LIGHT?e=d:h===n8.NORMAL_LIGHT&&(e=a||d),e},[h,a,d]);return(0,eN.o)(()=>{let e;if(!!i)return h===n8.NORMAL_LIGHT&&f.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),f.current+=1},1e3)),()=>{clearTimeout(e)}},[i,h]),(0,m.useEffect)(()=>{["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!n[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:t.awemeId,key:e,adType:V.Z9.DisplayCard13,logId:null==t?void 0:t.logPb}})})},[n,t]),(0,u.jsx)("div",{ref:l,className:g()(n3.default.adWrapper,{[n3.default.hasTransition]:!(h===n8.HIDDEN||o),[n3.default.adWrapperHidden]:h===n8.HIDDEN||o}),id:n3.default.adWrapper,children:(0,u.jsxs)("div",{className:n3.default.adContainer,onClick:e=>p(e),children:[(0,u.jsxs)("div",{className:n3.default.adSource,onClick:e=>p(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:v,iconHeight:30,iconWidth:30,className:n3.default.adIcon}),(0,u.jsx)("span",{className:n3.default.adName,children:y})]}),h>n8.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>p(e,n5.Title),className:n3.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:n3.default.moreIcon}),(0,u.jsx)("div",{className:n3.default.split}),(0,u.jsx)("div",{className:n3.default.adTitle,children:s})]}),(0,u.jsx)("div",{className:n3.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>p(e,n5.Button),style:{background:h<=n8.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:r},children:(0,u.jsx)("span",{style:{fontWeight:500},children:_||"查看详情"})})})]})})};function oe(e){let{awemeInfo:l}=e||{},t=(0,eh.A)(l),i=(0,lk.rQ)(l);return t&&i?(0,u.jsx)(n9,(0,r._)((0,d._)({},e),{adData:i})):null}let ol=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"FeedAd",Slardar:l,children:(0,u.jsx)(oe,(0,d._)({},e))})};var ot=t("774575");let oi=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{let e=(null==t?void 0:t.min_price)?["product_name","product_title","ad_title","word_image_url","image_url","button_text","min_price","product_tags"]:["product_name","ad_title","word_image_url","image_url","button_text"];try{var i,n;let o=(0,em.Rx)(l),a=null==o?void 0:null===(i=o.lynx_components)||void 0===i?void 0:i.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);e.forEach(e=>{!t[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:e,adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:l.logPb}})}),!(null==t?void 0:t.min_price)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"min_price",adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:l.logPb}}),!(null==a?void 0:null===(n=a.lynx_raw_data)||void 0===n?void 0:n.open_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"open_url",adType:V.Z9.Live,creativeId:null==o?void 0:o.creative_id,logId:l.logPb}})}catch(e){}},[l])};var on=t("438740"),oo=t("13365");let oa=e=>{var l,t;let{adData:i,logParams:n}=e,o=null==i?void 0:null===(l=i.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(t=o.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info;(0,m.useEffect)(()=>{let e=["product_phrase","product_name","image_url","live_product_infos"];try{let l=[];e.forEach(e=>{!(null==a?void 0:a[e])&&l.push(e)}),["collection_num","return_vistors","favorable_rate","product_tags","sell_num"].every(e=>!(null==a?void 0:a[e]))&&l.push("feedback"),l.length>=e.length&&(0,lL.E)("othershow_fail",{tag:"draw_ad",value:i.creative_id,log_extra:i.log_extra}),Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{key:l,adType:V.Z9.Live,creativeId:null==i?void 0:i.creative_id,logId:null==n?void 0:n.requestId,logParams:n}})}catch(e){}},[i])};var od=t("262652"),or=t("116569"),os=e=>{let{className:l,children:t,style:i,onClick:n}=e;return(0,u.jsx)("span",{style:i,className:g()(or.default.adTag,l),onClick:n,children:t})};let ou=["不容错过的优品","值得买的好物","优选心仪好物","精选超值好货"],oc=["人气热卖","优选好物"],ov=["优选好物"],om=e=>{var l,t;let{adData:i,onClickElement:n}=e,o=null==i?void 0:null===(l=i.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(t=o.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info,r=(0,nY.As)(null==i?void 0:i.log_extra),{product_phrase:s,product_name:c,image_url:v,product_tags:_,return_vistors:f,favorable_rate:p,sell_num:h,button_text:g,button_background_color:y,live_product_infos:w}=a||{},I=(0,m.useMemo)(()=>{var e,l,t,i,o;let a;let d=s?(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_short_phrase:s}),children:s})}):null,v=(0,nY.Hy)(h)?(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",sell_num:h}),children:["爆卖",(0,nY.Hy)(h),"件"]})}):null,m=(null==_?void 0:_.length)>0?(0,u.jsx)("div",{className:od.default.tagLine,children:_.slice(0,2).map((e,l)=>(0,u.jsx)(os,{className:od.default.tag,style:0===l?{marginRight:"4px"}:{},onClick:l=>n(l,{refer:"sow",product_tags:e}),children:e},e))}):null;return(null==w?void 0:null===(e=w[0])||void 0===e?void 0:e.product_feedback)?a=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>{var l;return n(e,{refer:"sow",product_feedback:null==w?void 0:null===(l=w[0])||void 0===l?void 0:l.product_feedback})},children:null==w?void 0:null===(i=w[0])||void 0===i?void 0:i.product_feedback})}):f?a=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:f}),children:f})}):p?a=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`商品好评率${Math.round(p)}%`}),children:["商品好评率",Math.round(p),"%"]})}):(null==w?void 0:null===(l=w[0])||void 0===l?void 0:l.collection_num)&&(a=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>{var l;return n(e,{refer:"sow",product_feedback:null==w?void 0:null===(l=w[0])||void 0===l?void 0:l.collection_num})},children:null==w?void 0:null===(o=w[0])||void 0===o?void 0:o.collection_num})})),{productName:c,phrase:d,sellInfo:v,tagsElement:m,tagsText:_,feedbackInfo:a,componentIds:null==r?void 0:r.component_ids,productGallery:null==w?void 0:null===(t=w[0])||void 0===t?void 0:t.product_gallery}},[e]),x=(0,m.useMemo)(()=>{let e=ou[Math.floor(Math.random()*ou.length)];return(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:l=>n(l,{refer:"sow",live_product_info_backup:e}),children:e})})},[n]);return(0,d._)({imageUrl:v||eU.DEFAULT_AD_IMAGE_URL,isBackupImgUrl:!v,buttonText:g,buttonBackgroundColor:y,productPhrase:s,defaultPhraseElement:x},I)};function o_(e){let{timerCb:l,isActive:t,awemeInfo:i,needInit:n=!0,stopBySeeking:o=!0}=e,a=(0,e$.n)(),d=(0,m.useRef)(!0),r=(0,m.useRef)(!1),s=(0,y.Z)(e=>{let{currentTime:t}=e||{};l({currentTime:t,isSeeking:!1})}),u=(0,y.Z)(e=>{let{currentTime:t}=e;if(0!==t){o&&(v(),d.current=!1),l({currentTime:t,isSeeking:!0});let e=(0,em.Rx)(i);(null==e?void 0:e.creative_id)&&(0,lL.E)("drag_bar",{tag:(0,lD.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra})}}),c=(0,y.Z)(()=>{if(!r.current){var e,l;null==a||null===(e=a.on)||void 0===e||e.call(a,ih.FP.TIMEUPDATE,s),null==a||null===(l=a.on)||void 0===l||l.call(a,ih.FP.SEEKING,u)}r.current=!0}),v=(0,y.Z)(()=>{if(r.current){var e,l;null==a||null===(e=a.off)||void 0===e||e.call(a,ih.FP.TIMEUPDATE,s),null==a||null===(l=a.off)||void 0===l||l.call(a,ih.FP.SEEKING,u)}r.current=!1}),_=(0,m.useCallback)(()=>{d.current=!0},[]),f=(0,m.useCallback)(()=>{n&&(_(),c()),l({currentTime:0,isSeeking:!0,isEnd:!0})},[n,_,c,l]);return(0,ng.u)(a,ih.FP.ENDED,f),(0,nM.Z)(()=>{_()},[i]),(0,m.useEffect)(()=>{if(!!t){if(a&&d.current)return c(),()=>{v()}}},[a,i,t,c,v]),(0,m.useEffect)(()=>{(null==a?void 0:a.currentTime)&&s({currentTime:a.currentTime})},[a]),{stopListen:v}}var of=t("697021"),op=t("706918"),oh=t("801103"),og=t("276541"),oy=t("647571"),ow=t("474379"),oI=t("250876");t("459903"),oy.Z.use([ow.Z]);var ox=e=>{let{slideItems:l,className:t,width:i,height:n=20,isStartPlay:o=!1}=e,[a,d]=(0,m.useState)(),r=(0,m.useRef)(null);return(0,m.useEffect)(()=>{if(a&&o&&(null==l?void 0:l.length)>1){if(!r.current){var e;null==a||null===(e=a.slideNext)||void 0===e||e.call(a),r.current=setInterval(()=>{var e;null==a||null===(e=a.slideNext)||void 0===e||e.call(a)},3e3)}}else r.current&&clearInterval(r.current),r.current=null},[o,l,a]),(0,m.useEffect)(()=>()=>{r.current&&clearInterval(r.current),r.current=null},[]),(0,u.jsx)("div",{className:g()(oI.default.adSwiper,t),children:(0,u.jsx)(oh.t,{allowTouchMove:!1,direction:"vertical",slidesPerView:1,spaceBetween:0,loop:!0,onInit:d,width:i,height:n,autoplay:!1,children:l.map((e,l)=>(0,u.jsx)(og.o,{children:(0,u.jsx)("div",{className:oI.default.slideContent,children:e})},l))})})},ob=e=>{let{className:l,imageUrl:t,isBackupImgUrl:i=!1,slideItems:n,buttonText:o,onClick:a,isStartPlay:d}=e;return(0,u.jsxs)("div",{className:g()(op.default.singleLineAdCard,l),onClick:e=>a(e,{refer:n5.Blank}),children:[(0,u.jsxs)("div",{className:op.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>a(e,{refer:n5.Photo,click_type:i?n6.AdBackupProduct:n6.AdProduct}),children:(0,u.jsx)(lO.Q,{src:t,iconHeight:28,iconWidth:28,className:op.default.adIcon})}),(0,u.jsx)("div",{onClick:e=>a(e,{refer:n5.Name}),children:(0,u.jsx)(ox,{isStartPlay:d,className:op.default.swiperContainer,width:136,slideItems:n})})]}),(0,u.jsxs)("div",{className:op.default.btnBox,onClick:e=>a(e,{refer:n5.Button}),children:[(0,u.jsx)("span",{className:op.default.text,children:o}),(0,u.jsx)(nN.z,{svg:(0,u.jsx)(of.Z,{}),className:op.default.icon})]})]})},oE=t("259351"),oT=e=>{let{className:l,title:t,imageUrl:i,isBackupImgUrl:n=!1,slideItems:o,buttonText:a,buttonBgColor:d=eU.DEFAULT_BUTTON_COLOR,onClick:r,isStartPlay:s}=e;return(0,u.jsxs)("div",{className:g()(oE.default.doubleLineAdCard,l),onClick:e=>r(e,{refer:n5.Blank}),children:[(0,u.jsxs)("div",{className:oE.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>r(e,{refer:n5.Photo,click_type:n?n6.AdBackupProduct:n6.AdProduct}),children:(0,u.jsx)(lO.Q,{src:i,iconHeight:40,iconWidth:40,className:oE.default.adIcon})}),(0,u.jsxs)("div",{className:oE.default.detail,children:[(0,u.jsx)("div",{className:oE.default.title,onClick:e=>r(e,{refer:n5.Name}),children:t}),(0,u.jsx)(ox,{isStartPlay:s,className:oE.default.swiperContainer,width:108,slideItems:o})]})]}),(0,u.jsx)("div",{className:oE.default.adButton,onClick:e=>r(e,{refer:n5.Button}),style:{background:d},children:a})]})},oC=t("608845"),oS=e=>{var l;let{className:t,title:i,imageUrl:n,isBackupImgUrl:o=!1,slideItems:a,buttonText:d,buttonBgColor:r=eU.DEFAULT_BUTTON_COLOR,tags:s=[],onClick:c,isStartPlay:v}=e;return(0,u.jsxs)("div",{className:g()(oC.default.strongStyleAdCard,t),onClick:e=>c(e,{refer:n5.Blank}),children:[(0,u.jsxs)("div",{className:oC.default.adInfo,children:[(0,u.jsx)("div",{onClick:e=>c(e,{refer:n5.Photo,click_type:o?n6.AdBackupProduct:n6.AdProduct}),children:(0,u.jsx)(lO.Q,{src:n,iconHeight:72,iconWidth:72,className:oC.default.adIcon})}),(0,u.jsxs)("div",{className:oC.default.detail,children:[(0,u.jsx)("div",{className:oC.default.title,onClick:e=>c(e,{refer:n5.Name}),children:i}),(null==s?void 0:s.length)>0&&(0,u.jsx)("div",{className:oC.default.tagLine,children:null==s?void 0:null===(l=s.slice(0,2))||void 0===l?void 0:l.map((e,l)=>(0,u.jsx)(os,{className:oC.default.tag,onClick:l=>c(l,{refer:n5.Pull,product_tags:e}),children:e},l))}),(0,u.jsx)(ox,{isStartPlay:v,className:oC.default.swiperContainer,width:156,slideItems:a})]})]}),(0,u.jsx)("div",{className:oC.default.adButton,style:{background:r},onClick:e=>c(e,{refer:n5.Button}),children:d})]})},oN=e=>{let{adData:l,awemeInfo:t,isActive:i,logParams:n,isHide:o=!1}=e||{},[a,r]=(0,m.useState)(!1),[s,c]=(0,m.useState)(),[v,_]=(0,m.useState)(!1),f=(0,m.useRef)(!1),p=(0,m.useRef)(new Date().getTime()),h=(0,m.useRef)(new Date().getTime()),y=(0,m.useCallback)(eZ()((e,l)=>{var i,n;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let o=(0,em.Rx)(t);(0,lL.E)("realtime_click",(0,d._)({tag:(0,lD.f)(),value:null==o?void 0:o.creative_id,log_extra:null==o?void 0:o.log_extra,ad_extra_data:(0,d._)({show_time:new Date().getTime()-p.current,click_time:new Date().getTime()-h.current},l)},l)),B.logInstance.sendLog("productEntranceClick",{cid:null==o?void 0:o.creative_id,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(i=t.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,ot.F)(null===(n=t.authorInfo)||void 0===n?void 0:n.followStatus)?"1":"0",commodity_id:"",product_id:"",if_qianchuan_ad:1,ad_type:V.Z9.Live})},1e3,{leading:!0,trailing:!1}),[t]),w=om({adData:l,onClickElement:y}),{productName:I,phrase:x,sellInfo:b,tagsElement:E,feedbackInfo:C,componentIds:S,buttonText:N,imageUrl:P,isBackupImgUrl:A,tagsText:L,defaultPhraseElement:k}=w,j="#FE2C55",D=I||"视频同款商品",{componentType:R,adSlideItems:M}=(0,m.useMemo)(()=>{let e=null,l=[],t=[];return(null==S?void 0:S.includes(V.nw.SingleLine303))?(e=V.nw.SingleLine303,t=[x,b,E,C].filter(e=>!!e),l=[D]):(null==S?void 0:S.includes(V.nw.MultiLine303))?(e=V.nw.MultiLine303,t=[x,b,E,C].filter(e=>!!e)):(null==S?void 0:S.includes(V.nw.Detail303))&&(e=V.nw.Detail303,t=[x,b,C].filter(e=>!!e)),0===t.length?l.push(k):l=l.concat(t.slice(0,3)),{componentType:e,adSlideItems:l}},[w]),{stopListen:F}=o_({awemeInfo:t,isActive:i,timerCb:e=>{let{currentTime:l,isSeeking:t,isEnd:i}=e;(t||i)&&(r(!0),c(j),_(!0),F()),l>=5&&r(!0),l>=7&&c(j),l>=8&&(_(!0),F())}});return((0,m.useEffect)(()=>{a&&(h.current=new Date().getTime(),(0,lL.E)("othershow",{tag:(0,lD.f)(),value:l.creative_id,log_extra:l.log_extra,refer:(0,em.UV)(R)?n5.SupportAreaCard:n5.SupportArea,ad_extra_data:{card_show_duration:h.current-p.current}}))},[a]),oa({adData:l,logParams:n}),(0,m.useEffect)(()=>{if(a&&!f.current&&R){var e,l;f.current=!0;let i=(0,em.Rx)(t);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.Live,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(e=t.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,ot.F)(null===(l=t.authorInfo)||void 0===l?void 0:l.followStatus)?"1":"0",commodity_id:"",product_id:""})}},[a]),(0,m.useEffect)(()=>{f.current=!1},[t]),a)?R===V.nw.SingleLine303?(0,u.jsx)(ob,{className:g()(oo.default.adCard,{[oo.default.hidden]:o}),buttonText:"观看直播",imageUrl:P,isBackupImgUrl:A,slideItems:M,isStartPlay:v,onClick:y}):R===V.nw.MultiLine303?(0,u.jsx)(oT,{className:g()(oo.default.adCard,{[oo.default.hidden]:o}),title:D,imageUrl:P,isBackupImgUrl:A,buttonText:"观看直播",slideItems:M,buttonBgColor:s,isStartPlay:v,onClick:y}):R===V.nw.Detail303?(0,u.jsx)(oS,{className:g()(oo.default.adCard,{[oo.default.hidden]:o}),title:D,imageUrl:P,isBackupImgUrl:A,buttonText:"观看直播",tags:L&&(null==L?void 0:L.length)>0?L:ov,slideItems:M,buttonBgColor:s,isStartPlay:v,onClick:y}):null:null},oP=t("101156");let oA=e=>{let{awemeInfo:l,isActive:t,adData:i,isHide:n=!1}=e||{},{product_title:o,product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v,min_price:_=0,product_tags:f=["优选好物"]}=i,p=(0,m.useRef)(!1),h=eZ()((e,t)=>{var i,o;if(y===n8.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let a=(0,em.Rx)(l);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==a?void 0:a.creative_id,log_extra:null==a?void 0:a.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedLiveAd",cid:null==a?void 0:a.creative_id,ad_refer:t}),B.logInstance.sendLog("productEntranceClick",{cid:null==a?void 0:a.creative_id,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(i=l.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,ot.F)(null===(o=l.authorInfo)||void 0===o?void 0:o.followStatus)?"1":"0",commodity_id:"",product_id:"",if_qianchuan_ad:1,ad_type:V.Z9.Live})},1e3,{leading:!0,trailing:!1}),{displayState:y}=n7({awemeInfo:l,isActive:t,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1});(0,m.useEffect)(()=>{p.current=!1},[l]);let w=(0,m.useMemo)(()=>{let e="";return y===n8.MINI_DARK||y===n8.MINI_LIGHT?e=a:y===n8.NORMAL_LIGHT&&(e=o||a),e},[y,o,a]);return(0,m.useEffect)(()=>{if(y!==n8.HIDDEN&&!n&&!p.current){var e,t;p.current=!0;let i=(0,em.Rx)(l);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.Live,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(e=l.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,ot.F)(null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus)?"1":"0",commodity_id:"",product_id:""})}},[y,n]),oi({awemeInfo:l,adData:i}),(0,u.jsx)("div",{className:g()(n3.default.adWrapper,on.default.adWrapper,{[n3.default.hasTransition]:!(y===n8.HIDDEN||n),[n3.default.adWrapperHidden]:y===n8.HIDDEN||n}),id:n3.default.adWrapper,children:(0,u.jsxs)("div",{className:n3.default.adContainer,onClick:e=>h(e),children:[!_&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:n3.default.adSource,onClick:e=>h(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:n3.default.adIcon}),(0,u.jsx)("span",{className:n3.default.adName,children:w})]}),y>n8.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>h(e,n5.Title),className:n3.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:n3.default.moreIcon}),(0,u.jsx)("div",{className:n3.default.split}),(0,u.jsx)("div",{className:n3.default.adTitle,children:r})]})]}),!!_&&(0,u.jsxs)(u.Fragment,{children:[y<n8.NORMAL_LIGHT&&(0,u.jsxs)("div",{className:n3.default.adSource,onClick:e=>h(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:n3.default.adIcon}),(0,u.jsx)("span",{className:n3.default.adName,children:w})]}),y>n8.MINI_LIGHT&&(0,u.jsxs)("div",{className:on.default.adTitleWrapper,children:[(0,u.jsx)("div",{onClick:e=>h(e,n5.Source),children:(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:on.default.mainCover,skeletonClass:on.default.skeleton})}),(0,u.jsxs)("div",{className:on.default.info,onClick:e=>h(e,n5.Title),children:[(0,u.jsx)("span",{className:on.default.adName,children:r}),(0,u.jsx)("div",{children:f.slice(0,2).map(e=>(0,u.jsx)("span",{className:on.default.tag,children:e},e))}),(0,u.jsxs)("div",{className:on.default.price,children:[(0,u.jsx)("span",{className:on.default.unit,children:"\xa5"}),_]})]})]})]}),(0,u.jsx)("div",{className:n3.default.adButton,children:(0,u.jsxs)(lA.Button,{theme:"solid",onClick:e=>h(e,n5.Button),style:{background:y<=n8.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:[(0,u.jsx)(oP.WaveLineAnimation,{size:15}),(0,u.jsx)("span",{style:{fontWeight:500},children:v||"查看详情"})]})})]})})},oL=e=>{var l,t;let{awemeInfo:i}=e||{},n=(0,eg.hj)(i),o=(0,em.Rx)(i),a=(0,nY.As)(null==o?void 0:o.log_extra),s=null==a?void 0:a.component_ids,c=null==o?void 0:null===(l=o.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),v=null==c?void 0:null===(t=c.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info;return n&&v?(null==s?void 0:s.includes(V.nw.SingleLine303))||(null==s?void 0:s.includes(V.nw.MultiLine303))||(null==s?void 0:s.includes(V.nw.Detail303))?(0,u.jsx)(oN,(0,r._)((0,d._)({},e),{adData:o})):(0,u.jsx)(oA,(0,r._)((0,d._)({},e),{adData:v})):null},ok=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{let e=(null==t?void 0:t.min_price)?["product_name","product_title","ad_title","word_image_url","image_url","button_text","min_price","product_tags"]:["product_name","ad_title","word_image_url","image_url","button_text"];try{var i,n,o,a;let d=(0,em.Rx)(l),r=null==d?void 0:null===(i=d.lynx_components)||void 0===i?void 0:i.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);r&&e.forEach(e=>{!t[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:e,adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:l.logPb}})});let s=null==d?void 0:null===(n=d.lynx_components)||void 0===n?void 0:n.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE);!(null==s?void 0:null===(o=s.lynx_raw_data)||void 0===o?void 0:o.mixed_area_info)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"lynx_components",adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:l.logPb}}),!(null==r?void 0:null===(a=r.lynx_raw_data)||void 0===a?void 0:a.open_url)&&!d.open_url&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"open_url",adType:V.Z9.ShopVideo,creativeId:null==d?void 0:d.creative_id,logId:l.logPb}})}catch(e){}},[l])};var oj=t("551491");let oD=e=>{var l,t;let{adData:i,logParams:n}=e,o=null==i?void 0:null===(l=i.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(t=o.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info;(0,m.useEffect)(()=>{let e=["product_phrase","product_name","image_url","live_product_infos"];try{let l=[];e.forEach(e=>{!(null==a?void 0:a[e])&&l.push(e)});["product_tags","return_vistors","favorable_rate","sell_num","collection_num"].every(e=>!(null==a?void 0:a[e]))&&l.push("feedback"),l.length>=e.length&&(0,lL.E)("othershow_fail",{tag:"draw_ad",value:i.creative_id,log_extra:i.log_extra}),Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{key:l,adType:V.Z9.Live,creativeId:null==i?void 0:i.creative_id,logId:null==n?void 0:n.requestId,logParams:n}})}catch(e){}},[i])},oR=e=>{var l,t;let{adData:i,onClickElement:n}=e,o=null==i?void 0:null===(l=i.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),a=null==o?void 0:null===(t=o.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info,r=(0,nY.As)(null==i?void 0:i.log_extra),{product_phrase:s,product_name:c,image_url:v,product_tags:_,return_vistors:f,favorable_rate:p,sell_num:h,collection_num:g,button_text:y,button_background_color:w}=a||{},I=(0,m.useMemo)(()=>{let e;let l=s?(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_short_phrase:s}),children:s})}):null,t=(0,nY.Hy)(h)?(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",sell_num:h}),children:["爆卖",(0,nY.Hy)(h),"件"]})}):null,i=(null==_?void 0:_.length)>0?(0,u.jsx)("div",{className:od.default.tagLine,children:_.slice(0,2).map((e,l)=>(0,u.jsx)(os,{className:od.default.tag,style:0===l?{marginRight:"4px"}:{},onClick:l=>n(l,{refer:"sow",product_tags:e}),children:e},e))}):null;return f?e=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:f}),children:f})}):p&&Number(p)>=80?e=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`商品好评率${Math.round(p)}%`}),children:["商品好评率",Math.round(p),"%"]})}):g&&(e=(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsxs)("span",{onClick:e=>n(e,{refer:"sow",product_feedback:`${(0,nY.WM)(g)}}人收藏`}),children:[(0,nY.WM)(g),"人收藏"]})})),{productName:c,phrase:l,sellInfo:t,tagsElement:i,tagsText:_,feedbackInfo:e,componentIds:null==r?void 0:r.component_ids}},[e]),x=(0,m.useMemo)(()=>{let e=[...ou,...oc],l=e[Math.floor(Math.random()*e.length)];return(0,u.jsx)("div",{className:od.default.swiperText,children:(0,u.jsx)("span",{onClick:e=>n(e,{refer:"sow",live_product_info_backup:l}),children:l})})},[n]);return(0,d._)({imageUrl:v||eU.DEFAULT_AD_IMAGE_URL,isBackupImgUrl:!v,buttonText:y,buttonBackgroundColor:w,defaultPhraseElement:x},I)};var oM=e=>{let{adData:l,awemeInfo:t,isActive:i,logParams:n,isHide:o=!1}=e||{},a=(0,m.useRef)(!1),r=(0,m.useRef)(0),s=(0,m.useContext)(nS.Context),[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(),[p,h]=(0,m.useState)(!1),y=(0,m.useRef)(new Date().getTime()),w=(0,m.useRef)(new Date().getTime()),I=(0,ep.ZO)({rawAdData:(0,em.Rx)(t)}),x={promotion_id:null==I?void 0:I.promotion_id,product_id:null==I?void 0:I.product_id},b=(0,m.useCallback)(eZ()((e,l)=>{var i,n;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let o=(0,em.Rx)(t);(0,lL.E)("realtime_click",(0,d._)({tag:(0,lD.f)(),value:null==o?void 0:o.creative_id,log_extra:null==o?void 0:o.log_extra,ad_extra_data:(0,d._)({show_time:new Date().getTime()-y.current,click_time:new Date().getTime()-w.current},l)},l)),B.logInstance.sendLog("productEntranceClick",{cid:null==o?void 0:o.creative_id,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(i=t.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,ot.F)(null===(n=t.authorInfo)||void 0===n?void 0:n.followStatus)?"1":"0",commodity_id:x.promotion_id||"",product_id:x.product_id||"",if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo})},1e3,{leading:!0,trailing:!1}),[t,x]),E=oR({adData:l,onClickElement:b}),{productName:C,phrase:S,sellInfo:N,tagsElement:P,feedbackInfo:A,componentIds:L,buttonText:k,imageUrl:j,isBackupImgUrl:D,tagsText:R,defaultPhraseElement:M}=E,F=C||"视频同款商品",{componentType:O,adSlideItems:W}=(0,m.useMemo)(()=>{let e=null,l=[],t=[];return(null==L?void 0:L.includes(V.nw.SingleLine102))?(e=V.nw.SingleLine102,t=[S,N,P,A].filter(e=>!!e),l=[F]):(null==L?void 0:L.includes(V.nw.MultiLine102))?(e=V.nw.MultiLine102,t=[S,N,P,A].filter(e=>!!e)):(null==L?void 0:L.includes(V.nw.Detail102))&&(e=V.nw.Detail102,t=[S,N,A].filter(e=>!!e)),0===t.length?l.push(M):l=l.concat(t.slice(0,3)),{componentType:e,adSlideItems:l}},[E]),U="#FE2C55",{stopListen:H}=o_({awemeInfo:t,isActive:i,timerCb:e=>{let{currentTime:l,isSeeking:t,isEnd:i}=e;(t||i)&&(v(!0),f(U),h(!0),H()),l>=5&&v(!0),l>=7&&f(U),l>=8&&(h(!0),H())}});return((0,m.useEffect)(()=>{c&&(w.current=new Date().getTime(),(0,lL.E)("othershow",{tag:(0,lD.f)(),value:l.creative_id,log_extra:l.log_extra,refer:(0,em.UV)(O)?n5.SupportAreaCard:n5.SupportArea,ad_extra_data:{card_show_duration:w.current-y.current}}))},[c]),oD({adData:l,logParams:n}),(0,m.useEffect)(()=>{if(c&&!o&&!a.current&&O){var e,l;a.current=!0;let i=(0,em.Rx)(t);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:t.awemeId,content_id:t.awemeId,author_id:null===(e=t.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,ot.F)(null===(l=t.authorInfo)||void 0===l?void 0:l.followStatus)?"1":"0",commodity_id:x.promotion_id||"",product_id:x.product_id||""})}},[c,o]),(0,m.useEffect)(()=>{r.current=0,a.current=!1},[t]),(0,eN.o)(()=>{var e;let l;if(!!i)return p&&r.current<1&&(null==s?void 0:null===(e=s.userInfo)||void 0===e?void 0:e.isLogin)&&(l=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),r.current+=1},1e3)),()=>{clearTimeout(l)}},[i,p,s]),c)?O===V.nw.SingleLine102?(0,u.jsx)(ob,{className:g()(oj.default.adCard,{[oj.default.hidden]:o}),buttonText:k||"查看详情",imageUrl:j,isBackupImgUrl:D,slideItems:W,isStartPlay:p,onClick:b}):O===V.nw.MultiLine102?(0,u.jsx)(oT,{className:g()(oj.default.adCard,{[oj.default.hidden]:o}),title:F,imageUrl:j,isBackupImgUrl:D,buttonText:k||"查看详情",slideItems:W,buttonBgColor:_,isStartPlay:p,onClick:b}):O===V.nw.Detail102?(0,u.jsx)(oS,{className:g()(oj.default.adCard,{[oj.default.hidden]:o}),title:F,imageUrl:j,isBackupImgUrl:D,buttonText:k||"查看详情",tags:R&&(null==R?void 0:R.length)>0?R:ov,slideItems:W,buttonBgColor:_,isStartPlay:p,onClick:b}):null:null};let oF=e=>{let{awemeInfo:l,isActive:t,adData:i,isHide:n=!1}=e||{},{product_title:o,product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v,min_price:_=0,product_tags:f=["优选好物"]}=i,p=(0,m.useRef)(0),h=(0,m.useRef)(!1),y=(0,m.useContext)(nS.Context),w=(0,ep.ZO)({rawAdData:(0,em.Rx)(l)}),I={promotion_id:null==w?void 0:w.promotion_id,product_id:null==w?void 0:w.product_id},{displayState:x}=n7({awemeInfo:l,isActive:t,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),b=eZ()((e,t)=>{var i,o;if(x===n8.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let a=(0,em.Rx)(l);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==a?void 0:a.creative_id,log_extra:null==a?void 0:a.log_extra,refer:t}),B.logInstance.sendLog("productEntranceClick",{cid:null==a?void 0:a.creative_id,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(i=l.authorInfo)||void 0===i?void 0:i.uid,follow_status:(0,ot.F)(null===(o=l.authorInfo)||void 0===o?void 0:o.followStatus)?"1":"0",commodity_id:I.promotion_id||"",product_id:I.product_id||"",if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedPreviewLiveAd",cid:null==a?void 0:a.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1});(0,m.useEffect)(()=>{p.current=0,h.current=!1},[l]),(0,eN.o)(()=>{var e;let l;if(!!t)return x===n8.NORMAL_LIGHT&&p.current<1&&(null==y?void 0:null===(e=y.userInfo)||void 0===e?void 0:e.isLogin)&&(l=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),p.current+=1},1e3)),()=>{clearTimeout(l)}},[t,x,y]);let E=(0,m.useMemo)(()=>{let e="";return x===n8.MINI_DARK||x===n8.MINI_LIGHT?e=a:x===n8.NORMAL_LIGHT&&(e=o||a),e},[x,o,a]);return ok({awemeInfo:l,adData:i}),(0,m.useEffect)(()=>{if(x!==n8.HIDDEN&&!n&&!h.current){var e,t;h.current=!0;let i=(0,em.Rx)(l);B.logInstance.sendLog("productEntranceShow",{cid:null==i?void 0:i.creative_id,if_qianchuan_ad:1,ad_type:V.Z9.ShopVideo,source_page:(0,i$.mo)(),enter_from:(0,i$.mo)(),enter_from_merge:(0,T.yW)(),group_id:l.awemeId,content_id:l.awemeId,author_id:null===(e=l.authorInfo)||void 0===e?void 0:e.uid,follow_status:(0,ot.F)(null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus)?"1":"0",commodity_id:I.promotion_id||"",product_id:I.product_id||""})}},[x,n]),(0,u.jsx)("div",{className:g()(n3.default.adWrapper,on.default.adWrapper,{[n3.default.hasTransition]:!(x===n8.HIDDEN||n),[n3.default.adWrapperHidden]:x===n8.HIDDEN||n}),id:n3.default.adWrapper,children:(0,u.jsxs)("div",{className:n3.default.adContainer,onClick:e=>b(e),children:[!_&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:n3.default.adSource,onClick:e=>b(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:n3.default.adIcon}),(0,u.jsx)("span",{className:n3.default.adName,children:E})]}),x>n8.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>b(e,n5.Title),className:n3.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:n3.default.moreIcon}),(0,u.jsx)("div",{className:n3.default.split}),(0,u.jsx)("div",{className:n3.default.adTitle,children:r})]})]}),!!_&&(0,u.jsxs)(u.Fragment,{children:[x<n8.NORMAL_LIGHT&&(0,u.jsxs)("div",{className:n3.default.adSource,onClick:e=>b(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:n3.default.adIcon}),(0,u.jsx)("span",{className:n3.default.adName,children:E})]}),x>n8.MINI_LIGHT&&(0,u.jsxs)("div",{className:on.default.adTitleWrapper,children:[(0,u.jsx)("div",{onClick:e=>b(e,n5.Source),children:(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:on.default.mainCover,skeletonClass:on.default.skeleton})}),(0,u.jsxs)("div",{className:on.default.info,onClick:e=>b(e,n5.Title),children:[(0,u.jsx)("span",{className:on.default.adName,children:r}),(0,u.jsx)("div",{children:f.slice(0,2).map(e=>(0,u.jsx)("span",{className:on.default.tag,children:e},e))}),(0,u.jsxs)("div",{className:on.default.price,children:[(0,u.jsx)("span",{className:on.default.unit,children:"\xa5"}),_]})]})]})]}),(0,u.jsx)("div",{className:n3.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>b(e,n5.Button),style:{background:x<=n8.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{style:{fontWeight:500},children:v||"查看详情"})})})]})})},oB=e=>{var l,t;let{awemeInfo:i}=e||{},n=(0,m.useMemo)(()=>(0,ep.o4)(i),[i]),o=(0,em.Rx)(i),a=(0,nY.As)(null==o?void 0:o.log_extra),s=null==a?void 0:a.component_ids,c=null==o?void 0:null===(l=o.lynx_components)||void 0===l?void 0:l.find(e=>(null==e?void 0:e.lynx_type)===eU.AD_FEED_TYPE),v=(null==c?void 0:null===(t=c.lynx_raw_data)||void 0===t?void 0:t.mixed_area_info)||{product_title:null==o?void 0:o.web_title,product_name:null==o?void 0:o.web_title,button_background_color:"#E6312E",ad_title:null==o?void 0:o.title,word_image_url:eU.DEFAULT_WORD_IMAGE_URL,image_url:eU.DEFAULT_AD_IMAGE_URL,button_text:null==o?void 0:o.button_text};return n&&v?(null==s?void 0:s.includes(V.nw.SingleLine102))||(null==s?void 0:s.includes(V.nw.MultiLine102))||(null==s?void 0:s.includes(V.nw.Detail102))?(0,u.jsx)(oM,(0,r._)((0,d._)({},e),{adData:o})):(0,u.jsx)(oF,(0,r._)((0,d._)({},e),{adData:v})):null};var oO=t("553746"),oV=t("125530"),oW={SingleLine:0,0:"SingleLine",TowLine:1,1:"TowLine"};let oU=e=>{var l,t,i;let{awemeInfo:n,isActive:o,className:a}=e,{displayState:d}=function(e){let{awemeInfo:l,isActive:t}=e,i=(0,e$.n)(),n=(0,m.useRef)(!0),o=(0,m.useRef)(!1),[a,d]=(0,m.useState)(0),r=(0,m.useCallback)(()=>{if(!o.current){var e,l;null==i||null===(e=i.on)||void 0===e||e.call(i,ih.FP.TIMEUPDATE,c),null==i||null===(l=i.on)||void 0===l||l.call(i,ih.FP.SEEKING,v)}o.current=!0},[i]),s=(0,m.useCallback)(()=>{if(o.current){var e,l;null==i||null===(e=i.off)||void 0===e||e.call(i,ih.FP.TIMEUPDATE,c),null==i||null===(l=i.off)||void 0===l||l.call(i,ih.FP.SEEKING,v)}o.current=!1},[i]),u=(0,m.useCallback)(()=>{n.current=!0},[]),c=(0,m.useCallback)(e=>{let{currentTime:l}=e||{};l>=16&&(n.current=!1,d(1),s())},[i,l,s]),v=(0,m.useCallback)(e=>{let{currentTime:t}=e;t>=16&&(d(1),s());let i=(0,em.Rx)(l);(0,lL.E)("drag_bar",{tag:(0,lD.f)(),value:i.creative_id,log_extra:i.log_extra}),n.current=!1},[s,l]),_=(0,m.useCallback)(()=>{d(1),u(),r()},[r,u]);return(0,ng.u)(i,ih.FP.ENDED,_),(0,m.useEffect)(()=>{u()},[t,u]),(0,m.useEffect)(()=>{d(0),u()},[l.awemeId,u]),(0,m.useEffect)(()=>{if(!!t){if(i&&n.current)return r(),()=>{s()}}},[i,l,t,r,s]),(0,m.useEffect)(()=>{(null==i?void 0:i.currentTime)&&c({currentTime:i.currentTime})},[i]),{displayState:a}}({isActive:o,awemeInfo:n}),r=(null==n?void 0:null===(t=n.anchorInfo)||void 0===t?void 0:null===(l=t.extra)||void 0===l?void 0:l[0])||{},s=(null==r?void 0:r.tags)||[],c=d===oW.TowLine&&s.length>0;return(0,u.jsx)("div",{className:g()("xgplayer-shop-anchor",oV.default.container,oV.default.shopAnchor,{[oV.default.more]:c},a),onClick:()=>{q.emit(q.EVENT.openAdSideCard);let e=(0,em.Rx)(n);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra,refer:"button"})},children:(0,u.jsxs)("div",{className:oV.default.subContainer,children:[(0,u.jsx)(nN.z,{svg:(0,u.jsx)(oO.Z,{}),className:oV.default.icon}),(0,u.jsxs)("div",{className:oV.default.desc,children:[(0,u.jsxs)("div",{className:oV.default.firstLine,children:[null==n?void 0:null===(i=n.anchorInfo)||void 0===i?void 0:i.titleTag,(null==r?void 0:r.elastic_title)&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("span",{className:oV.default.delimiter,children:" | "})," ",null==r?void 0:r.elastic_title]})]}),c&&(0,u.jsx)("div",{className:oV.default.secondLine,children:s.map((e,l)=>(0,u.jsxs)("span",{className:oV.default.towLineItem,children:[e," ",l<s.length-1&&(0,u.jsxs)(u.Fragment,{children:[" ",(0,u.jsx)("span",{className:oV.default.delimiter,children:" | "})]})]},e))})]})]})})},oH=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"AdShopAnchor",Slardar:l,children:(0,u.jsx)(oU,(0,d._)({},e))})},oG=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{let e=(0,em.Rx)(l);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(i=>{!t[i]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:i,adType:V.Z9.Download,logId:null==l?void 0:l.logPb,creativeId:null==e?void 0:e.creative_id}})})},[t,l])};var oz=t("439018");let oZ=e=>{let{awemeInfo:l,isActive:t,adData:i,isHide:n=!1}=e||{},{product_name:o,button_background_color:a,ad_title:d,word_image_url:r,image_url:s,button_text:c}=i,v=(0,m.useRef)(0);(0,m.useEffect)(()=>{if(t){var e,i;let t=(0,em.Rx)(l),n=null==t?void 0:null===(i=t.track_url_list)||void 0===i?void 0:null===(e=i.url_list)||void 0===e?void 0:e[0];n&&(0,lj.R)(n)}},[l,t]);let{displayState:_}=n7({awemeInfo:l,isActive:t,showTimeList:[i.show_button_seconds,i.show_button_color_seconds,i.switch_style_seconds],needInit:!1}),f=eZ()((e,t)=>{if(_===n8.HIDDEN||n)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(l);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:t}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedDownloadAd",cid:null==i?void 0:i.creative_id,ad_refer:t})},1e3,{leading:!0,trailing:!1});return(0,m.useEffect)(()=>{v.current=0},[l]),(0,eN.o)(()=>{let e;if(!!t)return _===n8.NORMAL_LIGHT&&v.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),v.current+=1},1e3)),()=>{clearTimeout(e)}},[t,_]),oG({awemeInfo:l,adData:i}),(0,u.jsx)("div",{className:g()(oz.default.adWrapper,{[oz.default.hasTransition]:!(_===n8.HIDDEN||n),[oz.default.adWrapperHidden]:_===n8.HIDDEN||n}),id:oz.default.adWrapper,children:(0,u.jsxs)("div",{className:oz.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:oz.default.adSource,onClick:e=>f(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:oz.default.adIcon}),(0,u.jsx)("span",{className:oz.default.adName,children:o})]}),_>n8.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,n5.Title),className:oz.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:r,iconHeight:30,iconWidth:30,className:oz.default.moreIcon}),(0,u.jsx)("div",{className:oz.default.split}),(0,u.jsx)("div",{className:oz.default.adTitle,children:d})]}),(0,u.jsx)("div",{className:oz.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>f(e,n5.Button),style:{background:_<=n8.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:a},children:(0,u.jsx)("span",{children:c||"立即下载"})})})]})})};function oK(e){let{awemeInfo:l}=e||{},t=(0,ey.L)(l),i=(0,lk.rQ)(l);return t&&i?(0,u.jsx)(oZ,(0,r._)((0,d._)({},e),{adData:i})):null}let oQ=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"FeedDownloadAd",Slardar:l,children:(0,u.jsx)(oK,(0,d._)({},e))})};var o$=t("846768");let oY=e=>{let{awemeInfo:l,adData:t}=e;(0,m.useEffect)(()=>{var e;let i=(0,em.Rx)(l);["product_name","ad_title","word_image_url","image_url","button_text"].forEach(e=>{!t[e]&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:e,adType:V.Z9.Mp,logId:null==l?void 0:l.logPb,creativeId:null==i?void 0:i.creative_id}})});let n=(0,em.BD)(l);(null==n?void 0:null===(e=n.lynx_raw_data)||void 0===e?void 0:e.web_url)&&Y.oe.event.error({name:Y.Mo.AdCardInfoMiss,report:{awemeId:l.awemeId,key:"web_url",adType:V.Z9.Mp,logId:null==l?void 0:l.logPb,creativeId:null==i?void 0:i.creative_id}})},[t,l])},oq=e=>{let l=(0,m.useRef)(null),{awemeInfo:t,isActive:i,adData:n,isHide:o=!1}=e||{},{product_name:a,button_background_color:d,ad_title:r,word_image_url:s,image_url:c,button_text:v}=n,_=(0,m.useRef)(0),f=eZ()((e,l)=>{if(p===n8.HIDDEN||o)return;e.stopPropagation(),q.emit(q.EVENT.openAdSideCard);let i=(0,em.Rx)(t);(0,lL.E)("realtime_click",{tag:(0,lD.f)(),value:null==i?void 0:i.creative_id,log_extra:null==i?void 0:i.log_extra,refer:l}),B.logInstance.sendLog("adComponentClick",{component_name:"FeedMpAd",cid:null==i?void 0:i.creative_id,ad_refer:l})},1e3,{leading:!0,trailing:!1}),{displayState:p}=n7({awemeInfo:t,isActive:i,showTimeList:[n.show_button_seconds,n.show_button_color_seconds,n.switch_style_seconds],needInit:!1});return(0,m.useEffect)(()=>{_.current=0},[t]),(0,eN.o)(()=>{let e;if(!!i)return p===n8.NORMAL_LIGHT&&_.current<1&&(e=setTimeout(()=>{q.emit(q.EVENT.openAdSideCard,{from:"automatic"}),_.current+=1},1e3)),()=>{clearTimeout(e)}},[i,p]),oY({awemeInfo:t,adData:n}),(0,u.jsx)("div",{ref:l,className:g()(o$.default.adWrapper,{[o$.default.hasTransition]:!(p===n8.HIDDEN||o),[o$.default.adWrapperHidden]:p===n8.HIDDEN||o}),id:o$.default.adWrapper,children:(0,u.jsxs)("div",{className:o$.default.adContainer,onClick:e=>f(e),children:[(0,u.jsxs)("div",{className:o$.default.adSource,onClick:e=>f(e,n5.Source),children:[(0,u.jsx)(lO.Q,{src:c,iconHeight:30,iconWidth:30,className:o$.default.adIcon}),(0,u.jsx)("span",{className:o$.default.adName,children:a})]}),p>n8.MINI_LIGHT&&(0,u.jsxs)("div",{onClick:e=>f(e,n5.Title),className:o$.default.adTitleWrapper,children:[(0,u.jsx)(lO.Q,{src:s,iconHeight:30,iconWidth:30,className:o$.default.moreIcon}),(0,u.jsx)("div",{className:o$.default.split}),(0,u.jsx)("div",{className:o$.default.adTitle,children:r})]}),(0,u.jsx)("div",{className:o$.default.adButton,children:(0,u.jsx)(lA.Button,{theme:"solid",onClick:e=>f(e,n5.Button),style:{background:p<=n8.MINI_DARK?eU.DEFAULT_BUTTON_COLOR:d},children:(0,u.jsx)("span",{children:v||"立即试玩"})})})]})})};function oJ(e){let{awemeInfo:l}=e||{},t=(0,ew.u)(l),i=(0,lk.rQ)(l);return t&&i?(0,u.jsx)(oq,(0,r._)((0,d._)({},e),{adData:i})):null}let oX=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"FeedMpAd",Slardar:l,children:(0,u.jsx)(oJ,(0,d._)({},e))})};var o0=t("120385"),o1=t("203875");let o2="RECOMMAND_LOGIN_PROMPT_TIMESTAMP",o4=new Date().toDateString(),o3=0,o5=0,o6=0,o8=()=>{var e,l;return(null===(l=window)||void 0===l?void 0:null===(e=l.localStorage)||void 0===e?void 0:e.getItem(o2))===o4||!1},o7=async()=>{try{a=!0}catch(e){}},o9=async(e,l)=>{if(o8())return()=>null;if(void 0===a&&await o7(),o8())return()=>null;clearInterval(o);let t=()=>{e.pause()};if(o5>42e4){var i,n;l(),null===(n=window)||void 0===n||null===(i=n.localStorage)||void 0===i||i.setItem(o2,o4),clearInterval(o)}let d=()=>{o3=Date.now()},r=()=>{o3=0};return e.on(ih.FP.PLAY,d),e.on(ih.FP.PAUSE,r),o=setInterval(()=>{o3>0&&(o5+=1e3)>42e4&&clearInterval(o)},1e3),()=>{e&&(e.off(ih.FP.PLAY,d),e.off(ih.FP.PAUSE,r),e.off(ih.FP.CANPLAY,t)),o3=0,clearInterval(o)}},ae=async(e,l)=>{if(o8())return()=>null;if(void 0===a&&await o7(),o8())return()=>null;let t=()=>{e.pause()};if(++o6>15){var i,n;l(),null===(n=window)||void 0===n||null===(i=n.localStorage)||void 0===i||i.setItem(o2,o4)}return()=>{e&&e.off(ih.FP.CANPLAY,t)}},al=(0,tx.ZP)(()=>t.e("30868").then(t.bind(t,950300)),{ssr:!1}),at=(0,eB.h)(e=>{var l;let{userInfo:t,isActive:i,dispatch:n,abtestData:o}=e,{isLogin:a}=t,d=(0,e$.n)(),[r,s]=(0,m.useState)(),[c,v]=(0,m.useState)(!1);(0,m.useEffect)(()=>{!i&&s(!1)},[i]);let _=(0,m.useCallback)(()=>{s(!1),d&&d.play()},[d]),f=(0,m.useCallback)(e=>{let{enterMethod:l="video_login_guide",isVideoGuide:t="0"}=e;(0,tD.default)({success:()=>{"recommend"===(0,T.yW)()&&(null==o?void 0:o.recommendLoginResume)===H.RecommendLoginResume.V2?q.emit(q.EVENT.RecommendLoginResume):n({type:"updateUserInfo"})},enterMethod:l,teaEvtParams:{is_video_guide:t}})},[n,o]),p=(null===(l=Z.Le.getConfig(Z.gI.IsInLookMiniModal))||void 0===l?void 0:l.isInMiniModal)||!1;return(0,m.useEffect)(()=>{if(d&&i&&!1===a&&!p){let e=()=>null,l=()=>null;return(async()=>{e=await o9(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})}),l=await ae(d,()=>{var e;s(!0),q.emit(null==q?void 0:null===(e=q.EVENT)||void 0===e?void 0:e.clarityRel,{loginMaskMeeted:!0})})})(),()=>{null==e||e(),null==l||l()}}},[d,i,a]),(0,m.useEffect)(()=>{(async()=>{v(await (0,tb.isHideLoginGuide)(o))})()},[o]),!p&&!1===a&&i&&r&&!c?(0,u.jsx)(al,{handleHideMask:_,handleLoginAfter:e=>f(e)}):null},"RecommendLoginGuide");var ai=t("613369"),an=t("532005"),ao=t("802913"),aa=t("656154"),ad=new i9.h({feedDownloadButtonShow:{eventName:"feed_download_button_show",params:{group_id:"",enter_from_merge:"",enter_from:"",follow_status:""}},feedDownloadButtonClick:{eventName:"feed_download_button_click",params:{group_id:"",enter_from_merge:"",enter_from:"",follow_status:"",if_highlight:0}},addToDesktopShow:{eventName:"add_to_desktop_show",params:{enter_from:"",type:"feed_follow_post_button",platform:"client",channel_id:"",ug_channel_id:""}},addToDesktopClick:{eventName:"add_to_desktop_click",params:{enter_from:"",type:"feed_follow_post_button",platform:"client",channel_id:"",ug_channel_id:""}}}),ar=t("717864");let as=b.fp.MidHigh+20;function au(e){let{highlightShow:l,followStatus:t,awemeId:i}=e,{downloadHref:n,downloadAttr:o}=(0,ar.o)({channelId:ao.g.Notice}),a=(0,m.useCallback)(()=>{ad.sendLog("feedDownloadButtonClick",{group_id:i,enter_from:(0,T.yW)(),enter_from_merge:(0,i$.vM)(),follow_status:String(t),if_highlight:l?1:0}),ad.sendLog("addToDesktopClick",{enter_from:(0,T.yW)(),channel_id:ao.g.Notice,type:"feed_follow_post_button",ug_channel_id:Z.Le.getConfig(Z.gI.WebUgChannelId)||""});let e=document.createElement("a");e.setAttribute("href",n),e.setAttribute("download",o),e.click()},[n,o,i,t,l]);return(0,u.jsx)("div",{className:g()(aa.default.container),style:{bottom:as},children:(0,u.jsxs)("div",{className:g()(aa.default.button,{[aa.default.redColor]:l}),onClick:a,children:[(0,u.jsx)("div",{className:g()(aa.default.text),children:"及时接收作品更新提醒"}),(0,u.jsx)("div",{className:g()(aa.default.downloadTips),children:"下载电脑客户端"})]})})}let ac=(0,eB.h)(e=>{var l;let{awemeInfo:t,isActive:i}=e,[n,o]=(0,m.useState)(!1),a=(0,e$.n)();return(0,m.useEffect)(()=>{if(a){let e=()=>{a.currentTime>=5&&o(!0)};return a.on(ih.FP.TIMEUPDATE,e),()=>{a.off(ih.FP.TIMEUPDATE,e)}}},[a]),(0,m.useEffect)(()=>{if(i&&t){var e;ad.sendLog("feedDownloadButtonShow",{group_id:null==t?void 0:t.awemeId,enter_from:(0,T.yW)(),enter_from_merge:(0,i$.vM)(),follow_status:String(null==t?void 0:null===(e=t.authorInfo)||void 0===e?void 0:e.followStatus)}),ad.sendLog("addToDesktopShow",{enter_from:(0,T.yW)(),channel_id:ao.g.Notice,type:"feed_follow_post_button",ug_channel_id:Z.Le.getConfig(Z.gI.WebUgChannelId)||""})}},[i,t]),(0,u.jsx)(au,{highlightShow:n,followStatus:null==t?void 0:null===(l=t.authorInfo)||void 0===l?void 0:l.followStatus,awemeId:null==t?void 0:t.awemeId})},"PostGuideDownload");var av=t("944387"),am=t("606265"),a_=t("767585");let af=e=>{let{brandAdComponentItem:l,openUrl:t,isActive:i,awemeInfo:n,position:o="center"}=e,a=(0,e$.n)();(0,m.useEffect)(()=>{var e;let t=q.listen(q.EVENT.quitInnerFeed,()=>{var e;((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle")}),n=q.listen(q.EVENT.InnerFeedReady,()=>{var e;((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")&&(0,eb.m)("brandMiddle")});return((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("KEYBOARD")?(0,eb.o)({pauseCustomShortcut:!0,pauseGlobalShortcut:!0,pausePlayControlShortcut:!0},"brandMiddle"):(0,eb.m)("brandMiddle"),!i&&(0,eb.m)("brandMiddle"),()=>{t(),n(),(0,eb.m)("brandMiddle")}},[l,i]),(0,m.useEffect)(()=>{let e=e=>{var a,d,r,s,u,c,v,m,_,f,p;if((0,eK.j)(e.code,e.keyCode)||(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.nodeName)==="INPUT"||(null==e?void 0:null===(d=e.target)||void 0===d?void 0:d.nodeName)==="TEXTAREA"||(null==e?void 0:null===(r=e.target)||void 0===r?void 0:r.contentEditable)==="true"||!i||!l)return;let h=(null==l?void 0:null===(s=l.brand_ad_component_float_tip)||void 0===s?void 0:s.actions)||[],g=null===(u=k.s.getAllPlayer())||void 0===u?void 0:u.length;h.includes("KEYBOARD")&&1===g&&(q.emit(q.EVENT.videoPause),B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(v=n.webRawData)||void 0===v?void 0:null===(c=v.brandAd)||void 0===c?void 0:c.brand_type],img_url:null==l?void 0:null===(m=l.brand_ad_component_float_tip)||void 0===m?void 0:m.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener")),h.includes("KEYBOARD_SPACE")&&1===g&&(32===e.keyCode||"Space"===e.code)&&(B.logInstance.sendLog("brandAdIconClick",{group_id:null==n?void 0:n.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==n?void 0:null===(f=n.webRawData)||void 0===f?void 0:null===(_=f.brandAd)||void 0===_?void 0:_.brand_type],img_url:null==l?void 0:null===(p=l.brand_ad_component_float_tip)||void 0===p?void 0:p.img_url,position:o,icon_type:"image",click_method:"keyborad"}),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener"))},d=eZ()(()=>{var e,n;if(!!i&&!!l)((null==l?void 0:null===(e=l.brand_ad_component_float_tip)||void 0===e?void 0:e.actions)||[]).includes("WHEEL")&&1===(null===(n=k.s.getAllPlayer())||void 0===n?void 0:n.length)&&(q.emit(q.EVENT.videoPause),window.open(t,(0,eQ.f)()?"_self":"_blank","noopener"))},5e3,{trailing:!1});return document.addEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.addEventListener("wheel",d,!0),()=>{document.removeEventListener("keydown",e,!0),(null==a?void 0:a.root)&&a.root.removeEventListener("wheel",d,!0)}},[l,t,i,a,n,o])};var ap=t("791032");let ah=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p}=e||{},[h,y]=(0,m.useState)(!1),[w,I]=(0,m.useState)(!1),x=(0,m.useRef)(!1);o_({timerCb:e=>{if(x.current)return;let{currentTime:l,isEnd:t}=e,i=p.show_time,n=p.show_time+.5;l>=i&&y(!0),l>=n&&I(!0),t&&!x.current&&(y(!0),I(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let b=eZ()(e=>{var l,t;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null==p?void 0:p.img_url,position:"center",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"splash_ad"});return}q.emit(q.EVENT.videoPause)},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(ap.default.adWrapper,v,{[ap.default.show]:h}),style:{width:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.width,height:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.height},children:(0,u.jsxs)(eJ.a,{onClick:e=>b(e),className:ap.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:[(0,u.jsx)("img",{className:ap.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),y(!1),x.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}}),p.has_guide&&w&&(0,u.jsx)("img",{src:eX,className:ap.default.tapIcon})]})})},ag=e=>{var l,t,i,n;let{awemeInfo:o,className:a,isActive:d,onBrandComponentClose:r,onBrandComponentShow:s}=e||{},[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(!1),[p,h]=(0,m.useState)(),y=(0,m.useRef)([]),w=null==o?void 0:null===(l=o.webRawData)||void 0===l?void 0:l.brandAd;return(o_({timerCb:e=>{var l,t;let i=!1;for(let n=0;n<(null===(l=w.biz_content.brand_ad_component_config)||void 0===l?void 0:l.middle.length);n++){let l=null===(t=w.biz_content.brand_ad_component_config)||void 0===t?void 0:t.middle[n];if(void 0===l.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&l.brand_ad_component_type===V.Wy.Img){h(l),i=!0;break}}else if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&e.currentTime<=l.brand_ad_component_float_tip.disappear_time&&l.brand_ad_component_type===V.Wy.Img){h(l),i=!0;break}}!i&&h(null)},stopBySeeking:!1,awemeInfo:o,isActive:d,needInit:!0}),af({brandAdComponentItem:p,openUrl:w.open_url,isActive:d,awemeInfo:o}),(0,m.useEffect)(()=>{var e,l,t,i,n;p&&!y.current.includes(null==p?void 0:null===(e=p.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==o?void 0:null===(t=o.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"center",icon_type:"image"}),y.current.push(null===(n=p.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[p]),_||c||(null==p?void 0:p.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsx)("div",{className:g()(a,a_.default.container),style:{bottom:`${null!==(n=null===(i=p.brand_ad_component_float_tip)||void 0===i?void 0:null===(t=i.position)||void 0===t?void 0:t.bottom)&&void 0!==n?n:96}px`},children:(0,u.jsx)(ah,{awemeInfo:o,isActive:d,onBrandComponentClose:()=>{null==r||r(),f(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==o?void 0:o.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==w?void 0:w.brand_type]})},onImgError:()=>{v(!0)},brandAdComponentFloatTip:p.brand_ad_component_float_tip})})};function ay(e){var l,t,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(l=v.webRawData)||void 0===l?void 0:l.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.middle)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(t=i.brand_ad_component_float_tip)||void 0===t?void 0:t.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.middle)||void 0===r?void 0:r.length)>0?(0,u.jsx)(ag,(0,d._)({},e)):null}let aw=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"MiddleFeedBrandAd",Slardar:l,children:(0,u.jsx)(ay,(0,d._)({},e))})};var aI=t("551784"),ax=t("343341"),ab=t("190995"),aE=t("936588");let aT=e=>{var l,t,i,n;let{awemeInfo:o,isActive:a}=e,[d,r]=(0,m.useState)((null==o?void 0:null===(t=o.chargeInfo)||void 0===t?void 0:null===(l=t.preview_config)||void 0===l?void 0:l.is_preview)?null==o?void 0:null===(n=o.chargeInfo)||void 0===n?void 0:null===(i=n.preview_config)||void 0===i?void 0:i.end_time:0),[s,u]=(0,m.useState)(!1),c=(0,e$.n)(),v=(0,y.Z)(()=>{var e,l,t,i;let n=null==o?void 0:null===(l=o.chargeInfo)||void 0===l?void 0:null===(e=l.preview_config)||void 0===e?void 0:e.end_time,a=(null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(t=i.preview_config)||void 0===t?void 0:t.start_time)||0,d=Math.ceil((null==c?void 0:c.currentTime)*1e3);n>=d&&a<=d?(r(n-d),u(!1)):u(!0)}),_=(0,y.Z)(()=>{var e,l,t,i;let n=null==o?void 0:null===(l=o.chargeInfo)||void 0===l?void 0:null===(e=l.preview_config)||void 0===e?void 0:e.end_time,a=(null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(t=i.preview_config)||void 0===t?void 0:t.start_time)||0,d=Math.ceil((null==c?void 0:c.currentTime)*1e3);n>=d&&a<=d?(r(n-d),u(!1)):u(!0)}),f=(0,y.Z)(()=>{var e,l,t,i;u(!1),r((null==o?void 0:null===(l=o.chargeInfo)||void 0===l?void 0:null===(e=l.preview_config)||void 0===e?void 0:e.is_preview)?null==o?void 0:null===(i=o.chargeInfo)||void 0===i?void 0:null===(t=i.preview_config)||void 0===t?void 0:t.end_time:0)}),p=eZ()(v,200),h=(0,y.Z)(()=>{var e,l,t,i,n;(null==o?void 0:null===(l=o.chargeInfo)||void 0===l?void 0:null===(e=l.preview_config)||void 0===e?void 0:e.is_preview)&&a&&(null==c||null===(t=c.on)||void 0===t||t.call(c,ih.FP.TIMEUPDATE,p),null==c||null===(i=c.on)||void 0===i||i.call(c,ih.FP.SEEKING,_),null==c||null===(n=c.on)||void 0===n||n.call(c,ih.FP.REPLAY,f))}),g=(0,y.Z)(()=>{var e,l,t;null==c||null===(e=c.off)||void 0===e||e.call(c,ih.FP.TIMEUPDATE,p),null==c||null===(l=c.off)||void 0===l||l.call(c,ih.FP.SEEKING,_),null==c||null===(t=c.off)||void 0===t||t.call(c,ih.FP.SEEKING,f)});return(0,m.useEffect)(()=>(h(),()=>{g()}),[null==o?void 0:o.awemeId,a,c]),(0,m.useEffect)(()=>{let e=()=>{if((0,l1.zJ)(o)){var e;null==c||null===(e=c.replay)||void 0===e||e.call(c)}};if(c)return c.on("ended",e),()=>{c.off("ended",e)}},[o,c]),{previewTime:d,isPreivewFinish:s}},aC=e=>{var l;let{className:t,awemeInfo:i,isShowReplay:n=!0,isActive:o,isMiniWin:a=!1}=e,d=(0,aE.GP)(i),[r,s]=(0,m.useState)(d||!1),c=(0,e$.n)();(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.ShowPreviewPaidMask,e=>{let{isShow:l,awemeId:t,playerId:n}=e;o&&t===(null==i?void 0:i.awemeId)&&(n===(null==c?void 0:c.playerId)||!n)&&s(l)});return()=>{null==e||e()}},[o,i,c]),(0,m.useEffect)(()=>{d?s(!0):s(!1)},[i]);let{isPreivewFinish:v}=aT({awemeInfo:i,isActive:o});return((0,m.useEffect)(()=>{!v&&!a&&s(!1)},[v]),(0,m.useEffect)(()=>{a&&(v?["primary","subscribe"].includes((0,id.$m)(i))&&s(!0):!d&&s(!1))},[v,a]),!r||(null==i?void 0:null===(l=i.chargeInfo)||void 0===l?void 0:l.has_paid))?null:(0,u.jsxs)("div",{className:g()(aI.default.conatienr,t,{[aI.default.filter]:d}),children:[(0,u.jsx)(eF.Z,{src:ax.Z,width:28,height:28,viewBox:"0 0 28 28"}),(0,u.jsx)("span",{className:aI.default.title,children:"购买后可看"}),!d&&n&&(0,u.jsxs)("div",{className:aI.default.subTitle,onClick:()=>{var e,l,t,n,o,a;(null==i?void 0:null===(l=i.chargeInfo)||void 0===l?void 0:null===(e=l.preview_config)||void 0===e?void 0:e.start_time)>0?null==c||null===(o=c.seek)||void 0===o||o.call(c,(null==i?void 0:null===(n=i.chargeInfo)||void 0===n?void 0:null===(t=n.preview_config)||void 0===t?void 0:t.start_time)/1e3):null==c||null===(a=c.replay)||void 0===a||a.call(c),s(!1)},children:[(0,u.jsx)(eF.Z,{src:ab.Z,width:20,height:20,viewBox:"0 0 20 20"}),"重播"]})]})},aS=e=>{let{isActive:l,startTime:t,awemeInfo:i,isLogin:n=!1,isMiniWin:o=!1}=e,a=(0,e$.n)(),d=(0,m.useRef)(!1);return(0,m.useEffect)(()=>{if(l&&a&&n)return()=>{if((null==a?void 0:a.currentTime)>0){var e,l;let t=1e3>=Math.abs((null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)-(null==a?void 0:a.currentTime)*1e3);(0,iy.J$)({item_id:null==i?void 0:i.awemeId,item_duration:Number(null==i?void 0:null===(l=i.video)||void 0===l?void 0:l.duration),item_progress:t?0:Math.floor((null==a?void 0:a.currentTime)*1e3)})}}},[l,i,a,n]),(0,m.useEffect)(()=>{if(a&&n){let e=()=>{if(l&&(null==a?void 0:a.currentTime)>0){var e,t;let l=1e3>=Math.abs((null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)-(null==a?void 0:a.currentTime)*1e3);(0,iy.J$)({item_id:null==i?void 0:i.awemeId,item_duration:Number(null==i?void 0:null===(t=i.video)||void 0===t?void 0:t.duration),item_progress:l?0:Math.floor((null==a?void 0:a.currentTime)*1e3)})}};return a.on(ih.FP.DESTROY,e),()=>{a.off(ih.FP.DESTROY,e)}}},[a,i,l,n]),(0,m.useEffect)(()=>{if(a&&n){let e=e=>{let{currentTime:l}=e,t=Math.floor(l);if(t>=10&&t%10==0){var n;(0,tJ.qQ)(tX.LocalStorageKeys.CurrentVideoProgress,{awemeType:null==i?void 0:i.awemeType,itemId:null==i?void 0:i.awemeId,preItemDuration:Number(null==i?void 0:null===(n=i.video)||void 0===n?void 0:n.duration),preItemProgress:1e3*t})}};return a.on("timeupdate",e),()=>{a.off("timeupdate",e)}}},[a,i,n]),(0,m.useEffect)(()=>{if(a&&l&&t>=3&&n&&!o&&!d.current){let e=()=>{var e,l;null===(l=a.showPrompt)||void 0===l||l.call(a,{text:`上次播放至：${(0,nY.$y)(1e3*t)}`},{mode:"arrow",autoHide:!0,interval:3e3,preventScreenOverflow:!0,style:{left:`${1e3*t/(null==i?void 0:null===(e=i.video)||void 0===e?void 0:e.duration)*100}%`,bottom:"10px",padding:"8px 12px",borderRadius:"12px",backgroundColor:"#33343F",color:"#ffffff",fontSize:"12px",transition:"none",zIndex:"20"}}),d.current=!0};return a.once("play",e),()=>{a.off("play",e)}}if(a&&l&&t>=3&&n&&o){var e;null===(e=a.hidePrompt)||void 0===e||e.call(a)}},[a,l,t,i,n,o]),null},aN=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"RecordContinuePlay",Slardar:l,children:(0,u.jsx)(aS,(0,d._)({},e))})};t("779788");var aP=t("565024"),aA=t("730319");let aL=tX.CookieKeys.StreamPlayerStatusParams,ak=e=>aP.Q.setItem(aL,JSON.stringify(e)),aj=Z.gI.PlayerStatus,aD=e=>Z.Le.setConfig(aj,e),aR=(0,eB.h)(()=>{let e=(0,e$.n)();return(0,m.useEffect)(()=>{if(!e)return()=>{};let l=()=>{let l=function(e){var l,t;let i={},{pluginsConfig:n={}}=null!=e?e:{};return i.is_auto_play=(null===(l=n[iF.p7.AutoPlaySettingPlugin])||void 0===l?void 0:l.nextAutoPlay)||(null===(t=n[iF.p7.SearchAutoPlaySettingPlugin])||void 0===t?void 0:t.nextAutoPlay)?1:0,i.is_full_screen=(0,el.r)()?1:0,i.is_full_webscreen=k.s.getIsPageFullscreen()?1:0,i.is_mute=e.muted?1:0,i.is_speed=e.playbackRate,i.is_visible=(0,aA.d)()?1:0,i}(e);ak(l),aD(l)};l();let t=[iB.C.AutoPlaySwitchChange,ih.FP.FULLSCREEN_CHANGE,ih.FP.VOLUMECHANGE,ih.FP.RATECHANGE],i=["visibilitychange"],n=[q.EVENT.pageFullScreen];t.forEach(t=>e.on(t,l)),i.forEach(e=>document.addEventListener(e,l));let o=n.map(e=>q.listen(e,l));return()=>{t.forEach(t=>e.off(t,l)),i.forEach(e=>document.removeEventListener(e,l)),o.forEach(e=>null==e?void 0:e())}},[e]),null},"RecRawDataCookiePlugin");var aM=t("23902"),aF=t.n(aM),aB=t("18263"),aO=t("953208"),aV=t("223526"),aW=t("133764"),aU=t("161724");let aH=[x.e.Normal],aG=e=>{let{isActive:l,abtestData:t,awemeInfo:i}=e||{},n=(0,e$.n)(),o=(0,m.useMemo)(()=>{if(!aF()(t))return(0,aW.h)()},[t]),a=(0,m.useCallback)(()=>{var e,l,i,n,a;let d=window.newPlayerPreloader,r=Z.Le.getConfig(Z.gI.PreloadList)||[],s=[];null==d||null===(e=d.preloadDataList)||void 0===e||e.forEach(e=>{var l;s.push(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.vid)}),(null==d?void 0:d._wipPreloadTask)&&s.push(null==d?void 0:null===(i=d._wipPreloadTask)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.vid);let u=null!==(n=null==o?void 0:o.preloadTime)&&void 0!==n?n:5;if((null==r?void 0:r.length)>0){let e=r.filter(e=>{var l;return l=e,aH.includes(l.awemeType)&&!(null==s?void 0:s.includes(e.awemeId))}).map((e,l)=>{var i,n;let o=(0,aU.d)({awemeInfo:e,abtestData:t,enableDash:!0});return{order:l,data:{codecType:null==o?void 0:o.codecType,vid:null==e?void 0:e.awemeId,payload:null==o?void 0:null===(i=o.definition)||void 0===i?void 0:i.list,preloadTime:u,vtype:null==o?void 0:null===(n=o.protocol)||void 0===n?void 0:n.toUpperCase(),bizType:(null==e?void 0:e.isAds)?aO._6.Ad:aO._6.Normal,loadRangeType:"only_size"}}});(null==e?void 0:e.length)>0&&(null===(a=aB.wt.addPreloadList)||void 0===a||a.call(aB.wt,e))}},[i,t,o]);return(0,m.useEffect)(()=>{let e=window.newPlayerPreloader;n&&l&&e&&aV.p.postTask({task:()=>a()})},[n,l,t]),null},az=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"PreloadNew",Slardar:l,children:(0,u.jsx)(aG,(0,d._)({},e))})};var aZ=t("795012"),aK=t("515330"),aQ=t("623607"),a$=t("207806");let aY={multiPhotoSlide:{eventName:"multi_photo_slide",params:{aweme_type:x.e.Note,enter_from:"",enter_method:"",author_id:"",group_id:"",pic_cnt:0,is_zoom:!1}},enterGraphicDetail:{eventName:"enter_graphic_detail",params:{enter_from:"",author_id:"",group_id:"",pic_cnt:0}},videoPlayFinish:{eventName:"video_play_finish",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:"",open_from_page:"",multi_window_order:""}},finishTuji:{eventName:"finish_tuji",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:""}}};var aq=new i9.h(aY);let aJ=e=>{let{timeDuration:l=3e3}=e,t=(0,e$.n)(),[i,n]=(0,m.useState)(!1),o=(0,m.useRef)(),a=(0,m.useCallback)(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{n(!0),o.current=null},l)},[l]);return(0,m.useEffect)(()=>{if(null==t?void 0:t.root){var e,l,i;let d=()=>{o.current&&clearTimeout(o.current),n(!1)},r=()=>{n(!1),a()},s=()=>{n(!1),a()};return null==t||null===(e=t.root)||void 0===e||e.addEventListener("mouseenter",r),null==t||null===(l=t.root)||void 0===l||l.addEventListener("mousemove",s),null==t||null===(i=t.root)||void 0===i||i.addEventListener("mouseleave",d),()=>{var e,l,i;null==t||null===(e=t.root)||void 0===e||e.removeEventListener("mouseenter",r),null==t||null===(l=t.root)||void 0===l||l.removeEventListener("mousemove",s),null==t||null===(i=t.root)||void 0===i||i.removeEventListener("mouseleave",d)}}},[null==t?void 0:t.root,a,n]),(0,m.useEffect)(()=>()=>{o.current&&clearTimeout(o.current),o.current=null},[]),i};var aX=t("850670");function a0(e,l){return(0,m.useMemo)(()=>{let t=[];if(e&&0===e.images.length)return t;let i=-1;for(let n=0;n<e.images.length;n++){let o=e.images[n],a={type:o.video?"video":"image",start:i+1,end:i+(o.video?o.video.duration+.999:l),duration:o.video?o.video.duration:l};i=a.end,t.push(a)}return t},[e,l])}function a1(){let e=(0,e$.n)();(0,m.useEffect)(()=>{if(e)return e.getPlugin("time")&&e.unRegisterPlugin("time"),()=>{!e.destroyed&&e.registerPlugin(aX.ar,{})}},[e])}var a2=t("262648"),a4=t("436241"),a3=t("404887");let{ArrowLeft:a5,ArrowRight:a6,A:a8,D:a7}=a2.bf,a9=e=>{let l=(0,e$.n)(),{preClick:t,nextClick:i,disableShortCut:n=!1,active:o=!0}=e;return(0,m.useEffect)(()=>{if(!!o){if(l){var e,a;if(n)return(0,a3.K)(l);let o={[a5.key]:{key:a5.key,action:t,disable:!1,noBodyTarget:!1},[a8.key]:{key:a8.key,action:t,disable:!1,noBodyTarget:!1},[a7.key]:{key:a7.key,action:i,disable:!1,noBodyTarget:!1},[a6.key]:{key:a6.key,action:i,disable:!1,noBodyTarget:!1}},r=(null==l?void 0:null===(a=l.plugins)||void 0===a?void 0:null===(e=a.keyboard)||void 0===e?void 0:e.keyCodeMap)||{};return l.updatePluginConfig(iF.p7.Keyboard,{keyCodeMap:(0,d._)({},r,o)}),()=>{if(!l.destroyed){if(l.plugins.keyboard){(0,a4.v)({currentCodeMap:l.plugins.keyboard.keyCodeMap,additionalCodeMap:o});let e=l.plugins.keyboard.keyCodeMap;l.updatePluginConfig(iF.p7.Keyboard,{keyCodeMap:(0,d._)({},e||{},o)})}}}}}},[l,t,i,n,o]),null};var de=t("666026");function dl(e){let{fragments:l,currentTime:t,onClick:i}=e,n=(0,e$.n)(),o=(0,m.useMemo)(()=>{if(null==n?void 0:n.root){var e,l;return null===(l=n.root)||void 0===l?void 0:null===(e=l.querySelector)||void 0===e?void 0:e.call(l,".douyin-player-controls")}return null},[null==n?void 0:n.root]);if(!o)return null;let a=Array(l.length).fill(0);for(let e=0;e<l.length;e++){let i=l[e];if(t>i.end)a[e]=100;else if(t>=i.start){a[e]=(t-i.start)/i.duration*100;break}}return(0,iK.createPortal)((0,u.jsx)("div",{className:de.default["progress-list"],children:a.map((e,l)=>(0,u.jsxs)("div",{onClick:()=>null==i?void 0:i(l),className:`${de.default["progress-inner"]}`,children:[(0,u.jsx)("div",{className:g()(de.default["progress-played"],{[de.default.transition]:![100,0].includes(e)}),style:{width:`${e}%`}}),(0,u.jsx)("div",{className:de.default["progress-cache"]})]},l))}),o)}let dt=e=>{var l,t;let{isActive:i,awemeInfo:n,swiper:o,onPlayFinish:a,playNextFunc:r,ablePlayNext:s,playPrevFunc:c,ablePlayPrev:v,logParams:_,arrowButtonSize:f=56,isClientMiniWin:p,disableShortCut:h=!1,isShowSideBar:y=!1,inSearch:w,leftStyle:I,rightStyle:b}=e,E=(0,e$.n)(),[T,C]=(0,m.useState)(!0),[S,N]=(0,m.useState)([!0,!0]),P=(0,m.useRef)(Date.now()),A=(0,m.useRef)(0),L=(0,m.useRef)(_),k=(0,m.useRef)(!0),j=(0,m.useRef)(null),D=e=>{C(e),k.current=e},[R,M]=(0,m.useState)(0),F=aJ({});a1();let B=a0(n,3e3);L.current=_;let O=(0,m.useCallback)(e=>{var l,t;aq.sendLog("multiPhotoSlide",(0,d._)({enter_from:null===(l=L.current)||void 0===l?void 0:l.enter_from,enter_method:"click_pic",author_id:null==n?void 0:null===(t=n.authorInfo)||void 0===t?void 0:t.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,el.r)()},L.current)),N([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1]),D(!1),M(B[e].end),null==o||o.slideTo(e,0)},[o,B,n]),V=(0,m.useCallback)(e=>{if(o.activeIndex>0){var l,t;aq.sendLog("multiPhotoSlide",(0,d._)({enter_from:null===(l=L.current)||void 0===l?void 0:l.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==n?void 0:null===(t=n.authorInfo)||void 0===t?void 0:t.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,el.r)()},L.current)),D(!1),M(B[o.activeIndex-1].end),o.slidePrev(),N([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1])}},[o,B,n]),W=(0,m.useCallback)(e=>{if(o.activeIndex<o.slides.length-1){var l;aq.sendLog("multiPhotoSlide",(0,d._)({enter_from:null==_?void 0:_.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==n?void 0:null===(l=n.authorInfo)||void 0===l?void 0:l.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,el.r)()},L.current)),D(!1),M(B[o.activeIndex+1].end),o.slideNext(),N([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1])}},[o,B,n]);return(a9({preClick:V,nextClick:W,disableShortCut:h}),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=e=>{if(e){var l;aq.sendLog("enterGraphicDetail",{enter_from:null==_?void 0:_.enter_from,author_id:null==n?void 0:null===(l=n.authorInfo)||void 0===l?void 0:l.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length})}};return E.on(ih.FP.FULLSCREEN_CHANGE,e),()=>{E.off(ih.FP.FULLSCREEN_CHANGE,e)}}},[n,E]),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=E.getPlugin(iF.p7.AutoPlaySettingPlugin)||E.getPlugin(iF.p7.SearchAutoPlaySettingPlugin);if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[n,E]),(0,m.useEffect)(()=>{if(E&&(null==n?void 0:n.awemeType)===x.e.Note){let e=E.getPlugin(iF.p7.InnerAutoPlayPlugin);if(e)return e._config.innerAutoPlayWeight+=1,()=>{e._config.innerAutoPlayWeight-=1}}},[n,E]),(0,m.useEffect)(()=>{if(o){let e=!1,l=()=>{e=!1,setTimeout(()=>O(o.activeIndex))},t=()=>{D(!1),M(B[o.activeIndex].end),e||o.once("touchEnd",l),e=!0};try{o.on("touchMove",t)}catch(e){}return()=>{try{null==o||o.off("touchMove",t)}catch(e){}}}},[o,B,O]),(0,m.useEffect)(()=>{if(i&&E){if(T){P.current=Date.now()-3e3*A.current*n.images.length;let e=eZ()(()=>{iM(E)>=5e3&&(j.current(),E.off(ih.FP.TIMEUPDATE,e))},500,{leading:!0,trailing:!0}),l=()=>{var l,t,i,a;if((Date.now()-P.current)/(3e3*n.images.length)>=1){E.off(ih.FP.TIMEUPDATE,e),E.on(ih.FP.TIMEUPDATE,e),M(B[0].start),A.current=0,P.current=Date.now();let n=E.getPlugin(iF.p7.AutoPlaySettingPlugin)||E.getPlugin(iF.p7.SearchAutoPlaySettingPlugin),o=E.getPlugin(iF.p7.InnerAutoPlayPlugin);n&&(null==n?void 0:null===(l=n._config)||void 0===l?void 0:l.nextAutoPlay)&&(null==n?void 0:n.playeNextWeightNum)<=1&&s&&(null==n?void 0:n.stopFlag)===0?null==r||r():o&&(null===(t=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===t?void 0:t.modeIndex)===no.KM.Nomal&&o._config.innerAutoPlayWeight>=0&&s&&(null==o?void 0:o.stopFlag)===0?null==r||r({from:"auto"}):o&&(null===(i=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===i?void 0:i.modeIndex)===no.KM.Reverse&&o._config.innerAutoPlayWeight>=0&&v&&(null==o?void 0:o.stopFlag)===0&&(null==c||c({from:"auto"}))}else M(Date.now()-P.current);let u=Math.floor((Date.now()-P.current)/3e3);if((null==o?void 0:o.activeIndex)!==u){if(null==o?void 0:o.destroyed)return;aq.sendLog("multiPhotoSlide",(0,d._)({enter_from:null==_?void 0:_.enter_from,enter_method:"auto",author_id:null==n?void 0:null===(a=n.authorInfo)||void 0===a?void 0:a.uid,group_id:null==n?void 0:n.awemeId,pic_cnt:n.images.length,is_zoom:(0,el.r)()},L.current)),null==o||o.slideTo(u,o.activeIndex===n.images.length-1?0:250),N([(null==o?void 0:o.activeIndex)===0,(null==o?void 0:o.activeIndex)===(null==n?void 0:n.images.length)-1])}},t=()=>{P.current=Date.now()-3e3*A.current*n.images.length};return E.on(ih.FP.TIMEUPDATE,l),E.on(ih.FP.PLAY,t),()=>{E.off(ih.FP.TIMEUPDATE,l),E.off(ih.FP.PLAY,t),E.off(ih.FP.TIMEUPDATE,e)}}{let e=()=>{D(!0)};(null==E?void 0:E.paused)&&E.once(ih.FP.PLAY,e);let l=()=>{E.once(ih.FP.PLAY,e)},t=()=>{E.off(ih.FP.PLAY,e)};return E.on(ih.FP.PAUSE,l),E.on(ih.FP.ENDED,t),()=>{E.off(ih.FP.PAUSE,l),E.off(ih.FP.ENDED,t),E.off(ih.FP.PLAY,e)}}}A.current=0},[i,E,T,B,o,r,s]),(0,m.useEffect)(()=>{if(o){let e=()=>{if(o.activeIndex===(null==n?void 0:n.images.length)-1){var l,t,i,r,s,u,c,v;aq.sendLog("videoPlayFinish",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,i$.mo)(),author_id:null==n?void 0:null===(l=n.authorInfo)||void 0===l?void 0:l.uid,group_id:null==n?void 0:n.awemeId,log_pb:null==n?void 0:n.logPb,compilation_id:null==n?void 0:null===(t=n.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==n?void 0:null===(i=n.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,aZ.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(r=Z.Le.getConfig("isCollapseAuthorCard"))||void 0===r?void 0:r.isCollapseAuthorCard)?0:1,from_follow_list:(null===(s=Z.Le.getConfig("fromFollowList"))||void 0===s?void 0:s.tag)?"1":"0",is_mute:(null==E?void 0:E.muted)?"1":"0",is_force:(null===(u=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===u?void 0:u.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==n?void 0:n.isSlides)?x.e.Slides:null==n?void 0:n.awemeType,pic_cnt:null==n?void 0:null===(c=n.images)||void 0===c?void 0:c.length,is_small_window:"0",column_type:(null==_?void 0:_.column_type)||(null==_?void 0:null===(v=_.search_params)||void 0===v?void 0:v.column_type),is_selected_label:(null==n?void 0:n.weeklyRecommend)?1:0},_,(0,eo.Wc)()));try{o.off("slideChange",e)}catch(e){}null==a||a()}};try{o.slideTo(0,0),N([0===o.activeIndex,o.activeIndex===(null==n?void 0:n.images.length)-1]),o.on("slideChange",e)}catch(e){}return()=>{try{o.off("slideChange",e)}catch(e){}}}},[o,n]),(0,m.useEffect)(()=>{if(o){j.current=()=>{var e,l,t,i,o,a,r;aq.sendLog("finishTuji",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,i$.mo)(),author_id:null==n?void 0:null===(e=n.authorInfo)||void 0===e?void 0:e.uid,group_id:null==n?void 0:n.awemeId,log_pb:null==n?void 0:n.logPb,compilation_id:null==n?void 0:null===(l=n.mixInfo)||void 0===l?void 0:l.mixId,playlet_id:null==n?void 0:null===(t=n.seriesInfo)||void 0===t?void 0:t.seriesId,tab_name:(0,aZ.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(i=Z.Le.getConfig("isCollapseAuthorCard"))||void 0===i?void 0:i.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=Z.Le.getConfig("fromFollowList"))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==E?void 0:E.muted)?"1":"0",is_force:(null===(a=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==n?void 0:n.awemeType,pic_cnt:null==n?void 0:null===(r=n.images)||void 0===r?void 0:r.length,is_small_window:"0"},_)),j.current=()=>{}};let e=()=>{o.activeIndex===(null==n?void 0:n.images.length)-1&&j.current&&!k.current&&j.current()};return o.on("slideChange",e),()=>{o.off("slideChange",e)}}},[o,n]),p||(null==n?void 0:null===(l=n.images)||void 0===l?void 0:l.length)!==1)?!p&&(null==n?void 0:null===(t=n.images)||void 0===t?void 0:t.length)>1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dl,{fragments:B,currentTime:R,onClick:O}),(0,u.jsx)("div",{className:g()(a$.default.leftArrow,a$.default.arrow,{[a$.default.disabled]:S[0],[a$.default.inSideBar]:y,[a$.default.inSearch]:w,[a$.default.hide]:F,[I]:I}),style:{width:`${f}px`,height:`${f}px`},children:(0,u.jsx)(eF.Z,{src:aK.Z,width:f,height:f,viewBox:"0 0 56 56",onClick:V})}),(0,u.jsx)("div",{className:g()(a$.default.rightArrow,a$.default.arrow,{[a$.default.disabled]:S[1],[a$.default.inSideBar]:y,[a$.default.inSearch]:w,[a$.default.hide]:F,[b]:b}),style:{width:`${f}px`,height:`${f}px`},children:(0,u.jsx)(eF.Z,{src:aQ.Z,width:f,height:f,viewBox:"0 0 56 56",onClick:W})})]}):null:(0,u.jsx)(dl,{fragments:B,currentTime:R,onClick:O})};t("635303");var di=t("451118"),dn=t.p+"media/generalBG.9f4484112e793191.png",da=t.p+"media/douyinDefault.330eae8fad2b7adc.png",dd=t("452112");let dr=e=>{let{imageInfo:l,className:t,imgPlaceHolderClassName:i,isMini:n,inSearch:o,isOneLive:a,isOneLiveMix:d}=e,[r,s]=(0,m.useState)(!0),[c,v]=(0,m.useState)(!1),[_,f]=(0,m.useState)(null),[p,h]=(0,m.useState)(-1),[y,w]=(0,m.useState)(!1),I=(0,m.useRef)(0),x=(0,$.G6)(),b=(0,$.vU)();I.current=(null==l?void 0:l.width)/(null==l?void 0:l.height);let E=(0,m.useCallback)(()=>{_&&I.current&&(_.offsetWidth/I.current>_.offsetHeight-(n?0:33)?s(!0):s(!1))},[_,n]),T=(0,m.useCallback)(()=>{c||v(!0)},[c]);(0,m.useEffect)(()=>{if(_&&E){let e=di.Z.bind(_,E);return()=>{e&&e()}}},[_,E]),(0,m.useEffect)(()=>{_&&(n?_.setAttribute("normal",""):_.removeAttribute("normal"))},[_,n]),(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.notevideo,e=>{"onelive_start"===e.type&&!0===e.isMix&&w(!0),"onelive_end"===e.type&&!0===e.isMix&&w(!1)});return()=>e()},[]);let C=(0,m.useMemo)(()=>{if(c)return null;if(-1!==p)return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("img",{src:null==l?void 0:l.urlList[p],className:g()({[dd.default.baseWidth]:!r,[dd.default.baseHeight]:r,[dd.default.isSafari]:x,[dd.default.inSearch]:o},dd.default.imgPlaceHolder,i),onError:T}),(0,u.jsxs)("div",{className:g()({[dd.default.backgroundImg]:!x,[dd.default.backgroundImgFirefox]:b,[dd.default.backgroundImgSarari]:x}),children:[(0,u.jsx)("img",{src:x?dn:(null==l?void 0:l.urlList[p])||dn}),!x&&(0,u.jsx)("div",{className:dd.default.backgroundMask})]})]});{let e=new Image;e.src=null==l?void 0:l.urlList[0];let t=setTimeout(()=>{null==l||l.urlList.map((e,l)=>{let t=new Image;t.src=e,t.onload=()=>h(l)})},2e3);return e.onload=()=>{h(0),clearTimeout(t)},(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("img",{src:da,className:g()({[dd.default.baseWidth]:!r,[dd.default.baseHeight]:r,[dd.default.isSafari]:x,[dd.default.inSearch]:o},dd.default.imgPlaceHolder,i)}),(0,u.jsxs)("div",{className:g()({[dd.default.backgroundImg]:!x,[dd.default.backgroundImgFirefox]:b,[dd.default.backgroundImgSarari]:x}),children:[(0,u.jsx)("img",{src:x?dn:da}),!x&&(0,u.jsx)("div",{className:dd.default.backgroundMask})]})]})}},[c,p,T,r]);return(0,u.jsx)("div",{className:g()(t,dd.default.imgBackground,dd.default.playerShowInfo,{[dd.default.isFirefox]:b,[dd.default.livePhoto]:5===l.clipType,[dd.default.withoutProgress]:a,[dd.default.isOneLiveMix]:d,[dd.default.isInLive]:y}),ref:f,children:C})};t("455663");var ds=t("827480"),du=t("435890");let dc=e=>{let{info:l,activeIndex:t,currentIndex:i,albumMusic:n,isInPreview:o,inSearch:a,isOneLive:d}=e,r=(0,m.useRef)(),s=(0,e$.n)(),[c,v]=(0,m.useState)(!1),_=(0,m.useRef)(!1),f=(0,m.useMemo)(()=>{let e=l.video.bitRateList.find(e=>0===e.isH265);return e&&e.playAddr?e.playAddr.map(e=>({src:(0,ds.preProcessUrl)(e.src).url})).concat({src:e.playApi}):[]},[l.video]);return((0,m.useEffect)(()=>{if(s){if(t===i){if(!s.paused){var e;null===(e=r.current)||void 0===e||e.play()}}else r.current&&(r.current.paused||r.current.pause(),r.current.currentTime=0)}},[s,t,i]),(0,m.useEffect)(()=>{if(s&&t===i){let e=()=>{var e;if(!(s.currentTime<=.5)||!_.current)n.beginTime,null===(e=r.current)||void 0===e||e.play()};return s.on("play",e),()=>{s.off("play",e)}}},[s,t,i]),(0,m.useEffect)(()=>{if(s){let e=()=>{var e;if(!(s.currentTime<=.5)&&!(s.duration-s.currentTime<=.5)&&(!(n.beginTime>1e3)||!(s.currentTime-n.beginTime/1e3<=.5)&&!(n.endTime/1e3-s.currentTime<=.5)))null===(e=r.current)||void 0===e||e.pause()};return s.on("pause",e),()=>{s.off("pause",e)}}},[s]),(0,m.useEffect)(()=>{if(s){let e=()=>{_.current=!0};return s.on("ended",e),()=>{s.off("ended",e)}}},[s]),(0,m.useEffect)(()=>{if(s&&t===i){let e=q.listen(q.EVENT.notevideo,e=>{let{type:l,index:i,playerId:n}=e;r.current&&"replay"===l&&n===s.playerId&&i===t&&r.current.play()});return()=>e()}},[s,t,i]),(0,m.useEffect)(()=>{if(s){let e=q.listen(q.EVENT.notevideo,e=>{"onelive_start"===e.type&&v(!0),"onelive_end"===e.type&&v(!1)});return()=>e()}},[s]),(0,m.useEffect)(()=>{t!==i&&v(!1)},[t,i]),(0,m.useEffect)(()=>{if(s&&t===i&&r.current){.01===s.volume?r.current.volume=parseFloat(s.config.volume_raw)||0:r.current.volume=s.volume,r.current.muted=s.muted;let e=e=>{if(!0!==e.isInternalOp).01===s.volume?r.current.volume=parseFloat(s.config.volume_raw)||0:r.current.volume=s.volume,r.current.muted=s.muted};return null==s||s.on(ih.FP.VOLUMECHANGE,e),()=>{null==s||s.off(ih.FP.VOLUMECHANGE,e)}}},[s,t,i]),i-t>1||i-t<-1)?null:(0,u.jsx)("div",{className:g()(du.default.container,{[du.default.withoutProgress]:d,[du.default.inSearch]:a,[du.default.isInPreview]:o,[du.default.livePhoto]:5===l.clipType,[du.default.isInLive]:c}),children:(0,u.jsx)("video",{className:du.default.video,muted:!0,playsInline:!0,"x5-playsinline":!0,"webkit-playsinline":!0,autoPlay:!1,onPlay:()=>{q.emit(q.EVENT.notevideo,{type:"start",playerId:null==s?void 0:s.playerId,index:i}),!d&&setTimeout(()=>{v(!0)})},onEnded:()=>{q.emit(q.EVENT.notevideo,{type:"end",playerId:null==s?void 0:s.playerId,index:i}),!d&&setTimeout(()=>{v(!1)})},onTimeUpdate:()=>{var e,l;q.emit(q.EVENT.notevideo,{type:"timeupdate",playerId:null==s?void 0:s.playerId,data:(null===(e=r.current)||void 0===e?void 0:e.currentTime)*1e3,index:i}),(0,$.G6)()&&(null==s?void 0:s.paused)&&(null===(l=r.current)||void 0===l||l.pause())},ref:r,children:f.map((e,l)=>(0,u.jsx)("source",{src:e.src},l))})})},dv={singleTime:2e3,speed:250},dm=e=>{var l,t,i,n,o,a;let{isActive:s,awemeInfo:c,swiper:v,onPlayFinish:_,playNextFunc:f,ablePlayNext:p,playPrevFunc:h,ablePlayPrev:y,logParams:w,arrowButtonSize:I=56,isClientMiniWin:b,disableShortCut:E=!1,isShowSideBar:T=!1,inSearch:C,leftStyle:S,rightStyle:N}=e,P=(0,e$.n)(),[A,L]=(0,m.useState)(0),[k,j]=(0,m.useState)(!0),[D,R]=(0,m.useState)([!0,!0]),M=(0,m.useRef)(w),F=(0,m.useRef)(!0),B=(0,m.useRef)(null),O=e=>{j(e),F.current=e},V=(0,m.useRef)(null),W=(0,m.useRef)(null),U=(null==c?void 0:null===(l=c.images)||void 0===l?void 0:l.length)===1&&(null==c?void 0:null===(i=c.images)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.clipType)===5,H=U&&(null==c?void 0:null===(o=c.images)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.livePhotoType)===1,G=aJ({});a1();let z=a0(c,dv.singleTime);M.current=w;let Q=(0,m.useCallback)(e=>{L(z[e].end)},[P,z]),$=(0,m.useCallback)(e=>{var l,t;aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null===(l=M.current)||void 0===l?void 0:l.enter_from,author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:"click_pic",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),v.slideTo(e,0),O(!1),Q(e),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])},[v,Q,c]),Y=(0,m.useCallback)(e=>{if(v.activeIndex>0){var l,t;aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null===(l=M.current)||void 0===l?void 0:l.enter_from,author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),O(!1),Q(v.activeIndex-1),v.slidePrev(),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])}},[v,Q,c]),J=(0,m.useCallback)(e=>{if(v.activeIndex<v.slides.length-1){var l;aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),O(!1),Q(v.activeIndex+1),v.slideNext(),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1])}},[v,Q,c]);a9({preClick:Y,nextClick:J,disableShortCut:E}),(0,m.useEffect)(()=>{if(P&&(null==c?void 0:c.awemeType)===x.e.Note){let e=e=>{if(e){var l;aq.sendLog("enterGraphicDetail",{enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length})}};return P.on(ih.FP.FULLSCREEN_CHANGE,e),()=>{P.off(ih.FP.FULLSCREEN_CHANGE,e)}}},[c,P]),(0,m.useEffect)(()=>{if(P&&(null==c?void 0:c.awemeType)===x.e.Note){let e=P.getPlugin(iF.p7.AutoPlaySettingPlugin)||P.getPlugin(iF.p7.SearchAutoPlaySettingPlugin);if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[c,P]),(0,m.useEffect)(()=>{if(P&&(null==c?void 0:c.awemeType)===x.e.Note){let e=P.getPlugin(iF.p7.InnerAutoPlayPlugin);if(e){let l=e._config.innerAutoPlayWeight;return e._config.innerAutoPlayWeight=l<0?l-1:0,()=>{let t=e._config.innerAutoPlayWeight;e._config.innerAutoPlayWeight=t<-1?l+1:0}}}},[c,P]),(0,m.useEffect)(()=>{if(v){let e=!1,l=()=>{e=!1,setTimeout(()=>$(v.activeIndex))},t=()=>{O(!1),Q(v.activeIndex),e||v.once("touchEnd",l),e=!0};try{v.on("touchMove",t)}catch(e){}return()=>{try{null==v||v.off("touchMove",t)}catch(e){}}}},[v,Q,$]);let X=(0,m.useCallback)(()=>{var e,l,t;let i=P.getPlugin(iF.p7.AutoPlaySettingPlugin)||P.getPlugin(iF.p7.SearchAutoPlaySettingPlugin),n=P.getPlugin(iF.p7.InnerAutoPlayPlugin);i&&(null==i?void 0:null===(e=i._config)||void 0===e?void 0:e.nextAutoPlay)&&(null==i?void 0:i.playeNextWeightNum)<=1&&p&&(null==i?void 0:i.stopFlag)===0?null==f||f():n&&(null===(l=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===l?void 0:l.modeIndex)===no.KM.Nomal&&n._config.innerAutoPlayWeight>=0&&p&&(null==n?void 0:n.stopFlag)===0?null==f||f({from:"auto"}):n&&(null===(t=Z.Le.getConfig(Z.gI.InnerAutoPlay))||void 0===t?void 0:t.modeIndex)===no.KM.Reverse&&n._config.innerAutoPlayWeight>=0&&y&&(null==n?void 0:n.stopFlag)===0&&(null==h||h({from:"auto"}))},[P,y,p,h,f]);return(0,m.useEffect)(()=>{if(s&&P&&v&&k&&"video"!==z[v.activeIndex].type){let e=1e3*P.currentTime;e>100&&c.imageAlbumMusicInfo.beginTime>1e3&&(e-=c.imageAlbumMusicInfo.beginTime);let l=()=>{let l=((P.currentTime+P.duration)*1e3-e)%(1e3*P.duration);if(c.imageAlbumMusicInfo.beginTime>1e3){let{beginTime:t,endTime:i}=c.imageAlbumMusicInfo,n=i-t;l=(1e3*P.currentTime-t+n-e)%n}if(l>=dv.singleTime){var t,i,n;if(v.activeIndex===c.images.length-1){X(),L(z[0].start),R([!0,!1]),v.slideTo(0,0);let e=P.getPlugin("pictureProgress");null==e||null===(i=e.innerList)||void 0===i||i.reset(),aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(n=c.authorInfo)||void 0===n?void 0:n.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),iM(P)>=5e3&&B.current();return}L(z[v.activeIndex+1].start),R([!1,v.activeIndex+1===(null==c?void 0:c.images.length)-1]),v.slideTo(v.activeIndex+1,dv.speed),aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(t=c.authorInfo)||void 0===t?void 0:t.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType}));return}L(z[v.activeIndex].start+l)};return P.on(ih.FP.TIMEUPDATE,l),()=>{P.off(ih.FP.TIMEUPDATE,l)}}},[null==v?void 0:v.activeIndex,P,s,k,z,X]),(0,m.useEffect)(()=>{if(s&&P&&v){let e=e=>{"switch_play_pause"===e.action&&e.paused&&O(!0)};return P.on(ih.FP.USER_ACTION,e),()=>{P.off(ih.FP.USER_ACTION,e)}}},[s,P,v]),(0,m.useEffect)(()=>{if(P){let e=!1,l=!1,t=()=>{e&&q.emit(q.EVENT.notevideo,{type:"replay",playerId:P.playerId,index:v.activeIndex}),l&&X()},i=()=>{V.current&&(e=!0,clearTimeout(V.current)),W.current&&(l=!0,clearTimeout(W.current))};return P.on("play",t),P.on("pause",i),()=>{P.off("play",t),P.off("pause",i)}}},[P]),(0,m.useEffect)(()=>{if(s&&P&&v){let e=q.listen(q.EVENT.notevideo,e=>{let{type:l,data:t,index:i,playerId:n}=e;if(P.playerId===n){if("start"===l&&U&&setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"onelive_start",playerId:P.playerId,isMix:H})},100),"timeupdate"===l&&v.activeIndex===i&&L(z[v.activeIndex].start+t),"end"===l){if(U&&(q.emit(q.EVENT.notevideo,{type:"onelive_end",playerId:P.playerId,isMix:H}),H?V.current=setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:P.playerId,index:v.activeIndex})},2500):setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:P.playerId,index:v.activeIndex})},300)),k){var o,a,s;if(v.activeIndex===c.images.length-1){H?W.current=setTimeout(()=>{X()},2500):X(),L(z[0].start),R([!0,!1]),v.slideTo(0,0);let e=P.getPlugin("pictureProgress");null==e||null===(a=e.innerList)||void 0===a||a.reset(),aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(s=c.authorInfo)||void 0===s?void 0:s.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType})),iM(P)>=5e3&&B.current();return}L(z[v.activeIndex+1].start),R([!1,v.activeIndex+1===(null==c?void 0:c.images.length)-1]),v.slideTo(v.activeIndex+1,dv.speed),aq.sendLog("multiPhotoSlide",(0,r._)((0,d._)({enter_from:null==w?void 0:w.enter_from,author_id:null==c?void 0:null===(o=c.authorInfo)||void 0===o?void 0:o.uid,group_id:null==c?void 0:c.awemeId,pic_cnt:c.images.length,is_zoom:(0,el.r)()},M.current),{enter_method:"auto",aweme_type:(null==c?void 0:c.isSlides)?151:null==c?void 0:c.awemeType}))}else setTimeout(()=>{q.emit(q.EVENT.notevideo,{type:"replay",playerId:P.playerId,index:v.activeIndex})},100)}}});return()=>{e(),clearTimeout(V.current),clearTimeout(W.current)}}},[s,P,v,k,X]),(0,m.useEffect)(()=>{if(v){let e=()=>{if(v.activeIndex===(null==c?void 0:c.images.length)-1){var l,t,i,n,o,a,r,s;aq.sendLog("videoPlayFinish",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,i$.mo)(),author_id:null==c?void 0:null===(l=c.authorInfo)||void 0===l?void 0:l.uid,group_id:null==c?void 0:c.awemeId,log_pb:null==c?void 0:c.logPb,compilation_id:null==c?void 0:null===(t=c.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==c?void 0:null===(i=c.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,aZ.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(n=Z.Le.getConfig(Z.gI.IsCollapseAuthorCard))||void 0===n?void 0:n.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=Z.Le.getConfig(Z.gI.FromFollowList))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==P?void 0:P.muted)?"1":"0",is_force:(null===(a=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==c?void 0:c.isSlides)?x.e.Slides:null==c?void 0:c.awemeType,pic_cnt:null==c?void 0:null===(r=c.images)||void 0===r?void 0:r.length,is_small_window:"0",column_type:(null==w?void 0:w.column_type)||(null==w?void 0:null===(s=w.search_params)||void 0===s?void 0:s.column_type),is_selected_label:(null==c?void 0:c.weeklyRecommend)?1:0},w,(0,eo.Wc)()));try{v.off("slideChange",e)}catch(e){}null==_||_()}};try{v.slideTo(0,0),R([0===v.activeIndex,v.activeIndex===(null==c?void 0:c.images.length)-1]),v.on("slideChange",e)}catch(e){}return()=>{try{v.off("slideChange",e)}catch(e){}}}},[v,c]),(0,m.useEffect)(()=>{if(v){B.current=()=>{var e,l,t,i,n,o,a;aq.sendLog("finishTuji",(0,d._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,i$.mo)(),author_id:null==c?void 0:null===(e=c.authorInfo)||void 0===e?void 0:e.uid,group_id:null==c?void 0:c.awemeId,log_pb:null==c?void 0:c.logPb,compilation_id:null==c?void 0:null===(l=c.mixInfo)||void 0===l?void 0:l.mixId,playlet_id:null==c?void 0:null===(t=c.seriesInfo)||void 0===t?void 0:t.seriesId,tab_name:(0,aZ.zD)()||(0,K.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(i=Z.Le.getConfig(Z.gI.IsCollapseAuthorCard))||void 0===i?void 0:i.isCollapseAuthorCard)?0:1,from_follow_list:(null===(n=Z.Le.getConfig(Z.gI.FromFollowList))||void 0===n?void 0:n.tag)?"1":"0",is_mute:(null==P?void 0:P.muted)?"1":"0",is_force:(null===(o=Z.Le.getConfig(Z.gI.ForceMuted))||void 0===o?void 0:o.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==c?void 0:c.awemeType,pic_cnt:null==c?void 0:null===(a=c.images)||void 0===a?void 0:a.length,is_small_window:"0"},w)),B.current=()=>{}};let e=()=>{v.activeIndex===(null==c?void 0:c.images.length)-1&&B.current&&!F.current&&B.current()};return v.on("slideChange",e),()=>{v.off("slideChange",e)}}},[v,c]),!b&&(null==c?void 0:null===(a=c.images)||void 0===a?void 0:a.length)>1?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(dl,{fragments:z,currentTime:A,onClick:$}),(0,u.jsx)("div",{className:g()(a$.default.leftArrow,a$.default.arrow,{[a$.default.disabled]:D[0],[a$.default.inSideBar]:T,[a$.default.inSearch]:C,[a$.default.hide]:G,[S]:S}),style:{width:`${I}px`,height:`${I}px`},children:(0,u.jsx)(eF.Z,{src:aK.Z,width:I,height:I,viewBox:"0 0 56 56",onClick:Y})}),(0,u.jsx)("div",{className:g()(a$.default.rightArrow,a$.default.arrow,{[a$.default.disabled]:D[1],[a$.default.inSideBar]:T,[a$.default.inSearch]:C,[a$.default.hide]:G,[N]:N}),style:{width:`${I}px`,height:`${I}px`},children:(0,u.jsx)(eF.Z,{src:aQ.Z,width:I,height:I,viewBox:"0 0 56 56",onClick:J})})]}):null};var d_=t("208275"),df=t("153296"),dp=t("452695");let dh=e=>{var l,t,i,n,o;let{isActive:a,awemeInfo:d,playNextFunc:r,playPrevFunc:s,ablePlayPrev:c,ablePlayNext:v,logParams:_,isMini:f,isClientMiniWin:p,onPlayFinish:h,customProps:y,disableShortCut:w=!1,isShowSideBar:I=!1,inSearch:b}=e,E=(0,e$.n)(),[T,C]=(0,m.useState)(null),[S,N]=(0,m.useState)(d),{arrowButtonSize:P=56,disableInactiveCursor:A=!1,leftStyle:L,rightStyle:k}=y||{},j=(null==d?void 0:null===(l=d.images)||void 0===l?void 0:l.length)===1&&(null==d?void 0:null===(i=d.images)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.clipType)===5,D=j&&(null==d?void 0:null===(o=d.images)||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.livePhotoType)===1,R=(0,m.useMemo)(()=>{var e;if((null==d?void 0:d.awemeType)!==x.e.Note)return[];if(a)return null==d?void 0:d.images;return(null==d?void 0:null===(e=d.images)||void 0===e?void 0:e.slice(0,1))||[]},[null==d?void 0:d.images,a,null==d?void 0:d.awemeType]),M=(0,m.useMemo)(()=>{var e,l;return!!(null==d?void 0:null===(l=d.images)||void 0===l?void 0:null===(e=l.find)||void 0===e?void 0:e.call(l,e=>e.video))},[null==d?void 0:d.images]);return((0,m.useEffect)(()=>()=>C(null),[]),(0,m.useEffect)(()=>{let{beginTime:e=0,endTime:l=Number.MAX_SAFE_INTEGER}=(null==d?void 0:d.imageAlbumMusicInfo)||{},t=()=>{(E.currentTime>=l/1e3||E.currentTime<e/1e3)&&(E.currentTime=e/1e3)};return(null==d?void 0:d.awemeType)===x.e.Note&&e>=0&&l>e&&(null==E||E.on(ih.FP.TIMEUPDATE,t)),()=>{null==E||E.off(ih.FP.TIMEUPDATE,t)}},[E,d]),(0,m.useEffect)(()=>{if(a&&T&&E){var e;T.update();let l=di.Z.bind(null==T?void 0:null===(e=T.$el)||void 0===e?void 0:e[0],()=>{T.update()});return()=>{l&&l()}}},[T,a,E]),(0,m.useEffect)(()=>{N(d)},[d]),(0,eN.o)(()=>{var e,l;if(a&&E&&(null==d?void 0:null===(e=d.imageAlbumMusicInfo)||void 0===e?void 0:e.volume)===0)return E.config.volume_raw=E.volume,E.volume=.01,()=>{E.volume=E.config.volume_raw,(0,tJ.qQ)(tX.LocalStorageKeys.PLAYER_VOLUME,E.config.volume_raw),(0,dp.c)({volume:E.config.volume_raw})};!a&&E&&(null==d?void 0:null===(l=d.imageAlbumMusicInfo)||void 0===l?void 0:l.volume)===0&&E.config.volume_raw&&((0,tJ.qQ)(tX.LocalStorageKeys.PLAYER_VOLUME,E.config.volume_raw),(0,dp.c)({volume:E.config.volume_raw}))},[a,E]),(null==d?void 0:d.awemeType)!==x.e.Note)?null:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d_.t,{direction:0,onSwiper:C,className:g()(a$.default.swiperContainer,"focusPanel"),tabIndex:-1,data:R,slideKey:(e,l)=>`${null==e?void 0:e.uri}_${l}`,speed:250,children:(0,u.jsx)(df.o,{className:a$.default.pictureFeed,children:e=>{let{slideData:l,activeIndex:t,currentIndex:i}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{style:{width:"100%",height:"100%",zIndex:2,background:"transparent"},className:g()(a$.default.mask,{[a$.default.inactive]:t!==i&&A}),type:"button",onKeyDown:e=>null==e?void 0:e.preventDefault()}),(0,u.jsx)(dr,{imageInfo:l,isMini:f,className:a$.default.itemImage,inSearch:b,isOneLive:j,isOneLiveMix:D}),a&&l.video&&(0,u.jsx)(dc,{albumMusic:d.imageAlbumMusicInfo,info:l,isMini:f,activeIndex:t,currentIndex:i,inSearch:b,isOneLive:j})]})}})}),S===d&&a&&!M&&(0,u.jsx)(dt,{isActive:a,awemeInfo:d,swiper:T,onPlayFinish:h,playNextFunc:r,playPrevFunc:s,ablePlayNext:v,ablePlayPrev:c,logParams:_,arrowButtonSize:P,isClientMiniWin:p,disableShortCut:w,isShowSideBar:I,inSearch:b,leftStyle:L,rightStyle:k}),S===d&&a&&M&&(0,u.jsx)(dm,{isActive:a,awemeInfo:d,swiper:T,onPlayFinish:h,playNextFunc:r,playPrevFunc:s,ablePlayNext:v,ablePlayPrev:c,logParams:_,arrowButtonSize:P,isClientMiniWin:p,disableShortCut:w,isShowSideBar:I,inSearch:b,leftStyle:L,rightStyle:k})]})},dg=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"PictureMode",Slardar:l,children:(0,u.jsx)(dh,(0,d._)({},e))})};var dy=t("969352"),dw=t("904886"),dI=t("730894");let dx=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,isActive:c,className:v,onBrandComponentClose:_,onImgError:f,brandAdComponentFloatTip:p,onBrandComponentShow:h}=e||{},[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(!1),b=(0,m.useRef)(!1);o_({timerCb:e=>{if(b.current)return;let{currentTime:l,isEnd:t}=e,i=p.show_time,n=p.show_time+.5;l>=i&&(w(!0),null==h||h()),l>=n&&x(!0),t&&!b.current&&(w(!0),null==h||h(),x(!0))},stopBySeeking:!1,awemeInfo:s,isActive:c,needInit:!0});let E=eZ()(e=>{var l,t;if(e.stopPropagation(),B.logInstance.sendLog("brandAdIconClick",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null==p?void 0:p.img_url,position:"bottom",icon_type:"image"}),null==p?void 0:p.is_open_JX_modal){e.preventDefault(),q.emit(q.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}q.emit(q.EVENT.videoPause)},1e3,{leading:!0,trailing:!1});return(0,u.jsx)("div",{className:g()(dI.default.adWrapper,v,{[dI.default.show]:y}),style:{width:null==p?void 0:null===(l=p.img_size)||void 0===l?void 0:l.width,height:null==p?void 0:null===(t=p.img_size)||void 0===t?void 0:t.height},children:(0,u.jsx)(eJ.a,{onClick:e=>E(e),className:dI.default.adButton,style:{width:null==p?void 0:null===(i=p.img_size)||void 0===i?void 0:i.width,height:null==p?void 0:null===(n=p.img_size)||void 0===n?void 0:n.height},target:"_blank",href:null==s?void 0:null===(a=s.webRawData)||void 0===a?void 0:null===(o=a.brandAd)||void 0===o?void 0:o.open_url,children:(0,u.jsx)("img",{className:dI.default.brandImg,src:null==p?void 0:p.img_url,style:{width:null==p?void 0:null===(d=p.img_size)||void 0===d?void 0:d.width,height:null==p?void 0:null===(r=p.img_size)||void 0===r?void 0:r.height},onError:()=>{null==f||f(),w(!1),b.current=!0,null==_||_(),Y.oe.event.error({name:Y.Mo.BrandComponentError,report:{type:"img"}})}})})})},db=e=>{var l,t,i,n,o,a,d,r;let{awemeInfo:s,className:c,isActive:v,onBrandComponentClose:_,onBrandComponentShow:f}=e||{},[p,h]=(0,m.useState)(!1),[y,w]=(0,m.useState)(!1),[I,x]=(0,m.useState)(),b=(0,m.useRef)([]),E=null==s?void 0:null===(l=s.webRawData)||void 0===l?void 0:l.brandAd;return(o_({timerCb:e=>{var l,t;let i=!1;for(let n=0;n<(null===(l=E.biz_content.brand_ad_component_config)||void 0===l?void 0:l.bottom.length);n++){let l=null===(t=E.biz_content.brand_ad_component_config)||void 0===t?void 0:t.bottom[n];if(void 0===l.brand_ad_component_float_tip.disappear_time){if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&l.brand_ad_component_type===V.Wy.Img){x(l),i=!0;break}}else if(e.currentTime>=l.brand_ad_component_float_tip.show_time&&e.currentTime<=l.brand_ad_component_float_tip.disappear_time&&l.brand_ad_component_type===V.Wy.Img){x(l),i=!0;break}}!i&&(x(null),null==_||_())},stopBySeeking:!1,awemeInfo:s,isActive:v,needInit:!0}),af({brandAdComponentItem:I,openUrl:E.open_url,isActive:v,awemeInfo:s,position:"bottom"}),(0,m.useEffect)(()=>{var e,l,t,i,n;I&&!b.current.includes(null==I?void 0:null===(e=I.brand_ad_component_float_tip)||void 0===e?void 0:e.img_url)&&(B.logInstance.sendLog("brandAdIconShow",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==s?void 0:null===(t=s.webRawData)||void 0===t?void 0:null===(l=t.brandAd)||void 0===l?void 0:l.brand_type],img_url:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:i.img_url,position:"bottom",icon_type:"image"}),b.current.push(null===(n=I.brand_ad_component_float_tip)||void 0===n?void 0:n.img_url))},[I]),y||p||(null==I?void 0:I.brand_ad_component_type)!==V.Wy.Img)?null:(0,u.jsxs)("div",{className:"xgplayer-bottom-brand-ad",children:[(0,u.jsx)(eF.Z,{onClick:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},width:"46",height:"23",viewBox:"0 0 46 23",src:ie,className:dw.default.close,style:{bottom:`${null==I?void 0:null===(i=I.brand_ad_component_float_tip)||void 0===i?void 0:null===(t=i.close_btn_position)||void 0===t?void 0:t.bottom}px`,right:`${null==I?void 0:null===(o=I.brand_ad_component_float_tip)||void 0===o?void 0:null===(n=o.close_btn_position)||void 0===n?void 0:n.right}px`}}),(0,u.jsx)("div",{className:g()(c,dw.default.container),style:{bottom:null!==(r=null===(d=I.brand_ad_component_float_tip)||void 0===d?void 0:null===(a=d.position)||void 0===a?void 0:a.bottom)&&void 0!==r?r:0},children:(0,u.jsx)(dx,{awemeInfo:s,isActive:v,onBrandComponentClose:()=>{null==_||_(),w(!0),B.logInstance.sendLog("brandAdIconClose",{group_id:null==s?void 0:s.awemeId,brand_ad_type:eU.AD_LOG_MAP[null==E?void 0:E.brand_type]})},onBrandComponentShow:f,onImgError:()=>{h(!0)},brandAdComponentFloatTip:I.brand_ad_component_float_tip})})]})};function dE(e){var l,t,i,n,o,a,r,s,c;let{awemeInfo:v}=e||{},m=(0,em.Kf)(v),_=null==v?void 0:null===(l=v.webRawData)||void 0===l?void 0:l.brandAd,f=null==_?void 0:_.open_url,p=null==_?void 0:null===(a=_.biz_content)||void 0===a?void 0:null===(o=a.brand_ad_component_config)||void 0===o?void 0:null===(n=o.bottom)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(t=i.brand_ad_component_float_tip)||void 0===t?void 0:t.is_open_JX_modal;return m&&(f||p)&&(null==_?void 0:null===(c=_.biz_content)||void 0===c?void 0:null===(s=c.brand_ad_component_config)||void 0===s?void 0:null===(r=s.bottom)||void 0===r?void 0:r.length)>0?(0,u.jsx)(db,(0,d._)({},e)):null}let dT=e=>{let l=(0,iJ.N)();return(0,u.jsx)(eB.k,{componentName:"BottomFeedBrandAd",Slardar:l,children:(0,u.jsx)(dE,(0,d._)({},e))})},dC=e=>{let{player:l,isActive:t,disableShortCut:i}=e;(0,m.useEffect)(()=>{var e,n,o,a,d,r;if(!!l)i||!t?null==l||null===(o=l.plugins)||void 0===o||null===(n=o.fullscreen)||void 0===n||null===(e=n.updateConfig)||void 0===e||e.call(n,{disabled:!0}):null==l||null===(r=l.plugins)||void 0===r||null===(d=r.fullscreen)||void 0===d||null===(a=d.updateConfig)||void 0===a||a.call(d,{disabled:!1})},[i,l,t])},dS=e=>{var l,t;let{isActive:i,isNext:n,isPrev:o,isFirst:a,isLast:r,index:s,awemeInfo:c,nextAwemeInfo:v,prevAwemeInfo:_,playNextFunc:f,abtestData:p,deleteCurrentSwiper:h,toggleComment:y,onAvatarClick:I,fullScreenTarget:E,logParams:T,videoToast:C,followHandler:S,playPrevFunc:N,userInfo:P,dispatch:A,isAuthorCardShow:L,isShowRelatedCard:k,children:j,videoHashtagClassName:D,isShowGuide:R,videoTags:F,showPlaySwitch:B=!0,moreBoxShowList:O={notInterestingIcon:!0,unfollow:!0,report:!0},shortCutFiltered:W,positionBoxClassName:U,actionFollow:H,actionUnFollow:G,isInnerFeed:z,isOuterFeedSplash:K,onRelatedClick:Q,onCooperationAuthorClick:Y,isShowCooperation:q,isAdShortCut:J=!0,onShopAnchorClick:X=()=>{},onActivityCardClick:el,onDouPlusClick:et,onShopAnchorMouseEnter:ei=()=>{},onShopAnchorMouseLeave:eo=()=>{},isShowAdCard:ea=!1,sideBarShow:ed,slardarInstance:er,defaultIsPageFullScreen:es,avatarTipText:eu,LiveSliderCard:ec,onDislike:eI,disableShortCut:eE,isDislike:eS,isShowShopSideCard:eN,splashAdStatus:eP,changeSplashAdStatus:eA,onReady:eL,disableFullScreenSearchBar:ek=!1,useNewUserSoundGuide:ej,chapterProps:eD,recommendTagProps:eR,canShowListenVideo:eM=!1,listenFeedNextAwemeInfo:eF,listenFeedPrevAwemeInfo:eB,aiNoteProps:eO,config:eV,isShowAiCard:eU}=e,{isiPad:eH,isMobile:eG}=(0,M.X)(),ez=(0,e$.n)(),eZ=(0,m.useMemo)(()=>(0,l1.GP)(c),[c]),{isMainland:eK,isWebMiniWin:eQ,pipWindow:eY,isListenVideoMiniWin:eq}=(0,iu.Iq)(e=>{let{isMainland:l,isWebMiniWin:t,pipWindow:i,isListenVideoMiniWin:n}=e;return{isMainland:l,isWebMiniWin:t,pipWindow:i,isListenVideoMiniWin:n}}),{isClientMiniWin:eJ,isCssFullScreen:eX,isFullScreen:e0,setIsSideBarShowFunc:e1,setSlideVideoTab:e2}=(0,m.useContext)(eT.C),{hasChapterBar:e4}=function(e){let[l,t]=(0,m.useState)(!1),i=(0,e$.n)(),n=(0,m.useMemo)(()=>(0,im.d)(e),[e]);return(0,m.useEffect)(()=>{if(i){var e,l;let o=e=>{if((null==e?void 0:e.eventType)==="firstFrame"||i.currentTime||(0,ee.r)()){var l,a;null===(l=i.off)||void 0===l||l.call(i,ih.FP.FIRST_FRAME,o),null===(a=i.off)||void 0===a||a.call(i,ih.FP.TIMEUPDATE,o),t(n)}};return null===(e=i.on)||void 0===e||e.call(i,ih.FP.FIRST_FRAME,o),null===(l=i.on)||void 0===l||l.call(i,ih.FP.TIMEUPDATE,o),()=>{var e,l;null===(e=i.off)||void 0===e||e.call(i,ih.FP.FIRST_FRAME,o),null===(l=i.off)||void 0===l||l.call(i,ih.FP.TIMEUPDATE,o)}}},[i,n]),(0,m.useEffect)(()=>{},[]),{hasChapterBar:l}}(c),[e3,e5]=(0,m.useState)(!1),e7=(0,m.useCallback)(()=>e5(!0),[]),e9=(0,m.useCallback)(()=>e5(!1),[]);(0,m.useEffect)(()=>{z&&e5(!1)},[z]);let le=(0,m.useMemo)(()=>eQ||eJ||eq,[eQ,eJ,eq]),{enablePip:ll}=(0,l5.$)({abtestData:p,awemeInfo:c});(0,tZ.g)({player:ez,awemeInfo:c}),(0,t$.G)({player:ez,awemeInfo:c,scene:"pc_web",abtestData:p}),(0,l7.V)({awemeInfo:c}),(0,m.useEffect)(()=>{i&&!z&&Z.Le.setConfig(Z.gI.InnerAutoPlay,null)},[i,z,c]);let lt=(0,m.useMemo)(()=>(0,ex.D)(c),[c]),li=(0,m.useMemo)(()=>(0,l1.zJ)(c),[c]);(0,t6.u)({awemeInfo:c,player:ez});let{isDanmuIcon:ln,hideList:lo,isChapterIcon:la,chapterMaxWidth:ld,isAiNoteIcon:lr}=(0,tn.Cy)({isActive:i,abtestData:p,player:ez,hasChapter:e4,hasAiNote:null==eO?void 0:eO.useable,isMiniWin:le,showAutoPlay:!li,showInnerAutoplay:z&&!li,showFakeScreen:(null==c?void 0:c.awemeType)!==x.e.Note,showPlayBackRatio:(null==c?void 0:c.awemeType)!==x.e.Note,showWatchLater:lt,isClientMiniWin:eJ});(0,m.useMemo)(()=>{var e;return[...(null==O?void 0:O.notInterestingIcon)?[]:[null===(e=ev.getShortcut().dislike)||void 0===e?void 0:e.badgeText],...W||[]]},[null==O?void 0:O.notInterestingIcon,W]);let ls=(0,m.useMemo)(()=>(0,em.Jt)(c),[c]),lu=(0,m.useMemo)(()=>(0,em.gc)(c),[c]),lc=(0,m.useMemo)(()=>(0,en.p)(c),[c]),lv=eP===V.QB.Normal||!lc;(0,m.useEffect)(()=>{var e,l,t,i;if(!!a&&!!lc)return eP===V.QB.Fullscreen?((0,eb.o)({pauseCustomShortcut:!0,pausePlayControlShortcut:!0},"splashAd"),tm.DJ.pause(["close","help"]),null==ez||null===(l=ez.controls)||void 0===l||null===(e=l.hide)||void 0===e||e.call(l)):(null==ez||null===(i=ez.controls)||void 0===i||null===(t=i.show)||void 0===t||t.call(i),tm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")),()=>{tm.DJ.resume(["close","help"]),(0,eb.m)("splashAd")}},[eP]),(0,to._)({awemeInfo:c,prevAwemeInfo:_,isInnerFeedModel:z&&i});let{isShowGuideDownload:lm}=iI({abtestData:p,awemeInfo:c,isActive:i,isLogin:null==P?void 0:P.isLogin});(0,m.useEffect)(()=>{2===s&&Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!1})},[s]),(0,ts.Q)({abtestData:p,player:ez,isActive:i,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:ls&&(0,em.Gu)(c)&&J?[]:["showAdDetail"],awemeInfo:c,showAdMenu:ls&&(0,em.Gu)(c),disableShortCut:eE,disableAllNativeShortCut:eE,isClientMiniWin:eJ,pipWindow:eY,isLogin:null==P?void 0:P.isLogin}),dC({player:ez,isActive:i,disableShortCut:eE}),(0,w.C)(eC.w3.components.recommend_video),(0,l2.P)({player:ez});let{anchorList:l_,hasJingxuanActivity:lf}=(0,ir.e)({abtestData:p,awemeInfo:c}),lp=(0,io.$)({abTestData:p,awemeInfo:c})&&!lf;return(0,m.useEffect)(()=>{if(i&&!z&&ez)return(0,Z.xL)(c,ez,"show"),()=>{(0,Z.xL)(c,ez,"leave")}},[i,c,z]),(0,tK.T)({isAuthorCardShow:L,isFirst:a,isLast:r,isShowRelatedCard:k,canUseListenFeed:!0,listenFeedPrevAwemeInfo:eB,listenFeedNextAwemeInfo:eF,prevAwemeInfo:_,nextAwemeInfo:v,isInnerFeed:z,isActive:i}),null==p||p.reuseVideo,(0,u.jsxs)(u.Fragment,{children:[!ek&&(eX||e0)&&i&&!le&&(0,u.jsx)(iO,{scene:b.lT.Recommend,awemeInfo:c,abtestData:p,userInfo:P,isMiniWin:le,isActive:i,isInnerFeed:z,player:ez}),(0,u.jsx)(iV.V,{awemeInfo:c,isActive:i,timeout:(0,$.b_)()?4e3:2e3,isFirst:a}),(0,u.jsx)(iW.p,{isActive:i,onRegisterSuccess:()=>{i&&(0,l4.g)(ez)},scene:b.lT.Recommend,disableShortCut:eE}),(0,u.jsx)(iU.E,{isActive:i,awemeInfo:c,abtestData:p,userInfo:P,deleteCurrentSwiper:h,config:eV,scene:b.lT.Recommend,isNext:n,currentIndex:s}),eZ?null:(0,u.jsx)(iH.Z,{awemeInfo:c,userInfo:P,isActive:i,isNext:n,isPrev:o,logParams:T,index:s}),j,(0,u.jsx)(iG.P,{isActive:i,awemeInfo:c,abtestData:p}),lv&&(0,u.jsx)("div",{className:g()(ip.default.splashAdComponent,{[ip.default.enterTransition]:lc&&!z}),children:(0,u.jsxs)(iz.n,{isActive:i,isMiniWin:le,awemeInfo:c,className:U,from:b.lT.Recommend,children:[B&&!eJ||eQ?(0,u.jsx)(iZ.I,{playPrevFunc:N,playNextFunc:f,disablePrev:a&&!(L||k)||(L||k)&&!_,disableNext:r&&!(L||k)||(L||k)&&!v,className:g()(ip.default.playSwitchContainer,e6.m4,"filter-bg",{[ip.default.isWebMiniWinSwitch]:eQ})}):null,!eJ&&(0,u.jsx)(e8.InteractionNew,{canShowListenVideo:eM,playPrevFunc:N,playNextFunc:f,listenFeedPrevAwemeInfo:eB,listenFeedNextAwemeInfo:eF,prevAwemeInfo:_,nextAwemeInfo:v,isAuthorCardShow:L,isShowRelatedCard:k,isFirst:a,isLast:r,canUseListenFeed:!0,actionFollow:H,actionUnFollow:G,awemeInfo:c,toggleComment:e=>(!z&&(0,Z.xL)(c,ez,"clickComment"),null==y?void 0:y(e)),loginUserInfo:P,loginDispatch:A,deleteCurrentSwiper:h,fullScreenTarget:E,onAvatarClick:(e,l)=>(!z&&(0,Z.xL)(c,ez,"head"),null==I?void 0:I(e,l)),onFollowBtnClick:()=>{!z&&(0,Z.xL)(c,ez,"follow")},onShareToFriend:()=>{!z&&(0,Z.xL)(c,ez,"share")},onDouPlusClick:et,abtestData:p,videoToast:C,isActive:i,followHandler:S,reportExtraParams:T,recordPreferVideoSwitch:!z,canShowAvatarFollowBtn:!lu,canShowAvatarAdBtn:lu,canShowAvatarTip:!(ls&&(0,em.Gu)(c)),canShowDislikeTip:!0,moreBoxShowList:(0,d._)({shortcutList:!0},O),className:e6.m4,avatarTipText:eu,showMusicDetail:!(ls&&(0,em.Gu)(c)),from:b.lT.Recommend,LiveSliderCard:ec,onRelatedClick:Q,videoTags:F,onDislike:eI,isInnerFeed:z,scene:"aweme_video_feed_pc",isShowAiCard:eU,recommendTriggered:null==eR?void 0:eR.recommended,showRecommendToFriend:!!eR})]})}),ej?(0,u.jsx)(i4,{isActive:i,awemeId:null==c?void 0:c.awemeId,isShowGuide:R}):(0,u.jsx)(i3.x,{isActive:i,awemeInfo:c,abtestData:p,isShowGuide:R,scene:b.lT.Recommend}),(0,u.jsx)(i5.V,{awemeInfo:c,isActive:i}),(0,u.jsx)(ni,{awemeInfo:c,isActive:i,isUseOneCheck:z,playPrevFunc:N,playNextFunc:f,deleteCurrentSwiper:h}),z||li?null:(0,u.jsx)(nn.kL,{isActive:i,awemeInfo:c,playNextFunc:f,ablePlayNext:!(r&&!(L||k)||(L||k)&&!v),shortcutDisabled:eH||eG,scene:b.lT.Recommend}),z?(0,u.jsx)(no.Ot,{isActive:i,awemeInfo:c,playPrevFunc:N,playNextFunc:f,ablePlayPrev:!((L||k)&&!_),ablePlayNext:!((L||k)&&!v),hide:lo.some(e=>e[0]===tn.p7.InnerAutoPlayer)}):null,le?null:(0,u.jsx)(na.t,{isActive:i,userInfo:P,dispatch:A,abtestData:p,awemeInfo:c,currentIndex:s,isInnerFeed:z}),li?null:(0,u.jsx)(nd.SD,{isActive:i,awemeInfo:c,abtestData:p,isInnerFeed:z,isOutFeed:!z,hide:lo.some(e=>e[0]===tn.p7.Clear)}),lt?(0,u.jsx)(nr.v,{isActive:i,awemeInfo:c,abtest:p,isLogin:null==P?void 0:P.isLogin,loginDispatch:A,toast:C,logParams:T}):null,ll&&(0,u.jsx)(ns._,{isActive:i,awemeInfo:c,abtestData:p}),(0,u.jsx)(nu.k,{isActive:i,onVolumeShortCutChange:()=>{(0,ib.t)(ez)}}),(0,u.jsx)(nc.g,{isActive:i,abtestData:p,awemeInfo:c}),(0,u.jsx)(nv.b,{isActive:i}),(0,u.jsx)(nf,{isActive:i}),(0,u.jsx)(nh,{isActive:i,awemeInfo:c}),ls&&(0,u.jsx)(nw,{awemeInfo:c,isActive:i}),ls&&(0,u.jsx)(nk,{awemeInfo:c,toast:C,abtestData:p}),"s",(0,u.jsx)(nj.W8,{slot:iE.o.CHILDREN,disable:ls&&(0,em.Gu)(c),isActive:i,awemeInfo:c,abtest:p,logParams:T,loginBlock:!(null==P?void 0:P.isLogin)&&!eQ,loginDispatch:A,speedType:(0,$.G6)()?e_.$.Safari:e_.$.Normal}),!le&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(nD.I,{isActive:i,fullScreenTarget:E,abtestData:p,isLogin:!!(null==P?void 0:P.isLogin),loginDispatch:A}),(0,u.jsx)(lb.Danmaku,{isActive:i,awemeInfo:c,userInfo:P,loginDispatch:A,abtestData:p,isDanmuIcon:ln}),(0,u.jsx)(lE.e,{isActive:i,awemeInfo:c,abtestData:p,aiNoteProps:eO,isAiNoteIcon:lr}),e4&&(0,u.jsx)(nz,{isActive:i,userInfo:P,awemeInfo:c,isChapterIcon:la,chapterProps:eD,chapterMaxWidth:ld}),(0,u.jsx)(nZ.V,{awemeInfo:c,logParams:T,isActive:i,defaultIsPageFullScreen:es}),(0,u.jsxs)(nK.r,{children:[!!(lv&&lp&&!(null==eR?void 0:eR.recommendTagType))&&(0,u.jsx)(io.n,{scene:"player",awemeInfo:c}),!!(lv&&!(0,id.$m)(c)&&(null==eR?void 0:eR.recommendTagType)&&!(null==eR?void 0:eR.isShowVideoInfoSideCard))&&(0,u.jsx)(n2,(0,d._)({userInfo:P,awemeInfo:c,player:ez,abTestData:p},eR)),!lc&&l_.length>0&&(0,u.jsx)(is.E,{awemeInfo:c,anchorList:l_,openActivityCard:el,abtestData:p}),eK&&!e3&&lv&&(0,ef.n)(c)&&!(0,ep.o4)(c)&&(0,u.jsx)(n4.n,{awemeInfo:c,onClick:X,isActive:i,onMouseEnter:ei,onMouseLeave:eo}),(0,eh.A)(c)&&(0,u.jsx)(ol,{isActive:i,awemeInfo:c,isHide:ea}),(0,eg.hj)(c)&&(0,em.Gu)(c)&&(0,u.jsx)(oL,{isActive:i,awemeInfo:c}),(0,ep.o4)(c)&&(0,em.Gu)(c)&&(0,u.jsx)(oB,{isHide:eN,isActive:i,awemeInfo:c}),(0,ep.o4)(c)&&!(0,em.Gu)(c)&&(0,u.jsx)(oH,{isActive:i,awemeInfo:c}),(0,ey.L)(c)&&(0,u.jsx)(oQ,{isActive:i,awemeInfo:c,isHide:ea}),(0,ew.u)(c)&&(0,u.jsx)(oX,{isActive:i,awemeInfo:c,isHide:ea}),lv&&(0,u.jsx)("div",{className:g()(ip.default.splashAdComponent,{[ip.default.enterTransition]:lc&&!z}),children:(0,u.jsx)(lQ.VideoInfoNew,{isActive:i,awemeInfo:c,userInfo:P,scene:b.lT.Recommend,isTopicLinkSearchResult:!0,videoHashtagClassName:D,videoTags:F||[],abTestData:p,isShowCreateTime:z||ed||!(ls&&(0,em.Gu)(c)||lc),canMixListen:!z,isInnerFeed:z,showGuideDownloadClient:lm,loginUserInfo:P,loginDispatch:A,fullScreenTarget:E,reportExtraParams:T,onCooperationAuthorClick:Y,isShowCooperation:q,showSideBar:ed,isShowBrandComponent:e3,onBrandComponentHide:e9,onBrandComponentShow:e7,onClickUserName:()=>{!z&&(0,Z.xL)(c,ez,"head")}})}),(0,u.jsx)(l$.H,{isActive:i,isAdAweme:ls,awemeInfo:c,abtestData:p,toast:C,playNextFunc:f})]}),lv?(0,u.jsx)(o0.h,{awemeInfo:c,isActive:i,userInfo:P,disableShortCut:eE,abtestData:p}):null,!eJ&&(0,u.jsx)(o1.q,{isActive:i,abtestData:p,isSliderVideo:!0,isKeyWorkCancalLike:!0,shortcutExclude:(0,em.Gu)(c)&&ls&&J?[]:["showAdDetail"],awemeInfo:c,showEnterDetail:!(ls&&(0,em.Gu)(c)),showAdMenu:ls&&(0,em.Gu)(c),disableShortCut:eE,userInfo:P,directJumpToUser:!1,showRecommendToFriend:!!eR}),eS?null:(0,u.jsx)(at,{isActive:i,userInfo:P,dispatch:A,abtestData:p}),!le&&(null==lo?void 0:lo.length)>0&&(0,u.jsx)(ai.g,{isActive:i,awemeInfo:c,hideList:lo,dispatch:A,abtestData:p,userInfo:P,isAdAweme:ls}),(0,u.jsx)(an.I,{isActive:i,awemeInfo:c,logParams:T}),lm?(0,u.jsx)(ac,{isActive:i,awemeInfo:c}):null,(0,u.jsx)(av.P,{isActive:i,controlHeight:b.fp.MidHigh,isMini:le})]}),(0,u.jsx)(am.t,{awemeInfo:c,isActive:i}),!!(!le&&lc&&a&&eP===V.QB.Fullscreen)&&(0,u.jsx)(eW,{awemeInfo:c,playNextFunc:()=>{null==eA||eA(V.QB.Normal),f()}}),!le&&lc&&a&&!z&&(0,u.jsx)(aw,{isActive:i,awemeInfo:c,onBrandComponentShow:()=>{},onBrandComponentClose:()=>{}}),!le&&(0,em.Kf)(c)&&!z&&(0,u.jsx)(dT,{isActive:i,awemeInfo:c,onBrandComponentShow:()=>{e5(!0)},onBrandComponentClose:()=>{e5(!1)}}),(null==c?void 0:null===(l=c.chargeInfo)||void 0===l?void 0:l.is_charge_content)&&(0,u.jsx)(aC,{awemeInfo:c,isActive:i,isMiniWin:le,isShowReplay:!le}),(null==c?void 0:null===(t=c.video)||void 0===t?void 0:t.duration)>18e4&&(0,u.jsx)(aN,{awemeInfo:c,isActive:i,isLogin:null==P?void 0:P.isLogin,isMiniWin:le}),i&&(0,u.jsx)(aR,{}),eQ&&(0,u.jsx)(tU.U,{awemeInfo:c}),(0,u.jsx)(az,{isActive:i,abtestData:p,awemeInfo:c}),(null==c?void 0:c.awemeType)===x.e.Note?(0,u.jsx)(dg,{isActive:i,awemeInfo:c,abTestData:p,logParams:T,playNextFunc:f,playPrevFunc:N,isClientMiniWin:eJ,ablePlayPrev:!((L||k)&&!_),ablePlayNext:!((L||k)&&!v),disableShortCut:eE,isShowSideBar:ed}):null]})},dN=(0,m.memo)((0,m.forwardRef)((e,l)=>{var t;let{awemeInfo:i,abtestData:n,isActive:o,onPlayer:a,hasPlaceholder:s=!0,isPrev:c,isNext:v}=e,{isListenVideoMiniWin:_}=(0,iu.Iq)(e=>{let{isListenVideoMiniWin:l}=e;return{isListenVideoMiniWin:l}}),f=(0,m.useRef)(null),p=(0,m.useMemo)(()=>(0,en.p)(i),[i]),h=(0,m.useMemo)(()=>(0,iT.i)({awemeInfo:i,abtestData:n,enableDash:!0,scene:b.lT.Recommend}),[i,n]),y=(0,m.useMemo)(()=>o||c||v,[o,c,v]);return(0,m.useImperativeHandle)(l,()=>{var e;return{getPlayer:()=>f.current.getPlayer(),player:null===(e=f.current)||void 0===e?void 0:e.player}}),(0,u.jsxs)(ix.N,{config:h,isInitPlayer:y,style:(0,d._)({height:"100%",width:"100%"},_?{display:"none"}:{}),className:g()(ip.default.container,"MediaNotSupportStyle","lowPopup","douyin-recommend-player",{"chapter-player-style":(0,im.d)(i)}),ref:f,scene:b.lT.Recommend,onPlayerCreated:a,abtestData:n,enableProgressPlugin:!(0,i_.gi)(i),children:[(null==n?void 0:null===(t=n.recCoverOptim)||void 0===t?void 0:t.cover)||!s||p?null:(0,u.jsx)(dy._,{awemeInfo:i,isActive:o,controlHeight:p?b.fp.SplashControls:b.fp.MidHigh,abtestData:n,slot:iE.o.START}),(0,u.jsx)(dS,(0,r._)((0,d._)({},e),{config:h,slot:iE.o.CHILDREN}))]})}));var dP=t("140447"),dA=t("543763"),dL=t("250103"),dk=t("114746"),dj=t("842602");let dD=e=>{let{log:l,isFromLynx:t,getLynxInfo:i}=(0,t2.H)(),{swiper:n,setAwemeInfoList:o,changeSplashAdStatus:a}=e,d=(0,m.useCallback)(e=>{l("useAwemeInfoListByLynx updateAwemeInfoList"),null==o||o((0,dj.TN)({awemeList:e}))},[o]);(0,F.C)(()=>{let e=q.listen(q.EVENT.changeLynxAwemeList,d);return()=>{null==e||e()}},[d]),(0,m.useEffect)(()=>{t()&&(l("usePlayByLynx changeSplashAdStatus"),null==a||a(V.QB.Normal))},[a,t]);let[r,s]=(0,m.useState)(0),u=(0,m.useCallback)(e=>{l("usePlayByLynx updateSwiperIndex",e),q.emit(q.EVENT.LynxSwiperFinish,-1),s(e)},[]);(0,m.useEffect)(()=>{var e;if(!(0,S.DT)())return()=>{};let t=null===(e=i())||void 0===e?void 0:e.swiperIndex;void 0!==t&&(l("usePlayByLynx updateSwiperIndex2",t),u(t));let n=q.listen(q.EVENT.changeLynxSwiperIndex,u);return()=>{n()}},[]),(0,m.useEffect)(()=>{if(!!(0,S.DT)())(null==n?void 0:n.slideTo)&&(l("usePlayByLynx slideTo",n),n.slideTo(r,0),l("usePlayByLynx LynxSwiperFinish"),q.emit(q.EVENT.LynxSwiperFinish,r))},[n,r])};var dR=t("248964"),dM=t("561756"),dF=t("634165"),dB=t("950672"),dO=t("647291"),dV=t("634362"),dW=t("730510");let dU=e=>{var l;let{awemeInfo:t,removeSlideListButton:i,isFromLynx:n}=e,o=(0,p.d)(),a=null!==(l=null==o?void 0:o.nonce)&&void 0!==l?l:"argus-csp-token";return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("script",{nonce:a,dangerouslySetInnerHTML:{__html:`
        try {
          if (window.__QUICK_PLAYER && window.__QUICK_PLAYER.createQuickPlayer) {
            window.__QUICK_PLAYER.createQuickPlayer(${JSON.stringify({awemeInfo:t,removeSlideListButton:i,isFromLynx:n})});
          }
        } catch (e) {
          console.log('createQuickPlayer error', e);
          if (window.__pace_load_deferred_scripts) {
            window.__pace_load_deferred_scripts();
          }
        }
      `}}),(0,u.jsx)("script",{nonce:a,dangerouslySetInnerHTML:{__html:`
        try {
          if (window.__pace_load_deferred_scripts) {
            window.__pace_load_deferred_scripts();
          }
        } catch (e) {}
      `}})]})};var dH=t("945388"),dG=t("85084");t("567754");let dz=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:"",defaultTitle:dH.SITE_DEFAULT_TITLE},{from:l,defaultTitle:t}=e;return l&&dH.SITE_NAME_MAP.get(l)||t};var dZ=t("265482");let dK=e=>{let{isSpider:l,redirectFrom:t}=e,i=l?dH.SITE_DEFAULT_TITLE:dz({from:t,defaultTitle:dH.SITE_DEFAULT_TITLE}),n="抖音让每一个人看见并连接更大的世界，鼓励表达、沟通和记录，激发创造，丰富人们的精神世界，让现实生活更美好。",o="抖音,抖音音乐,抖音短视频,抖音官网,amemv,抖音app,抖音app下载";return(0,eN.o)(()=>{(0,dG.J)({title:i,description:n,keywords:o})},[]),(0,u.jsxs)(dZ.Z,{children:[(0,u.jsx)("title",{children:i}),(0,u.jsx)("meta",{name:"description",content:n}),(0,u.jsx)("meta",{name:"keywords",content:o}),(0,u.jsx)("link",{rel:"canonical",href:"https://www.douyin.com/"})]})};var dQ=t("696745"),d$=t.p+"media/blackBg_big.b7bedc994a938699.png",dY={recommendFakeVideo:"hMkBqQ7u",blackBg:"neudZ7lh",controls:"UgUrZuwu",progress:"wCAmkeP2",leftWrap:"PPANNJWy",playBtn:"CCfCSjWc",time:"xV9Zy4WW",timeSeparator:"xy8j9Drk",loading:"ErU_JjFW"};let dq=(0,m.forwardRef)((e,l)=>{var t;let{awemeInfo:i,isLive:n=!1}=e,o=n?0:(0,en.p)(i)?b.fp.SplashControls:b.fp.MidHigh;return(0,u.jsxs)("div",{ref:l,className:g()(dY.recommendFakeVideo,{[dY.blackBg]:!0}),id:"recommend-fake-video",style:{paddingBottom:`${o}px`,backgroundImage:`url(${d$})`},children:[(0,u.jsx)("img",{id:"recommend-fake-video-img",src:d$,alt:"",width:"0",height:"0",style:{display:"none"}}),(0,u.jsxs)("div",{className:dY.controls,style:{height:`${o}px`},children:[(0,u.jsx)("div",{className:dY.progress}),(0,u.jsx)("div",{style:{height:`${o-2}px`},children:(0,u.jsxs)("div",{className:dY.leftWrap,children:[(0,u.jsx)("div",{className:dY.playBtn}),(0,u.jsxs)("div",{className:dY.time,children:[(0,u.jsx)("span",{children:"00:00"}),(0,u.jsx)("span",{className:dY.timeSeparator,children:"/"}),(0,u.jsx)("span",{children:(0,nY.$y)((null==i?void 0:null===(t=i.video)||void 0===t?void 0:t.duration)||0)})]})]})})]}),(0,u.jsx)(dQ.b,{usePerfLoading:!1,className:dY.loading,text:"加载中",slot:es.t6.INSIDE})]})});var dJ=t("458343"),dX=t("477667"),d0={widgetMiniWinGuideModalInner:"uguIOeRm",close:"Jw0xzeIQ",content:"u1OtEza9",viewInfo:"IQ03yMaa",settingInfo:"whtL4hj9",infoTitle:"AP9BKf0O",infoDesc:"lPXtDI4e",setButton:"EiSHWGNh",panelContainer:"cMRwBCfY",guideContainer:"YENX1ye1",guideHeader:"sm0ckyJ8",closeButton:"xlIAK1CR",topTip:"rhKt7r4J",subTip:"vKfVPruY",buttonArea:"Uh5pLx6z",button:"b1NosYME"},d1=t("167951");let d2=()=>{var e,l,t,i;let n=Date.now(),o=null!==(l=null===(e=(0,d1.Es)())||void 0===e?void 0:e.user_unique_id)&&void 0!==l?l:"",{showTimes:a=0,lastShowTime:d=0}=null!==(i=(null!==(t=(0,tJ.$o)(tX.LocalStorageKeys.WidgetMiniWinGuideTimes))&&void 0!==t?t:{})[o])&&void 0!==i?i:{},r=!1;return a<3&&n-d>432e6&&(r=!0),!!r||!1},d4=()=>{var e,l,t,i;let n=Date.now(),o=null!==(l=null===(e=(0,d1.Es)())||void 0===e?void 0:e.user_unique_id)&&void 0!==l?l:"",a=null!==(t=(0,tJ.$o)(tX.LocalStorageKeys.WidgetMiniWinGuideTimes))&&void 0!==t?t:{},{showTimes:s=0}=null!==(i=a[o])&&void 0!==i?i:{};(0,tJ.qQ)(tX.LocalStorageKeys.WidgetMiniWinGuideTimes,(0,r._)((0,d._)({},a),{[o]:{showTimes:s+1,lastShowTime:n}}))};var d3=t("2165");let d5=e=>{let{abTestData:l}=e,[t,i]=(0,m.useState)(!1),{attemptOpen:n,executeClose:o}=(0,iQ.B)({popName:"添加小窗",onOpen:()=>{i(!0)},onClose:()=>{i(!1)}}),a=(0,m.useCallback)(()=>{o(),d3.Z.sendLog("smallWindowToastClick",{click_result:"close"})},[]),d=(0,m.useCallback)(()=>{eP.invoke("setDesktopMiniWindowWidgetState",{state:!0,from:"web"}),o(),d3.Z.sendLog("smallWindowToastClick",{click_result:"add"})},[]);return((0,m.useEffect)(()=>{t&&d3.Z.sendLog("smallWindowToastShow",{})},[t]),(0,m.useEffect)(()=>{let e=(0,S.FJ)().awemePcClient;if((0,nm.dz)()&&e&&(0,iC.y)(e,">=","3.7.0"))return q.listen(q.EVENT.changeMinWindows,async e=>{let{event:l,source:t=""}=e,i=(await eP.invoke("isDesktopMiniWindowWidgetAutoAdd")).data;!(0,nm.O)()&&"close"===l&&!["client","resize"].includes(t)&&!i&&d2()&&n({afterCallback:()=>{d4()}}),"open"===l&&o()})},[]),(0,eN.o)(()=>{let e="WidgetMiniWinGuideModal";return t&&(0,eb.o)({pausePlayControlShortcut:!0,pauseCustomShortcut:!0,pauseGlobalShortcut:!0},e),()=>{(0,eb.m)(e)}},[t]),(0,dJ.w)(()=>{o()},[]),t)?(0,u.jsx)("div",{className:g()(d0.panelContainer,d0.panelContainerAdjust),children:(0,u.jsxs)("div",{className:d0.guideContainer,onClick:e=>e.stopPropagation(),children:[(0,u.jsxs)("div",{className:d0.guideHeader,children:[(0,u.jsx)(eF.Z,{src:dX.Z,className:d0.closeButton,width:28,height:28,onClick:a}),(0,u.jsx)("div",{className:d0.viewInfo,children:(0,u.jsx)("video",{src:"//p-pc-weboff.byteimg.com/tos-cn-i-9r5gewecjs/widget-mini-window.mp4",autoPlay:!0,muted:!0,loop:!0})})]}),(0,u.jsxs)("div",{className:d0.content,children:[(0,u.jsx)("div",{className:d0.topTip,children:"添加「小窗播放」到桌面"}),(0,u.jsx)("div",{className:d0.subTip,children:"添加后，支持快速开启「小窗播放」看抖音"}),(0,u.jsx)("div",{className:d0.buttonArea,children:(0,u.jsx)(lA.Button,{theme:"solid",type:"primary",className:d0.button,onClick:d,children:"立即添加"})})]})]})}):(0,u.jsx)(u.Fragment,{})};var d6={swiperItem:"P2uoik9n",content:"hu8OAx_c",clientMiniWin:"toDpmMrJ",noSelect:"oMGCEkxE",splashTransition:"HPVeSh0l"};let d8=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,m.useEffect)(()=>{!e&&(window.cacheDebugVids=e=>{(0,tb.setCookiesItem)(tX.CookieKeys.DebugVids,JSON.stringify(e)),window.location.reload()},window.clearDebugVids=e=>{(0,tb.removeCookiesItem)(tX.CookieKeys.DebugVids),window.location.reload()})},[])},d7=e=>{let{awemeInfoList:l,abTestData:t}=e,[i,n]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{let e;let t=null==l?void 0:l[0];return(null==l?void 0:l.length)?!i&&(null==t?void 0:t.awemeType)!==x.e.Normal&&(n(!0),clearTimeout(e)):e=setTimeout(()=>n(!0),5e3),()=>{clearTimeout(e)}},[l,i,null==t?void 0:t.longtaskOpt]),(0,m.useEffect)(()=>{let e=q.listen(q.EVENT.videoPlay,()=>{n(!0)}),l=q.listen(q.EVENT.videoPlayPrevent,()=>{n(!0)});return()=>{e(),l()}},[]),{isFirstScreenFrame:i}};var d9=t("130556");let re=()=>{(0,m.useEffect)(()=>{(0,G.B1)("page_recommend_render");try{if(Z.Le.getConfig(Z.gI.ReportFirstFeedCoverShow)){Z.Le.setConfig(Z.gI.ReportFirstFeedCoverShow,!1);let e=new PerformanceObserver(l=>{for(let t of l.getEntries())if((null==t?void 0:t.identifier)==="lcp_ele"){e.disconnect(),(0,d9.l)(()=>{var e,l,i,n;let o=(0,G.fX)(),a={first_cover_show:null==t?void 0:t.startTime,new_player:null==o?void 0:null===(e=o.new_player)||void 0===e?void 0:e.startTime,play_init_duration:(0,G.L8)("player_init","new_player","player_ready"),feed_request_start:null==o?void 0:null===(l=o.app_request_start)||void 0===l?void 0:l.startTime,feed_request_duration:(0,G.L8)("request_duration","app_request_start","app_request_end"),app_recommend_page:null==o?void 0:null===(i=o.page_recommend)||void 0===i?void 0:i.startTime,recommend_page_component:null==o?void 0:null===(n=o.page_recommend_render)||void 0===n?void 0:n.startTime};d3.Z.sendLog("recommendProcessStat",a)});return}});e.observe({type:"element",buffered:!0})}}catch(e){}},[])},rl="RECOMMENTFETCHERROR",rt=()=>{(0,m.useEffect)(()=>{let e=localStorage.getItem(rl);e&&(localStorage.removeItem(rl),Y.oe.event.error({name:Y.Mo.PrefetchFailed,report:{message:e,isSync:!0}}))},[])};var ri=t("583165");let rn="RECOMMEND_USE_CACHE",ro=()=>{(0,m.useEffect)(()=>{let e=Number((0,ri.tN)("recommendFeedCache")),l=Number(localStorage.getItem(rn));l&&(localStorage.removeItem(rn),Y.oe.event.info({name:Y.Mo.RecommendUseCache,report:{recommendFeedCache:e,isExpire:1!==l}}))},[])},ra=e=>{let{list:l,ssrStatusCode:t,csrStatusCode:i,refreshIndex:n}=e,o=(0,m.useRef)(null);(0,m.useEffect)(()=>{l&&l.length>0?clearTimeout(o.current):!o.current&&(o.current=setTimeout(()=>{!(null==l?void 0:l.length)&&(Y.oe.event.error({name:Y.Mo.FirstScreenFailed}),d3.Z.sendLog("recommendFirstFailed",{ssr_status_code:t,csr_status_code:i,refresh_index:n}))},3e4))},[l])},rd=e=>{let{abTestData:l,swiper:i}=e,n=(0,m.useRef)(250);return(0,m.useEffect)(()=>{let e;(0,Q.N)(async()=>{let{Pylon:l,EBiz:i}=await t.e("74770").then(t.bind(t,198991));e=new l({biz:i.DOUYIN_WEB_RECOMMEND})},!1);let o=()=>{try{let{slideConfig:d,preloadConfig:r}=(null==l?void 0:l.pageSpeed)||{},{nextPlayer:s}=window;if(d&&e){let l=e.strategyInference({scene:"feed_slide",abConfig:{slideStrategy:[6,12]}});0===l?n.current=d.normal:2===l?n.current=d.slow:1===l&&(n.current=d.fast)}if(r){var t,i,o,a;(null==s?void 0:null===(t=s.preLoadData)||void 0===t?void 0:t.byteLength)||(null==s?void 0:null===(a=s.plugins)||void 0===a?void 0:null===(o=a.mp4encryptplayer)||void 0===o?void 0:null===(i=o.preLoadData)||void 0===i?void 0:i.byteLength)?n.current=r.preload:n.current=r.noPreload}}catch(e){}};if(i&&(null==l?void 0:l.pageSpeed))return i.on("slideChange",o),()=>{i.off("slideChange",o)}},[i,null==l?void 0:l.pageSpeed]),{pageSpeed:n.current}};var rr=t("679105"),rs=t("298432"),ru=t("399629"),rc=t("333760"),rv=t("257858");t("882732");var rm=t("596161");let r_=()=>"insert"===(0,K.Rs)("feed_operation"),rf=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=e?["feed_operation","aweme_id"]:["feed_operation","aweme_id","play_progress","from_device_id","record_type"];(0,K.U$)(l);try{let e=new URL(window.location.href);l.forEach(l=>e.searchParams.delete(l)),history.replaceState(null,"",e.toString())}catch(e){}},rp=()=>{let e=(0,K.Rs)("aweme_id");return null!=e?e:null},rh=e=>{if(e){var l;e.continationInfo={playProgress:Number(null!==(l=(0,K.Rs)("play_progress"))&&void 0!==l?l:0),continationVideoAlreadyConsume:!1,fromDeviceId:(0,K.Rs)("from_device_id"),recordType:(0,K.Rs)("record_type"),urlSource:(0,K.Rs)("url_source"),enterFromOnCellphone:(0,K.Rs)("enter_from_on_cellphone"),previousPageOnCellphone:(0,K.Rs)("previous_page_on_cellphone"),isLandscapeStatusOnCellphone:Number((0,K.Rs)("is_landscape_status_on_cellphone")),enterMethodOnCellphone:(0,K.Rs)("enter_method_on_cellphone"),itemDuration:Number((0,K.Rs)("item_duration")),fromUserId:(0,K.Rs)("from_user_id"),fromAppId:Number((0,K.Rs)("from_app_id"))}}return e},rg=e=>{let{urlSource:l,itemDuration:t,enterFromOnCellphone:i,previousPageOnCellphone:n,isLandscapeStatusOnCellphone:o,enterMethodOnCellphone:a,fromDeviceId:d,fromUserId:r,fromAppId:s}=(null==e?void 0:e.continationInfo)||{};"app_continued"===l&&(d3.Z.sendLog("continuingRemindShow",{scene:"video",enter_from_on_cellphone:i,previous_page_on_cellphone:n,is_landscape_status_on_cellphone:o,enter_method_on_cellphone:a,from_device_id:d,from_user_id:r,item_duration:t,aweme_type:String(null==e?void 0:e.awemeType),item_id:null==e?void 0:e.awemeId,from_app_name:rm.AppID2AppName[(null!=s?s:"").toString()]}),nC.F.info("正在播放手机端的视频"))},ry={PLAY_PROGRESS:30,CONTINUE_ALLOW:600,VIDEO_FILTER:[[60,300,60],[300,600,100],[600,-1,150]]},rw=()=>Math.floor(Date.now()/1e3),rI=e=>{let{setAwemeInfoList:l,swiper:t,userInfo:i}=e,n=(0,rc.U7)();(0,m.useEffect)(()=>{if(t)return q.listen(q.EVENT.recommendInsertVideo,async e=>{rg(e),l(l=>{eP.invoke("mainWindowShowView");let i=l.findIndex(l=>(null==l?void 0:l.awemeId)===(null==e?void 0:e.awemeId));if(setTimeout(()=>{q.emit(q.EVENT.triggerModalPlayerClose),q.emit(q.EVENT.closeImConversation)}),-1===i)return l.splice(t.activeIndex,-1,e),[...l];{var n,o,a;let r=l[i];return(r.continationInfo=(0,d._)({},null!==(n=null==e?void 0:e.continationInfo)&&void 0!==n?n:{}),i<t.activeIndex)?(l.splice(i,1),l.splice(t.activeIndex-1,-1,r),t.slideTo(t.activeIndex-1,0),[...l]):i>t.activeIndex?(l.splice(i,1),l.splice(t.activeIndex,-1,r),[...l]):((null===(o=window.player)||void 0===o?void 0:o.seek)&&"number"==typeof(null==e?void 0:null===(a=e.continationInfo)||void 0===a?void 0:a.playProgress)&&window.player.seek(e.continationInfo.playProgress),l)}})})},[t]);let o=e=>{var l;let{awemeInfo:t}=e;t.continationInfo={playProgress:e.playProgress,urlSource:"pc_continued"},q.emit(q.EVENT.webFeedPushMessage,{userId:null===(l=t.authorInfo)||void 0===l?void 0:l.uid,itemId:t.awemeId,itemType:t.awemeType,playTime:e.playProgress,cover:t.video.cover,fromDeviceId:"",fromDeviceType:e.toClient,recordType:e.recordType,awemeInfo:t})},a=(0,m.useCallback)(async()=>{var e,l,t,i,n,o;let a="app_continued"===(0,K.Rs)("url_source"),d=Number((0,K.Rs)("from_app_id")),r=rp();if(!r)return;let s=await (0,iy.m_)({awemeId:r,originType:rv.F.RecommendInsert}),u=null!==(t=null==s?void 0:s.detail)&&void 0!==t?t:{};if(rh(u),rf(),a&&((null==s?void 0:s.statusCode)!==0||!u||(null==u?void 0:null===(e=u.chargeInfo)||void 0===e?void 0:e.is_charge_content))&&d3.Z.sendLog("continued_broadcast_receive_sync_message",{scene:"video",stage:"fetch_aweme_fail",stage_detail:"recommend",item_id:r,status_code:null==s?void 0:s.statusCode,log_pb:null==s?void 0:s.logPb,filter_reason:null==s?void 0:null===(i=s.filterDetail)||void 0===i?void 0:i.filterReason,filter_detail:null==s?void 0:null===(n=s.filterDetail)||void 0===n?void 0:n.detailMsg,is_charge_video:!!(null==u?void 0:null===(o=u.chargeInfo)||void 0===o?void 0:o.is_charge_content),from_app_id:d}),null==u?!void 0:null===(l=u.chargeInfo)||void 0===l?!void 0:!l.is_charge_content)q.emit(q.EVENT.recommendInsertVideo,u)},[]),r=(0,m.useCallback)(async()=>{var e,l,t,a,d,r,s,u,c,v;if(!n||![rs.b.Default,rs.b.Open].includes(null!==(t=null==i?void 0:null===(e=i.info)||void 0===e?void 0:e.continuationState)&&void 0!==t?t:0))return;let m=await (0,ru.mZ)();if(m.liveMulticastInfo){null===(s=m.liveMulticastInfo.awemeInfo)||void 0===s||null===(r=s.cellRoom)||void 0===r||null===(d=r.rawdata)||void 0===d||null===(a=d.owner)||void 0===a||a.web_rid;let{recordType:e,createTime:l}=m.liveMulticastInfo,t=(0,rc.bp)({uid:i.info.uid});if(e===Number(rs.ns.manual)){o({awemeInfo:m.liveMulticastInfo.awemeInfo,recordType:m.liveMulticastInfo.recordType});return}if(e===Number(rs.ns.auto)&&(()=>{if(!(!t||l&&rw()-l>=ry.CONTINUE_ALLOW))return o({awemeInfo:m.liveMulticastInfo.awemeInfo,recordType:m.liveMulticastInfo.recordType}),!0})())return}if(0===m.statusCode&&(null===(l=m.multicastList)||void 0===l?void 0:l.length)>0){let e=m.multicastList,l=m.multicastList[0];if(l.recordType===Number(rs.ns.manual)&&(null==l?void 0:null===(c=l.awemeInfo)||void 0===c?void 0:null===(u=c.chargeInfo)||void 0===u?void 0:u.is_charge_content)){o(l);return}if(l=null,!(0,rc.bp)({uid:null==i?void 0:null===(v=i.info)||void 0===v?void 0:v.uid}))return;e.forEach(e=>{var t,i,n,o,a;if(l||e.recordType!==Number(rs.ns.auto)||(null==e?void 0:null===(i=e.awemeInfo)||void 0===i?void 0:null===(t=i.chargeInfo)||void 0===t?void 0:t.is_charge_content)||(null!==(a=null==e?void 0:e.playProgress)&&void 0!==a?a:0)<ry.PLAY_PROGRESS||e.createTime&&rw()-e.createTime>=ry.CONTINUE_ALLOW)return;let d=Math.floor((null==e?void 0:null===(o=e.awemeInfo)||void 0===o?void 0:null===(n=o.video)||void 0===n?void 0:n.duration)/1e3);if(!(d>0))return;let r=d-e.playProgress;ry.VIDEO_FILTER.forEach(t=>{(-1===t[0]||d>t[0])&&(-1===t[1]||d<=t[1])&&(-1===t[2]||r>t[2])&&(l=e)})}),l&&o(l)}},[n,n]);(0,m.useEffect)(()=>{if(i.isLogin){let e=!Z.Le.getConfig(Z.gI.FirstEnterRecommend),l=async()=>{r_()||1!==abTestData.douyinMulticastLiveNew&&r()};if(!e)return q.listen(q.EVENT.firstEnterVideoPlay,l);l()}},[i.isLogin,r]);let s=(0,c.a)();(0,m.useEffect)(()=>{r_()&&a()},[s.search]),(0,m.useEffect)(()=>()=>{Z.Le.setConfig(Z.gI.FirstEnterRecommend,!0)},[])};var rx=new i9.h({first_feed_predict:{eventName:"first_feed_predict",params:{is_correct:0,first_type:0,incorrect_reason:"",predict_duration:0,status_code:"",feed_logid:"",predict_logid:"",first_aweme_id:""}}});let rb=e=>{let l=(0,m.useRef)(!1);(0,m.useEffect)(()=>{try{var t,i,n;if(l.current||e.awemeInfoList.length<2)return;l.current=!0;let o="useCache"===window.FEED_CACHE_INFO,a="topLive"===window.FEED_CACHE_INFO,d=window.FEED_CACHE_INFO&&!o?window.FEED_CACHE_INFO:void 0,r=o?null==e?void 0:null===(t=e.awemeInfoList)||void 0===t?void 0:t[1]:null==e?void 0:null===(i=e.awemeInfoList)||void 0===i?void 0:i[0],s={is_correct:(null==r?void 0:r.awemeType)===x.e.LiveCard===a?1:0,first_type:r.awemeType,incorrect_reason:d,predict_duration:0,first_aweme_id:null===(n=e.awemeInfoList[0])||void 0===n?void 0:n.awemeId};rx.sendLog("first_feed_predict",s)}catch(e){}},[e.awemeInfoList,e.feedLogId])};var rE=t("892766"),rT=t("76223"),rC=t("492652"),rS=t("109050");t("242079"),t("851912"),t("954372");class rN{setDbObject(e){this.dbObject=e}creatTable(e,l,t,i){var n,o;let a;return!(null===(n=this.dbObject)||void 0===n?void 0:n.objectStoreNames.contains(e))&&(a=null===(o=this.dbObject)||void 0===o?void 0:o.createObjectStore(e,l||{autoIncrement:!0}),this.creatIndex(a,{indexName:t,colName:t})),a}creatIndex(e,l){var t;let{indexName:i,colName:n,indexparam:o={unique:!0}}=l;null==e||null===(t=e.createIndex)||void 0===t||t.call(e,i,n,o)}getIndexData(e,l,t){return new Promise((i,n)=>{try{var o;let a=null===(o=this.dbObject)||void 0===o?void 0:o.transaction([e]);if(!a){n();return}let d=a.objectStore(e).index(l),r=null==d?void 0:d.get(t);r.onerror=e=>{n(e)},r.onsuccess=e=>{var l;(null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.result)?i(e.target.result):i(null)}}catch(e){n(e)}})}addData(e,l){return new Promise((t,i)=>{try{if(!this.dbObject){i();return}let n=this.dbObject.transaction(e,"readwrite").objectStore(e).put(l);n.onsuccess=()=>{t(!0)},n.onerror=e=>{i(e)}}catch(e){i(e)}})}remove(e,l){return new Promise((t,i)=>{try{if(!this.dbObject){i();return}let n=this.dbObject.transaction(e,"readwrite").objectStore(e).delete(l);n.onsuccess=()=>{t(!0)},n.onerror=e=>{i(e)}}catch(e){i(e)}})}constructor(e,l=1){(0,nR._)(this,"openDb",void 0),(0,nR._)(this,"dbObject",void 0),(0,nR._)(this,"indexDB",void 0),this.indexDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.indexDB&&(this.openDb=this.indexDB.open(e,l))}}let rP=e=>{var l;return null!==(l=Math.floor(e/1e3))&&void 0!==l?l:0},rA={feedCacheTable:{tableName:"feedCache",indexName:"key",keyPath:"key",keyName:"feedCache",cookieKey:"feed_cache_data"},selectedFeedCacheTable:{tableName:"selectedFeedCache",indexName:"key",keyPath:"key",keyName:"selectedFeedCache",cookieKey:"SelectedFeedCache"}};class rL{get config(){return rA[this.dbKey]}get dbInstance(){return rL.dbInstance}set expiredTime(e){this._cookieExpiredTime=rP(e)}static init(){return rL.initPromise?rL.initPromise:(rL.initPromise=new Promise((e,l)=>{var t;rL.dbInstance=new rN("FeedDataBse",3);let{openDb:i}=null!==(t=this.dbInstance)&&void 0!==t?t:{};if(!i){l();return}i.onerror=e=>{},i.onsuccess=l=>{var t,i;null===(i=this.dbInstance)||void 0===i||i.setDbObject(null==l?void 0:null===(t=l.target)||void 0===t?void 0:t.result),e(!0)},i.onupgradeneeded=e=>{var l;null===(l=this.dbInstance)||void 0===l||l.setDbObject(e.target.result),Object.values(rA).forEach(e=>{var l;null===(l=this.dbInstance)||void 0===l||l.creatTable(e.tableName,{keyPath:e.keyPath,unique:!0},e.indexName,e.keyPath)})}}),rL.initPromise)}init(){return rL.init()}async addCache(e,l){var t,i,n;await (null===(t=this.dbInstance)||void 0===t?void 0:t.addData(this.config.tableName,(0,r._)((0,d._)({},e),{key:this.config.keyName})))&&aP.Q.setItem(this.config.cookieKey,null!=l?l:{uuid:e.uuid,scmVersion:e.scmVersion,date:e.date,dyQ:null==e?void 0:null===(i=e.awemeInfo)||void 0===i?void 0:i.dyQ,awemeId:null==e?void 0:null===(n=e.awemeInfo)||void 0===n?void 0:n.awemeId,awemeInfoVersion:e.awemeInfoVersion},this._cookieExpiredTime)}hasCacheCookie(){return aP.Q.hasItem(this.config.cookieKey)}getCache(){var e;return null===(e=this.dbInstance)||void 0===e?void 0:e.getIndexData(this.config.tableName,this.config.indexName,this.config.keyName).then(e=>e).catch(e=>{})}deleteCache(){var e;return aP.Q.setItem(this.config.cookieKey,{uuid:"",scmVersion:"",date:0,awemeInfoVersion:""},0),aP.Q.removeItem(this.config.cookieKey,"/"),null===(e=this.dbInstance)||void 0===e?void 0:e.remove(this.config.tableName,this.config.keyName)}constructor(e,l=86400){(0,nR._)(this,"dbKey",void 0),(0,nR._)(this,"_cookieExpiredTime",void 0),this.dbKey=e,this._cookieExpiredTime=l}}(0,nR._)(rL,"dbInstance",void 0),(0,nR._)(rL,"initPromise",void 0);class rk{async start(){var e,l;null===(l=rk.feedDb)||void 0===l||null===(e=l.init)||void 0===e||e.call(l)}initCacheFeed(){this.getCacheAwemeInfoPromise=this.getCacheAwemeInfo()}getCacheFeed(){return this.getCacheAwemeInfoPromise}deleteCacheFeed(){var e,l;this.getCacheAwemeInfoPromise=void 0,null===(l=rk.feedDb)||void 0===l||null===(e=l.deleteCache)||void 0===e||e.call(l),this._cacheFeed=[]}getCache(){var e,l;null===(l=rk.feedDb)||void 0===l||null===(e=l.getCache)||void 0===e||e.call(l)}get cacheFeed(){return this._cacheFeed}async checkAweme(e){var l;let t=[{item_id:e.awemeId,dy_q:e.dyQ,tag:e.isAds?2:0,potential_risk_level:0,authentication_token:""}],i=await (0,i8.Y)(t);return(0!==i.statusCode||!((null===(l=i.result)||void 0===l?void 0:l.length)>0))&&!0}async preloadVideo(e){let l=document.createElement("video");l.src=e,l.onloadeddata=()=>{}}async getCacheAwemeInfo(){var e,l,t,i,n;await (null===(l=rk.feedDb)||void 0===l?void 0:null===(e=l.init)||void 0===e?void 0:e.call(l));let o=await this.getCache(),a=null==o?void 0:o.awemeInfo;if(a&&(null==o?void 0:o.videoData)){let e=o.videoData,l=URL.createObjectURL(e),d=(a.video.bitRateList||[]).find(e=>e.dataSize===a.video.playAddrSize)||(null===(t=a.video.bitRateList)||void 0===t?void 0:t[0]);return(d&&(d.playAddr=[{src:l}],d.playApi=l),a.video.bitRateList=d?[d]:[],a.video.playAddr=[{src:l}],a.video.playAddrH265=[{src:l}],a.video.playApi=l,a.video.playApiH265=l,this.preloadVideo(l),await this.checkAweme(a))?(this._cacheFeed=[a],[a]):(null==rk||null===(n=rk.feedDb)||void 0===n||null===(i=n.deleteCache)||void 0===i||i.call(n),!1)}return!1}async canSaveCacheFeed(e){var l,t,i,n;let{isLogin:o,uuid:a,scmVersion:d,maxAge:r}=e;if(!r)return!1;let s=await (null===(t=rk.feedDb)||void 0===t?void 0:null===(l=t.getCache)||void 0===l?void 0:l.call(t));return!s||!!("3.0"!==s.awemeInfoVersion||Date.now()-s.date>r)&&(await (null===(n=rk.feedDb)||void 0===n?void 0:null===(i=n.deleteCache)||void 0===i?void 0:i.call(n)),!0)}async saveCacheFeed(e){var l,t,i,n,o,a,d;let{awemeInfo:r,uuid:s,scmVersion:u}=e,c=((null==r?void 0:null===(l=r.video)||void 0===l?void 0:l.bitRateList)||[]).find(e=>0===e.isH265&&"mp4"===e.format),v=(null==c?void 0:c.playApi)||(null==r?void 0:null===(t=r.video)||void 0===t?void 0:t.playApi),m=(null==c?void 0:c.dataSize)||(null==r?void 0:null===(i=r.video)||void 0===i?void 0:i.playAddrSize);if(r&&v&&m){let e=Date.now(),l=v,t=await fetch(v).then(e=>(l=e.url,e.blob())),i=this.isValidUrl(l)?new URL(l).host:"";if(d3.Z.sendLog("videoCacheInfo",{host:i,cache_size:m,aweme_id:r.awemeId,group_id:r.groupId,duration:Date.now()-e,is_success:(null==t?void 0:t.size)===m?1:0,vduration:`${null==r?void 0:null===(n=r.video)||void 0===n?void 0:n.duration}`}),d3.Z.sendLog("prfTaskDataSize",{cdn_size:m,group_id:r.groupId,vduration:null==r?void 0:null===(o=r.video)||void 0===o?void 0:o.duration,is_cache:1,enter_from:(0,T.yW)()}),(null==t?void 0:t.size)===m){let e=Date.now();return await (null===(d=rk.feedDb)||void 0===d?void 0:null===(a=d.addCache)||void 0===a?void 0:a.call(d,{uuid:s,awemeInfo:r,videoData:t,scmVersion:u,date:e,awemeInfoVersion:"3.0"})),!0}}else d3.Z.sendLog("videoCacheInfo",{is_success:0});return!1}constructor(e=172800){return(0,nR._)(this,"getCacheAwemeInfoPromise",void 0),(0,nR._)(this,"_cacheFeed",void 0),(0,nR._)(this,"isValidUrl",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(/^http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(e)}),!rk.feedDb&&(rk.feedDb=Z.Le.getConfig(Z.gI.FeedDb)||new rL("feedCacheTable",e)),this._cacheFeed=[],!rk.instance&&(rk.instance=this),rk.instance}}(0,nR._)(rk,"feedDb",void 0),(0,nR._)(rk,"instance",void 0);let rj=()=>{let e=new Date().getHours();return(!(e>=20)||!(e<=22))&&!0},rD=e=>{var l,t,i,n;let{initialRecommendAwemeList:o}=e,{userInfo:a}=(0,rC.useUserContext)(),d=(0,rT.U)(),r=(0,m.useRef)(!1),s=(0,m.useRef)(!1),u=null==a?void 0:a.isLogin,c=null==a?void 0:null===(l=a.info)||void 0===l?void 0:l.uniqueId,v=!!(null==d?void 0:null===(t=d.recommendQuickStartV1)||void 0===t?void 0:t.cache),_=null!==(n=null==d?void 0:null===(i=d.recommendQuickStartV1)||void 0===i?void 0:i.expire)&&void 0!==n?n:0,f=(0,m.useCallback)(async()=>{if(!v)return;let e=new rk(_);try{var l,t,i;if(r.current||s.current)return;d3.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"start"});let n=(null===(l=window)||void 0===l?void 0:l.version)||"";if(!await e.canSaveCacheFeed({isLogin:u,uuid:c,scmVersion:n,maxAge:_})){s.current=!!_,d3.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"cache not needed"});return}r.current=!0;let o=await (0,rS.Nu)({tagId:"",pullType:8,count:1,refreshIndex:1,preFetch:!1,usePassThrough:!1,useProtobuf:!1,needTranslation:void 0},null),a=null==o?void 0:null===(i=o.awemeList)||void 0===i?void 0:null===(t=i.find)||void 0===t?void 0:t.call(i,e=>{var l,t,i;return!(0,en.p)(e)&&(null==e?void 0:e.isFromSort)!==!1&&(null==e?void 0:e.awemeType)===x.e.Normal&&!(null==e?void 0:null===(l=e.chargeInfo)||void 0===l?void 0:l.is_charge_content)&&(null==e?void 0:null===(t=e.video)||void 0===t?void 0:t.playAddrSize)&&(null==e?void 0:null===(i=e.video)||void 0===i?void 0:i.playAddrSize)<=314572800});if(!a){d3.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:"aweme invalid"});return}let d=await e.saveCacheFeed({awemeInfo:a,uuid:c,scmVersion:n});d3.Z.sendLog("videoCacheStepInfo",{action:"fetchCache",info:`cache ${d?"success":"fail"}`}),r.current=!1,s.current=d}catch(e){r.current=!1}},[u,c,_,v]);(0,m.useEffect)(()=>{let e;if(!v)return;let l=async()=>{clearTimeout(e),"hidden"===document.visibilityState&&rj()&&(e=setTimeout(f,3e4))};return document.addEventListener("visibilitychange",l),()=>{clearTimeout(e),document.removeEventListener("visibilitychange",l)}},[v,f]),(0,m.useEffect)(()=>{let e;if(!v||s.current)return;let l=v?6e4:0;return l&&rj()&&(e=setTimeout(f,l)),()=>{clearTimeout(e)}},[f,v]),(0,rE.O)(!0,()=>{f()}),(0,F.C)(()=>{},[]),(0,F.C)(()=>{try{if(v&&new rk(_).start(),(null==o?void 0:o.length)&&"topLive"===Z.Le.getConfig(Z.gI.isUseVideoCache)){var e;d3.Z.sendLog("videoCacheStepInfo",{action:"checkTopLive",info:(null==o?void 0:null===(e=o[0])||void 0===e?void 0:e.awemeType)===x.e.LiveCard?"1":"0"})}}catch(e){}},[v])};var rR=t("328155"),rM=t("821408"),rF=t("128231"),rB=t.n(rF);let rO=()=>{let e=async()=>{if(Z.Le.getConfig(Z.gI.IsInMiniWin))return;let e=await eP.invoke("isTopWebview");if((null==e?void 0:e.data)===!1){var l;q.emitAfterListen(q.EVENT.videoPause,"useCheckAllowPlay"),q.emitAfterListen(q.EVENT.livePause),null===(l=window.player)||void 0===l||l.pause()}},l=rB()(async()=>{"hidden"===document.visibilityState&&e()},400);(0,F.C)(()=>{let t=(0,K.Rs)("open_mini_window");if(!(0,S.DT)()||t)return;let i=q.listen(q.EVENT.firstFrameReady,()=>{e()}),n=q.listen(q.EVENT.videoPlay,()=>{e()});return document.addEventListener("visibilitychange",l),()=>{i(),n(),document.removeEventListener("visibilitychange",l)}},[])},rV=e=>{let{setAwemeInfoList:l,swiper:t,hitOomOptimize:i}=e,n=(0,m.useRef)(!1),o=(0,m.useRef)(!1),a=(0,m.useRef)(!1),d=(0,m.useRef)(!1),r=(0,m.useRef)(0),s=(0,m.useRef)(),u=async()=>{let e=await eP.invoke("GET_APP_CONFIG_ITEM",{data:{key:"CloseLynxByDouyin",parse:!0}});return!!(null==e?void 0:e.data)},c=async()=>await eP.invoke("GET_APP_CONFIG_ITEM",{data:{key:"LynxDouyinInfo",parse:!0}}),v=e=>{var l,t,i,n,o,a;let{isInit:d,info:r,feedItem:s}=e||{};if(d){Z.Le.setConfig(Z.gI.PlayerStateFromLynx,{paused:!0});return}if(!r){Z.Le.setConfig(Z.gI.PlayerStateFromLynx,void 0);return}let u=((null==r?void 0:null===(t=r.data)||void 0===t?void 0:null===(l=t.forWeb)||void 0===l?void 0:l.seekDuration)||0)/1e3;Z.Le.setConfig(Z.gI.PlayerStateFromLynx,{paused:!!(null==r?void 0:null===(n=r.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:i.isPause),vid:null==s?void 0:s.awemeId,seekTime:u,muted:null==r?void 0:null===(a=r.data)||void 0===a?void 0:null===(o=a.forWeb)||void 0===o?void 0:o.isMute})},_=async e=>{var t,i,n,o,a,s,u,v,m;if(!e&&d.current)return;let _=e||await c();(!d.current&&(null==_?void 0:null===(n=_.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:null===(t=i.feedList)||void 0===t?void 0:t.length)||r.current!==(null==_?void 0:null===(s=_.data)||void 0===s?void 0:null===(a=s.forWeb)||void 0===a?void 0:null===(o=a.feedList)||void 0===o?void 0:o.length))&&(r.current=null==_?void 0:null===(m=_.data)||void 0===m?void 0:null===(v=m.forWeb)||void 0===v?void 0:null===(u=v.feedList)||void 0===u?void 0:u.length,l(e=>{var l,t,i,n;let o=(null==_?void 0:null===(t=_.data)||void 0===t?void 0:null===(l=t.forWeb)||void 0===l?void 0:l.feedList.map(e=>`${e.aweme_id}`))||[],a=(e||[]).filter(e=>!o.includes(`${e.awemeId}`));return[...(0,dj.TN)({awemeList:null==_?void 0:null===(n=_.data)||void 0===n?void 0:null===(i=n.forWeb)||void 0===i?void 0:i.feedList}),...a]}),d.current=!0)},f=(e,i)=>{(null==t?void 0:t.slideTo)&&(!a.current||i)&&l(l=>{var n,d,r,s,u,c,m,_,f;let p=l[null==e?void 0:null===(d=e.data)||void 0===d?void 0:null===(n=d.forWeb)||void 0===n?void 0:n.feedPlayIdx];return v({info:e,feedItem:p,isInit:!i}),o.current=!0,a.current=!0,t.slideTo(null==e?void 0:null===(s=e.data)||void 0===s?void 0:null===(r=s.forWeb)||void 0===r?void 0:r.feedPlayIdx,0),i&&(null===(f=window.player)||void 0===f||f.seek(null==e?void 0:null===(c=e.data)||void 0===c?void 0:null===(u=c.forWeb)||void 0===u?void 0:u.seekDuration,(null==e?void 0:null===(_=e.data)||void 0===_?void 0:null===(m=_.forWeb)||void 0===m?void 0:m.isMute)?"pause":"play")),l})},p=async()=>{await u()&&eP.invoke("SET_APP_CONFIG_ITEM",{data:{key:"LynxDouyinInfo",value:""}})},h=async function(e){var l,t,i;let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(n.current&&o.current&&a.current&&d.current){v(),s.current=void 0,p();return}let m=e||await c();s.current=m,await u()&&(r=!0),r&&(n.current=!0),(null==m?void 0:null===(i=m.data)||void 0===i?void 0:null===(t=i.forWeb)||void 0===t?void 0:null===(l=t.feedList)||void 0===l?void 0:l.length)?(_(m),f(m,r)):s.current=void 0},g=async e=>{eP.invoke("SET_APP_CONFIG_ITEM",{data:{key:"WebIsReady",value:"1"}})},y=()=>!1;!i&&(window.updateFeedByLynxInfo=h),(0,F.C)(()=>{if(!!y())h(s.current,!1)},[]),(0,F.C)(()=>{if(!!y())t&&!a.current&&h(s.current,!1)},[t]),(0,F.C)(()=>{if(!y())return;q.emitAfterListen(q.EVENT.livePause),v({isInit:!0});let e=q.listen(q.EVENT.firstFrameReady,()=>{g("firstFrameReady"),e()}),l=q.listen(q.EVENT.PlayerCreated,()=>{g("PlayerCreated"),l()}),t=q.listen(q.EVENT.videoPlay,()=>{g("videoPlay"),t()});return()=>{e(),l(),t()}},[])},rW=e=>{var l,t,i,n,o,a;let s=null===(i=window)||void 0===i?void 0:null===(t=i.TTE_ENV)||void 0===t?void 0:null===(l=t.initPageStore)||void 0===l?void 0:l.layoutInitialPropsInOffline;return(0,r._)((0,d._)({},e),{isSpider:!1,redirectFrom:void 0,ffDanmakuStatus:(null==s?void 0:null===(o=s.backendAbTest)||void 0===o?void 0:null===(n=o.danmaku)||void 0===n?void 0:n.douyin_danmaku)||0,danmakuSwitchStatus:(null==s?void 0:s.danmakuSwitchStatus)||0,freeAdStatus:(null==s?void 0:null===(a=s.freeAdStatus)||void 0===a?void 0:a.status)||0,isMobileSite:!1,useCache:!1,noUseCacheReson:"client_offline"})};var rU=t("459132");let rH=e=>{let{setAwemeInfoList:l,initialRecommendAwemeList:t=[]}=e;(0,F.C)(()=>{(async()=>{if((0,S.DT)()&&!rU.B.prefetchFromClientUsed&&window.clientNodePrefetchPromise){var e,i,n,o,a,d,r,s,u;if((null==t?void 0:t.length)>0){B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:0,cancel_reason:"has_init_list",data_length:0,status_code:0,jsb_cost:0});return}let c=new Date().getTime(),v=await window.clientNodePrefetchPromise;if(rU.B.setPerfetchUsed(),(null==v?void 0:null===(i=v.data)||void 0===i?void 0:null===(e=i.aweme_list)||void 0===e?void 0:e.length)>0&&(null===(n=v.data)||void 0===n?void 0:n.status_code)===0){let e=(null===(o=(0,rS.A)(null==v?void 0:v.data))||void 0===o?void 0:o.awemeList)||[];l(l=>{var t,i,n,o,a,d,r,s;return(null==l?void 0:l.length)?(B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.log_pb,cancel_reason:"has_list_data",data_length:null==v?void 0:null===(r=v.data)||void 0===r?void 0:null===(d=r.aweme_list)||void 0===d?void 0:d.length,status_code:String(null==v?void 0:null===(s=v.data)||void 0===s?void 0:s.status_code),jsb_cost:new Date().getTime()-c}),l):(rU.B.setIsUseNodeFetch(),B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:1,log_id:null==v?void 0:null===(t=v.data)||void 0===t?void 0:t.log_pb,cancel_reason:"",data_length:null==v?void 0:null===(n=v.data)||void 0===n?void 0:null===(i=n.aweme_list)||void 0===i?void 0:i.length,status_code:String(null==v?void 0:null===(o=v.data)||void 0===o?void 0:o.status_code),jsb_cost:new Date().getTime()-c}),e)})}else B.logInstance.sendLog("clientNodeFeedFetch",{first_data_from:"client_node_prefetch",is_use:0,log_id:null==v?void 0:null===(a=v.data)||void 0===a?void 0:a.log_pb,cancel_reason:(null==v?void 0:null===(d=v.data)||void 0===d?void 0:d.cancelReason)||"data_error",data_length:null==v?void 0:null===(s=v.data)||void 0===s?void 0:null===(r=s.aweme_list)||void 0===r?void 0:r.length,status_code:String(null==v?void 0:null===(u=v.data)||void 0===u?void 0:u.status_code),jsb_cost:new Date().getTime()-c})}})()},[t,l])};var rG=t("939965"),rz=t("766619");let rZ=e=>{let{smartDataTrackConfig:l,authorCardPreload:t}=e||{};(0,m.useEffect)(()=>{if(!(!(0,$.km)(80)&&(0,$.i7)()))return;let{scene:i}=l||{};if(i===rz.P.AUTHOR_CARD_PRELOAD){var n;return null===(n=(0,rG.lZ)())||void 0===n||n.registerScene(rz.P.AUTHOR_CARD_PRELOAD,(0,r._)((0,d._)({},l),{abTestData:e,enableInference:!!(null==t?void 0:t.model_url)})),()=>{var e;null===(e=(0,rG.lZ)())||void 0===e||e.unregisterScene(rz.P.AUTHOR_CARD_PRELOAD)}}},[t,l])};t("950331");var rK=t("302653"),rQ=t.n(rK),r$=t("238944");let{useRecommendGuide:rY}=I.Z;(0,G.B1)({tag:"page_recommend"});let rq=(0,dL.C)((0,m.memo)(function(e){var l,i,n,o,a,_;let h=e;try{(0,S.DT)()&&(null===(i=window)||void 0===i?void 0:i.is_client_offline)&&(null===(a=window)||void 0===a?void 0:null===(o=a.TTE_ENV)||void 0===o?void 0:null===(n=o.initPageStore)||void 0===n?void 0:n.layoutInitialPropsInOffline)&&(h=rW(h))}catch(e){}let{isSpider:I,redirectFrom:b,ffDanmakuStatus:E=0,danmakuSwitchStatus:T=0,recommendAwemeList:C,recommendAwemeListPromise:N,firstSsrStatusCode:P,useCache:A,noUseCacheReson:k,otherInfo:G,quickPlayerVal:en}=h||{},eo=(0,p.d)();_=null==eo?void 0:eo.nonce;let ev=I||(0,S._Q)(),[em,e_]=(0,m.useState)(null!=C?C:[]),[ef,ep]=(0,m.useState)(null),[eh,eg]=(0,m.useState)(!1),[ey,ew]=(0,m.useState)(0),{isMobile:eI,isiPad:ex}=(0,M.X)(),[eb,eE]=(0,m.useState)(!0),[eT,eS]=(0,m.useState)(!0),eP=(0,m.useRef)(()=>{}),eA=(0,m.useRef)(null),eL=(0,m.useRef)(null),ek=(0,m.useRef)(null),ej=(0,m.useRef)(""),eD=(0,m.useRef)(()=>{}),eR=(0,m.useRef)(!1),{userInfo:eM,dispatch:eF}=(0,nS.useUserInfoContext)()||{userInfo:{}},{isLogin:eB,info:eO}=eM,eV=(0,L._)()||{},{modalVideoDetail:eW,changeSplashAdStatus:eU,splashAdStatus:eH,isSplashTransitionEnd:eG}=(0,dV.K)(e=>{let{modalVideoDetail:l,changeSplashAdStatus:t,splashAdStatus:i,isSplashTransitionEnd:n}=e;return{modalVideoDetail:l,changeSplashAdStatus:t,splashAdStatus:i,isSplashTransitionEnd:n}}),{removeSlideListButton:ez}=(0,iu.Iq)(e=>{let{removeSlideListButton:l}=e;return{removeSlideListButton:l}}),eZ=(0,y.Z)(()=>{try{var e;(null==eL?void 0:eL.current)&&(null==eL?void 0:null===(e=eL.current)||void 0===e?void 0:e.style)&&(eL.current.style.display="none")}catch(e){}eE(!1)}),eK=(0,m.useMemo)(()=>{var e;return!!(0,S.DT)()||(null===(e=(0,z.V)())||void 0===e?void 0:e.isSupport)},[]);(0,F.C)(()=>{e_(function(){var e,l,t,i,n,o,a;let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(r_()&&rp()===(null==d?void 0:null===(i=d[0])||void 0===i?void 0:i.awemeId))return rh(null==d?void 0:d[0]),rf(!0),rg(null==d?void 0:d[0]),[...d];if(null===(e=window.__QUICK_PLAYER)||void 0===e?void 0:e.recommendDbAwemeInfo){d.unshift(null===(n=window.__QUICK_PLAYER)||void 0===n?void 0:n.recommendDbAwemeInfo);let e=rQ()(d,"awemeId");return null===(a=window)||void 0===a||null===(o=a.__QUICK_PLAYER)||void 0===o||delete o.recommendDbAwemeInfo,e}return(null===(t=window)||void 0===t?void 0:null===(l=t.__QUICK_PLAYER)||void 0===l?void 0:l.recommendCachePromise)&&(window.__QUICK_PLAYER.recommendCachePromise.__flag=!0),d}(C))},[]),(0,m.useEffect)(()=>(Z.Le.setConfig(Z.gI.RecommendReqCount,(null==C?void 0:C.length)||0),(0,Z.Vv)(void 0),()=>{Z.Le.setConfig(Z.gI.RecommendReqCount,0)}),[]),(0,m.useEffect)(()=>{let e=setTimeout(()=>{eE(!1),eS(!1)},1e4);return()=>{e&&clearTimeout(e)}},[]);let eQ=(0,m.useMemo)(()=>({cardBetween:12,upperSpace:0,nextSwiperHeaderHeight:0}),[]);rZ(eV),d8(!1);let{refLiveStore:e$}=(0,et.g)({swiper:ef,setAwemeInfoList:e_,awemeInfoList:em,refMixPlayer:eA,abTestData:eV,liveCardDisable:(0,S.DT)()}),{pageSpeed:eY}=rd({swiper:ef,abTestData:eV});(0,ei.A)({awemeInfoList:em,setAwemeInfoList:e_}),ea({awemeInfoList:em,setAwemeInfoList:e_});let eq=(0,m.useCallback)(()=>{Z.Le.setConfig(Z.gI.VideoFeedList,{autoPlayCount:1})},[]);(0,eN.o)(()=>{let e=(0,K.Rs)("enter_recommend_method"),l=(0,K.Rs)("page_url");e&&B.logInstance.sendLog("enterRecommend",{enter_from:"recommend",enter_method:e,page_url:null==l?void 0:l.toString()})},[]),(0,m.useEffect)(()=>{let{adCommentAIPreloadStatus:e=H.AdCommentAIPreloadStatus.Off,commentAiPreloadStatus:l=H.CommentAIPreloadStatus.Off}=null!=eV?eV:{},i=[H.AdCommentAIPreloadStatus.Off],n=[H.CommentAIPreloadStatus.Off,H.CommentAIPreloadStatus.CommentPreloadAll];!(i.includes(e)&&n.includes(l))&&(0,Q.N)(async()=>{let{Pylon:e,EBiz:l}=await t.e("74770").then(t.bind(t,198991));new e({biz:l.DOUYIN_WEB_RECOMMEND})},!1)},[null==eV?void 0:eV.adCommentAiPreloadStatus,null==eV?void 0:eV.commentAiPreloadStatus]);let{fetchSlideList:eJ,statusCode:eX,refRefreshIndex:e0,isListError:e1,setIsListError:e2,setRefreshIndex:e4}=(0,rr.b)({abTestData:eV,isLogin:eB,refCancelTabFeedFunc:eP,retryFuncRef:eD,ffDanmakuStatus:E,danmakuSwitchStatus:T,initialRecommendAwemeList:C,initialRecommendAwemeListPromise:N});rH({setAwemeInfoList:e_,initialRecommendAwemeList:C}),rD({initialRecommendAwemeList:C}),dD({setAwemeInfoList:e_,swiper:ef,changeSplashAdStatus:eU}),rV({setAwemeInfoList:e_,swiper:ef,hitOomOptimize:!1}),rO(),j();let{deleteCurrentSwiper:e3,nextPageFunc:e5,lastPageFunc:e6,retryFunc:e8}=(0,ed.zg)({swiper:ef,awemeInfoList:em,setAwemeInfoList:e_,fetchSlideList:eJ,swiperCallBack:e=>{eq(),eS(!1)},fromTab:er.B.RECOMMEND,abTestData:eV,initialRecommendAwemeList:C,initialRecommendAwemeListPromise:N,enableSlideBlockedLog:!0});eD.current=e8;let{isFirstScreenFrame:e7}=d7({awemeInfoList:em,abTestData:eV});re(),rt(),ro(),ra({list:em,ssrStatusCode:null!=P?P:-9,csrStatusCode:null!=eX?eX:-9,refreshIndex:e0.current});let{recommendGuideChild:e9,recommendGuideVisible:le,handleCloseGuide:ll,useNewUserSoundGuide:lt}=rY({swiper:ef,isCanShow:!eh&&!eW,enterFrom:"recommend",awemeInfoList:em,isCloseInGuide:!0,slot:es.t6.OUTSIDE,disableLottie:(0,$.b_)()||(0,$.Sb)(),newUserGuide:1,removeSlideListButton:ez});rI({setAwemeInfoList:e_,swiper:ef,userInfo:eM});let li=(0,m.useMemo)(()=>{var e,l;return(Z.Le.setConfig(Z.gI.FeedBackInfo,{refreshIndex:e0.current,activeIndex:null!==(l=null==ef?void 0:ef.activeIndex)&&void 0!==l?l:-1,awemeInfoList:null==em?void 0:null===(e=em.map)||void 0===e?void 0:e.call(em,e=>e.awemeType)}),0===em.length&&eX===O.ERROR_CODE.ERROR_NO_NETWORK)?(null==eU||eU(V.QB.Normal),(0,u.jsx)(D.oO,{slot:es.t6.OCCUPATION})):e1&&0===em.length?(Y.oe.event.error({name:Y.Mo.FeedServerError,report:{tab:"recommend",statusCode:eX,logId:ej.current}}),d3.Z.sendLog("feedServerError",{status_code:eX,log_id:ej.current}),null==eU||eU(V.QB.Normal),(0,u.jsx)(D.nl,{title:"服务器出现问题",desc:"请刷新页面重试",slot:es.t6.OCCUPATION,primaryButtonTitle:"刷新",primaryButtonAction:()=>window.location.reload()})):null},[eX,e1,em]),{updateActiveIndex:ln}=(0,dA.Z)({swiper:ef,awemeInfoList:em,fetchSlideList:eJ,setAwemeInfoList:e_,abTestData:eV});(0,m.useEffect)(()=>q.listen(q.EVENT.refreshPage,()=>{ln(0,!0),(0,ed.JA)({refCancelTabFeedFunc:eP,setAwemeInfoList:e_,fetchSlideList:eJ,fromTab:er.B.RECOMMEND}),e2(!1)}),[eJ]),(0,m.useEffect)(()=>{(async()=>{let[e]=await Promise.all([W.get({key:U.TccKey.CommonSetting,defaultValue:U.TCC_DEFAULT_VALUE_MAP.get(U.TccKey.CommonSetting)})]);!e.showFeedUserGuide&&eg(!0)})()},[]),(0,eN.o)(()=>(eq(),()=>{eq()}),[]),(0,m.useEffect)(()=>{document.body.style.minWidth="580px"},[]),(0,dP.Z)("RECOMMEND_INDEX_RENDER",{abTestData:eV,awemeInfoList:em,banRecommendGuide:eh,statusCode:eX,slideHeight:eQ});let lo=(0,R.Z)({refMixPlayer:eA}),la=(0,y.Z)(e=>{e3(e)});(0,m.useEffect)(()=>{var e;if(!eR.current)Z.Le.setConfig(Z.gI.IsForceInsert,{isForceLive:!!(null===(e=em[0])||void 0===e?void 0:e.libfinsertTaskId)}),eR.current=!0},[em]),(0,m.useEffect)(()=>{let e=em.map((e,l)=>({vid:e.awemeId,isLive:e.awemeType===x.e.LiveCard,isActive:l===ey}));q.emit(q.EVENT.changeVideoListContext,{list:e})},[em,ey]);let ld=(0,m.useRef)({}),lr=(0,y.Z)(e=>{let{from:l}=e||{};if(le&&ll({scroll:"mouse",keyboard:"keyboard",click_button:"next_video_button"}[l]),!le)"auto"===l&&(0,Z.Vv)(ec.PagingType.auto),e5(e)}),ls=(0,y.Z)(e=>{e6(e)}),lu=J.t.isOptimizeFeed(eV)?ls:e6,{isAiSearchShow:lc}=(0,dR.E)(),lv=(0,m.useMemo)(()=>({paddingLeft:0,paddingRight:lc?312:ez?12:68}),[lc,ez]),lm=df.o;(0,w.C)(eC.w3.components.recommend_page),!function(){let{awemeFeed:e}=(0,iD.j)(),l=(0,m.useRef)(!1);(0,rM.M)(),(0,dJ.w)(()=>{e.getValue("modalAwemeInfo")&&((0,rR.Nr)(location.pathname)?l.current=!0:e.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null}))},[]),(0,m.useLayoutEffect)(()=>q.listen(q.EVENT.exitChildRoute,()=>{"/"!==location.pathname&&l.current&&(l.current=!1,e.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null}))}),[])}();let l_=(0,c.a)(),{isFromLynx:lf}=(0,t2.H)(),lp="/"===l_.pathname||l_.pathname.startsWith("/root/live");rb({feedLogId:ej.current,awemeInfoList:em,otherInfo:G});let lh=(0,iD.j)(),{awemeFeed:lg}=lh,ly=(0,s._)(lh,["awemeFeed"]);return(0,eN.o)(()=>{if((null==eV?void 0:eV.themeColorOptimize)===H.ThemeColorOptimize.V3)return(0,r$.x)(),()=>{(0,r$.x)()}},[eV]),(0,u.jsxs)(iD.b,{context:(0,r._)((0,d._)({},ly),{metaCtxId:"recommend"}),children:[(0,u.jsx)(dK,{isSpider:ev,redirectFrom:b}),(0,u.jsx)(d5,{abTestData:eV}),(0,u.jsx)(f,{resolve:N}),(0,u.jsxs)(eu.ZP,{isVideoSupportMP4:eK,onSwiper:ep,abTestData:eV,isDefaultShowSideBar:!1,swiperStyle:lv,cardBetween:eQ.cardBetween,upperSpace:eQ.upperSpace,nextSwiperHeaderHeight:eQ.nextSwiperHeaderHeight,data:em,scene:es.R5.Recommend,splashAdStatus:eH,useWheelListener:eH===V.QB.Normal,swiperClassName:g()({[d6.splashTransition]:eH===V.QB.Normal&&!eG&&!(0,$.b_)()}),pagingSpeed:eY,children:[(0,u.jsx)(t3.p,{}),e7&&eK&&e9,li,(0,u.jsx)(lm,{"data-e2e":"feed-item",className:g()(d6.swiperItem,"page-recommend-container",{[d6.noSelect]:!!(null==eV?void 0:eV.shitCardCss),[d6.clientMiniWin]:!!lo}),slot:es.t6.INSIDE,children:e=>{let{slideData:l,activeIndex:t,currentIndex:i}=e,n=(!!e$.current[0]||i>0)&&(0,X.g)({abTestData:eV});if(ew(t),ln(t),t>=2&&(0,dk.U)(),!(l&&1>=Math.abs(t-i)))return null;{var o,a;let e=t===i&&!((0,ee.B)()&&(null==l?void 0:l.awemeType)===x.e.LiveCard)&&!(!lp&&(null==l?void 0:l.awemeType)===x.e.LiveCard),d=t-1===i,r=t+1===i,s=null==l?void 0:l.awemeId;return e&&!ld.current[s]&&(ld.current[s]=!0,Z.Le.setConfig(Z.gI.FeedLatestViewedAweme,{awemeId:s})),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(t3.p,{isActive:e}),(0,u.jsx)(v.NoSSR,{children:(0,u.jsx)(dB.ce,{isVideoSupportMP4:eK,InnerPlayer:n?dN:iv,isDyPlayer:n,videoRef:e?eA:ek,className:g()(d6.content),isFullScreen:(0,el.r)(),item:l,deleteCurrentSwiper:la,playNextFunc:lr,playPrevFunc:lu,isActive:e,isFirst:0===i,isFirstLive:!!(null==e$?void 0:null===(o=e$.current)||void 0===o?void 0:o[0]),isNext:r,isPrev:d,isLast:i===em.length-1,index:i,from:dO.x_.recommend,tab:dO.x_.recommend,swiper:ef,isClientMiniWin:lo,splashAdStatus:eH,changeSplashAdStatus:eU,isSplashTransitionEnd:eG,onReady:eZ,isShowGuide:le,useNewUserSoundGuide:lt})}),eb&&0===i&&!lf()&&!(null==eV?void 0:null===(a=eV.webcodecRecommend)||void 0===a?void 0:a.open)&&(0,u.jsx)(dq,{ref:eL,isLive:(null==l?void 0:l.awemeType)===x.e.LiveCard,awemeInfo:l,abtestData:eV})]})}}}),0===em.length&&eX!==O.ERROR_CODE.ERROR_NO_NETWORK&&(0,u.jsx)(dF.e,{abTestData:eV,slot:es.t6.INSIDE}),!eI&&!ex&&!ez&&(0,u.jsx)(dW.z,{isVideoSupportMP4:eK,show:em.length>0&&eH===V.QB.Normal,playNextFunc:()=>{lr({from:"click_button"})},playPrevFunc:()=>{e6({from:"click_button"})},swiper:ef,className:g()("recommend-out-switch-btn"),awemeInfoList:em,slot:es.t6.OUTOFCONTAINER,from:dO.x_.recommend})]}),(0,u.jsx)(dM.IsLivingPlugin,{activeIndex:ey,dataList:em,setDataList:e_,scene:"recommend"}),!!en&&(0,u.jsx)(dU,{awemeInfo:(null==eo?void 0:null===(l=eo.firstLoadCache)||void 0===l?void 0:l.recommend)?void 0:null==C?void 0:C[0],isFromLynx:lf(),removeSlideListButton:ez})]})}),e=>(0,E.oS)(e))},543763:function(e,l,t){t(250440),t(874386);var i=t(88648),n=t(302653),o=t.n(n),a=t(302461),d=t(828782),r=t(66627),s=t(401156),u=t(441447),c=t(725887),v=t(832052),m=t(436536);let _=e=>{var l,t,i;return(null==e?void 0:e.awemeId)||(null==e?void 0:null===(i=e.cellRoom)||void 0===i?void 0:null===(t=i.rawdata)||void 0===t?void 0:null===(l=t.owner)||void 0===l?void 0:l.web_rid)};l.Z=e=>{let{swiper:l,fetchSlideList:t,awemeInfoList:n,setAwemeInfoList:f,abTestData:p}=e,h=(0,i.useRef)(0),g=(0,i.useRef)(!1),y=(0,i.useRef)(!1),w=e=>{let{currentAwemeId:t}=e;h.current<=n.length-1&&f(e=>{let i=e.filter((e,l)=>l<=h.current).map(e=>_(e)),n=e.map((e,l)=>l>h.current||_(e)===t?e:null).filter(e=>!!e),o=n.findIndex(e=>!i.includes(_(e)));return -1!==o?(h.current=o,null==l||l.slideTo(o,0),y.current=!1):(h.current=0,setTimeout(()=>{null==l||l.slideTo(0,0)},0),y.current=!0),n})},I=async e=>{var l,i;let{currentAwemeId:n}=e,o=await t({mode:"loadmore",pull_type:18,refresh_type:18});0===o.statusCode&&(null===(l=o.data)||void 0===l?void 0:l.length)&&f(e=>{let l=(o.data||[]).filter(l=>!e.find(e=>_(e)===_(l)));return[...e.map((e,t)=>{if(_(e)===n)return e;if(t>h.current&&!(null==e?void 0:e.isAds)&&[v.e.Normal,v.e.Note].includes(null==e?void 0:e.awemeType)&&l.length){let e=l[0];return l.splice(0,1),e}return e}),...l]}),0===o.statusCode&&!(null===(i=o.data)||void 0===i?void 0:i.length)&&y.current&&!o.hasMore&&(h.current=0,y.current=!1,u.emit(u.EVENT.refreshPage))};return(0,a.o)(()=>{var e;return(0,m.oX)(async()=>{if(!g.current&&!!l&&"number"==typeof(null==l?void 0:l.activeIndex)){g.current=!0;try{let e=_(n[l.activeIndex]);w({currentAwemeId:e}),await I({currentAwemeId:e})}catch(e){}g.current=!1}},!(null==l?void 0:null===(e=l.slides)||void 0===e?void 0:e.length))},[t,l,n,f]),(0,i.useEffect)(()=>{if(y.current&&n.length>1){var e,t,i;y.current=!1;let n=null===(e=c.Le.getConfig(c.gI.IsSidebarShow))||void 0===e?void 0:e.isModal,o=null===(t=c.Le.getConfig(c.gI.IsInLookMiniModal))||void 0===t?void 0:t.isInMiniModal,a=null===(i=c.Le.getConfig(c.gI.IsInModalVideo))||void 0===i?void 0:i.isInModal;!n&&!o&&!a&&(null==l||l.slideNext())}},[l,n]),(0,i.useEffect)(()=>{if(n.length){let e=o()(n,e=>_(e));e.length!==n.length&&f(e)}},[n,f]),{updateActiveIndex:(e,l)=>{(0,m.C6)(),l?h.current=e:h.current=Math.max(e,h.current);let t=(0,d.FJ)().awemePcClient||"0.0.0";(0,d.DT)()&&(0,r.y)(t,">=","4.3.0")&&(0,s.PZ)(n,h.current)}}}},505725:function(e,l,t){t.d(l,{m:function(){return v}}),t(250440),t(874386),t(675373);var i=t(88648),n=t(987475),o=t(245861),a=t(847191),d=t(725887),r=t(828782),s=t(529596),u=t(379788),c=t(54730);let v=e=>{let{awemeInfo:l,abtestData:t,isActive:v,isLogin:m,player:_}=e,[f,p]=(0,i.useState)(!1),h=(0,i.useRef)(!1),g=(0,o.p)(l),y=(0,i.useMemo)(()=>{var e;return null===(e=d.Le.getConfig(d.gI.WallPaperIds))||void 0===e?void 0:e.includes(null==l?void 0:l.awemeId)},[l]);return(0,i.useEffect)(()=>{let e=async()=>{if(!(!1===m||!v||y||g||(0,r.DT)()||(0,r.tq)())){if(h.current){p(!0);return}try{var e;let[t,i]=await Promise.all([(0,s.Y)(),(0,u.lx)({secUid:null===(e=l.authorInfo)||void 0===e?void 0:e.secUid})]);(function(e,l,t){var i,o,d,r;let s=new Date().getTime(),u=null!==(o=(0,a.$o)(n.LocalStorageKeys.PostGuideDownloadClient))&&void 0!==o?o:{lastTimestamp:0,showTimes:0},v=s-u.lastTimestamp>=864e5,m=u.showTimes<10;if(e===c.Q.Normal&&v&&m&&!1===t&&[1,2].includes(null==l?void 0:null===(i=l.authorInfo)||void 0===i?void 0:i.followStatus)){let e=null!==(r=null===(d=(0,a.$o)(n.LocalStorageKeys.PostGuideDownloadClient))||void 0===d?void 0:d.showTimes)&&void 0!==r?r:0;return(0,a.qQ)(n.LocalStorageKeys.PostGuideDownloadClient,{lastTimestamp:new Date().getTime(),showTimes:e+1}),!0}return!1})(null==i?void 0:i.accountType,l,t)&&(h.current=!0,p(!0))}catch(e){}}};if(_)return _.once("timeupdate",e),()=>{_.off("timeupdate",e)}},[t,l,v,m,y,g,_]),{isShowGuideDownload:f}}},549909:function(e,l,t){t.d(l,{b:function(){return o}});var i=t(88648),n=t(441447);let o=e=>{let{isActive:l,player:t}=e;(0,i.useEffect)(()=>{if(l){let e=null,l=n.listen(n.EVENT.liveModalShow,()=>{t&&(e=n.listen(n.EVENT.liveModalClose,()=>{var e;null==t||null===(e=t.play)||void 0===e||e.call(t)}))});return()=>{null==l||l(),null==e||e()}}},[l,t])}},415124:function(e,l,t){t.d(l,{F:function(){return h}});var i=t(520739);t(413806),t(826893),t(250440),t(874386);var n=t(563097),o=t(88648),a=t(946075),d=t(734123),r=t(725887),s=t(441447),u=t(335101),c=t(443073),v=t(289228);let m=()=>{var e,l;return null!==(l=null===(e=r.Le.getConfig(r.gI.TabTenVVID))||void 0===e?void 0:e.split(",").length)&&void 0!==l?l:0},_=e=>{let{from:l="",isActive:t=!1,awemeInfo:i}=null!=e?e:{},n=(0,a.k)();(0,o.useEffect)(()=>n.listen(()=>{r.Le.setConfig(r.gI.TabTenVVID,"")}),[]),(0,o.useEffect)(()=>{var e;let l=null!==(e=r.Le.getConfig(r.gI.TabTenVVID))&&void 0!==e?e:"";t&&!(null==l?void 0:l.includes(null==i?void 0:i.awemeId))&&r.Le.setConfig(r.gI.TabTenVVID,`${null!=l?l:""}${l?",":""}${null==i?void 0:i.awemeId}`)},[t,null==i?void 0:i.awemeId])},f=()=>!1,p=e=>{let{awemeInfo:l,isActive:t,abtestData:i,isMiniWin:n=!1}=e,a=(0,u.n)(),[r,c]=(0,o.useState)(""),[v,p]=(0,o.useState)(0);(0,o.useEffect)(()=>{if(!t||!f())return;let e=e=>{let{currentTime:l}=e;p(l)};return null==a||a.on(d.Events.TIME_UPDATE,e),()=>{null==a||a.off(d.Events.TIME_UPDATE,e)}},[a,t]),(0,o.useEffect)(()=>{let e=s.listen(s.EVENT.closeOtherTip,e=>{"WatchLaterGuide"!==e&&c("")});return()=>e()},[]),_(e);let h=m();return(0,o.useEffect)(()=>{r&&c(""),p(0)},[t,l,a]),(0,o.useEffect)(()=>{n&&c("")},[n]),(0,o.useEffect)(()=>{if(!t||r||n)return},[t,l,v,i,h,r,n,a]),null},h=e=>{let l=(0,c.N)();return(0,n.jsx)(v.k,{componentName:"PositionBox",Slardar:l,children:(0,n.jsx)(p,(0,i._)({},e))})}},815242:function(e,l,t){t.d(l,{i:function(){return c}}),t(429532);var i=t(371790),n=t(656600),o=t(725887),a=t(113925),d=t(736054),r=t(903220),s=t(713533),u=t(739444);function c(e){var l;let{awemeInfo:t,abtestData:c={},isInnerFeed:v=!1,isMultiInstanceScene:m=!1,isActive:_,getFullscreenTarget:f}=e,p={},h=(0,s.YO)({abtestData:c,awemeInfo:t,isInnerFeed:v});return Object.assign(p,(0,u.k)({awemeInfo:t,abtestData:c,enableSr:h}),(0,r.QF)({awemeInfo:t,abtestData:c,enableSr:h})),(0,a.Zf)({config:p,awemeInfo:t,abtestData:c}),(0,d.LX)({config:p,awemeInfo:t,abtestData:c,isMultiInstanceScene:m}),(0,s.nq)({config:p,abtestData:c,enableSr:h}),p.autoplay=_,"function"==typeof f&&(p.fullscreenTarget=f()),i.t.isOptimizeUpdateTime(c)&&(!(p.time&&"object"==typeof p.time)&&(p.time={}),p.time.smartRender=!0),n.f.isDots(c)&&(!(p.progresspreview&&"object"==typeof p.progresspreview)&&(p.progresspreview={}),p.progresspreview.isDotAdaptWidth=!1),(null===(l=o.Le.getConfig(o.gI.AbtestData))||void 0===l?void 0:l.startOpt)&&(p.loadStartDelay=!0),p}},128439:function(e,l,t){t.d(l,{g:function(){return o}});var i=t(399242),n=t(798644);let o=e=>{if(!!e){if(n.s.getAllPlayer().find(e=>n.s.getPlayerScene(e.playerId)===i.lT.Modal)){var l;null===(l=e.pause)||void 0===l||l.call(e),e.config.autoplay=!1,e.autoplay=!1}}}},821408:function(e,l,t){t.d(l,{M:function(){return r}});var i=t(88648),n=t(302461),o=t(458343),a=t(909543),d=t(328155);let r=()=>{let{pathname:e}=(0,a.a)(),l=(0,i.useRef)(!0),t=(0,i.useRef)(e),r=(0,d.Nr)(e),s=(0,i.useRef)(!1);(0,n.o)(()=>{if(s.current){s.current=!1;return}performance.mark("recommend_mounted"),l.current&&(l.current=!1)},[e]),(0,i.useEffect)(()=>{if(!!r)return()=>{location.pathname===t.current&&(s.current=!0)}},[r]),(0,o.w)(()=>{performance.getEntriesByName("recommend_mounted").length>0&&performance.clearMarks("recommend_mounted")},[])}},970224:function(e,l,t){t(429532);var i=t(88648);function n(){return(n=Object.assign||function(e){for(var l=1;l<arguments.length;l++){var t=arguments[l];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}let o=i.forwardRef(function(e,l){return i.createElement("svg",n({viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,ref:l},e),i.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 38C20 32.4772 24.4772 28 30 28H90C95.5229 28 100 32.4772 100 38V74C100 79.5229 95.5229 84 90 84H72V91L82.5231 95.3846C83.4174 95.7573 84 96.6311 84 97.6C84 98.9255 82.9255 100 81.6 100H72H48H38.4C37.0745 100 36 98.9255 36 97.6C36 96.6311 36.5826 95.7573 37.4769 95.3846L48 91V84H30C24.4772 84 20 79.5228 20 74V38ZM70.2929 58.7071L60.7071 68.2929C60.3166 68.6834 59.6834 68.6834 59.2929 68.2929L49.7071 58.7071C49.0771 58.0771 49.5233 57 50.4142 57H55L55 46C55 45.4477 55.4477 45 56 45L64 45C64.5523 45 65 45.4477 65 46L65 57H69.5858C70.4767 57 70.9229 58.0771 70.2929 58.7071Z",fill:"currentColor"}))});o.elementType="Icon",l.Z=o},865223:function(e,l,t){t.d(l,{Z:function(){return m}});var i=t("134761"),n=t("520739"),o=t("878389");t("268917"),t("429532");var a=t("732715");t("544943"),t("874386"),t("413806"),t("826893");function d(){return Date.now()}t("250440"),t("779788");class r{config(e){window.collectEvent(`${this._name}.config`,e)}event(e,l){window.collectEvent(`${this._name}.${e}`,l)}init(e){window.collectEvent(`${this._name}.init`,e)}start(){window.collectEvent(`${this._name}.start`)}constructor(e){this._name=e}}let s=1;class u{get videoSize(){if(!this._player)return{width:0,height:0,play_width:0,play_height:0};let{clientWidth:e,clientHeight:l,videoWidth:t,videoHeight:i}=this._player;return{width:t,height:i,play_width:e,play_height:l}}initTea(e){let{TeaCtor:l=r}=e,t=this._Tea=new l(`douyin-player-logger-${s++}`),{user_unique_id:i,teaInitPre:n,user_id:o,device_id:a}=e;n&&n(t),t.init({app_id:7497}),t.start(),t.config({user_unique_id:i||o,device_id:a})}push(e){if(e.timestamp=d(),(e=(0,o._)((0,n._)({},e,this.videoSize),{core_type:this._player.srcObject?"mediastream":"media"})).play_current_time=this._player.currentTime,e.cdn_play_url=this._player.src,!!e.cdn_play_url){{var l,t;e.live_stream_session_id=function(e,l){if("string"==typeof e)return new URLSearchParams(e.split("?")[1]).get(l)}(e.cdn_play_url,"_session_id"),e.random_session_id=+e.cdn_play_url.includes("rsi=0"),e.play_format="string"!=typeof(t=e.cdn_play_url)?"unknown":t.indexOf(".flv")>-1?"flv":t.indexOf(".m3u8")>-1?"m3u8":t.indexOf(".mp4")>-1?"mp4":t.indexOf(".sdp")>-1?"rtm":"unknown";let{url:i,protocol:n}=(null===(l=this._player.config)||void 0===l?void 0:l.baseConfig)||{};try{e.base_config=JSON.stringify({url:i,protocol:n})}catch(e){}}e.visible=document.visibilityState,e.muted=+this._player.muted,Object.assign(e,function(){let e={cpu_core_number:-1,memory_usage:-1,network_downlink:-1};try{var l;e.cpu_core_number=navigator.hardwareConcurrency||-1,e.memory_usage=navigator.deviceMemory||-1,e.network_downlink=null===(l=navigator.connection)||void 0===l?void 0:l.downlink,void 0==e.network_downlink&&(e.network_downlink=-1)}catch(e){}return e}(),this.commonParams),this.send(e)}}send(e){var l;if(null===(l=this.isDisableReport)||void 0===l?!void 0:!l.call(this,e.event_key,e))this.onReport&&this.onReport(e.event_key,e),this._Tea.event(e.event_key,e)}constructor(e,l){(0,i._)(this,"commonParams",void 0),(0,i._)(this,"_player",void 0),(0,i._)(this,"onReport",void 0),(0,i._)(this,"isDisableReport",void 0),(0,i._)(this,"updateCommonParams",e=>{Object.assign(this.commonParams,e)}),this.initTea(e),this.commonParams=l,this.onReport=e.onReport,this.isDisableReport=e.isDisableReport,this._player=e.player}}let c=e=>{let{TTCommon:l}=window;return l?(c=e=>{if(!e)return 0;try{let{alg_type:t,sharp_level:i,scale_type:n,sr_enable:o,sr_local_error:a,proc_avg:d,render_from:r}=JSON.parse(l.executeWithElement(e,"getSrCurrentInfo",""))||{};return{is_super_resolution:3===o&&0===a||!a&&d>0?1:0,sr_alg_type:t,sr_sharp_level:i,sr_scale_type:n,sr_enable:o,sr_local_error:a,sr_render_from:r}}catch(e){return{}}})(e):(c=()=>{},{})};class v{init(){this.initLog(),this.initEvt()}initLog(){let e=function(e){let{player:l,project_key:t,user_id:i,device_id:o,user_unique_id:a,app_name:d,cdn_ip:r,aid:s,is_preview:u,codec_type:c,ext:v,product_line:m="live"}=e;return(0,n._)({project_key:t,product_line:m,live_sdk_version:"2",player_sdk_version:l.version,logger_version:"0.11.16",report_version:"5",user_id:i,device_id:o,uuid:a,app_name:d,cdn_ip:r,is_wasm:0,review_is_live:2,aid:s,live_id:`${s}-${i}-${Date.now()}`,is_preview:u?1:0,codec_type:c||"h264",ua:navigator.userAgent,href:window.location.href,fps:-1,logger_init_time:Date.now(),dpr:devicePixelRatio||1},v)}(this.options);this.log={start_play:{start_play_time:0,event_key:"start_play"},first_frame:{start:0,first_frame_view:0,event_key:"first_frame",first_sei_delay:0,ntp_sync:0,ntp_delta:0,ttfb:-1,ttdb:-1,ttfb_end:0},first_frame_failed:{code:void 0,msg:"",event_key:"first_frame_failed"},stall:{reason:0,stall_start:0,stall_end:0,ready_state:0,event_key:"stall"},play_stop:{code:0,stop_time:0,drop_percent:0,is_stream_received:0,stall_count:0,stall_time:0,retry_count:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,event_key:"play_stop",dns_parse_time:-1,redirect:-1,ttfb:-1,buffered:[],is_firstframe_received:0,meta:null},playing:{index:0,stall_count:0,stall_time:0,play_time:1e4,retry_count:0,is_last:0,video_buffer_time:0,audio_buffer_time:0,speed_switch_count:0,speed_switch_info:"none",download_speed:0,decode_fps:0,render_fps:0,drop_count:0,drop_percent:0,sei_source:"",sei_delay:0,ntp_sync:0,ntp_delta:0,event_key:"playing",stop_time:0,duration:0,stall_count_per_100sec:0,stall_time_per_100sec:0,rtm_network:[]},play_error:{code:void 0,info:"",event_key:"play_error"},play_low_decode:{fps:-1,decode_fps:-1,bitrate:-1,url:-1,msg:"",event_key:"play_low_decode"},play_av_unsync:{aDts:-1,vDts:-1,frameLength:-1,currentTime:-1,duration:0,event_key:"play_av_unsync"},play_loadstream:{loadstream_url:"",event_key:"play_loadstream"},play_stream_loaded:{event_key:"play_stream_loaded"},play_metadata_loaded:{metadata_type:"",event_key:"play_metadata_loaded"},play_demux_error:{msg:"",event_key:"play_demux_error"},play_stream_discontinue:{type:"",dts:-1,event_key:"play_stream_discontinue"},pause:{event_key:"pause"},play_url_change:{event_key:"play_url_change"},play_result:{event_key:"play_result",result:0,threshold:this.options.playResultThreshold||25e3,is_threshold:0,start:0},play_ended:{event_key:"play_ended"},play_chase_frame:{event_key:"play_chase_frame"},play_audio_gap:{event_key:"play_audio_gap"},play_audio_overlap:{event_key:"play_audio_overlap"},degrade:{event_key:"degrade"},worker_message:{event_key:"worker_message"}},this.tea=new u(this.options,e)}initEvt(){var e,l,t;let i=this._player;i&&(this._player.on(a.le.SEI,this.handleSEIParsed),this._player.on(a.le.FLVERROR,this.handleError),this._player.on(a.le.TTFB,this.handleTTFB),this._player.on(a.le.RESPONSEHEADERS,this.setCdnIp),this._player.on(a.le.METADATA,this.handleMetaDataLoaded),this._player.on(a.le.PROP_SPEED,this.handleSpeedUpdate),this._player.once(a.le.KEYFRAME,this.handleKeyframe),this._player.on(a.le.PROP_ENDEDSTATUS,this.handleEndStatus),this._player.on(a.le.RTM_NETWORK,this.handleRTMNetwork),null===(e=this._player._core)||void 0===e||e.on("srstate_change",this.handleSRStateChange),null===(l=this._player._core)||void 0===l||l.on("workerinit",this.handleWorkerInit),null===(t=this._player._core)||void 0===t||t.on("unsync",this.handleAVUnsync),i.addEventListener("loadstart",this.reportStartPlay),i.addEventListener("loadeddata",this.reportFirstframe),i.addEventListener("canplay",this.handleCanplay),i.addEventListener("waiting",this.handleWaiting),i.addEventListener("playing",this.handleOncePlaying),i.addEventListener("playing",this.handlePlaying),i.addEventListener("timeupdate",this.handleTimeupdate),i.addEventListener("ended",this.handleEnd),i.addEventListener("pause",this.handlePause),i.addEventListener("error",this.handleError),i.addEventListener("degrade",this.handleDegrade),this.initWindowListener())}offEvt(){var e,l,t;let i=this._player;i&&(this._player.off(a.le.SEI,this.handleSEIParsed),this._player.off(a.le.FLVERROR,this.handleError),this._player.off(a.le.TTFB,this.handleTTFB),this._player.off(a.le.RESPONSEHEADERS,this.setCdnIp),this._player.off(a.le.METADATA,this.handleMetaDataLoaded),this._player.off(a.le.PROP_SPEED,this.handleSpeedUpdate),this._player.off(a.le.KEYFRAME,this.handleKeyframe),this._player.off(a.le.PROP_ENDEDSTATUS,this.handleEndStatus),this._player.off(a.le.RTM_NETWORK,this.handleRTMNetwork),null===(e=this._player._core)||void 0===e||e.off("srstate_change",this.handleSRStateChange),null===(l=this._player._core)||void 0===l||l.off("workerinit",this.handleWorkerInit),null===(t=this._player._core)||void 0===t||t.off("unsync",this.handleAVUnsync),i.removeEventListener("loadstart",this.reportStartPlay),i.removeEventListener("loadeddata",this.reportFirstframe),i.removeEventListener("canplay",this.handleCanplay),i.removeEventListener("waiting",this.handleWaiting),i.removeEventListener("playing",this.handleOncePlaying),i.removeEventListener("playing",this.handlePlaying),i.removeEventListener("timeupdate",this.handleTimeupdate),i.removeEventListener("ended",this.handleEnd),i.removeEventListener("pause",this.handlePause),i.removeEventListener("error",this.handleError),i.removeEventListener("degrade",this.handleDegrade),this.removeWindowListener())}initWindowListener(){window.addEventListener("beforeunload",this.destroyFunc)}removeWindowListener(){window.removeEventListener("beforeunload",this.destroyFunc)}stallEnd(){let e=d();if(this.inWaitingStart){let l=e-this.inWaitingStart;l>200&&(this.log.play_stop.stall_count++,this.log.play_stop.stall_time+=l,this.log.playing.stall_time+=e-Math.max(this.inWaitingStart,this.log.playing.timestamp),this.log.stall.stall_end=e,this.log.playing.stall_count++,this.tea.push(this.log.stall))}this.inWaitingStart=0}reportPause(){this.log.pause.timestamp=d(),this.tea.push(this.log.pause)}handleUserLeave(){if(!this.destroyed&&!!this.started)this.updatePlayStopParams(),this.reportPlayStop(),this.clearPlayingInterval()}reportPlayStop(){this.tea.push(this.log.play_stop)}updatePlayStopParams(){let e=d(),l=e-this.log.start_play.start_play_time,{play_stop:t}=this.log;if(this.inWaitingStart&&e-this.inWaitingStart>200&&(t.stall_time+=e-this.inWaitingStart),this.inWaitingStart=0,Object.assign(t,{stall_time_per_100sec:t.stall_time/l*100,stall_count_per_100sec:1e3*t.stall_count/l*100}),0===this.log.play_stop.stall_count_per_100sec&&(this.log.play_stop.stall_time_per_100sec=0),!(this.log.play_stop.stall_time_per_100sec>100)&&!(this.log.play_stop.stall_time_per_100sec<0))this.log.playing.index?(Object.assign(this.log.playing,{is_last:1}),this.reportPlaying(!1)):(this.log.play_stop.error_code=this.log.play_error.code,this.log.play_stop.error_info=this.log.play_error.msg),Object.assign(t,{duration:l/1e3,play_time:l})}reportPlaying(e){this.log.playing.index++;let l=this.log.playing.timestamp,t=0,i=d();this.inWaitingStart&&this.inWaitingStart<i&&(t=Math.min(this.log.playing.play_time,i-Math.max(this.inWaitingStart,l))),this.getPlayerQuality(),this.getPlayerBuffer(),this.updateSpeedAndFPS();let a=i-l;a<0&&(a=1e4),t>200&&(this.log.playing.stall_time+=t,this.log.playing.stall_count++),Object.assign(this.log.playing,{duration:e?0:a/1e3,stall_time_per_100sec:e?0:this.log.playing.stall_time/a*100,stall_count_per_100sec:e?0:1e3*this.log.playing.stall_count/a*100,first_frame_view:this.log.first_frame.first_frame_view}),this.log.playing.video_render_stall_time_per_100sec=this.log.playing.stall_time_per_100sec,this.log.playing.video_render_stall_count_per_100sec=this.log.playing.stall_count_per_100sec,this.log.playing.timestamp=i,this.tea.push(Object.assign((0,o._)((0,n._)({},c(this._player._video)),{time_hour:new Date(i).getHours()}),this.log.playing)),this.log.playing.stall_time=0,this.log.playing.stall_count=0,this.log.playing.rtm_network=[]}setPlayResultTimer(){this.clearPlayResultTimer(),this.log.play_result.start=d(),this.playResultTimer=setTimeout(()=>{if(!(this.log.play_result.timestamp>=this.log.play_result.start))this.log.play_result.elapsed=d()-this.log.play_result.start,this.log.play_result.is_shorter=+(this.log.play_result.elapsed<this.log.play_result.threshold),!this.log.play_result.is_shorter&&(this.log.play_result.is_threshold=1,this.tea.push(this.log.play_result))},this.log.play_result.threshold)}clearPlayResultTimer(){clearTimeout(this.playResultTimer)}clearPlayingInterval(){clearInterval(this.intervalId)}getPlayerBuffer(){let e=this._player,l=e.buffered;if(l){let t=Math.max(0,l.length-1);try{let i=(l.end(t)-e.currentTime)*1e3;return this.log.playing.audio_buffer_time=this.log.playing.video_buffer_time=i,i}catch(e){}}return 0}getBuffered(){let e=[];try{for(let l=0;l<this._player.buffered.length;l++)e.push([this._player.buffered.start(l),this._player.buffered.end(l)])}catch(e){}return e}getPlayerQuality(){let e=this._player;try{let l=e.getVideoPlaybackQuality();this.log.playing.drop_count=l.droppedVideoFrames-this.tempDroppedFrameCount,this.log.playing.drop_percent=this.log.playing.drop_count/(l.totalVideoFrames-this.tempTotalFrameCount),this.log.play_stop.drop_percent=l.droppedVideoFrames/l.totalVideoFrames,this.tempDroppedFrameCount=l.droppedVideoFrames,this.tempTotalFrameCount=l.totalVideoFrames,this.log.stall.drop_count=this.log.playing.drop_count,this.log.stall.drop_percent=this.log.playing.drop_percent}catch(e){}}updateSpeedAndFPS(){if(this.speedInfo){let{totalByteSize:e,recentSpeed:l,renderFrames:t}=this.speedInfo,i=d(),n=i-this.playingSpeedInfoCache.timestamp;if(this.playingSpeedInfoCache.timestamp){if(e>=this.playingSpeedInfoCache.totalByteSize){let t=e-this.playingSpeedInfoCache.totalByteSize;this.log.playing.downloaded_size=t,this.log.playing.download_speed=8*t/n,this.log.playing.current_speed=l/8e3}else this.log.playing.downloaded_size=e,this.log.playing.download_speed=l/1e3,this.log.playing.current_speed=l/8e3;this.log.playing.render_fps=(t-this.playingSpeedInfoCache.renderFrames)/n*1e3}else this.log.playing.downloaded_size=e,this.log.playing.current_speed=l/8e3;this.playingSpeedInfoCache={totalByteSize:e,renderFrames:t,timestamp:i}}}constructor(e){var l,t=this;(0,i._)(this,"options",void 0),(0,i._)(this,"_player",void 0),(0,i._)(this,"log",{}),(0,i._)(this,"tea",void 0),(0,i._)(this,"inWaitingStart",0),(0,i._)(this,"tempDroppedFrameCount",0),(0,i._)(this,"tempTotalFrameCount",0),(0,i._)(this,"started",!1),(0,i._)(this,"firstFrameViewed",!1),(0,i._)(this,"destroyed",!1),(0,i._)(this,"speedInfo",void 0),(0,i._)(this,"playingSpeedInfoCache",{renderFrames:0,totalByteSize:0,timestamp:0}),(0,i._)(this,"playResultTimer",void 0),(0,i._)(this,"intervalId",void 0),(0,i._)(this,"reportUrlChange",e=>{this.tea.push(Object.assign(this.log.play_url_change,{url:e}))}),(0,i._)(this,"updateExt",e=>{var l;null===(l=this.tea)||void 0===l||l.updateCommonParams(e)}),(0,i._)(this,"reportStartPlay",()=>{this.log.start_play.start_play_time=d(),!this.started&&this.tea.push(this.log.start_play),this.started=!0,this.setPlayResultTimer()}),(0,i._)(this,"handleTTFB",e=>{let{responseUrl:l,url:t,elapsed:i}=e;this.log.first_frame.ttfb=i||-1,this.log.first_frame.is_redirect=+(l!==t)}),(0,i._)(this,"setCdnIp",e=>{var l;let{headers:t}=e;t&&(null===(l=this.tea)||void 0===l||l.updateCommonParams({cdn_ip:t["x-server-ip"]||t["X-Server-Ip"]||t["X-SERVER-IP"]}))}),(0,i._)(this,"handleMetaDataLoaded",e=>{let{trackType:l,codec:t}=e;this.log.play_metadata_loaded.meta=e,this.log.play_metadata_loaded.codec=t,this.log.play_metadata_loaded.mediaType=l,"video"===l&&this.tea.updateCommonParams({codec_type:t}),this.tea.push(this.log.play_metadata_loaded)}),(0,i._)(this,"handleSpeedUpdate",e=>{if(this.speedInfo=e,this.speedInfo){let{recentSpeed:e,renderFrames:l}=this.speedInfo;this.log.stall.current_speed=e/8e3,this.log.stall.render_fps=l}}),(0,i._)(this,"handleKeyframe",e=>{this.log.play_stop.is_firstframe_received=1,this.log.play_stop.firstframe_pts=e.pts}),(0,i._)(this,"handleEndStatus",()=>{this.stallEnd()}),(0,i._)(this,"handleRTMNetwork",e=>{this.log.playing.rtm_network.push(e)}),(0,i._)(this,"handleSRStateChange",function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.running?t.log.playing.is_super_resolution=1:(t.log.playing.is_super_resolution=0,t.log.playing.sr_code=e.code,t.log.playing.sr_message=e.message)}),(0,i._)(this,"handleWorkerInit",e=>{let{costtime:l,workerReadyTime:t,workerinitStartTime:i}=e.detail||e,a=t>this.log.start_play.start_play_time?t-i:0;this.log.play_stop.worker_init_cost=this.log.first_frame.worker_init_cost=a,this.tea.push((0,o._)((0,n._)({},this.log.worker_message),{cost_time:l,worker_init_cost:a}))}),(0,i._)(this,"handleAVUnsync",e=>{let{currentTime:l,gap:t}=e.detail||e;this.tea.push((0,o._)((0,n._)({},this.log.play_av_unsync),{currentTime:l,duration:t}))}),(0,i._)(this,"handleWaiting",()=>{!this.inWaitingStart&&this.firstFrameViewed&&(this.inWaitingStart=this.log.stall.stall_start=d(),this.log.stall.play_current_time=this._player.currentTime,this.log.stall.buffered=this.getBuffered(),this.log.stall.start_diff=this.inWaitingStart-this.log.first_frame.timestamp,this.log.stall.audio_buffer_time=this.getPlayerBuffer())}),(0,i._)(this,"handleCanplay",()=>{this.stallEnd(),this.reportFirstframe()}),(0,i._)(this,"handleOncePlaying",()=>{if(this._player.removeEventListener("playing",this.handleOncePlaying),this._player.paused){this.handlePause();return}this.playingSpeedInfoCache={totalByteSize:0,renderFrames:0,timestamp:0},this.reportPlaying(!0),this.clearPlayingInterval();this.intervalId=setInterval(()=>{(100>Math.abs(d()-this.log.playing.timestamp-1e4)||d()-this.log.playing.timestamp>=1e4)&&(this._player?this._player.paused?this.handlePause():this.reportPlaying(!1):this.destroyFunc())},1e3)}),(0,i._)(this,"handlePlaying",()=>{this.stallEnd()}),(0,i._)(this,"handleTimeupdate",()=>{this.stallEnd()}),(0,i._)(this,"handleSEIParsed",e=>{if(100===e.code){let l;let{log:{playing:t,first_frame:i,play_result:n}}=this;try{l=new TextDecoder("utf-8").decode(e.content)}catch(t){l=function(e){var l,t,i,n,o;for(l="",i=e.length,t=0;t<i;)switch((n=e[t++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:l+=String.fromCharCode((31&n)<<6|63&(o=e[t++]));break;case 14:o=e[t++],l+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&e[t++])<<0)}return l}(e.content)}l=l.slice(l.indexOf("{"),l.lastIndexOf("}")+1);try{let e=JSON.parse(l),o=e.ts||e.heart_beat&&e.heart_beat.ts;if(Object.assign(i,e.loudness),Object.assign(n,e.loudness),!o){t.sei_string=l;return}t.sei_delay=d()-o,i.first_sei_delay=t.sei_delay,t.sei_source=e.source,t.ntp_sync=0,i.ntp_sync=0}catch(e){t.sei_string=l}t.sei_delay?t.sei_string=void 0:t.sei_string=l}}),(0,i._)(this,"handlePause",()=>{this.stallEnd(),this.clearPlayingInterval(),this.reportPlaying(!1),this._player.addEventListener("playing",this.handleOncePlaying),this.reportPause()}),(0,i._)(this,"handleEnd",()=>{this.stallEnd(),this.clearPlayingInterval(),this.log.playing.is_last=1,this.reportPlaying(!1),this.tea.push(this.log.play_stop)}),(0,i._)(this,"handleError",e=>{e=e.detail||e;let l=this._player.error||{};Object.assign(this.log.play_error,{code:e.httpCode||e.code||l.code,info:e.message||l.message}),this.tea.push(this.log.play_error),!this.destroyed&&(!this.firstFrameViewed&&(Object.assign(this.log.first_frame_failed,{code:this.log.play_error.code,msg:e.message||l.message}),void 0!==this.log.first_frame_failed.timestamp&&(this.log.first_frame_failed.timestamp=d()),this.tea.push(this.log.first_frame_failed),!this.log.play_result.is_threshold&&(this.clearPlayResultTimer(),this.log.play_result.reason=e.message||l.message,this.log.play_result.code=this.log.play_error.code,this.tea.push(this.log.play_result))),this.handleUserLeave())}),(0,i._)(this,"handleDegrade",e=>{Object.assign(this.log.degrade,{message:e.message}),this.tea.push(this.log.degrade)}),(0,i._)(this,"reportFirstframe",()=>{if(this.firstFrameViewed)return;this.firstFrameViewed=!0;let e=d();Object.assign(this.log.first_frame,{first_frame_view:e-this.log.start_play.start_play_time,buffered:this.getPlayerBuffer()}),this.tea.push(this.log.first_frame),this.clearPlayResultTimer(),this.log.play_result.result=1,this.tea.push(this.log.play_result),this.log.play_stop.is_stream_received=1}),(0,i._)(this,"destroyFunc",()=>{!this.destroyed&&(this.handleUserLeave(),this.destroyed=!0,this.offEvt(),this.clearPlayingInterval(),this.clearPlayResultTimer())}),this.options=(l=e,(0,n._)({onReport:()=>{}},l)),this._player=this.options.player,this.init()}}class m{bindUrlChange(){this.player.on("urlchange",this.restart)}offUrlChange(){this.player.off("urlchange",this.restart)}updateExt(e){this.options.ext=(0,n._)({},this.options.ext,e),this.logger.updateExt(e)}destroy(){this.logger.destroyFunc(),this.offUrlChange()}constructor(e){(0,i._)(this,"player",void 0),(0,i._)(this,"options",void 0),(0,i._)(this,"logger",void 0),(0,i._)(this,"restart",e=>{let{url:l}=e;this.logger.reportUrlChange(l),this.destroy(),this.logger=new v(this.options),this.bindUrlChange(),this.logger.reportStartPlay()}),this.options=e,this.logger=new v(e),this.player=this.options.player,this.bindUrlChange(),this.logger.reportStartPlay()}}}}]);